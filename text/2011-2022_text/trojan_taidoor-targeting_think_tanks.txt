Security Response

Contents
Executive summary............................................ 1
Introduction ....................................................... 1
Technical details ................................................ 3
The email ...................................................... 3
The attachment ............................................ 6
The dropper .................................................. 7
The payload .................................................. 8
Command-and-Control server ..................... 8
Variants ...................................................... 11
Patterns of activity ..................................... 12
Attacker profile .......................................... 12
Conclusion........................................................ 12
Symantec protection ....................................... 13
Appendix .......................................................... 14
Sample files ................................................ 14
Recommendations ..................................... 15

Trojan.Taidoor:
Targeting Think Tanks

Stephen Doherty  
and Piotr Krysiuk

Executive summary
Trojan.Taidoor  has  been  consistently  used  in  targeted  attacks  dur-
ing  the  last  three  years.  Since  May  2011,  there  has  been  a  sub-
stantial  increase  in  its  activity.  Taidoor’s  current  targets  are  pri-
marily  private  industry  and  influential  international  think  tanks 
with  a  direct  involvement  in  US  and  Taiwanese  affairs.  Facilities 
in  the  services  sector  that  these  organizations  may  use  have  also 
been  targeted.  There  are  a  number  of  additional  ancillary  targets. 

in-field  telem-
Trojan.Taidoor  dates  back  to  March  2008  and 
etry  has  identified  Taidoor  being  used  in  targeted  attack  emails 
since  May  2009.  Fourteen  distinct  versions  and  three  sepa-
rate  families  of  the  Trojan  have  been  identified  to  date.  The 
threat  continues  to  evolve  to  suit  the  attackers’  requirements. 

Introduction
During  2009,  and  the  majority  of  2010,  government  organizations 
and  a  range  of  private  companies  were  targeted  by  the  Taidoor  at-
tackers.  However  around  the  beginning  of  2011,  the  attackers’  fo-
cus  shifted  dramatically,  with  international  think  tanks,  the  manu-
facturing  industry,  and  defense  contractors  who  have  interests  in 
Taiwan  consistently  being  targeted.  The  chart  below  illustrates  the 
volumes  and  the  industries  targeted  using  Taidoor  over  the  last 
three  years.  The  shift  in  targets  is  clearly  portrayed  in  figure  1.

Security Response

Trojan.Taidoor: Targeting Think Tanks

Figure 1
Targeted Taidoor attacks per industry 2009-2011

In 2011 the US had been involved in a variety of discussions with Taiwan, the most public of which was in relation 
to the upgrade of the Taiwanese Air Force. Around the same time Taidoor started to almost exclusively target in-
dividuals from influential think tanks, specifically those who have expertise in South Asian and South-East Asian 
policy and military strategy. Although these are 
not the first attacks on think tanks, the persis-
tence and sheer volume of the Taidoor attacks 
has made them more notable. A timeline of 
the attacks highlights the increased volume of 
targeted Taidoor emails sent between May and 
October 2011, including their peak during the 
US-Taiwan Defense Industry Conference that 
was held September 18-20, 2011, as shown in 
figure 2.

Figure 2
Increase of Trojan.Taidoor targeted attack emails

While Taidoor’s targets have changed over the 
years, the attack methodology has remained 
consistent. Currently the only known attack 
vector for Taidoor is through targeted emails. 
The email attachments exploit a variety of 

Page 2

 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

vulnerabilities, yet the payload Trojan itself has seen little change in terms of functionality. Taidoor is limited to 
using publicly disclosed vulnerabilities; no zero-day exploits have been seen in use. This separates Taidoor from 
more recent high-profile attacks—such as those involving Duqu or the recent attacks on RSA—where the at-
tacks are highly sophisticated and exploit zero-day vulnerabilities. The Taidoor group appears to play a numbers 
game when it comes to breaching networks, relying on targeting users running out-of-date, unpatched versions 
of software for the attacks. As one particular campaign gathered momentum, the attackers resorted to sending 
broad and repeated barrages of emails to large groups of individuals at the target organizations in an attempt to 
compromise the network.

The rest of the document will discuss these attacks in more detail, beginning with a breakdown of the typical 
stages of a Taidoor attack. Starting with crafting the targeted email, the focus will then move to the attachment 
and its components: the Taidoor dropper containing the true payload—an embedded, encrypted back door 
Trojan offering remote access to the attacker on the compromised computer. Detailed analysis of the command-
and-control (C&C) functionality will be revealed, including the observation of hacked third-party servers as part 
of its infrastructure to forward communications to the attackers. During the analysis some live interactive ses-
sions were captured revealing interaction with a human attacker, and his or her intentions once on the box. One 
of these interactive sessions is presented. The final section provides attributes that may point to the profile of 
the attackers. 

Taidoor is not going away. It’s persistent, it’s constantly evolving, and the adaptability of the attackers will en-
sure that it remains a danger to any organization that falls within its scope. 

Figure 3
Mail server country of origin for Taidoor emails

Technical details

The email

This is the breach component of Taidoor, which is 
pivotal to the attack. Taidoor emails are created 
with varying degrees of sophistication and are 
typically employed in a two-pronged attack. 

The vast majority of emails used in these recent 
attacks are sent from mail servers based in Tai-
wan and the US, as shown in figure 3. The coun-
try of origin will change depending on the targets 
of the attack. For example the mails from France 
contained subject matter related to the G20 sum-
mit in Paris, while those coming from Turkey were 
directed at targets with Turkish email addresses.

Crafting the email
To begin with, the main target of interest is 
identified. The content of the email is specifically 
crafted in order to entice the chosen target into 
opening it. The email is then either sent solely to 
the target of interest or the target of interest plus 
a group of other personnel working at the same 
organization. This second strategy is popular with 
more recent Taidoor attacks, as it would prove 
useful in situations where compromising the main 
target is proving difficult. Compromising a lower-
value target still provides a foothold within the 
organization from where the attacker can then 
attempt to move towards the true target.

Page 3

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

There are two types of content typically found in Taidoor emails. The first type is simple, requiring little-or-no 
background research on the target. The content is general, typically including a catchy Subject line, a funny im-
age, a brief message, or a topical subject that may entice the user into opening the malicious attachment, such 
as that displayed in figure 4.

Figure 4
A generic Taidoor email

The second type requires some background research on the intended target. Far more preparation is required, 
as the email will need to contain content relevant to the target. The subject line, the message body and the at-
tached document will all contain information that might entice them into reading what is inside the attachment. 
The content is typically related to policy or events that the target would be interested in or would likely attend. 
The sender’s email address will also be doctored so that it appears to have come from a reputable source; some-
one they would probably recognize by name. This would likely be a co-worker, a speaker at an upcoming event, or 
a prominent individual in their chosen field. 

Page 4

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Here is an example of a targeted attack that took place on October 24, 2011. Over the course of the day, targeted 
mails were sent to 25 individuals working at three separate organizations. The same malicious file was attached 
to all the emails; however, the subject line and the message content differed. Examining the malicious attach-
ment we could see it was identical for each email. Here are the four subject lines used in these emails, followed 
by an example email:

•	
•	
•	
•	

Fwd: Panetta criticizes North Korea for reckless acts
Panetta criticizes North   for reckless acts
Returned mail: see transcript for details
Warning: could not send message for past 4 hours

Figure 5
An targeted Taidoor email

Out of the 25 emails, 22 were sent through a Taiwanese mail server. They targeted individuals working at an 
influential international think tank located in the US and were sent in quick succession. Later that day two more 
emails containing an identical attachment were sent through a mail server located in the US. However this time 
the emails targeted three prominent figures working at three separate organizations: one located in the US (the 
think tank that was targeted in the earlier batch of emails) and two others in Germany. These three targets are 
subject experts on military strategy and policy in South-East Asia. This tactic is typical of Taidoor, as mentioned 
earlier, where one of these targets appears to be the “real” target of interest and the rest appear to be of lesser 
interest, but could offer up useful information or be used as a stepping stone toward the true target. 

Page 5

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Figure 6
Emails targeting “Mr. X” (2011)

Determining who the targets of interest are is 
straightforward when examining the frequency 
of targeted emails sent to individuals. As an 
example, a target of interest at one of these 
organizations is referred to as “Mr. X”. 

Mr. X was sent up to 23 targeted Taidoor 
emails in June 2011 —a substantial increase 
from previous months. This individual was 
consistently targeted for over nine months—by 
far the most targeted individual. Such focus 
demonstrates the persistence of the Taidoor 
attackers. The repeated attempts indicate that 
this target has been extremely difficult to com-
promise and is considered of high value. 

Figure 7
Popularity of attachment type
(.dll, .scr, and .exe files are typically contained within archive files)

The attachment

The sample email above contained a mali-
cious PDF attachment; however, Taidoor 
doesn’t confine itself to PDFs. Taidoor has 
been used in a wide variety of attachments, 
including malicious Microsoft PowerPoint, 
Word (.doc and .rtf file formats), and Excel 
files. Malicious executables and even DLLs 
(BID 47741) have been used as part of 
recent attacks. In these cases the malicious 
file is typically contained within an archive. 
In more recent attacks Word documents 
and PDFs have been the most popular at-
tack vectors. However the malicious attach-
ments constantly change, with new exploits 
appearing regularly. 

The malicious attachments have used a 
large set of vulnerabilities over the years, 
covering all main document formats. This 
clearly indicates that this group has both 
the focus and the intent to keep these 
exploits relevant and up-to-date. The group 
is clearly not afraid to try out new exploits. 
The number utilized is remarkable.

•	
•	
•	
•	
•	
•	
•	
•	
•	

Microsoft PowerPoint Malformed Record Remote Code Execution Vulnerabilit
Microsoft Word Malformed Data Structures Code Execution Vulnerabilit
Adobe Acrobat and Reader Multiple Arbitrary Code Execution and Security Vulnerabilitie
Microsoft PowerPoint Sound Data (CVE-2009-1129) Remote Code Execution Vulnerabilit
Adobe Reader and Acrobat ‘newplayer()’ JavaScript Method Remote Code Execution Vulnerabilit
Microsoft Excel ‘FEATHEADER’ Record Remote Code Execution Vulnerabilit
Adobe Flash Player CVE-2011-0611 ‘SWF’ File Remote Memory Corruption Vulnerabilit
Multiple Microsoft Products DLL Loading Arbitrary Code Execution Vulnerabilit
Adobe Acrobat and Reader CVE-2011-2100 DLL Loading Arbitrary Code Execution Vulnerabilit

y (BID 18382)

y (BID 36945)

y (BID 21518)

y (BID 47741)

y (BID 47314)

s (BID 27641)
y (BID 34839)

y (BID 48252)

y (BID 37331)

It is worth noting again that none of the vulnerabilities used by Taidoor are zero-day exploits. Taidoor simply 
leverages publicly disclosed security bugs in popular applications and therefore relies on the target or targets to 
be running unpatched software.

Page 6

 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Figure 8
Breakdown of malicious attachment types for 2011
(.dll, .scr, and .exe files are typically contained within archive files)

Figure 8 shows the email attachment 
types chosen by attackers in 2011.

We can see a marked increase in the 
use of vulnerable Word documents in 
the run-up to the US-Taiwan Defense 
Industry Conference in September 
2011. The group probably found 
more success with the Word exploit 
for this period of the campaign. 
However they switch to older vulner-
abilities if the new ones are proving 
less successful, which was the case 
for BID 47741. 

The goal of the email is to entice the 
recipient into opening the malicious 
attachment. The goal of the attach-
ment is to surreptitiously copy the 
embedded Trojan onto 
the user’s computer and 
launch it without drawing 
attention to the fact that 
the user has just been 
compromised.

Figure 9
Taidoor PDF attachment

Taking the attachment 
in the previous targeted 
email, let’s examine what 
happens if the malicious 
document is opened. 
The PDF is exploiting BID 
47314, a vulnerability 
in Adobe Reader that 
leads to code execution 
of the attacker’s choos-
ing. This code decrypts, 
extracts, and executes 
the embedded Taidoor 
dropper. It also extracts 
and presents the clean 
PDF in figure 9, so as not 
to alarm the user to any 
unusual behavior. 

The content in the PDF was scraped from an Associated Press article that started to appear on most major news 
feeds the very day the email was sent: October 24, 2011.

The dropper

Once the user has opened the malicious attachment the infection process is set into motion. Once the dropper 
is created in the file system, it is executed. It starts one of the following legitimate processes, after which it will 
replace this clean, in-memory image with the malicious back door component:

•	
•	

services.exe 
svchost.exe 

Page 7

 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

The back door component is normally present in the form of either an encrypted resource entry or as an encrypt-
ed binary array within the code section of the dropper. Figure 10 helps illustrate the layout of each file and the 
steps taken once the malicious attachment is launched. 

Figure 10
Taidoor file layout

47314

The payload

The final payload is now in place. This is the back door component that communicates with the C&C server. The 
back door stores configuration information in the “.data” section which is setup by the attackers. This configu-
ration information contains up to three C&C servers, up to three ports per server, and a default sleep interval. 
Once the back door is successfully installed on the system it will attempt to communicate with the C&C server 
using the HTTP protocol. Let us examine this in more detail.

Command-and-Control server

Protocol
Trojan.Taidoor communicates with the controlling server using the HTTP protocol with requests using the follow-
ing format and detailed in table 1:

http://[C&C _ SERVER]:[PORT]/[RANDOM].php?id=[RAND][ID][OPTIONAL]

Table 1

HTTP communication format
Variable
[C&C_SERVER]

Description
Up to three configurable C&C servers

[PORT]

Up to three configurable ports

[RANDOM_PATH]

Five random, lower-case letters. Recreated every time Taidoor initializes or fails to contact its configured servers.

[RAND]

[ID]

Six-decimal, random number recreated for each request. The values are between 0-32767 (limited by RAND_MAX).

Twelve characters derived from MAC address of the compromised computer.

[OPTIONAL]

Is "&ext=[FILENAME]", which may be present in requests, related to specific commands.

Page 8

PDF ExploitingBID CleanPDFEncryptedTaidoorDecryptsTaidoordropperEncryptedback doorcomponentBack doorInjectsEncryptedC&Cserversservices.exe / svchost.exe 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

When the message body is present in a request or response, it is encrypted using RC4. The RC4 key is simply a 
string representation of the compromised computer’s adapter address (e.g. 01-27-89-AB-CD-EF). This means 
that the C&C server must be able to compute the RC4 key from the [ID] present in the HTTP request. Because 
such an [ID] is unique for each computer it could also be used by the controlling server for tracking purposes. 

Trojan.Taidoor uses an algorithm when generating the ID field. First it obtains a string representation of the 
adapter address. A default value of “01-01-01-01-01-01” is used if it fails to obtain the adapter address. It strips 
the “-” characters from the string and then increments the value of each character. If it encounters ‘9’ this value 
will be set to ‘0’. For example “01-27-89-AB-CD-EF” would convert to “123890BCDEFG”

Trojan.Taidoor periodically queries the C&C server for commands by sending GET requests with an empty mes-
sage body. This period is configurable by the attacker and is stored, along with the C&C information, in the 
data section. Values for this sleep interval has been seen as low as two and as high as 600 seconds. The server 
responds with RC4-encrypted commands in the message body. The first byte of decrypted message body is the 
command ID, followed by an optional parameter. Table 2 details the commands available to the attacker.

Table 2

Taidoor C&C commands
ID* Format Command
2

Set Delay

DWORD

Details
Period in milliseconds for the sleep time in between requests. 

3

4

5

7

STRING

Execute  
Command

Command to be executed. The generated output is collected in a temporary file and 
sent in a separate POST request. The POST request does not contain any indication 
about the corresponding command.**

STRING

Download and Execute

The URL location to download a file, which is saved to the %Temp% folder and ex-
ecuted.

STRING

Download File

STRING

Upload File

Path of the file to be created. The content of the file is downloaded using a separate 
GET request with [OPTIONAL] set to "&ext=[BASE64_ENCODED_FILENAME]"

Parameter is the path of the file to be uploaded. Content of the file is uploaded using 
separate POST request with [OPTIONAL] set to "&ext=[BASE64_ENCODED_FILE-
NAME]"

*All other commands are IDs treated as pings. 

**A strong indicator this back door is designed for human operators.

Live interactive session
Our honeypots were able to capture some live, interactive sessions of the attackers in action. Table 3 presents 
logs of the activities of an attacker during one of these sessions on September 16, 2011. This is the first 60 sec-
onds of the attacker in action, logged from 02:23:06 UTC.

Table 3

Example of attacker activities through back door
Timeline
2011-09-16 02:23:06 UTC: RECV

Commands Received
[Ping]

2011-09-16 02:23:15 UTC: RECV

[Set sleep interval to 1 second]

2011-09-16 02:23:23 UTC: RECV

cmd /c net start

2011-09-16 02:23:31 UTC: RECV

cmd /c dir c:\docume~1\

2011-09-16 02:23:52 UTC: RECV

cmd /c dir “c:\docume~1\<CurrentUser>\recent” /od

2011-09-16 02:24:00 UTC: RECV

cmd /c dir c:\progra~1\

2011-09-16 02:24:12 UTC: RECV

cmd /c dir “c:\docume~1\<CurrentUser>\desktop” /od

2011-09-16 02:24:25 UTC: RECV

cmd /c netstat –n

2011-09-16 02:24:32 UTC: RECV

cmd /c net use

Page 9

 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Before the attacker starts an interactive command shell, Taidoor is instructed to reduce the sleep interval to one 
second. This improves Trojan.Taidoor’s response time to subsequent commands sent by the attacker. Over the 
next 60 seconds the attacker will look for the following information about the compromised host:

•	
•	
•	
•	
•	
•	
•	

Currently running services.
Contents of the “Documents and Settings” folder: What users are on the system?
Contents of the “Recently Used Documents” item.
Contents of the “Program Files” folder: What software is installed?
Contents of the Desktop.
A list of the currently open TCP/IP connections.
A list of available network connections.

Figure 11
C&C servers by country

Figure 12
Previously hacked C&C server, as shown in a  
publicly accessible website

The attacker initially searches for docu-
ments and users of interest on the com-
promised computer. If the user is not a 
target of interest, the attacker can search 
for other computers of higher value on the 
network using the shell or by downloading 
additional tools on to the compromised 
computer in order to assist in traversing 
the network. It is worth noting that this is 
not automated, but that an actual attacker 
sitting at the other end, typing these com-
mands.

Hacked third-party servers
Some basic reconnaissance was done on 
the C&C servers used by Trojan.Taidoor. 
Many of the Taidoor C&C servers probed 
appeared to be compromised third-party 
servers, as opposed to leased servers 
commonly used as part of a C&C infra-
structure. The servers are probably used 
in an effort to hide the true location of 
the attacker and they simply forward the 
malicious communication to another loca-
tion. The highest concentrations of Trojan.
Taidoor C&C servers are in the US and 
Taiwan, as shown in figure 11. 

Simple fingerprinting on these computers 
revealed that they were consistently run-
ning a number of services. It is probable 
that such services were vulnerable to basic 
attacks, as several of the C&C servers had 
been compromised by third-party hackers 
prior to their use by the Taidoor attack-
ers. The screenshot in figure 12 is from a 
cached Web page defacement of one par-
ticular server. Such defacements are typi-
cally performed by attackers with limited 
skill sets. This implies that the services on 
the computer were trivial to compromise 
or that it was poorly maintained, with little 
or no patching.

Page 10

 
 
Security Response

Variants

Trojan.Taidoor: Targeting Think Tanks

To date we have seen at least 14 different variants of Trojan.Taidoor. The earliest compilation date is March 11, 
2008. Trojan.Taidoor doesn’t track version information itself. However, examining modifications to the compiled 
code section of the back door component over time allows for version tracking. Most of the distinct PE images 
share identical code sections, and only the details of the C&C servers in the data section differ between attacks. 
Some versions have seen extensive use, while others have been seen far less frequently, and for very brief peri-
ods of time. Figure 13 tracks the modifications over time. 

Figure 13
Taidoor versioning 2008-2011, based on PE code section similarity

This chart shows the date and timestamp of the compiled files with the identified version of the back door. 
Version 1 was used on March 11, 2008 and version 13 was used from March 16, 2011 up until August 13, 2011. 
There is very little overlap in use of the back doors between versions. This indicates that a single entity is re-
sponsible for development. If the source code of the threat was shared amongst multiple entities, there would be 
a much larger number of versions, 
and their use would overlap more. 
Several variants were used for an 
extended period of time, the most 
widely being version 13—the ver-
sion used to target think tanks.  

Figure 14
Taidoor version distribution in emails (2010-2011)

The chart in figure 14 compares 
the date of emails, instead of 
compile time, with the back door 
version. There is some degree 
of overlap, but the majority of 
usage is again distinct between 
versions. This reinforces the as-
sumption that a single entity is in 
control of the source code. 

Page 11

 
 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Patterns of activity

Some interesting patterns of behavior were observed during the interactive sessions with the C&C servers. For 
most of the day the servers would issue a connection reset or return an HTTP 404 (Not Found) message. These 
servers then “woke up” for certain periods of the day. These times typically occurred between 1:00 and 8:00 
UTC. This was the case for the majority of successful C&C interactions logged, indicating some regular pattern of 
activity for these attackers. 

Attacker profile

Attributing the Taidoor attacks to a particular party is not likely, but there are a number of factors in the Trojan.
Taidoor attacks that may offer an indication as to the source of the threat. 

Taidoor has been maintained with new versions and new exploits relatively consistently from 2008, up to the end 
of 2011. Such consistency is possible for an individual working full-time. However, the additional work required 
to maintain the infrastructure behind Taidoor—hacking C&C servers, investigating targets in order to tailor 
attacks, and then actually spreading within a network once it is compromised—is beyond the capabilities of an 
individual. A number of people are clearly involved. This is likely an organized group of individuals who have a 
broad range of skills and a reasonable level of hacking ability, given the number of compromised C&C servers. It 
is quite possible that individuals within the group are given particular roles for each stage of the operation, since 
this work would divide up easily. 

However, although the group is active and must consist of several people, their resources are limited. No zero-
day exploits have been found associated with Taidoor; only previously published ones. The group does not have 
the skills to develop a zero-day, nor the funds to obtain them. The C&C servers are hacked, not purchased. 
Although hacking of the C&C servers does offer a level of anonymity, it is also an unreliable method of control. 
The hacked C&C servers may be discovered by the owner of the compro-
mised computer and shut down at any time. As such, it is unlikely that 
the group has access to substantial funds. 

Table 4

The times of operation of the attackers may be an indicator as to their 
location. As described earlier, interactions with the C&C servers oc-
curred primarily between 1:00 and 8:00 UTC. Table 4 shows these times 
for various countries around the world. 

In addition, the group can write competent emails in both English and 
Traditional Chinese. 

Time zones
Region
Japan

Local Time
10:00am—5:00pm

Taiwan

 9:00am—4:00pm

China (Beijing)

9:00am—4:00pm

India

6:30am—1:30pm

Russia (Moscow)

5:00am—12:00pm

The motivations of the group are difficult to determine. Clearly there 
was a major shift in the group in 2011, judging from the change in tar-
gets. Initially starting with a wide range of disparate targets, the group 
began to focus almost exclusively on one particular type of target—
policy think tanks—and in relation to one particular topic: US-Taiwanese dealings. The nature of the topic is 
something that would be of most interest to parties involved in the discussions, parties who may be affected by 
the discussions such as private industry looking for a competitive advantage or nation states, or possibly hackers 
looking to expose confidential information on such discussions for ideology or fame.

5:00pm—12:00pm

8:00pm—3:00am

US (Eastern)

US (Pacific)

UK

1:00am—8:00am

Conclusion

Trojan.Taidoor’s attack methodology follows a consistent pattern associated with targeted attacks: a crafted 
email with a malicious attachment. It’s clear that this group is highly motivated and persistent, which is evi-
dent from the longevity of the Taidoor campaign and the variation in targeted organizations. These attacks are 
ongoing, so we will continue to provide Symantec customers with cutting-edge solutions to protect themselves 
against both current and future Taidoor attacks.

Page 12

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Symantec protection

Many different Symantec protection technologies play a role in defending against this threat, including:

File-based protection (traditional antivirus)

Traditional antivirus protection is designed to detect and block malicious files and is effective against files as-
sociated with this attack.

r

•	
•	
•	

Trojan.Taidoo
e
Trojan Hors
f
Trojan.Pidie

Network-based protection (IPS)

Network-based protection in Symantec Endpoint Protection can help protect against unauthorized network ac-
tivities conducted by malware threats or intrusion attempts. Symantec Critical System Protection and Symantec 
Web Gateway can block access to the C&C servers. 

Behavior-based protection

Symantec products, like Symantec Endpoint Protection, with behavior-based detection technology can detect 
and block previously unknown threats from executing, including those associated with this attack. Files detected 
by this technology will be reported as Bloodhound.Sonar.9.

Reputation-based protection (Insight)

Symantec Download Insight, found in Symantec Endpoint Protection and Symantec Web Gateway, can proac-
tively detect and block files associated with this attack using Symantec’s extensive file reputation database. Files 
detected by this technology will be reported as WS.Reputation.1.

Email-based protection

The Skeptic heuristic engine in Symantec MessageLabs Email Security.cloud can proactively detect and block 
emails that are associated with this attack.

Other protection

Application and Device Control — Symantec Endpoint Protection users can enable this feature to detect and 
block potentially malicious files from executing.

Symantec Critical System Protection can also prevent unauthorized applications from running.

IT Management Suite provides comprehensive software and patch management.  Critical System Protection can 
protect servers against vulnerabilities between patching cycles. 

Page 13

Trojan.Taidoor: Targeting Think Tanks

Security Response

Appendix

Sample files

The following files are a representative sample of those used in the Taidoor attacks.

Table 5

Sample MD5s
MD5
50c3de93fc5ee424b22c85c5132febe9

d6a23c475907336d5bf0f11111e62d44

e0255a0bbd6d067bc5d844819fee4ec6

28f7eca368fd18b0a7c321927281e387

8e3d7fcfa89307c0d3b7951bd36b3513

c2e05204221d08d09da1e3315b1b77a1

e8390f9960e1acb2ca474a05fdbd1feb

02a1a396e3607a5d2f8ece9fc5d65427

a41186ac5bef467204c721e824b550cf

46c6da9be372f64ef17205fd3649fa80

4c874b2bf0a5ee4bdebf7933af0d66b1

002cec5517c17ffac2e37908fcab45ff

207e770f53bf1ea6bfb8068614ad0f70

d49024573cb0763c1b33259ddbf4dd72

e05b832dc588b1055d64daa7dfd03eb7

f8c670662bc2043664269671fb9a2288

18471c628a29e602ec136c52f54f1f83

34d333a18b5b8b75cad46601163469ce

ec8a87a00b874899839b03479b3d7c5c

c645169173c835c17abb0bde59b594bb

60d519e00f92b5d635f95f94c2afdc68

804011277338eb3c372ae4b520124114

b817c2335e520312d0ae78c309d73d22

50a713a00c8468f7f033e79a97f6b584

d642d3dde179ce5be63244c0f6534259

8810f26133d5586477c8552356fc4439

527a6cd21f0514ef5baa160b6e6b1482

90ed80f18b05a52bf2801c7638b371e3

e8291553bd947082476a123c64ac8e82

b25c3e81cdef882f532ba78a8fdcd7ca

60a8524d36d8a5e70d853bf3212616c5

b8c89fdc109db7522faf2180648dad2f

4859ba249a200d34189166abfd57a3dd

309ac58218250726b3588d61738d5b21

90c88267efd63fd8e22fb0809be372bc

6491873b351b8d0deccd6e30211ce137

2a0dcb1915c0465949e7aecfb06f47ea

08cdc6213d63ea85fbccd335579caec4

c898abcea6eaaa3e1795322d02e95d7e

de095f05913928cf58a27f27c5bf8605

8c57fe2c1112d2122bfd09f5f91f7154

b4cb1b1182ea0b616ed6702a2b25fac2

86730a9bc3ab99503322eda6115c1096

Type
scr

Target Region Date
USA

18/05/2011

scr

pdf

pdf

pdf

pdf

pdf

pdf

pdf

pdf

pdf

pdf

pdf

exe

scr

pdf

scr

scr

pdf

xls

doc

scr

doc

pdf

pdf

doc

doc

pdf

doc

pdf

doc

doc

doc

pdf

dll

pdf

pdf

pdf

pdf

pdf

xls

pdf

pdf

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

UK

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

USA

17/05/2011

20/06/2011

23/06/2011

22/06/2011

24/06/2011

24/06/2011

26/06/2011

27/06/2011

27/06/2011

29/06/2011

28/06/2011

29/06/2011

05/07/2011

06/07/2011

07/07/2011

08/08/2011

04/08/2011

10/08/2011

05/08/2011

16/08/2011

21/08/2011

15/08/2011

30/08/2011

31/08/2011

02/09/2011

30/08/2011

06/09/2011

14/09/2011

14/09/2011

16/09/2011

15/09/2011

09/09/2011

29/09/2011

20/09/2011

14/10/2011

18/10/2011

20/10/2011

24/10/2011

25/10/2011

29/10/2011

01/11/2011

03/11/2011

Page 14

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Recommendations

Update antivirus definitions
Ensure that your antivirus software has up-to-date antivirus definitions and ensure that your product has the auto-
protect feature enabled. You can obtain the latest definitions through LiveUpdate or download the latest definition 
files from our website.

Apply patches for the following vulnerabilities
Symantec recommends that users apply patches for the following vulnerabilities to help protect against this and 
similar attacks:

•	
•	
•	
•	
•	
•	
•	
•	
•	

Microsoft PowerPoint Malformed Record Remote Code Execution Vulnerabilit
Microsoft Word Malformed Data Structures Code Execution Vulnerabilit
Adobe Acrobat and Reader Multiple Arbitrary Code Execution and Security Vulnerabilitie
Microsoft PowerPoint Sound Data (CVE-2009-1129) Remote Code Execution Vulnerabilit
Adobe Reader and Acrobat ‘newplayer()’ JavaScript Method Remote Code Execution Vulnerabilit
Microsoft Excel ‘FEATHEADER’ Record Remote Code Execution Vulnerabilit
Adobe Flash Player CVE-2011-0611 ‘SWF’ File Remote Memory Corruption Vulnerabilit
Multiple Microsoft Products DLL Loading Arbitrary Code Execution Vulnerabilit
Adobe Acrobat and Reader CVE-2011-2100 DLL Loading Arbitrary Code Execution Vulnerabilit

y (BID 18382)

y (BID 36945)

y (BID 21518)

y (BID 47741)

y (BID 47314)

s (BID 27641)
y (BID 34839)

y (BID 48252)

y (BID 37331

Prevent back door communications
Block access to the following command-and-control server IP addresses that are associated with this attack.

Table 6

C&C servers
IP
110.142.12.95

203.45.204.239

220.245.107.203

193.170.111.210

88.117.175.114

81.21.80.40

203.188.255.117

24.79.164.206

213.41.162.198

62.38.148.117

212.205.207.42

202.82.162.61

218.103.88.197

220.246.17.40

220.246.5.52

219.76.232.33

202.65.218.205

202.60.254.253

203.198.133.15

203.198.142.209

210.3.235.154

210.245.194.241

122.160.96.111

Country
Australia

Australia

Australia

Austria

Austria

Azerbaijan

Bangladesh

Canada

France

Greece

Greece

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

Hong Kong

India

ASN
1221

1221

7545

1853

8447

39280

9832

6327

13193

3329

6799

4515

4515

4515

4515

4515

9584

9925

4760

4760

9304

17444

24560

Registrar
apnic

apnic

apnic

ripencc

ripencc

ripencc

apnic

arin

ripencc

ripencc

ripencc

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

Page 15

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Table 6

C&C servers
IP
61.12.21.84

202.56.122.100

203.92.33.98

59.162.253.38

202.155.109.228

217.218.246.18

78.39.115.35

78.39.236.6

192.116.205.100

2.116.180.66

83.149.128.190

2.229.10.5

210.20.35.2

202.251.249.136

61.200.43.129

203.179.145.2

219.123.85.187

61.107.131.147

61.107.29.111

211.177.131.120

211.47.189.41

203.234.132.173

222.101.218.86

61.80.90.113

211.169.248.159

211.233.62.146

211.233.62.147

211.233.62.148

211.234.117.132

211.234.117.185

211.254.153.122

218.208.203.106

207.248.250.60

201.158.139.83

201.175.42.79

201.116.58.243

62.231.246.150

203.81.229.89

200.115.173.102

203.215.80.180

212.33.79.176

62.89.115.229

80.96.120.22

212.76.68.141

212.76.68.74

212.11.189.124

203.126.74.13

Country
India

India

India

India

Indonesia

Iran

Iran

Iran

Israel

Italy

Italy

Italy

Japan

Japan

Japan

Japan

Japan

South Korea

South Korea

South Korea

ASN
17820

10077

10029

17908

4795

12880

12880

12880

5486

3269

31319

12874

9824

4686

17676

4716

17506

9457

9457

9318

South Korea

38661

South Korea

South Korea

South Korea

South Korea

South Korea

South Korea

South Korea

South Korea

South Korea

South Korea

Malaysia

Mexico

Mexico

Mexico

Mexico

Oman

Pakistan

Panama

Philippines

Poland

Poland

Romania

Saudi Arabia

Saudi Arabia

Saudi Arabia

Singapore

9979

4766

4766

3786

3786

3786

3786

3786

3786

3786

4788

11172

14000

22908

8151

28885

38616

27956

6648

8865

12968

2614

41176

41176

42428

3758

Registrar
apnic

apnic

apnic

apnic

apnic

ripencc

ripencc

ripencc

ripencc

ripencc

ripencc

ripencc

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

lacnic

lacnic

lacnic

lacnic

ripencc

apnic

lacnic

apnic

ripencc

ripencc

ripencc

ripencc

ripencc

ripencc

apnic

Page 16

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Table 6

C&C servers
IP
58.185.2.34

202.172.37.145

203.116.203.67

213.81.217.7

217.125.43.149

203.64.22.11

202.39.212.245

210.242.240.218

211.20.65.188

211.21.156.15

211.22.75.68

211.72.181.61

211.72.191.145

211.72.80.242

220.130.219.242

220.133.170.33

59.120.16.115

59.120.54.79

60.248.17.81

60.249.219.82

60.251.220.144

61.218.83.3

61.220.129.45

61.220.42.130

61.221.152.191

61.221.233.99

61.222.205.180

219.84.143.15

219.87.26.129

202.3.167.6

61.19.124.116

61.7.150.118

61.7.158.11

58.137.157.163

58.137.163.166

202.60.203.229

202.183.233.66

113.53.236.67

213.42.74.85

64.118.87.250

98.189.155.145

65.115.139.158

209.156.150.178

12.43.95.117

168.8.80.21

68.195.237.234

64.39.73.148

Country
Singapore

Singapore

Singapore

Slovakia

Spain

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Taiwan

Thailand

Thailand

Thailand

Thailand

Thailand

Thailand

Thailand

Thailand

UAE

United States

United States

United States

United States

United States

United States

United States

ASN
3758

17547

4657

6855

3352

1659

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

3462

18182

9924

9831

9931

131090

131090

4750

4750

17887

10227

9737

5384

32742

22773

209

1785

7018

6389

6128

United States

27521

Registrar
apnic

apnic

apnic

ripencc

ripencc

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

apnic

ripencc

arin

arin

arin

arin

arin

arin

arin

arin

Page 17

 
Security Response

Trojan.Taidoor: Targeting Think Tanks

Table 6

C&C servers
IP
68.82.45.168

65.214.70.122

76.5.157.172

208.40.105.162

184.11.128.172

65.23.153.148

65.23.153.178

216.139.109.156

208.57.226.46

209.123.166.170

64.34.60.218

108.77.146.124

64.167.26.66

65.68.51.49

99.1.23.71

70.63.209.63

216.27.242.38

216.27.242.41

72.9.221.133

174.123.19.84

65.246.9.27

65.249.138.102

71.246.244.139

96.229.98.180

206.111.214.29

Country
United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

United States

ASN
7922

13388

13787

2707

5650

22822

22822

33165

18687

8001

13768

7132

7132

7132

7132

11426

22343

22343

22343

21844

701

701

19262

19262

2828

Registrar
arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

arin

Page 18

 
Security Response

Any technical information that is made available by Symantec Corporation is the copyrighted work of Symantec Corporation and is owned by Symantec
Corporation.

NO WARRANTY . The technical information is being delivered to you as is and Symantec Corporation makes no warranty as to its accuracy or use. Any use of the
technical documentation or the information contained herein is at the risk of the user. Documentation may include technical or other inaccuracies or typographical
errors. Symantec reserves the right to make changes without prior notice.

About the authors
Stephen Doherty is a Security Response Manager 
and Piotr Krysiuk is a Senior Software Engineer, 
located in Dublin, Ireland.

For specific country offices and contact num-
bers, please visit our Web site. For product 
information in the U.S., call 
toll-free 1 (800) 745 6054.

Symantec Corporation
World Headquarters
350 Ellis Street
Mountain View, CA 94043 USA
+1 (650) 527-8000
www.symantec.com

About Symantec
Symantec is a global leader in
providing security, storage and
systems management solutions to
help businesses and consumers
secure and manage their information.
Headquartered in Moutain View, Calif.,
Symantec has operations in more
than 40 countries. More information
is available at www.symantec.com.

Copyright © 2012 Symantec Corporation. All rights reserved.
Symantec and the Symantec logo are trademarks or registered
trademarks of Symantec Corporation or its affiliates in the
U.S. and other countries. Other names may be trademarks of
their respective owners.

