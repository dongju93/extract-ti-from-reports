855 868

3 33

du

ur

s

r

s

s

r

s

s

dr

d d

r

r
r

d s

w r

d

r

d s

r d s

s

r

rs

r d

r
E s r Eur

sur s

d

s

w r
d

d
d d

s

s

s d

r

s

s

ur

s

s

Eur
r

d
s r d

w r

s

s

dr

r

us d

ss

r u

r du

s
d

r w s
r
d r s w r

d w
rs

r

s
r
ss d

u d

r w r

r

r s
d

d ws

d

s u

s
u s

d

r
d
s
us s d

s r

d

w r w s

r
w r

u s

ss r d
d
d

u

d

w r us rs w

s

s u d w

s

rus s u
d
r s

w r

s

d
s

us d
r d

r

r

r

r

r d rs r

r

w r w s r
d s

d

s d
u

d

s

w r

d

s

rs

d
r

r

w r

s s

d s s

s

r
rs w

I
s

s

d

s r
ss

s s

r

s d r

us
r s ur

s

s

s

d

d

r

d

s

s u

d

w w r d

d

ur

s s

w s wr

r

s

s d

s u

r
s su

d s
I
s

d

r d

s d

u s r u

d

d

z

s

w r w

ss u

u

z d
s

s s

w

w

s

E 201

113

d

E 2015 1 01 w r

u d

s

s w

s

ss

s

rs

www z

I

s

s w u d

r
s

s ru

w r s

s

u
w

ur r

s ru

z d

r d

ss

rs

s
s r

s w r s ur
s
s s

r

ss s w r
d

s

ud
d

r

u

r
s

s

s ur

s w

r r

ss w

ur

r
s w u d

s
r

rs

u

rd
w r

d d

rds

ddr ss s r
s

w

r

d r

s

ur

r

ddr ss s u
s ru

u 6

u

s

r
s w

s ur d

ddr ss s

I
s s

w

d
s

s

d

s

w
w r us d

I Nt* and Rtl*
ss us r s

d d r
s us d

s s

s INT 2Eh

rus s w r

d s d

d CALL ntdll!KiFastSystemCall
s
w

s d
d

s r

d

s

s

d ws

s r

rs

s

w

Is
u d rs
r
r d

d s s
d
s

s r u d u

d u d r d u

s u

d ws

s
r

s
s s

r w

d ws r

r

r s
r

d

rs

r

u
s

d

us
r

u

d r
s

su r u
r

s

s s

u s

u d

s s

r

ss

d

u d

s s

u

d s w

d r s

s

ss

s

z d s

ru

s

d

r s

r

u

r

rus r du s

r w E

u

s

s r s
r

ur

r

d

I

r us
s
r d

r

s
ds s

I

s d
rus s w r

r u d r

s

d w

u

s
r u

s

s

w

d d s

s

s u
s

s

s

r

s
s r

r
ss s

d

w d s
u s r d
r

s

r

r

us

us

d

r

us

rs

r

d

d
s s

r

r u

s d r w r

r

r

s

r
u

I

d

u

us

ru
2015 1 01

r
d

r

s r

s
s d
s w
d
r u

r

s
r
r w

s
s r
s

s

w

w
ss w

d

s r

r

d

rus s w r

r

ru

s

d

s

s

r
r us d

s

s

u r

d
s ru

s r
s r

ud d
ss
s r

s

s
s r s r
dd

r w

E 201
s
urr

r
s d

113
w us
us r

s
d

E

s r

r

ss

u ur

r

s

s
w ru
r

w wr

s s N

r

d s

r u r

d s

kernel32.dll

u

ss w r s

r
d user32.dll

s N

d ws su s s

d

N

s
z d
r

r
d

r

r

r

ntdll.dll I

C:\Windows\Temp:1
s r d

ru

s r

us

u

r

w

s

u s SetupExecute

HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\\

d BootExecute

r ws rs
r

explorer.exe

N

s r

s r
s dd
r

sur

su

ss

N

s

w r

ss

d r
s

s r

r s

r

r dr
s dr

rs r us
rs r

d d

r

rus s w r

r dr
r

rs r

ru

d

r

w r
r w

r

ss

d

u d

r r
ss

r

r

ru s
u

d

N

s s

ru

s w r d
s d

d w

r

r

w

r

N
ur

w

s d

N

ru

d

s

s s

r

s

s

N

dur
s s

u

r
r
r

s
ss

r

s

r

d

r
rus s r

r

r

s

rus s w r
w s d
us

s

s

d
r
us s
rus s w r

d

s

d s u d r

rdpinst.exe

d r

s rs

ru

\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce

s s
N

s

ru
r

d dr

s

d

r

ru

r

s u

N
r

ss

s

r wr
r

r

s r

ur

s

u

r

s ru ur
rs

r

r

w r s

s

s r
s s

d
r

s

s s ru ur

s

s s ru ur
s s
rs

r

r

r

r

r s
ss d s

r

u
r

r

r

d
r s

s

r

r

r

s
s s

u

r
d s
r

d us
d

d

s

us

s
r

r

d r

r
r du

ss s
s

r

s

s

u

rs

r

r r s

d

d r
s

s
d

s
r u

s r
s r

E

s ur

r

r s
s r

r

s

r

r

d

ss

d

r

I

ud d

s

d r

r
w

r

r
ss

d 6

r

s
u

r

s

r

d

d
E 201

r

r ss d
113

d

d ws N

I

rs
rs
u
ddr ss

s

I d
d

s

s

u s s d
d

r

ur

s r
r

u
ss w w r

r

s

d N

u s

s

d

r

d

s

d

s

u

u

r

w s

s z
r d

z d

E

r

r

s

d u

w

I

d

s r

us

s

ddr ss

r

r ur

r

N

d s

ddr ss

d r

u

s

I

s

d r

w

r d u

u

s

r

d u
su s s
rr r

ss

N
us d

r

I

d

E

H d r

r

r

Native

WindowsGUI

s w

d Subsystem
r ru

r

d r

1
u s

s

2
s d

s

d

d

s

d

ssw rd d r

u

s

s

d u

r

s

d r

d

s

s

d

u d

r
r

d us

w

r

d N

s

u
s ur

r

sd r

sd
s ur

s r s s r
u 1 56 1 26 sd r

r

r

u

r

r

su r u

d

s

s

r

s ru

u

rs

r d r

s

r

s

s r

r s r u

r d

s

N

r

r

r
u

s

r

r r

r

s d
ss

s

r

s d r
d
s

6

d r

r

r

r ss d

d

r

d

s
E 201

r
s
113 ur

d
r

s

r

N

d
r
d

rr

d

d

r ss d s r

r

us d r

s

s s

u

r

s
w r

s

r

s r

r

d

s

u

r

us su

r s ws

s

s

s

u

d

s
w u d

s

u

r

rw
r u

s

u
u

r
r u

s

d

r
d s d

s
d

s

s d
r du s

r

rus

s

s

d u w

s r
I w r

us d

ru

u
r u

r s

s

s

s d

r u d r

u

s

s

r

d

s

d r

r

ur

I w r

r d

r

w

rus r du s

s

d

r u

d d s

rs

d

w

s

s

s

s

r

r s

rd r

r

u d

I

s

I

s s

s ru

w u d
r

s w
r

s

s
w u d
d
d
us d

ru

d

s

I

s ru
u
u d

s

d

r du

r
ur s
r
r d r

s r E

s s
s
ss r
r

r
s d

r

r

d I
d
s

r u
ur s r su
s

s w u d

rd r
ru

d

s

r

86 s ru

w
s
s
s ru
0 80000002 0 80000003 r 0 8000000

us s

r d

d r

s

r u z
s
s
I w r
d

I
r u

s d s d

d

us

w
ss

rs
d s
r
d I s ru

sur
s
ur s

s r

s rs E
ur
r

E

r

s d
us

d s
s

r

I
E

s ru
d E

s

w

r d s r

s

u d

s

s

s

r

ss w

r

s

I w r E

0 8000000

Intel(R) Xeon(R) CPU
Common KVM processor
Common 32-bit KVM
Virtual CPU
Intel Celeron_4x0 (Conroe/Merom Class Core 2)
Westmere E56xx/L56xx/X56xx (Nehalem-C)
Intel Core 2 Duo P9xxx (Penryn Class Core 2)
Intel Core i7 9xx (Nehalem Class Core i7)
Intel Xeon E312xx (Sandy Bridge)
AMD Opteron 240 (Gen 1 Class Opteron)
AMD Opteron 22xx (Gen 2 Class Opteron)
AMD Opteron 23xx (Gen 3 Class Opteron)
AMD Opteron 62xx class CPU
Intel CPU version

s

s r

s

u r

s r

s us d

d E

# kvm -cpu ?
x86           qemu64  QEMU Virtual CPU version 2.4.0
x86           phenom  AMD Phenom(tm) 9550 Quad-Core Processor
x86         core2duo  Intel(R) Core(TM)2 Duo CPU     T7700  @ 2.40GHz
x86            kvm64  Common KVM processor
x86           qemu32  QEMU Virtual CPU version 2.4.0
x86            kvm32  Common 32-bit KVM processor
x86          coreduo  Genuine Intel(R) CPU           T2600  @ 2.16GHz
x86              486
x86          pentium
x86         pentium2
x86         pentium3
x86           athlon  QEMU Virtual CPU version 2.4.0
x86             n270  Intel(R) Atom(TM) CPU N270   @ 1.60GHz
x86           Conroe  Intel Celeron_4x0 (Conroe/Merom Class Core 2)
x86           Penryn  Intel Core 2 Duo P9xxx (Penryn Class Core 2)
x86          Nehalem  Intel Core i7 9xx (Nehalem Class Core i7)
x86         Westmere  Westmere E56xx/L56xx/X56xx (Nehalem-C)
x86      SandyBridge  Intel Xeon E312xx (Sandy Bridge)
x86        IvyBridge  Intel Xeon E3-12xx v2 (Ivy Bridge)
x86    Haswell-noTSX  Intel Core Processor (Haswell, no TSX)
x86          Haswell  Intel Core Processor (Haswell)
x86  Broadwell-noTSX  Intel Core Processor (Broadwell, no TSX)
x86        Broadwell  Intel Core Processor (Broadwell)
x86       Opteron_G1  AMD Opteron 240 (Gen 1 Class Opteron)
x86       Opteron_G2  AMD Opteron 22xx (Gen 2 Class Opteron)
x86       Opteron_G3  AMD Opteron 23xx (Gen 3 Class Opteron)
x86       Opteron_G4  AMD Opteron 62xx class CPU
x86       Opteron_G5  AMD Opteron 63xx class CPU
x86             host  KVM processor with all supported host features (only available in KVM mode)

I

ss s

s r

s s r d

s ru

ur

r

r

I

s ru

u d w

r s r

s

r

I w r E

0 0000000

r

r

r

s

s r E

s

0 0000000

s w r ur

s r

s

VMwareVMware
XenVMMXenVMM
KVMKVMKVM
prl hyperv
Microsoft Hv

www
r
s

r
1 9

s ru

H s

s

r

u

s

I

r

s

brbrb-d8fb22af1
jonathan-c561e0
avreview1-VMXP
vwinxp-maltest
avreview-VMSunbox
infected-system

us d

s s r
r

w r s

s r

u d

d

I s ru

I
www u

u 325383 d

r

s r

us

d u

s

u s 6

3
32 r

ur s s w r d

r

s

s

s I

r su

GetComputerNameW() s

u d

s

r

ss

s r su s
s
s s

su

s

r

s

s

r s d

s

d

s

s

s

s r

s

s s

u s r

GetModuleFileNameW()
r

s

s

s

s

s

s

s

us d

s d

s

C:\xxx\sample.exe
C:\sample.exe
C:\Shared\dum._vxe
C:\SniferFiles\sample.exe
C:\virus\virus.exe
C:\virus.exe
c:\sampel.exe
C:\setup.exe
C:\runme.exe
c:\VMRun\Zample.exe
c:\FILE.EXE
C:\run\temp.exe
c:\taskrun\samples\rtktst.exe.exe
c:\artifact.exe
C:\manual\sunbox.exe
C:\1.exe

r

d

malware.exe
\virus\
admin\downloads\samp1e_
sample_execution
mlwr_smpl.exe

s

r

w r

s

r

r

'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\\xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx'

s

r

d

rs

s

I s r

r

us

s

s d

us s

s

r

dr

s r s

s

r

r

s w d

s

ru

u

r w s w r
r

r

s ss

d w

u

s r s

us d

r

s d
ss

d

r

d

s

r

s

u us d
ru

rd

s
s s s

w
s w

s s
r d r
w s

rus

d

w

u d

s d r d

us

rs

s

d

d
w d

r

ss
32 d

r
ur u
u

s
d d d
s d

s s

s

w

r

d

r
r
r
d I

ss s
ss

u

u s

s

s

d
s

r

s

z

u
ss r

kernel32.dll

s

d d

r
r

ru

rus r du s

ntdll.dll s
d u

d w

d s

us r

ntdll.dll

r
s

w
d

u

d

r

r

s s

s

d r u r s

r wr

r

kernel32.dll
u d

ntdll.dll

r ntdll.dll
w

s s

us

r s

r d

d

s

r

d s w d u

d

N

kernel32.dll

us

u d r

ntdll.dll u

s

us r s

s

su

ss
d

d r

s

w

r

ntdll!LdrGetDllHandle()

d
s

s ss

d w us r s

s

s r

ss s

d

r

kernel32!GetModuleHandle()

d r

d

s

r

32

r

d d I

ss

d w

s d s

r d

r

r

s

r

r d

s

d d

s

r du s

I

s

u d

r su

s s r d s

u ur

us u

su

r ss d r s

u s

d d

u

z d

NN
u 32 d
d
u rd32 d
d

w

dd rr

s

d r

u

u rd

u

EH

d

ur

2

s32 d E s s

r

d

r

s

s

I
s w r

s

s r d r

r s r

u d

r

ss

r

s r

ur

s

s

r

ss

d w s d

C:\agent\agent.pyw
C:\sandbox\starter.exe
c:\ipf\BDCore_U.dll
C:\cwsandbox_manager
C:\cwsandbox
C:\Stuff\odbg110
C:\gfisandbox
C:\Virus Analysis
C:\iDEFENSE\SysAnalyzer
c:\gnu\bin
C:\SandCastle\tools
C:\cuckoo\dll
C:\MDS\WinDump.exe
C:\tsl\Raptorclient.exe
C:\guest_tools\start.bat
C:\tools\aswsnx\snxcmd.exe
C:\Winap\ckmon.pyw
c:\tools\decodezeus
c:\tools\aswsnx
C:\sandbox\starter.exe
C:\Kit\procexp.exe
c:\tracer\mdare32_0.sys
C:\tool\malmon
C:\Samples\102114\Completed
c:\vmremote\VmRemoteGuest.exe
d:\sandbox_svc.exe

Nu

r w

r

s s

r

I

r s

r du

r

r s 1

r d r
s
r

w s s r d r
s d
ru

r us H r s w
r u

I

s ud

r

1

r

u

s

d

RtlGetNativeSystemInformation(SystemBasicInformation, ...)

s

w

s

d \_SYSTEM\_BASIC\_INFORMATION.NumberOfProcessors
r

ss s

d

r

r

r

struct
d

u

SYSTEM\_BASIC\_INFORMATION s ru
r d r
s 1

r du

d

s

s
r d s ud

r

r d s r

s

r

d

'Intel(R) Core(TM) i7'
'Intel(R) Core(TM) i5'
'Intel(R) Core(TM) i3'
'Intel(R) Core(TM)2 Duo CPU'

N u r
r
s

I

s
NtQuerySystemInformation() d u

IN

E

r

SYSTEM_BASIC_INFORMATION

r

s 32

r

s

I N
d

u
N r
d

rd

I

u d

s ur
u
3 00 0

RtlGetNativeSystemInformation() s

s

s ur

struct

s ru

E

I

IN

I N

s

s r

ss

d w s w r us d

u

z s

s

dir_watch.dll
tracer.dll
SbieDll.dll
APIOverride.dll
NtHookEngine.dll
api_log.dll
LOG_API.DLL
LOG_API32.DLL

ntdll!LdrGetDllHandle() I

s

s r

d d

r

ss

r

s

r

r

r

N

s

I

r

s us N u r

s

I

r

s

du I

r

ntdll!RtlGetNativeSystemInformation(SystemModuleInformation, ...) s

d

s r ur s

s

d d

r

dr

rs

E

I

r

du

s

r d

s

s r

z d

d r

s dr

rs r

u d

r

ss w

r

s ru
s ru
d

ru
ru

ru

s s

s s
r

sI

d

s dr

rs

s
s s
us s s
s s
r

ur

ss

r s s

ur
ur

d
d

I

u

H

s r

r s s

r s s
d

r s

s s

w
I d

dr

rs r

u d

s

d

s ru

r

r

s

u s

ds
ds

s s
s s

s s

s s
s s

s s

s s

I
r

ws

s

E

sd

s s

360

s

360
360
360
360
360
360
360
360

s s
6 s s

r s s
r 6 s s
r
H
H

r s s
r6 s s

s s

s s
w r

s

N r

ur

Nd s s s
Nd s

6 s s

N r

360

360
360 s

s s
s s

I d

u
r s s
s s
d H s s

rus

s

z

r
s s
w r
w 6 s s
r d s
r

u

I d

r

r

s

s

w s
r
d s

s s

s s s

sr
r s s
s s

s

s s

s
dds s s
d s s
d s s

rs
1 s s
s s
d s s

s s s
d
u

s s
s s

r

s s
Nd sI s s
dw d6 s s
dw d32 s s

s
s s
z

s
sw
sw r s s
sw dr2 s s

s s

u

s s

s s

s s

sw
swNd s
sw
sw s s
sw
r

r

s s

s s
r s s
s s

s s

E E

E w

s s
ww s s
s s

dr s s
w s s

s s

du

s

r s s
s s
s s s
z
d s
dsdr
d s s
u

s s
r

s s

u

s s

r

ss

s w

u

s

w s

u d

r

du

r

ss s s

u

r

d

N

s

I

r

5

5

r

r

r
d

N

E

E

IN

I N I

r

ss w

s

s

u d

s r

ss d s r

rd d

d

s s w r
s s

d

r
u
s r usu
r

r

r s

ru

u

u
r

r

s s s
d

s

r

ss

s

r

ss
u

r
r

r s
s

r s

d

s s d

d

d

r

rus u
d
s

s

u ru s
u ru s

du

u

r

r

r

r r

d
d

r r

u

r

s r

r

s

z r

z r

u

d
d

r
r
r

r
s
s
s s

sr

sd

usr
w r

r

r

r

ss

QueryFullProcessImageNameW() s

d

d

r d

s

s

d

s I

s r

s

urs

u

r

ss

r

s

HE E
r
r H

d

r
r

EN

N

E

E HE

r du
1

1

r

r

ss
H
1
dd w r

r

Is

I
s

N

s

rus dus r
w

s r

d

s
u

r
u

r

s

s

r

s
s

s
r us d r

s

u
5 H 1

s s d

s

d

d H 256

s s

w r d s

d s

u

s

su

w s

s r

su

s

u d

s

r s

s I

r

s

r

ss s

r

d

Is

N

w r

s
r
r

r
r

s I s

d

s
w r

s
s 86

s w d r
w r

w r

s
w r

H rd

s

d r

s w r

s r

s r

u

urr
urr

r
r

E
E

s

dr
s r
s r

u s r

E

w r

s

d

r
E u
E u

I E

I

s

r u z d

rd d s

d rs

d H

r d

r I

s
s

r u

I

u s

u d

s

r

ss s

r

s H rdw r

d rs

d I

s

rdw r s
s r
s r
s r

r

s r

H

E
E

s r
I

E
urr
urr

I

r
r

E u
E u

d

s

s

r

ss

r

s

I
I H
I

r
EN0000

u

r

1

s r

E

urr

r

E u

EN

E

02

\Registry\Machine\HARDWARE\DESCRIPTION\System\ s u r d

d

d

s

s

s

s

s

u
s

rs

H

1

1
1

d

s

rs

r u

s r

s r

s

r

ss s

r

d

I

I

rd NI

du s ss

d w

r

w r w r d

d I

ssu

r

w r

d

s

I

r

r

us

s

IPHLPAPI!GetAdaptersInfo()

d

r

r

N w r I

s s

s

d
s

s
s

s u

NI s

r

s

d

s

d
8139

w

us

r

I

s E

r

ur

NI

NI

s s
r

s s

r
N

rds w
d
r
r u

d

d u r
r
d

us N w r

s us r
s

d w

s
ds

8139

s E

s us r
s

d w

s
ds

s

w r

w r
r s
r s

d

H

r N w r
us d

d r d r d d

I

w r

w r
w r

r u

rd s N
r
r

r u E
r u E
H s

E

d
d
r

s

ddr ss s w r su

ddrddr ssss

II II

rr

00:01:02:03:04:xx 3

d

r

u

r u d

r s

s

w

r
r
d

r
r

r

r

8
1

ur

r

ddr ss

00:03:FF:xx:xx:xx

00:0C:29:xx:xx:xx

08:00:27:xx:xx:xx
00:07:e9:e4:ce:4d I

r s
w r
d us

I

r

r

u r

s

00:30:18:ab:d7:f2

w I

r

d

00:ff:f2:f8:30:xx

00:50:56:xx:xx:xx

w r

r u
I

52:54:00:12:34:56

00:1c:42:xx:xx:xx

r

s I

00:15:5d:xx:xx:xx

00:1d:d8:xx:xx:xx
I w u d
d

w w

r s
r s

w s
r

r

r
r

r
r
00 0
d

ss
s s

s

d s

d w

rs w d w

r us d
dd ww
E

ssss

N

IN

u ru s

w ss

0
0
0
0

s r

d
r us d
dd ww
r
r
r
r
w

s s
s s
s s
s s

s r
ss

r

us

us

s

rdw r

ss

NN
d u

ddr ss

d s

s

r u
0 r su s

0 r su s

s

E
r du

w r

s r u s r

9

d

s

d 00 30 18
d d

d

2 I

r

ur

s

d

s

r

r

d

s

u d

s

s s r

ss s

r

d r

ur

s

s

s d

s

s
s
s
s

r

s

r

s
r
r

r

s www s s
r
s
s

s www s s
r
r

s
r
s www s s
s www s s

s
r
r

s
s

dd ww

ssss

d

I

d w
E

IN

0
0
0
0
0
0
0
0
0
0
0
0
0

u d r 6 r
r

00000

10011 6 35016

d w ss

r
s
ss rr
s r
s r
s r
s r

3

6532531

s r

dd

s

r u

s r

s r

s r

s r

s r

s r

s r

u s

dd

s

E

E

E

E

E

E

s r
8 9 600 5
s r

r

z r

s r
s r

2 5

s r
98 8
s r

9 22

8

55 83

3

E
6532531
E
8 9 600 5

E
E
E
E

E

E

urr

urr

urr

urr

urr

urr

E

E

E
E

dd ww
r

r s

0

100
r
r
w r s

s
r du

d s
2

u
0 95

s r
r

E

r s

ssd r

u d

r s

r du

s

r

r

u

u

d r 0
d r 6 53
d r 56
d r 56
r

I

I

r

r

s r

s r w rr
z r
s
E

us

d

r 1 6

r N

86

r s @
us
r
r

r

r

r

r s
r s
r s
r s

r s

d ws urr
d ws urr
d ws urr
d ws urr

d ws urr

w r

I

r

rs
rs
rs
rs

rs

s
s
s
s

s

w6 32N d

r s

d ws urr

NN

ss

r
r 2 5

z r

Ir s N w r
I s
s

z r s1

13 E68 1

98 8

9 22

I

r 2

r

rs

r u

u s

s

r

r

r

r

r

r

r

E u

E u

E u

E u

E u

E u

I

I

I

I

I

I

EN 80EE

EN 80EE

E

E

EE

00000000

E

00

E

00000000

E

00

EN 5333

E

8811

00000000

E

00

EN 1

EN 1

EN 1

8

8

8

E

E

E

005

000

006

0 001

0 001

0 061

8

8

8

E

E

E

00

00

00

r s

d ws urr

rs

s

25

16E5

8

55 83

w6 32N d

r s

d ws urr

w6 32N d
w6 32N d

r s
r s

d ws urr
d ws urr

w6 32N d

r s

d ws urr

w6 32N d

r s

d ws urr

rs

rs
rs

rs

rs

s

s
s

s

s

Ir s N w r

s
I s

z r s1

r

13 E68 1

25

16E5

r u

r u
r
3 d

r u
s

rs

s

s

r

r

r

r

r

s

r
rs
u s

rs

r
rd us d
s

s

r

rs

r

r

r
s s

d w

I

r 2

s s

d w

r

r

s

IN

s ru

s d

u
s d u

d

r

s

r

r

r

s

r
u s

r s

w r

d s ru
s

u

r
d u s d
d
r

s

u

d

r

s

r

s s w

s

s

u

I
w r

s ru
IN
u s w u d r su

w E

s

r
r s u s s w r

r us s

s s w

r

u

u

u

s I

us

s

r

us

wr

ss

I ssu

N s r

w r

s

d

d s

r

s

3

r

d

3

d rs r
dd rIrI
0 15 d
0 80

r

dd rr NN
I
r

r

0 1013

rrus

rd

r

s

NN

ss

s
r

s
ss r

u

r

r

ur

r

s

d r

u

s

s

d d

d

rs I

d

rds r

r u
s

E

d

s
dd rr NN

d r
dd rIrI
0 8086 I
0 10d
0 1002
N w

N d

us

r

s w

s

d

s

r

s s

ss

s d
ur

s s

d

d
s w
s d

d

du

GetCursorPosition() I
r
u

15

s

I

u s

r d

d

s

s r

s u

du

r

r 15

us
r

d I

s

us
s
s
r

s
w r
r

r

d
s
us

w s

s
s w

r s I
s

ssu
r

s d

w u d
s

s u
w

d

s

s

s

s

s
r

ur

w

d

ur

s d

s s

us

r

us

us

r w

r

s us r

w r s

us

urs r r u d

s

s u

z s d r

s s

s

GetCursorPosition()

s

u w

ss

us r s

s

r

us

u

N

s ru

s

r

s

u

r d

u

s

r
u d u
d w u d ru

r d

s

r

s

r

rs

r

d
us

s d
r

u s us

r

us

r

I

s

s

r

r

d

s
d
w d ws su s s
r
s s

r ss d

s r

d d I
N

32

s

d

u

s

r

r u

r

s
wr
d
r d d w d ws 2000
ru s

s

s

d s

N

d

u w r
s

r
s s

r

us

s

u

u d

d r

N
us s

r
r

s wr

s s r

s
r s

s
d

s

r

r

s ru

s

d

s r s u

rs I

s

s

d

r ss d us

s
r

r

r

r
u d

s

s

r

r

rds
s d

rus u d

s

r
s r

r

u

r

rus s w r

I w

s

d

rs

s

0.0.0.0

s

host us d
rus

w

s

N

d

I

s

s

dr

d

%SystemRoot%\rdpinst.exe

d

sur

ru s

r

u

s

r

s r

u

\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce

d

u

d s

r s s
rs

s

r

s w

r

r s u u

s w

d s

r

s ru

d

w

d

s r

r

d

d r

r s

s 2 s r

r

r H

u

u

ur

r

d s

H

s

d s w s nullptr

r
I
256256 66 9811 0

638d5 9 2

21
0 28 62 0880 3 9 9 13

6

2 3 6 866 15d 0 11d dd 3 d 9 33 d6963

0633d8 652028 0
1 598 8

916

2d d88d3 0 60
6 3 295 6985251d 1 962 2 2 69 36 5 2
31 816855 d82 5 d68 3832d

803 5 8

5 0218
829 12d

d N

I

r

3

d rd

s

d
d 6

ss d
E 201

d

113

u w r w

I
w d

d s

r

s

r

d w u d
s s

r

r

u

s s

d w u

r

us

d

r du s

u

r

r

rs

s ur

s

E

s

du

r

2016

s

s r d

r

r s

s
