{"rule_id": 200, "name": "Bitter_APT_Malware_analysis", "description": "-", "references": [], "File_Names": ["Action.docx", "19.md", "VTFS.QD", "winlgn.exe"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid registry key.\n\nThis use too, the EncodePointer function for encoding a specified pointer (encoded pointers can be used to provide another layer of\nprotection for pointer values).\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n9/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nAfter performing the reconnaissance actions, this can send a query as pulse with the informations to the C2, the URL to send is decoded\nand an additional operation give the final URL.\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n10/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n11/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n12/17\n\n \n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nThe data are encoded by the algorithm too, with the script, we can decode the strings and see that the roles and data send to the C2.\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n13/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nSNI=VTFS.QD&UME=Xjoepxt!8!Qspgfttjpobm&OPQ=benjo&IVR=VTFS.QD$$benjoAA11482.572.3314613.96675&st=0  (Here from\nthe Anyrun sandbox)\n\nWe can resume all the variables used and the type of the informations sent in the C2.\n\nVariable\n\nDescription\n\nSNI\n\nUME\n\nOPQ\n\nIVR\n\nst\n\nComputer name\n\nOS Version\n\nAccount name\n\n[Computer name]##[Account name]@@[GUID]\n\ndownloaded file executed successfully ?\n\nCyber kill chain\n\nThis process graph represents the cyber kill chain of Bitter sample.\n\nCyber Threat Intel\n\nSince the last 2 weeks, the C2 domain have changed (.193 to .198) due to this are on the same subnet of the Verdina organization (Bulgaria\ncloud provider).\n\nWe can note on the WHOIS information that this registered in Ras al-khaimah location.\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n14/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nThe location is placed in the business place of the city.\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n15/17\n\n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nWe can note that two phone numbers with the country indicate (Indian and Iranian) have the same address for two companies.\n\nIn Ras al-Khaimah, there is no corporate tax, no profits, no customs duties, no inheritance tax, it is not excluding that the group Bitter\nchose this place as a tax haven for their operations.\n\nReferences MITRE ATT&CK Matrix\n\nList of all the references with MITRE ATT&CK Matrix\n\nEnterprise tactics\n\nTechnics used\n\nRef URL\n\nExecution\n\nT1203 - Exploitation for Client Execution\n\nhttps://attack.mitre.org/techniques/T1203\n\nPersistence\n\nT1060 - Registry Run Keys / Startup Folder\n\nhttps://attack.mitre.org/techniques/T1060\n\nDiscovery\n\nT1012 - Query Registry\n\nhttps://attack.mitre.org/techniques/T1012\n\nLateral Movement\n\nT1105 - Remote File Copy\n\nhttps://attack.mitre.org/techniques/T1105\n\nC & C\n\nT1105 - Remote File Copy\n\nhttps://attack.mitre.org/techniques/T1105\n\nIndicators Of Compromise (IOC)\n\nList of all the Indicators Of Compromise (IOC)\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n16/17\n\n \n\f9/2/2019\n\nCyberThreatIntel/Malware analysis 31-08-19.md at master \u00b7 StrangerealIntel/CyberThreatIntel\n\nIndicator\nIndicator\n\nDescription\nDescription\n\nUrgent Action.docx\n\n34b53cd683f60800ac4057d25b24d8f083f759d024d22b4e5f2a464bc85de65\n\nsmss.exe\n\nmaq.com.pk\n\ndcb8531b0879d46949dd63b1ac094f5588c26867805d0795e244f4f9b8077ed\n\nDomain requested\n\n203.124.43.227\n\nIP requested\n\nhttp[:]//maq.com.pk/\n\nHTTP/HTTPS requests\n\nhttp[:]//maq.com.pk/wehsd\n\nHTTP/HTTPS requests\n\nhttp[:]//maq.com.pk/wehs\n\nHTTP/HTTPS requests\n\nhttp[:]//onlinejohnline99.org/kvs06v.php\n\nHTTP/HTTPS requests\n\nonlinejohnline99.org\n\nDomain C2\n\n93.123.73.193\n\n93.123.73.198\n\nIP C2\n\nIP C2\n\nThis can be exported as JSON format Export in JSON\n\nLinks\n\nOriginal tweet: https://twitter.com/RedDrip7/status/1164855381052416002\n\nAnyrun Link:\n\nUrgent Action.docx\n\nDocs :\n\nBitter Analysis by Unit42\n\nTool for decoding the encoded strings of ArtraDownloader\n\nYARA Rule Bitter Variant1 (August 2019)\n\nhttps://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore APT organization/Bitter/27-08-19/Malware analysis 31-08-19.md\n\n17/17\n\n\f"], "URLs": ["https://github.com/StrangerealIntel/CyberThreatIntel/blob/master/offshore"], "weight": 0.0}