{"rule_id": 489, "name": "TA410", "description": "-", "references": [], "File_Names": ["Pense1.txt", "qtinfo.txt", "QQSetupEx_func.pdb", "EhStorAuthn_shadow.exe", "Driver.pdb", "pense1.txt", "hhw.exe", "Hha.dll", "rebare.dat", "rescure86.dat", "fcClientDll.pdb", "Cert.pem", "Dlcore.dll", "Responsor.dat", "rescure.dat", "Temptcm.tmp", "dlcore.dll", "QQSetupEx.exe", "responsor.dat", "rescure64.dat", "EhStorAuthn.exe", "Rescure.dat"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["26eb8a1f0bdde626601d039ea0f2c92a7921152371bafe5e811c6a1831f071ce", "13e761f459c87c921dfb985cbc6489060eb86b4200c4dd99692d6936de8df5ba", "faa80e0692ba120e38924ccd46f6be3c25b8edf7cddaa8960fe9ea632dc4a045", "cd8f877c9a1c31179b633fd74bd5050e4d48eda29244230348c6f84878d0c33c", "0701cc7eb1af616294e90cbb35c99fa2b29d2aada9fcbdcdaf578b3fcf9b56c7", "e4ad5d3213425c58778d8a0244df4cd99c748f58852d8ac71b46326efd5b3220", "2481fd08abac0bfefe8d8b1fa3beb70f8f9424a1601aa08e195c0c14e1547c27", "b7960d1f40b727bbea18a0e5c62bafcb54c9ec73be3e69e787b7ddafd2aae364", "de30929ef958211f9315e27a7aa45ef061726a76990ddc6b9d9f189b9fbdd45a", "479954b9e7d5c5f7086a2a1ff1dba99de2eab2e1b1bc75ad8f3b211088eb4ee9", "27f5df1d35744cf283702fce384ce8cfb2f240bae5d725335ca1b90d6128bd40"], "Registry_Entries": ["HKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\Print\nResponsor\\2\n\nGup.exe\n\n32bit Driver,\nKeylogger\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\Print\nResponsor\\3\n\nGup.exe\n\n64bit Driver,\nKeylogger\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\Print\nResponsor\\4\n\nGup.exe\n\nRAT config\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n12/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{2D-\nB80286-1784-48b5-A751-B6ED1F490303}\n\nDlcore.dll\n\nExecution Stage Ex-\necuting dlcore.dll\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\\n{804423C2-F490-4ac3-BFA5-13DEDE63A71A}\n\nrescure.dat\n\nExecution Stage In-\nstall keylogger driver\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\\n{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}\n\nrescure.dat\n\nExecution Stage \n\nRAT fully installed.\n\nFlowCloud Configuration\n\nThe FlowCloud loader component EhStorAuthn.exe stores the malware configuration in\nthe registry early in the installation chain and is represented in the table above. The\nRegistry data is composed of multiple encrypted headers (using XORs and RORs) and\ndata is encrypted using a modified (or broken) AES algorithm. The plaintext data is\ncompressed with ZLIB and serialized using Google\u2019s Protocol Buffers.  Figure 10 shows an\nexample of a configuration as displayed by FlowCloud\u2019s debug logging:\n\nFigure 10 Example of a configuration as displayed by debug logging\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n13/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nCommand and Control\n\nFlowCloud malware handles configuration updates, file exfiltration, and commands as\nindependent threads utilizing a custom binary C2 protocol. We identified these\nindependent threads as part of an extensive command handling functionality with\ndistinct command managers existing for each command. The sample we analyzed utilized\nport 55555 for file exfiltration and port 55556 for all other data. We identified FlowCloud\ncommunication with the IP 188.131.233[.]27. The requests and responses are composed\nof multiple encrypted headers (using XORs and RORs) and TEA encrypted data using a\nkey generation scheme involving a hardcoded string of random characters and MD5\nhashing. The plaintext data is compressed using ZLIB and serialized using Google\u2019s\nProtocol Buffers. An example parsing of an initial beacon is demonstrated in Figure 11\nExample of FlowCloud parsing an initial C2 beacon:\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n14/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nFigure 11 Example of FlowCloud parsing an initial C2 beacon\n\nComparing Public TA429 (APT10) Indicators with TA410 Campaigns\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n15/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nPublications by FireEye and EnSilo regarding TA429 (APT10) campaigns contain\nindicators that later appeared in TA410 campaigns. In our retrospective analysis of that\nresearch, we determined that TA429 (APT10) used phishing macros that were later seen\nbeing used by LookBack and FlowCloud malware. Additionally, we identified the Quasar\nRAT delivery URL hxxp://ffca.caibi379[.]com/rwjh/qtinfo.txt used by FlowCloud macros\nin November, which was published in the enSilo report prior to observable weaponization\nfor TA410 campaigns.\n\nInterestingly, the compilation date of several LookBack malware modules used in July\n2019 were September 14, 2018. This includes the SodomMain and SodomNormal\nmodules covered in previous Proofpoint blogs on LookBack malware. That date is just one\nday after FireEye released their initial analysis of similar TA429 (APT10) macros utilized\nin Japan on September 13, 2018.\n\nWhile LookBack malware samples were not observed in the wild until June 2019, this\nSeptember 2018 compilation date demonstrates a large lag time between compilation and\ndelivery. This possibly suggests manipulation of compilation times by threat actors but\nhas not been conclusively determined.\n\nThe first identified server installation by TA410 on actor-controlled infrastructure\noccurred in December 2018. Most of the domain registration (weaponization) for\nLookBack and FlowCloud campaigns began in May and June 2019 respectively. These\nevents were after FireEye\u2019s initial publication in September 2018.\n\nAdditionally, enSilo\u2019s publication on potentially TA429 (APT10) related Quasar RAT\nsamples was published on May 24, 2019. It was not until the second week of November\n2019 when the inactive URL was incorporated into a phishing macro as part of a\nFlowCloud campaign targeting US utilities. WHOIS records and passive DNS information\nfor ffca.caibi379[.]com indicate that the registrant email and address fields for the\ndomain were updated on June 7, 2019. The A record for the domain was updated on\nSeptember 9, 2019 at which time it resolved to the IP 34.80.27[.]200 contained within an\nASN owned by Google. For the prior eight months beginning on January 2, 2019 and\nencompassing the period of activity discussed by enSilo, the domain was hosted on\nseveral IP\u2019s in an ASN owned by APNIC Hostmaster. The shift away from IP\ninfrastructure owned by APNIC represents a departure in threat actor infrastructure\nhosting tactics well after the publication by enSilo and within the weaponization period\nfor TA410\u2019s campaign targeting US utilities. While this research is not conclusive, it\ndemonstrates that all observed TA429 (APT10) similarities and indicators of compromise\nwere available publicly prior to the start of TA410 campaigns. Therefore, while not\nconclusive from current analysis, the possibility remains that these overlaps represent\nfalse flag activity by the TA410 threat actor. Based on this analysis Proofpoint analysts\ntrack TA410 as a distinct threat actor from TA429 (APT10) at this time.\n\nConclusion\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n16/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nThe convergence of LookBack and FlowCloud malware campaigns in November 2019\ndemonstrates the capabilities of TA410 actors to distinctly utilize multiple tools as part of\na single ongoing campaign against US utilities providers. Both malware families\ndemonstrate a level of sophistication in their conception and development while the\nextensible code base of FlowCloud malware suggests that this group may have been\noperating as early as 2016. TA410 operators demonstrate a willingness to dynamically\nevolve phishing tactics to increase the effectiveness of their campaigns and a keen eye\ntowards plausible social engineering within a very select targeted sector. It remains\nunclear if the nature of the tactics and indicators that are shared with TA429 (APT10)\nwere developed by this group or culled from readily available technical reporting that pre-\ndated these campaigns. The possibility remains that these overlaps represent intentional\nfalse flag efforts to cloak the identity of these perpetrators while they targeted a critical\nand geo-politically sensitive sector of energy providers in the US. Regardless of the actor\u2019s\nintention, TA410 has established itself as a motivated actor with mature toolsets carrying\nout long term campaigns against highly important and geographically concentrated target\nsets.\n\nIndicators of Compromise (IOCs)\n\nIOC\n\nIOC\nType\n\nfaa80e0692ba120e38924ccd46f6be3c25b8edf7cddaa8960fe9ea632dc4a045 SHA256\n\nb7960d1f40b727bbea18a0e5c62bafcb54c9ec73be3e69e787b7ddafd2aae364 SHA256\n\n26eb8a1f0bdde626601d039ea0f2c92a7921152371bafe5e811c6a1831f071ce SHA256\n\ncd8f877c9a1c31179b633fd74bd5050e4d48eda29244230348c6f84878d0c33c SHA256\n\ne4ad5d3213425c58778d8a0244df4cd99c748f58852d8ac71b46326efd5b3220 SHA256\n\n589229e2bd93100049909edf9825dce24ff963a0c465d969027db34e2e-\nb878b4\n\nSHA256\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n17/20\n\n1334 742f2\n\n7 8412d76b 228b99935 49d\n\nSHA256\n\n\f8/20/2020\n\n(2) New Messages!\n\n1334c742f2aec7e8412d76ba228b99935a49d-\nc96a1e8e1f3446d9f61247ae47e\n\nSHA256\n\nde30929ef958211f9315e27a7aa45ef061726a76990ddc6b9d9f189b9fbdd45a SHA256\n\n0b013ccd9e10d7589994629aed18ffe2388cbd745b5b28ab39c07835295a1-\nca9\n\nSHA256\n\n479954b9e7d5c5f7086a2a1ff1dba99de2eab2e1b1bc75ad8f3b211088eb4ee9 SHA256\n\nd5191327a984fab990bfb0e811688e65e9aaa751c3d93-\nfa92487e8a95cb2eea8\n\nSHA256\n\n0701cc7eb1af616294e90cbb35c99fa2b29d2aada9fcbdcdaf578b3fcf9b56c7\n\nSHA256\n\n27f5df1d35744cf283702fce384ce8cfb2f240bae5d725335ca1b90d6128bd40\n\nSHA256\n\n13e761f459c87c921dfb985cbc6489060eb86b4200c4dd99692d6936de8df5ba SHA256\n\n2481fd08abac0bfefe8d8b1fa3beb70f8f9424a1601aa08e195c0c14e1547c27\n\nSHA256\n\n188.131.233[.]27\n\n118.25.97[.]43\n\n34.80.27[.]200\n\n134.209.99[.]169\n\n101.99.74[.]234\n\nAsce[.]email\n\npowersafetrainings[.]org\n\nIP\n\nIP\n\nIP\n\nIP\n\nIP\n\nDomain\n\nDomain\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n18/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nmails.daveengineer[.]com\n\npowersafetraining[.]net\n\nmails.energysemi[.]com\n\nwww.mails.energysemi[.]com\n\nwww.powersafetraining[.]net\n\nwww.powersafetrainings[.]org\n\nffca.caibi379[.]com\n\nhttp://ffca.caibi379[.]com/rwjh/qtinfo.txt\n\nDomain\n\nDomain\n\nDomain\n\nDomain\n\nDomain\n\nDomain\n\nDomain\n\nURL\n\nhttps://www.dropbox[.]com:443/s/ddgifm4ityqwx60/Cert.pem?dl=1\n\nURL\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\2\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\3\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\4\n\nRegistry\nKey\n\nRegistry\nKey\n\nRegistry\nKey\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{2DB80286-1784-48b5-A751-\nB6ED1F490303}\n\nRegistry\nKey\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{804423C2-F490-4ac3-BFA5-\n13DEDE63A71A}\n\nRegistry\nKey\n\nHKEY LOCAL MACHINE\\HARDWARE\\{A5124AF5 DF23 49bf B0ED\n\nR i t\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n19/20\n\n\f8/20/2020\n\n(2) New Messages!\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{A5124AF5-DF23-49bf-B0ED-\nA18ED3DEA027}\n\nRegistry\nKey\n\nG:\\FlowCloud\\trunk\\Dev\\src\\fcClient\\Release\\QQSetupEx_func.pdb\n\ng:\\FlowCloud\\trunk\\Dev\\src\\fcClient\\Release\\fcClientDll.pdb\n\nF:\\FlowCloud\\trunk\\Dev\\src\\fcClient\\kmspy\\Driver\\Release\\Driver.pdb\n\nF:\\FlowCloud\\trunk\\Dev\\src\\fcClient\\kmspy\\Driver\\x64\\Release\\Driver.pdb\n\nFile\nPath\n\nFile\nPath\n\nFile\nPath\n\nFile\nPath\n\nET and ETPRO Suricata/SNORT Signatures\n\n2837783 ETPRO TROJAN Win32/LookBack CnC Activity\n\n\u00a9 2020. All rights reserved. Terms and conditions Privacy Policy Sitemap\n\nhttps://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\n\n20/20\n\n\u00a0\n\f"], "URLs": ["https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new", "http://ffca.caibi379[.]com/rwjh/qtinfo.txt", "https://www.dropbox[.]com:443/s/ddgifm4ityqwx60/Cert.pem?dl=1"], "weight": 0.0}