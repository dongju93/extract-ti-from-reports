{"rule_id": 442, "name": "SpyRATsofOceanLotusMalwareWhitePaper", "description": "-", "references": [], "File_Names": ["WinWord.exe", "blecanyon.com", "mobsync.exe", "mscorsvw.exe", "coleope.com", "Allowances.doc", "146552.html", "Stub.exe", "Reflection.Emit", "tonholding.com", "68622.html", "z.gl", "c\u00e1o.doc", "teriava.com", "no.doc", "fids.exe", "ailloux.com", "KoreanTimesSSK.ttf", "mdnsNSP.exe", "powergala.info", "runnerfd.com", "ordanuy.com", "HD_me_infect.doc", "Eoneorbin.com", "clang_compiler32.dll", "traveroyce.com", "notificeva.com", "openddns.info", "wolfgangneudorf.com", "Lbertussbau.com", "maerferd.com", "hutech.exe", "alyerrac.com", "NetworkMiner.exe", "galaspot.net", "bao.docx", "jeffreyue.com", "myfile.exe", "tin.doc", "galamower.com", "Font.exe", "PAGE.exe", "Excel.exe", "icons.exe", "msofficecloud.org", "yiihao126.net", "adstripstravel.com", "Origin.exe", "FontExt.dll", "consent.exe", "ucaargo.com", "dinh.doc", "arinaurna.com", "MsoCache.exe", "CiscoEapFast.exe", "GSIS.doc", "10007.vbs", "lap.doc", "Erstin.com", "ultraqueryns.net", "SndVolSSO.exe", "FirefoxUpdate.exe", "wpfgfx_v0300.dll", "microsoft.jpg", "panggin.org", "Harinarach.com", "CSRSS.Exe", "icmannaws.com", "honoremarson.com", "aulolloy.com", "KB12345678.exe", "Avidilleneu.com", "icon.ico", "Chinanetworkvub.info", "asian.jpg", "XamlDiagnostics.dll", "rastlsc.exe", "sicaogler.com", "garyschulze.com", "tx32.dll", "tulationeva.com", "CiscoEapFAST.EXE", "Avidsontre.com", "user.gif", "WinWorld.exe", "galaburner.info", "hieryells.com", "Jeffreyue.com", "compiler32.exe", "FirefoxInstaller.exe", "ep7res01.dll", "virginiaar.com", "Mf.dll", "ygq651ww.dll", "nsquery.net", "xwizard.exe", "SwUSB.exe", "hgfs.dll", "luan.doc", "ultraqueryns.biz", "dreyoddu.com", "Voting.xls", "pack.exe", "SyLog.bin", "clearddns.com", "chinanetworkvub.info", "flash_installer.exe", "GoogleUpdateSetup.exe", "gnsdk_submit.dll", "Cursif.ttf", "McUtil.dll", "Rackerasr.com", "cenjungle.com", "appspot.org", "ThunderbirdEML.KD", "153666.html", "ng.doc", "urnage.com", "Sylog.bin", "yceunca.com", "Oftonlos.com", "abelleds.com", "dwarduong.com", "underwears.png", "7zS.sfx", "centarget.com", "plugin.lst", "cdn.net", "phat.exe", "avicap32.dll", "tzutil.exe", "certcredprovider.dll", "tsworthoa.com", "angelinagerste.com", "myvtfile.exe", "apt32.html", "tephens.com", "0.cs", "20Stub.exe", "Orinneamoure.com", "img.png", "Table.xls", "msprivs.exe", "user.ico", "vieweva.com", "KB3033929.exe"], "MD5_Hashes": ["bc1ccc120d185a0c36b191ec6b74397c", "2d9d166b4d40c220df895235c06777b0", "a2b45cae93603d04592a684285ebe7b9", "c117ea93410ad849e7a3ff9293bcd9ab", "dc1e8e868c347d310f24235eb4391559", "4f761095ca51bfbbf4496a4964e41d4f", "627e3ff5659b9a0ab9dc4b283c3288dd", "90a9df6643a8976883e7f5a473ce8349", "6baafffa7bf960dec821b627f9653e44", "a5abc26a34f4f21c20619146686670bf", "e1973fcd28806ef60f47d01f8b7cc23e", "2f5a12c23e90f769b388d1edace2371d", "c8eaa7653991bb8eccbd436442f95003", "40f644f1957d0a30ba76470279e1463a", "05fb8bb25d02c96d17e8a4564f255252", "f7af180d088f6b86509c2bea2d5cca6a", "d95bbf9645994e891f3a8156eee9cbee", "54bb003b233a2249bcd3f79fd8406727", "5180a8d9325a417f2d8066f9226a5154", "96b971c9ac868c8d9ae98618b9a9bddc", "f9f843dc7c3486ea1ca979980a9fd318", "58febe3cdd3a523bc2a5162ad302c49f", "5394b09cf2a0b3d1caaecc46c0e502e3", "f0be949e85e5c4e8a6bd4d94c90ab9b3", "93da064e3fc4422c63fecca93ee1b157", "025faee9578c97fbaa0da61d55691758", "c4dbc10104f058fcc5500d61cd48746a", "1fa011e6a692ee95452c626e61b5263a", "ce50e544430e7265a45fab5a1f31e529", "6575db1c50c5bdd0313622e16c08f79a", "a2859b211809978bd128a1025e403963", "02b2d905a72c4bb2abfc278b8ca7f722", "9eed9619eac172fa0b29de755907759c", "6a7abc717abb17ce60a922057a2e9386", "b45203c7cbc35a092e7e8749bf17e4a7", "eb2b52ed27346962c4b7b26df51ebafa", "5421781c2c05e64ef20be54e2ee32e37", "fa6d09f010f11351a92c409fef7ba263", "87d108b2763ce08d3f611f7d240597ec", "a04be5ca8df86ee9b93974f4da88548e", "fba089444c769700e47c6b44c362f96b", "f6ee4b72d6d42d0c7be9172be2b817c1", "5bc2b316311c3d8104506795d843ca9d", "1f8ade068ba6fbfe8605e0946bf2d79f", "a532040810d0e34a28f20347807eb89f", "fcd7227891271a65b729a27de962c0cb", "27ac632a3a270900986d7afef67317a2", "facec411b6d6aa23ff80d1366633ea7a", "46745e29f15eedfabba7e080f6295200", "317d959d0ea2ba06789255301c32032d", "4185f19a957f870ce6b511c4f86d7c06", "e71f3dc106852cd4648c41376204af9f", "018433e8e815d9d2065e57b759202edc", "c212074b43b6ef811f2a8fb72e670e0c", "aa1f85de3e4d33f31b4f78968b29f175", "88152846c45924d5706a11523942c82b", "417a0ecf6459edf56ea704a9b5783208", "d1e614479fee318904442c16c5ef4877", "f1af6bb36cdf3cff768faee7919f0733", "471a2e7341f2614b715dc89e803ffcac", "e9abe54162ba4572c770ab043f576784", "ba844b09524aea077f6a175da10a6bf0", "406dbee627ad8777d28ae2234a9e7c68", "e07ce38a0e6da5ca974f87006de2e826", "c781b4cde28609ff2d7b217671e1f110", "ba49eb3b3b5b747b7e0331855eba83f5", "f9c820264597d8f649d88522dd66f222", "9b7b0060229c6e3fd8a6c6599867b866", "3bd041ef488806c55fbc40b4af24eabb", "e2e4b2f28d29fd19bb28287a4d99ede2", "d35efe4ba43e3803d57b4945fa3ab5dd", "e02e37ea705f1066798f285836a6fc46", "f769ac32c8550a27fd77a664103fcc4b", "d592b06f9d112c8650091166c19ea05a", "aea9fbb5b3cd8fcd48add7d9ca6ed639", "121918fd5630cb670d182c8483738bf1", "a7f98d3b7b7e2a7d1c194c2f26045618", "5458a2e4d784abb1a1127263bd5006b5", "1a4d58e281103fea2a4ccbfab93f74d2", "90c3b5bcb26d83b34a81b302787933ba", "95a85454593426d42e45d11959801d58", "5475d81ce3b3e018c33fbc83bdc0aa68", "b7b990fe7884b1ec0998ac465b936b8c", "a69c31b0b86f43c7f7bf7a45d22f246f", "29a807b64777ea215b1953e091e8ea1c", "58d2907361f6414742dcc5071ca20980", "ba4268f8694be7a252b917a692d157c3", "cf8d4728a093ce412d0477a2eadc2955", "42123d2493598c9ac9803fe1b92ed032", "b65b82eddcecd719c55d6d222926e648", "a01fda63947b9b0bb29e8dd8e258e5c8", "1ff1263633b46e662504c3fc5889c7fc", "b424c855a9494409b6e0e70d87ffd558", "ac8b9e5c35e134da9ec701bcd9bcf760", "7edcae7740ee7e7c75699cfbb4d89310", "fbd96ee03328af76dd6ffe161544e2ed", "18dde939dd712165fc71b35175869697", "3b53e66f34beb3cd30e6a7da457e86c8", "8de7d600d83bb3a6d2dd42932eed6f92", "d802aa9938e87dc33cf2c7a07e920b0b", "05bc07fc6265e6affa8478118c02942a", "8d6e7c359776cdb16aaf9630b63c535f"], "SHA1_Hashes": ["d00377793cdfea033296436c67cf2b3cf8989048"], "SHA256_Hashes": ["0009f9789f0b3fd20e9a2c48ab36bbca322cdf050fc8d3ebe7e12b470a0e4551", "ce478c8aabc980083a62f4ce4b040f1068e648d7cf6f3f94f283fd620eb8da24", "5091430fac8b608ac612c35a1e29ce47cdeb22429657460dddc660727806b511", "453168b12bdc881bd6763fbc456620fd42efe6a718c6aecb2fa4982a44207999", "bacdb6a6bdd0b81c551ef30514dc3186f483b135fbc63759dd861d2de59585ad", "ef095eb5790495aa6a18efc31cfc6087df187ec749162336213eab0f3ba453ea", "0fdf7fa5c5f978a08f493e777510f1f2d86a368f83696b3ba46e43fe9c3642f8", "1210384a9d0ca2e089efab14f2e9f6d55a3824031c1e589b96f854fb96411288", "6b560e2fc0be10d0ffd9e5440101f083ed7f5328735df79fd6c537c61bfcfe88", "857462a7a466e1f6934b6b313d7d3adaf14ca92fc8eabd820f6bf1eda29c093c", "54df4c7e55ceb16e875b07b621b66f577f42198b85872261cd9a5be885ede7d2", "16a608f88ef13ebdb2287482aa29629e7b34664cf133ab7d653c15808e92f8fa", "29bdd6341d59caa70a9e9f6229f7d4c2603d2ba333bc4573cf8c0faabe0f16af", "b2e7b34ece74ff87845c55068dff207552bc90d28f6622c52d7aa54347255700", "75835af4e772ead0e9faddd59328c44ab9a5b80f7df64f7d2ef18f94483c08de", "4ce7c9e9ca6f785921921de4d0b75c5436cd0d760ac71ddb30b8c5a610ae34dd", "34cf914444493995379731c887637c07fd6308e412a15518b60a2642820f09d4", "8f00c2dab8cc32e0052b7779de0bdc8faa385e890415555e86efdfc3b01cc504", "5dff6bc9e8898f2ed09ced9ac23b7e4d867e90c3efbe42726edcb01ecb0b1673", "e22d2c3e78908a2a8301755da5927132f24bd3a2d5957b7d379febd46b20d163", "e19fc649fe55d73eff5b1e3f7180d777fbc5d481855f0b4e8eb0b78a25212353", "12c2c3566c29f80478277e0f96b79fc85b9e86ebf16505d8f2d7877a6204f860", "a17d4568ad5f745d36fc17846d3e0edf63d4e3c9fccb9861579e957f7a560217", "6b2a24e2818efff0e4571ae24f1aaffb9745c8b1426bfa57e6a7c067a7a074f8", "cb999fb3a5982c6b59fdfcd9e9a5fbf5727a48faf25f66e8e1664b9b807b7d29", "890e5bd2650399d7fc3b543e8d1e65c0385f4d6003186245c8574c1913ca5d64", "10b09f64d75d748726a9b6a8880c6cd3cf8bcdb55c6b52e9a65940b27894f8e5", "26529af7782a902c04ae01898c8b14c9f01302165335858ad666b10532584254", "155b13e582adeab564c60a1091b4dccc43ed78db290aa3e2da7e8bc1e039770c", "d2619dd966f942d9870e7728d4fb238f83b5769d84f0850e3df35ab167da3a41", "ea2c54dc6a9cb33817f9967a20a841764e82b9bb399d6a8791c1fcb0dc6faa2f", "7477db2fab4dc77213008682e3302d6dd30e3963885f0a156d14bd067fa5b5cc", "afaafe2944970913772d013853ecc297c66230fa25c78956ac53a6c933059276", "c55ff0bb70b704eff1eee8d21a6c2e6fbc06eb1d5fcbb030fdaebebd9f8decf3", "c4d4169dc85ad57168b1efabdd32cb67a76c27ce1fb615685505b378ee345a3f", "12f941f43b5aba416cbccabf71bce2488a7e642b90a3a1cb0e4c75525abb2888", "c24e6d402a5adf1ece2d6a3dbe270e0904d43119d68e7862555505825a273cad", "808a06b2726c642449d53dc01080a61bef3851eab9e0a99e44e3bbd19a74b63a", "0528e2fa94f3b1253fe6c6a53452364568767253954630ab5cc141e41690ea43", "e6594d11244357537fa3ef5292cb52ccbd7c8f26a277f7003ade80964351878f", "85b2d3c74e6a662657f04ec58e5519338fd16fa955773c826e34e3eefd06e3c2", "b6b872de14275866bed7d9a7f685a382a29fa298394d21cdd365de452db5a3c8", "fadb91606e09b86c39aad99b452525217563594dc9c610120860a38439adb243", "5d0baa165715d710edd4b202d9e6494f1061159521ba0b2474556e3bfe481ba1", "70a749a760e99471b6825818f9091f4ee08de538b4686fa0475f0df667e91643", "023a4f500af9aac9960066a96fb0d811e4e25df7d9d564b3d0cc899b7c2bb5b3", "a2155529411a2ae173a65b818b69df9628a4093417f8991683f06aa310dbb5bf", "3caaa69c5ce00e17efc61a83ad71823dcfcca6a7c9dc013be3d58b1c894d407a", "1eca9dfd04fd5272a656d6e6d41c9ccc21a2700a979addf612a4de3b071253f5", "8f667d56778a2c1d68fc33be1870ea0c5fda7173c8875eddb31a2a4a3b406f55", "9b237ec0a5e87be62c32ad795c2b5ff43134de4f9426398593bd7efcff90cf98", "16fdb8f388f5a8737130d952f752fc9201ffde8549ae583c7582ab01147d171d", "7c2b7593bcabdb253ebcf4905367d6760f53ac118edb70a305502ef11a63ec12", "bdb83301a470d202480274df161638f83f8f26e7dda131a11b89a5a3d8259c73", "4ab2df974e5e563f611d7267916a00c18f819f5b8770ffcfadc5e1959047fb8e", "087ef9f7ce4681d49c6fa8842785fedef21461f160a34fc37c75fed26ddfa91e", "d957bccabad8af0e1b7fb7b7dd11a06d37656123ac97d353e1e93f0e72f35d49", "4b9a4571651af706c222a50056e4343eec75d4935f888102955bbececd94fd98", "ef68cfad4cdae58624d12ff97ae00e68aafae9e6f33f3bd23dffc37869a1e578", "bb5114227ab5bb2e6bde5bcd876e437f72998ee88d27f7cbb15828c82666bef1", "699eb46678331ec02318bfcab291125ed707e6ab2b68ca18a5680fcd850c12f6", "7f20a38a265f074be3cfced5fffc04c8dc2ebb4dea02ba3ebb4d3d23d7d4d2fd", "d0a725ee4602cd90493103648e6ec453b7987a016c19cff5c79cc42f4510e92f", "b6242d27c437a44b670c7a9a8a6bd2a92f6c4d66615310fadad146605d73e600", "66f7850c039cd85acdcb9a68674ec7422f9ab6edc89d95fb877562ca26d71d52", "45243bd5eb94718bcc0b36d941989d9e2d8c9329c059c3e537513e7fa21e0f5a", "ff37aff31e0dcc9bc51b29fc5ea1e671de6e59d1fca51c681b3b0d52687ae73f", "1fc1bc4d004ab51398070d8e3025fecf8878229cda8befdbc9a2faf592b8d876", "9afd2ccb1e2c434d296a6fa54fa5425c827e4172947c05a7db226076996a3715", "d7549b1ddd668c5706b680654b2c39b6e401c55ecf25d0c4b1bff6468426e7ed", "30d6a4b9c41225c22b3d1bf2f1eab3d1c57c8b1a69502eab076a4f97f14023ac", "73bdfeed3b4385fbc237fd2d8b60a1e0e13b147046b951ef9f237cecd2d7006d", "c2f5ee2b99b2160178e947099d54cea940c21911997246938d274e9c6a834bc8", "f5872f49943c39b73026fc3982b85330953a138cc27c23487a28103337bfdbb5", "3cc166273476ebaf4d083e444914bdecf39a3faac5d049800859988b9c9c91b1", "d96f269b27138c282bd43beeb15f9f8ced006d2359ef43a79b98e3900e4f3a5e", "c70aceebfe9df5541e3a323928867d98ae6edcbd6ab7114b9f2da4dd45502cfe", "71bb21f0f778a27b2b4590aba090704802330208a44b079ffab64b790dfd5c8c", "36c62261ba32b9a2d81c1c3ac9e317c52c76ebe57cecd620ce646c7c94f994f9", "82369d8e376beb0c26d93e16f9794139163ce14e394d113a84a40f96bcde0cbb", "a87a14347dfa87128a5e5eb85067dbb6aac9d28484c08923c55c36ab1a3a99fa", "d3cf53d74868625d4ee00e367162798f829acf532bad69cf1b7ce959de0e072a", "c161134bf3330c82eb0278fe54b2975c26301bdfdc4fc35d5344f9becf5574c7", "13221bc0b7ee8f2ee265231134baa29624b7480e577f194b84a8652c67403150", "9d57ce4d1578fe7b3651a98b41a62888a1b228d6152acfd3b5c3e0b4c81c77ad", "e7c855161c6240beb0dec7b8209df8289be22eb9665cf71cf76228472c9de8b5", "06dec0082eac094dc0b4b3de8854f190f1d3112dada0d414d9a085a0ee309199", "84d9af7b24ce85c3e5d97236c8562fcd45d34d99b07412fbdaca697c5961723e", "a40741b588147021ec0e9908857a2938f1d9bab73ebde18d2ea77feac053b1dc", "e13cd452c0d9b8fa1a6f3a3b8722e35870efa0bec90bedf4eb757a9fe4c0c27b", "198e3c9e6f3dbcf586ac90486187ebfffdeb1c5d663131fc60c45451b04cce7a", "08744b41169f163d1fde59f98f4702cef46632a50b7c2bcbda60ae6626170a3b", "a70e7d11fb221210b50691d2904712313bc94370dd7893bf1bf4501018a112a9", "72ab5a4086ab51b09bf0de3cff666fd0b50eb33581c06094d02f8283162fcf18", "aea41f0fe65b8d414fb0130089ffd84662e94062bbded7fcdfb144a8dc9156b3", "7f38efc01d7388df1a00500b5e9c857e47501066b49a8fcb8324378daab32d1e", "4331c18483950c9a48a71a9b1d9b26ad1e2216d170898c22494900c8fc5e36dd", "f18e0335dc23604632b9af5f174ab2f53bfcfd500fd1d470d283835fad189005", "c8baddcd5967b502106f408cbe770c2af0256d6d0fcd11893719c0ecc8bc6cfd", "cb62e646b5b62db41b3b28709ea49ea4a941599a00cbde1bca2144f11fac8422", "07154b7a45937f2f5a2cda5b701504b179d0304fc653edb2d0672f54796c35f7", "34ae9148a4db9993110e4fe4a0f8e9db17790b036ea0f5c236f53cbf845dd2a3", "5e1d794cb53d10f3e0759347254a7a6c54005da1a4382574653fca5bd6d7ef88", "8c355092c7aaadb11748fd87ce528d3cdb483104e979d9b560af840eb8089f94", "f58a9713e22318e0b7bec000b886b378af5aa06a7c960496a04d3e74db368fd3", "9453ab44d0e10a59b322614b9a76ab87deb4c93bfce6466d5afa945ea8ebb7d6", "5c0cda1f5f7e69ec3d2b9c6c129f3b0509af84ff6e6f4b18b401f37777096027", "d4008091d1b25214d7575881364d95f3ecdc0222f1e84c4c537ce87e5c4cd122", "969d97e3fe95de96971a65de02d2bf7fb7d81cbbda24dd47c3c1ffcf81bbcee3", "30d06e100215461ad1c5b3bdb7a3b65c61f0ad27ebd733c7a37f40bd4b64932e", "a5497ec98195e7731b3de4f2e8c28083f86f46818ddc42425713be5410b9540d", "209c52bc39e8fa3df3d4d12a4d1913f3751582b34898adf966dd227cd5a0c99a", "703af242be581aa4c4c73b08ae57caf7c5d90f09f0991a963e07d02fb4209f75"], "Registry_Entries": ["HKCU\\SOFTWARE\\ThunderbirdEML.KD \nregistry key:\n\nValue Name\n\n(default)\n\nType\n\nSize\n\nDescription\n\nREG_BINARY\n\n32 bytes\n\nValue sent by the C2 server upon initial communication; it's needed \nto initiate download/execution of additional malware stages\n\nEditFlags\n\nREG_BINARY\n\nVariable\n\nDisableProcessIsolation\n\nREG_BINARY\n\n<DWORD>\n\nREG_DWORD\n\n8 bytes\n\n4 bytes\n\nList of C2 URLs encoded with XOR 0x8A8B8C; can \nbe set using one of the C2 commands\n\nSystem time, set at the time of the first C2 connection\n\nThese values are queried/set by the C2 server during the \nprocess of downloading and executing additional stages\n\nFigure 33: Check for C2 URL in registry\n\nFigure 34: Decryption of URL from registry value\n\n22\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fIf the EditFlags registry value contains additional URLs, they will be prioritized, otherwise the malware will attempt to connect to \nthe following hardcoded URLs:\n\n\u2022  happy.abelleds.com\n\n\u2022  far.ordanuy.com \n\n\u2022  home.runnerfd.com \n\n\u2022  dyndns.yceunca.com\n\nFigure 35: Hardcoded C2 domains\n\nThe malware has the capability to detect and bypass the victim\u2019s proxy configuration. There are two possible operation modes:\n\n\u2022  TCP sockets, on port 61781 (default) or on port 443 (in case victim\u2019s machine is configured to use a proxy)\n\n\u2022  HTTP POST/GET on ports 80 or 443, with the optional use of authentication (supports Basic and Digest schemes)\n\nC2\nProtocol\nInitially, the backdoor will connect to one of the C2 URLs using raw sockets and perform a simple handshake:\n\nSend 1 byte: 0x02\nRecv 1 byte: 0x03\n\n23\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fIf that fails, the backdoor will try to determine if the victim\u2019s machine is configured to use a proxy server. In such case, the backdoor \nwill first try to connect to the proxy and authenticate (if required):\n\n\u2022  HTTP proxy (1) and HTTPS proxy (2) - connect to the proxy URL with the following header:\n\nCONNECT %s:%d HTTP/1.1\nHost: %s:%d\nProxy-Connection: keep-alive\nUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like \nGecko) Chrome/48.0.2564.109 Safari/537.36\n\nFigure 36: HTTP proxy URL headers\n\nNote: The User-Agent string first appeared in Chrome from February 2016.\n\nFigure 37: Connection via HTTP proxy\n\nThe backdoor also supports Basic and Digest HTTP authentication methods. In case of Digest authentication, the backdoor will use \nthe hardcoded string \u201cd35efe4ba43e3803d57b4945fa3ab5dd\u201d as the value for client nonce parameter.\n\nFigure 38: Strings related to HTTP authentication, hardcoded \u201ccnonce\u201d value highlighted\n\n24\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \f\u2022  SOCKS proxy (4) - connect to the proxy server on specified port and send client connection request:\n\nSend 10 bytes: 04 01 + c2_port + c2_ip\nRecv  8 bytes: 00 5A XX XX XX XX XX XX (request granted)\n\n\u2022  SOCKS5 proxy (5) \u2013 connect to the proxy server on specified port and send client connection request:\n\nSend  3 bytes: 05 01 00\nRecv  2 bytes: 05 00\nSend 10 bytes: 05 01 00 01 + c2_port + c2_ip\nRecv 10 bytes.\n\nFigure 39: Connection via socks5 proxy\n\n25\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fAfter a successful handshake, the backdoor will collect system information, such as the username, computer name, OS version, and \ndetails of the first active network adapter (excluding loopback), and send this information to the C2 server:\n\n\u2022  Send 4-bytes (size of the upcoming packet)\n\n\u2022  Send packet with system information:\n\nOffset\n\nSize\n\nDescription\n\n0x0000\n\n4 bytes\n\nDecompressed size\n\n0x0004\n\n4 bytes\n\nCompressed size\n\n0x0008\n\nzlib compressed system information \n(decompressed size 0x199 bytes)\n\nFigure 40: System information packet\n\nFigure 41: Basic communication scheme\n\n26\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fThe decompressed zlib data contains:\n\nOffset\n\n0x0000\n\n0x0001\n\n0x0021\n\n0x0030\n\n0x0040\n\n0x0044\n\n0x0045\n\n0x0046\n\n0x0047\n\n0x0048\n\n0x004C\n\n0x0050\n\n0x0054\n\n0x0058\n\nSize (bytes)\n\nDescription\n\n1 byte\n\n32 bytes\n\n15 bytes\n\n16 bytes\n\n4 bytes \n\n1 byte\n\n1 byte \n\n1 byte \n\n1 byte \n\n4 bytes \n\n4 bytes \n\n4 bytes \n\n4 bytes\n\n0x03\n\nValue from ThunderbirdEML.KD\\(default)\n\nComputer name\n\nUser name\n\nunknown\n\nOS major version\n\nOS minor version\n\nService Pack major version\n\nService Pack minor version\n\nProduct Type\n\nSystem time low\n\nSystem time high\n\nFirst byte from RCDATA resource (in this case 0x02)\n\n128 bytes\n\nAdapter description\n\n0x00D8\n\n8 bytes\n\nAdapter physical address\n\n0x00E0\n\n0x00F0\n\n0x00F4\n\n0x00F5\n\n0x00F6\n\n0x010F\n\n16 bytes\n\n4 bytes\n\n1 byte\n\n1 byte\n\n25 bytes\n\n138 bytes\n\nAdapter IP addresses\n\nZero\n\nConnection mode (0x01 \u2013 raw sockets; 0x02 HTTP POST/GET)\n\nConnection method (initially set to 0)\n\nConnection data in format of %s:%d (initially set to zeroes)\n\nConnection data in format of %s:%s (initially set to zeroes)\n\nFigure 42: Decompressed system information structure\n\nThe following diagram shows a request containing system information, with the compressed (green) and decompressed (red) sizes, \nzlib data (blue), and finally the decompressed information (pink):\n\nFigure 43: Decoded system information request\n\n27\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fThen, the malware will create three threads that are responsible for downloading and executing payloads, processing additional C2 \ncommands and sending responses. \n\nFigure 44: Thread responsible for downloading and executing next stage payloads\n\nOnce an internal event is set, the backdoor will contact the C2 server to download and execute additional stages. To do that, it will \nproceed as follows:\n\n\u2022  Connect and send beacon based on the internally specified connection method \n\n\u2022  Send 1 byte (0x06) \n\n\u2022  Send data from the \u201c(default)\u201d value in the registry (32-bytes), zlib compressed \n\n\u2022  Receive a 4-byte integer that will be used as registry value name \n\n\u2022  Send data from that registry value (4-bytes) \n\n\u2022  Receive 4-bytes (size of upcoming packet) \n\n\u2022  Receive zlib compressed packet containing next stage payload\n\n\u2022  Decompressed data format:    \n\nregval_data_len \nregval_data \npath_len \npath \nfile_content_size \nfile_content \ncommandline_len \ncommandline\n\n\u2022  Write file_content to path (create directories if needed) \n\n\u2022  Create process path commandline \n\n\u2022  Set registry value to the regval_data\n\n\u2022  Send 4-byte response (last error code).\n\n28\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fCommands\nBesides executing additional next-stage payloads, the backdoor can process six additional commands. \n\nFigure 45: Command processor\n\nThe C2 command packets have the following format:\n\nOffset\n\nDescription\n\n0x00\n\n0x04\n\n0x08\n\n0x0C\n\nUnknown\n\nCommand ID\n\nLength of parameters\n\nParameters\n\nThe following commands are supported:\n\nCode\n\nParameters\n\nDescription\n\n0\n\n1\n\n3\n\n6\n\n7\n\n8\n\nvalue_data\n\nSet \u201c(default)\u201d value in the registry (expected to be 32 bytes)\n\ndword ip_address port\n\nConnect to specified IP on specified port and send a beacon; send code 0x05 + content \nof the \u201c(default)\u201d value from the registry + dword back to the original C2 server\n\napplication_name cmd_line\n\nCreate process\n\nfile_name file_content\n\nCreate and write file\n\ndata_len data\n\n(none)\n\nSet EditFlags value in the registry\n\nDelete files: C:\\Windows\\Origin\\Origin.exe, %appdata%\\Origin\\Origin.exe and terminates \n\n29\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fSplinter RAT\n\nClassification\n\nMalware/Backdoor\n\nAliases\n\nWINDSHIELD (FireEye)\n\nSize\n\nType\n\n355 KB (364,353 bytes)\n\nPowerShell/Shellcode/Win32 PE (DLL)\n\nFile Name\n\nunderwears.png\n\nTimestamp\n\nThu, August 07 2008 01:43:09 UTC (spoofed)\n\nObserved\n\nNovember 2017\n\nOverview\nSplinter arrives as an MSBuild project file containing a Base64 encoded PowerShell script generated using the MSFvenom psh-\nreflection module. As in the case of Remy, it utilizes on-the-fly C# compilation and strips off several PowerShell wrappers before \nthe shellcode that calls the final payload is invoked. The backdoor itself is a Win32 PE EXE file and has the capability to collect \ninformation, download and execute payloads, run WMI queries, and manipulate files, processes, and registry entries.\n\nThe overall functionality of Splinter appears pretty much in line with the \u201cKOMPROGO\u201d malware (as described in the FireEye \nAPT32 report).\n\nFeatures\n\u2022  Several PowerShell \u201cwrappers\u201d\n\n\u2022  MSFvenom psh-reflection payload\n\u2022  Veil powershell/shellcode_inject\n\n\u2022  Custom C2 protocol (different from Remy and Roland)\n\n\u2022  38 C2 commands \n\n\u2022  Use of LZHAM for compression of backdoor response data\n\nBehavior\nThe backdoor will not attempt to communicate with the C2 if any of these network monitors are running:\n\n\u2022  wireshark.exe (check for running process)\n\n\u2022  NetworkMiner.exe (check for running process)\n\n\u2022  TCPView (check for window name)\n\nFigure 46: Find network monitors\n\n30\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fIt will also constantly check for these processes and exit in the event any of these are detected.\n\nAs in the case of other backdoors used by the OceanLotus Group, the most sensitive strings, including hardcoded C2 addresses, are \nstack-based and obfuscated with one-byte incremental XOR:\n\nFigure 47: Stack-based string decryption\n\nFigure 48: String decryption loop\n\nThe following URLs are hardcoded in the binary:\n\n\u2022  rss.honoremarson[.]com (89.249.65.134, 185.244.213.28)\n\n\u2022  repo.paigeherzog[.]com (89.249.65.134, 185.244.213.28)\n\n\u2022  ssl.wolfgangneudorf[.]com (89.249.65.134, 185.244.213.28)\n\n\u2022  help.angelinagerste[.]com (69.64.147.33, 185.244.213.28)\n\n\u2022  mms.garyschulze[.]com (69.64.147.35, 91.195.240.103)\n\nThe backdoor also maintains a hardcoded list of ports to use, including 443, 1364, and 35357.\n\nAfter sending an initial handshake, composed of two hardcoded values (request code and victim\u2019s ID) buried inside pseudo-random \ndata, the backdoor will send the contents of the \u201cKey\u201d value from [HKLM|HKCU]\\Software\\Microsoft\\GameCenter\\Identity. If this \nvalue is empty or doesn\u2019t exist, the malware will send a hardcoded string instead.\n\n31\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fFigure 49: C2 communication\n\nThe C2 server is expected to respond first with a header, that will indicate the size of upcoming packet, followed by a value that \nwill be written by the backdoor to the same registry location. Then, the C2 communicates with the backdoor by sending a header \ncontaining command code and length of parameters, followed by a packet containing the command parameters string.\n\nC2\nProtocol\nThe standard C2 request/response consists of a 40-byte header packet, that includes the request code, hardcoded value (bot version \nor victim ID), compression indicator and length of upcoming data, and is padded with pseudo-randomly generated bytes. If the length \nfield is not 0, the header is followed by a variable size packet containing data and optionally compressed with LZHAM algorithm. \n\nThe header of each C2 command packet additionally contains the command code, length of session ID, length of uncompressed \ndata (optionally), and two boolean values indicating if the data is compressed and if the backdoor should compress the response. \nThe size of the data packet is calculated by combining the length of data with the length of session ID. The session ID value sent by \nthe C2 is prepended to the data packet in the backdoor\u2019s response.\n\nOffset\n\n0x0000\n\n0x0001\n\n0x0003\n\n0x0007\n\n0x0008\n\n0x000C\n\n0x000E\n\n0x0010\n\n0x0011\n\n0x0015\n\n0x0017\n\n0x001B\n\n0x001C\n\nLength\n\n1 byte\n\n2 bytes\n\n4 bytes\n\n1 byte\n\n4 bytes\n\n2 bytes\n\n2 bytes\n\n1 byte\n\n4 bytes\n\nInitial Ping\n\nSubsequent Backdoor Responses\n\nC2 Request/Response\n\nrandom byte\n\n0x02\n\nhardcoded \n0xC19A \n\nhardcoded 0x7266\n\nzero\n\nlength of data\n\nlength of data\n\nrandom byte\n\n[copied from C2 request packet]\n\nrandom dword\n\n[copied from C2 request packet]\n\nrandom word\n\n[copied from C2 request packet]\n\nbot version \n/ victim ID\n\nbot version / victim ID\n\nrandom byte\n\ncompressed bool\n\nzero\n\ndecompressed size\n\ncompressed bool\n\ndecompressed size\n\n2 bytes \n\nrandom word\n\n[copied from C2 request packet]\n\n4 bytes\n\n1 byte\n\n4 bytes\n\nrandom dword\n\ncommand code\n\ncommand code\n\nrandom byte\n\n[copied from C2 request packet]\n\nzero\n\nbackdoor error code\n\n32\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fOffset\n\n0x0020\n\n0x0021\n\n0x0023\n\n0x0024\n\nLength\n\nInitial Ping\n\nSubsequent Backdoor Responses\n\nC2 Request/Response\n\n1 byte\n\n2 bytes\n\n1 byte\n\n4 bytes\n\nrandom byte\n\ncompressed bool\n\nrandom word\n\nlength of session ID\n\nrandom byte\n\nzero\n\nrandom dword\n\n[copied from C2 request packet]\n\ncompress response bool\n\nlength of session ID\n\nFigure 50: Initial C2 packet with request code and victim ID highlighted in red \n\nFigure 51: Second packet. RED: request code, size of data, victim id, compression bool; GREEN: data \u2013 hardcoded key \n\nCommands\n\nCommand Code\n\nParameters\n\n0x04B604C5\n\nTimeout value\n\n0x089BE370\n\n0x036E7BDA\n\n0x2E6C900F\n\n0x1A18C8D2\n\n0x2EC5A3F2\n\n0x0945C6BD\n\n0x0C963EDB\n\n-\n\n-\n\n-\n\n-\n\n-\n\n-\n\n-\n\nDescription\n\nSet connection timeout\n\nCheck process token membership\n\nGet user name\n\nGet content of ", "HKCU\\Control Panel\\Accessibility\\Keyboard Layout_", "HKCU\\SOFTWARE\\Microsoft\\SkyDrive\\{87F4F1B2-824E-420F-8B48-\n4E8B575C2A7B} registry key. The registry path is stored as a stack-based, RC4 encrypted string:\n\nFigure 66: String decryption\n\n40\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fC2\nProtocol\nIn order to bypass firewalls and fly under the radar, the backdoor uses the ICMP protocol to communicate with the C2 server.\n\nFigure 67: Creating an ICMP handle\n\nFigure 68: Backdoor communication through ICMP\n\nThe C2 command packets have the following format:\n\nOffset\n\n0x0000\n\n0x0004\n\n0x0008\n\nSize\n\n4 bytes\n\n4 bytes\n\nDescription\n\nMagic, or session ID\n\nCommand code\n\nvariable\n\nCommand parameters\n\nThe backdoor response header consists of the following information:\n\nOffset\n\n0x0000\n\nSize\n\n4 bytes\n\n0x0004\n\n4 bytes\n\n0x0008\n\n0x000C\n\n0x0010\n\n0x0014\n\n4 bytes\n\n4 bytes\n\n4 bytes\n\nDescription\n\nMagic/ID (copied \nfrom the request)\n\nLength of header \n(hardcoded 0x0C)\n\nError code\n\nOriginal data size\n\nCompressed data size\n\nVariable\n\nCompressed response\n\n41\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fCommands\n\nCommand Code\n\nParameters\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\nApplication name\nCommand line\n\nPath\n\nCommand line\n\nFile name\nCompressed data\n\nValue data\n\n-\n\nPath\n\nExisting file path\nNew file path\n\nPath\n\n-\n\nPath\n\nPath\n\nDescription\n\nCreate process\n\nCopy specified file to %TEMP% folder\n\nReverse shell\n\nDecompress data sent by C2 and write it to a specified file on disk\n\nSet registry value \u201cU\u201d under SOFTWARE\\Microsoft\\SkyDrive\\\n{87F4F1B2-824E-420F-8B48-4E8B575C2A7B} key to provided data\n\nEnumerate windows\n\nDirectory listing\n\nMove file\n\nDelete file\n\nGet logical drives\n\nCreate directory\n\nRemove directory\n\nDenis\n\nClassification\n\nMalware/Backdoor\n\nAliases\n\nSize\n\nType\n\nFile Name\n\nObserved\n\nSOUNDBITE (FireEye)\n\n< 300KB\n\nWin32 PE (EXE)\n\nCiscoEapFast.exe, WerFault.exe, SwUSB.exe, msprivs.exe, SndVolSSO.exe\n\n2016\n\nOverview\nDenis is a simple backdoor developed by the OceanLotus Group, well observed in-the-wild and renowned for using DNS tunneling \nas a transport mechanism for C2 communications. \n\nDenis is typically deployed early in the attack lifecycle, and it appears to be less tailored/targeted than the more advanced backdoors \nthat are utilized once a foothold has been established within an environment. \n\nBehavior\nUpon execution, Denis imports the bulk of its runtime APIs dynamically, with the DLL and function names encoded as stack-\nbased strings:\n\n42\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fFigure 69: Denis import DLL and function names encoded on the stack\n\nThese UNICODE strings are decoded using byte level add/subtract, depending on the variant:\n\nFigure 70: ADD 0x80 string decoding\n\nThis technique is used heavily amongst APT32 backdoors (for example Remy below):\n\nFigure 71: Remy stack-based string decoding\n\n43\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fAfter importing APIs, Denis will typically create a mutex to prevent multiple instances running, before decoding the DNS names \nused for C2 tunneling in much the same way as API/function names:\n\nFigure 72: Denis C2 domain name decoding\n\nAfter decoding and reading configuration stored in the registry, Denis will create a thread to communicate with the C2 server, typically \nsupporting the following commands:\n\nCommand Code\n\nDescription\n\n0x01\n\n0x02\n\n0x03\n\n0x04\n\n0x05\n\nLoad DLL and run exported function\n\nUnload DLL\n\nCreate process (hidden)\n\nRead file\n\nRun cmd.exe with redirected stdout\n\n0x06/0x07\n\nWrite file\n\n0x0a\n\n0x0b\n\n0x0c\n\n0x0f\n\n0x10\n\n0x11\n\n0x12\n\n0x13\n\n0x14\n\nEnumerate windows\n\nSet registry value\n\nGet registry value\n\nList directory\n\nMove file\n\nDelete file\n\nGet logical drive information\n\nCreate directory\n\nDelete directory\n\n44\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fC2 data is Base64 encoded and prepended to one of several configured domain names, before being transmitted via DNS request, \ntypically routed via a DNS forwarder:\n\nFigure 73: Denis DNS tunneling\n\nDenis samples have been observed using a variety of forwarders and name servers for C2, as well as using NULL/TEXT/CNAME \nrecords to embed encoded data, depending on configuration.\n\nNetwork Intelligence\nNetwork intelligence was initially obtained during November 2017.\n\n167.114.44.146\nAll C2 domains were registered using Privacy Guardian on August 21, 2017. All host names resolve to the same Canadian IP address \n(167.114.44.146).\n\nWhois\n\n45\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fDomains\n\nFirst seen\n\n46\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \f87.117.234.172\nWhois\n\nDomains\n\nFirst seen\n\n47\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \f27.102.67.42\nWhois\n\n89.249.65.134\nWhois\n\n48\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fDomains\n\nFirst Seen\n\n89.249.65.134\n\n185.244.213.28 \nWhois\n\n49\n\nMalware Analysis White Paper : The SpyRATs of OceanLotus \fDomains\n\nFirst seen\n\nConclusions\nOceanLotus employs both home-brew and off-the-shelf RATs. \nThey use PowerShell scripts from open-source exploit kits, \nincluding MSFvenom, Veil, and DKMC, to load shellcode and \nDLL payloads into memory. C2 functionality is customized \nto the target, and all domains are registered through an \nanonymization service called PrivacyGuardian.  \n\nThe Roland and Remy trojans share similarities and some \ncode re-use with other known OceanLotus malware. The \noverall design and development of these threats indicate they \ncome from a well-funded development team. The OceanLotus \nGroup uses an expansive amount of custom library code that \ncan easily be repurposed for maximum effectiveness against \ntheir next target.\n\nAppendix\nOceanLotus Table\n\n+1-844-CYLANCE\nsales@cylance\ufffdcom\nwww\ufffdcylance\ufffdcom\n\n20181012-0293\u00a9 2018 Cylance Inc. Cylance\u00ae and CylancePROTECT\u00ae and all associated logos and designs are trademarks or registered trademarks of Cylance Inc. All other registered trademarks or trademarks are property of their respective owners.\fOceanLotus Table\n\nMD5\n\nSHA256\n\nSource\n\nFile Names\n\nType\n\nName\n\nAliases\n\nSize\n\nTimestamp First Seen ITW Parent\n\nRelationships\n\nHosted On\n\nC2\n\nIOCS\n\nunderwears.png\n\nPS1 + DLL\n\nRemy\n\nWindshield\n\n364353\n\n11/8/17 0:32\n\ngnsdk_submit.dll, certcredprovider.dll.mui\n\nplugin.lst\n\nDLL\n\nDLL\n\nRoland\n\nCamCapture\n\n272872\n\n5/28/09 13:54\n\nApr-17\n\n120320\n\n10/24/07 4:23\n\nNov-17\n\nOsErXrdO, wpfgfx_v0300.dll\n\nPS1 + EXE\n\nSplinter\n\nKomprogo (?)\n\n2133014\n\n7/13/10 11:49\n\nNov-17\n\n29a807b64777ea215b1953e091e8ea1c\n\nd2619dd966f942d9870e7728d4fb238f83b5769d84f0850e3df35ab167da3a41\n\nf9f843dc7c3486ea1ca979980a9fd318\n\n72ab5a4086ab51b09bf0de3cff666fd0b50eb33581c06094d02f8283162fcf18\n\ne1973fcd28806ef60f47d01f8b7cc23e\n\na5497ec98195e7731b3de4f2e8c28083f86f46818ddc42425713be5410b9540d\n\n121918fd5630cb670d182c8483738bf1\n\nd4008091d1b25214d7575881364d95f3ecdc0222f1e84c4c537ce87e5c4cd122\n\na2859b211809978bd128a1025e403963\n\nbacdb6a6bdd0b81c551ef30514dc3186f483b135fbc63759dd861d2de59585ad\n\n6575db1c50c5bdd0313622e16c08f79a\n\n70a749a760e99471b6825818f9091f4ee08de538b4686fa0475f0df667e91643\n\n40f644f1957d0a30ba76470279e1463a \n\nafaafe2944970913772d013853ecc297c66230fa25c78956ac53a6c933059276\n\n417a0ecf6459edf56ea704a9b5783208 \n\naea41f0fe65b8d414fb0130089ffd84662e94062bbded7fcdfb144a8dc9156b3\n\nd1e614479fee318904442c16c5ef4877\n\n29bdd6341d59caa70a9e9f6229f7d4c2603d2ba333bc4573cf8c0faabe0f16af\n\n1f8ade068ba6fbfe8605e0946bf2d79f\n\nc2f5ee2b99b2160178e947099d54cea940c21911997246938d274e9c6a834bc8\n\nc117ea93410ad849e7a3ff9293bcd9ab\n\n9453ab44d0e10a59b322614b9a76ab87deb4c93bfce6466d5afa945ea8ebb7d6\n\n0529b1d393f405bc2b2b33709dd57153\n\ne6594d11244357537fa3ef5292cb52ccbd7c8f26a277f7003ade80964351878f\n\n41bced8c65c5822d43cadad7d1dc49fd\n\nd3cf53d74868625d4ee00e367162798f829acf532bad69cf1b7ce959de0e072a\n\nbc1ccc120d185a0c36b191ec6b74397c\n\nc4d4169dc85ad57168b1efabdd32cb67a76c27ce1fb615685505b378ee345a3f\n\n42123d2493598c9ac9803fe1b92ed032\n\n969d97e3fe95de96971a65de02d2bf7fb7d81cbbda24dd47c3c1ffcf81bbcee3\n\nCy\n\nCy\n\nCy\n\nCy\n\nCy\n\nCy\n\n9\n\n9\n\n5\n\n5\n\n5\n\n1\n\n1\n\n5\n\n5\n\nimg.png\n\nuser.ico\n\nmicrosoft.jpg\n\nicon.ico\n\nhgfs.dll\n\nep7res01.dll\n\nhp6000.dll\n\nrtx.exe\n\nNetcaEKeyClient.exe\n\nGoogleUpdateSetup.exe\n\nGoogleUpdateSetup.exe\n\n3b53e66f34beb3cd30e6a7da457e86c8\n\n34cf914444493995379731c887637c07fd6308e412a15518b60a2642820f09d4\n\n5\n\nKoreanTimesSSK.ttf, KB3033929.exe\n\n3bd041ef488806c55fbc40b4af24eabb\n\n66f7850c039cd85acdcb9a68674ec7422f9ab6edc89d95fb877562ca26d71d52\n\n46745e29f15eedfabba7e080f6295200\n\n3caaa69c5ce00e17efc61a83ad71823dcfcca6a7c9dc013be3d58b1c894d407a\n\ne02e37ea705f1066798f285836a6fc46\n\nef68cfad4cdae58624d12ff97ae00e68aafae9e6f33f3bd23dffc37869a1e578\n\n7edcae7740ee7e7c75699cfbb4d89310\n\ne7c855161c6240beb0dec7b8209df8289be22eb9665cf71cf76228472c9de8b5\n\n5\n\n5\n\n4\n\n4\n\n7zS.sfx.exe\n\nSo tay van de phap ly cho cac nha hoat \ndong nhan quyen_20170427.final.exe\n\nCursif.ttf\n\nExcel.exe\n\ne71f3dc106852cd4648c41376204af9f\n\n023a4f500af9aac9960066a96fb0d811e4e25df7d9d564b3d0cc899b7c2bb5b3\n\n4\n\nInstall.RobotoSlab-Font.exe\n\nPS1\n\nPS1\n\nPS1\n\nPS1\n\nDLL\n\nDLL\n\nDLL\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nCobaltStrike\n\n289385\n\nCobaltStrike\n\n286001\n\nCobaltStrike\n\n287984\n\nCobaltStrike\n\n264862\n\nNov-17\n\nNov-17\n\n5/23/17 21:04\n\n12/7/17 20:28\n\n5407928\n\n9/1/14 11:43\n\n5/23/17 0:43\n\n94720\n\n10/20/10 20:09\n\n5/23/17 0:43\n\nef68cfad4cdae58624d12ff97ae00e68aafae9e6f33f3bd23dffc37869a1e578\n\nef68cfad4cdae58624d12ff97ae00e68aafae9e6f33f3bd23dffc37869a1e578\n\n94720\n\n5/10/07 20:40\n\n6/11/17 6:42\n\n25904128\n\n5/10/08 3:30\n\n3/25/15 0:42\n\n8608256\n\n4/24/10 18:51\n\n2/2/15 20:44\n\nSalgorea (Symc), \nEncryptor (360)\n\nSalgorea (Symc), \nEncryptor (360)\n\n2508288\n\n1/24/08 7:47\n\n8/2/17 21:49\n\n2511360\n\n2/12/06 8:11\n\n6/1/17 4:50\n\n1451520\n\n2/13/11 16:41\n\n6/11/17 6:42\n\n1709568\n\n2/12/06 8:11\n\n7/9/17 17:13\n\nhttp[:]//adstripstravel[.]com/resources/images/img.png\n\nhttp[:]//adstripstravel[.]com/user.ico\n\nhttp[:]//110.10.179[.]65:80/download/microsoft.jpg\n\nhttp[:]//support.chatconnecting[.]com:80/icon.ico\n\nhttp[:]//template.ethanypin[.]com/KoreanTimesSSK.ttf\n\n8260608\n\n10/19/11 23:29\n\n6/11/17 11:31\n\n54df4c7e55ceb16e875b07b621b66f577f42198b85872261cd9a5be885ede7d2\n\nhttp[:]//template.ethanypin[.]com/Cursif.ttf\n\n1517568\n\n12/11/08 17:32\n\n5/23/17 0:42\n\n1693696\n\n12/21/10 21:49\n\n7/23/17 4:45\n\n2044928\n\n12/27/11 16:09\n\n6/23/17 10:08\n\n29bdd6341d59caa70a9e9f6229f7d4c2603d2ba333bc4573cf8c0faabe0f16af, \nc2f5ee2b99b2160178e947099d54cea940c21911997246938d274e9c6a834bc8\n\nhttps[:]//xc2dfa-sn3301.files.1drv[.]com/y4mzaSVTDpsdcSchibE9Jtc_\nczEWKouetlGePP89op0rwCx471q4Eaj8LKql7iprSszeUCMeFSyiKTAiyNM4ONPPW6q_13rgYs6iJwE85LGfIKneCt7SVosmeM8K_\nOZlnUn0NOiWGUa0S9vflX8YUBG4E6oE4Gss9vV3VhvxIAk-3eWztb5fY0v6CsXEbybiB8U\nDcTIj9dyK5ZwB1brAzUtQ/Install.RobotoSlab-Font.exe?download&psid=1\n\nhttp[:]//download-attachments.s3.amazonaws[.]com/d00377793cdfea033296436c67cf2b3cf8989048/\nc9c5fb3a-936b-456e-9878-2e95becde07e\n\n9eed9619eac172fa0b29de755907759c\n\n16fdb8f388f5a8737130d952f752fc9201ffde8549ae583c7582ab01147d171d\n\n4\n\nWinWorld.exe, Bai viet hot can dang bao final.exe, \nPhu huynh khong tin tuong truong dai hoc hutech.exe\n\nEXE\n\nCobaltStrike\n\n184832\n\n6/14/17 7:38\n\n6/24/17 5:19\n\nc4dbc10104f058fcc5500d61cd48746a\n\n82369d8e376beb0c26d93e16f9794139163ce14e394d113a84a40f96bcde0cbb\n\n4\n\nflash_installer.exe\n\nc781b4cde28609ff2d7b217671e1f110\n\n45243bd5eb94718bcc0b36d941989d9e2d8c9329c059c3e537513e7fa21e0f5a\n\nfcd7227891271a65b729a27de962c0cb \n\nb6b872de14275866bed7d9a7f685a382a29fa298394d21cdd365de452db5a3c8\n\n58d2907361f6414742dcc5071ca20980 \n\n5dff6bc9e8898f2ed09ced9ac23b7e4d867e90c3efbe42726edcb01ecb0b1673\n\n4\n\n6\n\n6\n\nfids.exe\n\nFontExt.dll, adobe-font-pack.exe\n\nflashplayer26pp_ka-install.exe, rastlsc.exe\n\neb2b52ed27346962c4b7b26df51ebafa \n\nbdb83301a470d202480274df161638f83f8f26e7dda131a11b89a5a3d8259c73\n\n6, 7, 10\n\nFirefoxInstaller.exe, 7zS.sfx.exe\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nEXE\n\nCobaltStrike\n\n181760\n\n6/14/17 7:38\n\n6/19/17 9:03\n\nCloudrunner \n(360)\n\nDenis\n\nDenis\n\nDenis\n\n70144\n\n3/7/16 22:54\n\n8/13/16 17:15\n\n1732096\n\n11/16/11 9:54\n\n10/15/17 6:47\n\n2639872\n\n9/17/08 19:34\n\n7/28/17 10:11\n\n16a608f88ef13ebdb2287482aa29629e7b34664cf133ab7d653c15808e92f8fa\n\nhttp[:]//dload01.s3.amazonaws[.]com/b89fdbf4-9f80-11e7-abc4-2209cec278b6b50a/FirefoxInstaller.exe\n\n1673728\n\n11/16/11 9:54\n\n9/28/17 12:23\n\n34ae9148a4db9993110e4fe4a0f8e9db17790b036ea0f5c236f53cbf845dd2a3\n\nhttp[:]//103.53.197[.]172/Firefox%20Setup%20Stub.exe\n\nrss.honoremarson.com, repo.paigeherzog.\ncom, ssl.wolfgangneudorf.com, help.\nangelinagerste.com, mms.garyschulze.com\n\nCreates/queries the following values under [HKLM|HKCU]\\Software\\\nMicrosoft\\GameCenter\\Identity: ", "HKCU\\Printers\\DevHP"], "URLs": ["http://193.169.244.213/WQLp,", "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html", "http://cdn-download01.s3.amazonaws.com/07b3aa08-86-842a-48b1-8e57-383d56a0d2e9/FirefoxUpdate.exe", "http://www.freebuf.com/articles/network/146552.html", "https://www2.cybereason.com/asset/61:research-cobalt-kitty-profile-iocs", "http://185.141.27.116/xyz2,", "http://193.169.244.213/safebrowsing/rd/", "https://mp.weixin.qq.com/s?__biz=MzI5NjA0NjI5MQ%3D%3D&idx=1&mid=2650164408&sn=a5abc26a34f4f21c20619146686670bf", "http://www.freebuf.com/articles/others-articles/153666.html", "http://185.141.27.116/safebrowsing/rd/", "https://mp.weixin.qq.com/s/UIV0YaIlSJLcYT32XJQPlg", "https://securelist.com/use-of-dns-tunneling-for-cc-communications/78203/", "http://adstripstravel.com/resources/images/", "http://adstripstravel.com/user.ico", "http://www.freebuf.com/news/topnews/68622.html", "https://researchcenter.paloaltonetworks.com/2017/06/unit42-new-improved-macos-backdoor-oceanlotus/", "https://github.com/Exploit-install/DKMC/blob/master/core/util/exec-sc.ps1"], "weight": 0.0}