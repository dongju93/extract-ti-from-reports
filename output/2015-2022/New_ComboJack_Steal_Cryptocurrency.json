{"rule_id": 530, "name": "New_ComboJack_Steal_Cryptocurrency", "description": "-", "references": ["CVE-2017-8579"], "File_Names": ["a.doko", "bstest.exe", "setup.txt", "\ufb01nspy.html", "system.net", "dridex_and_lockyret.html", "ComboJackImage2.png", "Container.exe", "achi.exe"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["a10a5666ce31c7a3de760f33d93bd924354e7bac1f07bde9e3ac3da8e250eb6d", "15e6984beea04bf2f26fbbe1e490c59d1f51ba7ad0dce3ac76cea21579ca694b", "228e8b728f7b714934f5ecfa6fd5de256d1d24f634a63f2fc4663c7cfb3b9d65", "325fd50143d6d975d9db18cf9a069c9107c3bfcad5a07653d53c0fc315ee27ab", "05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136", "98e896586ea71f80a2b0024ec86133bfa5163f01f4faa1b1f380f0a2ea128c2f", "ea5eb17c32767486c1b3a8ee7a8eacefab125c93414cdea97348c2ee96752f7e", "cab010b59cf9d649106477df012ca49f939aa537910b56bfadbe1381b0484d88", "d0f6dcdb4f749490a7ef678e9006474c885fbb3d8e396a5c8f2150441bb34782", "85c27addbf3a7234ac1e2922002fdef216994708bdda28f2ad6d3a7a1b32934e", "9613aefc12880528040812b0ce9d3827d1c25fe66f8598eaef82c169e8ed02da", "2ee9a1c554a774925f83428a0822b901d7b3ed81c247cb0d038ecc188d9f9149", "c1cc9448ee5684698f7891911821a9eb86f56be8852adef613b2fab4636e7b36", "05cbc6b1e98bc6f8935f95454ba214cccaf3a36c497126512669daba59a407a0", "8d8f497313ed797090ef552d44198f8c21f0a6ed261b30902d4d37478cd2efeb", "4d96d8cfefd9cc3f86bd3ab7f054f0b0acef726a4c349359bf44d22952b4744d", "d92b4c622d3524f6d5ce8fe53d802c6a0c51fd1f56ac2b554daac24d7b4fb8ef", "8a6f75a4a58bdafed085fd640681a4c94eee54f1bfb6e5eb6dcf8eb7524d2a2e", "bd1b56b6814aae369b0593dfe71450e1b45cb288f752faa2622d1b189bc6b2d6", "a6807cf5ed53b34cc9513defcde56c8a956c3d574ee9f300b3a763a7c8287081"], "Registry_Entries": ["HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\NVIDIA \u2013 C:\\ ProgramData\\NVIDIA\\NVDisplay.Container.exe\n\nWhen the above steps are completed, ComboJack enters into an in\ufb01nite loop. Every half second it checks the contents of the clipboard. The\ncontents of the clipboard are checked for various criteria to determine if the victim has copied wallet information for various digital currencies. In\nthe event a wallet of interest is discovered, ComboJack will replace it with a hardcoded wallet that the attacker presumably owns in an attempt to\nhave the victim accidentally send money to the wrong location. This tactic relies on the fact that wallet addresses are typically long and complex\nand to prevent errors, most users will opt to copy an exact string in order to prevent potential errors. If any potential currency addresses are found,\nthey are replaced following the criteria in the table below:\n\nChecks for this\ncriteria\n\nReplaces with\n\nWallet Type\n\n0xE44598AB74425450692F7b3a9f898119968da8Ad\n\nEthereum\n\n4BrL51JCc9NGQ71kWhnYoDR\ufb00sDZy7m1HUU7MRU4nUMXAHNFBE Monero. It\u2019s important to note that\nthis replacement string is not long\nenough, as Monero wallet\naddresses are either 95 or 106\ncharacters in length. This was\nlikely a mistake made by the\nauthor.\n\n1LGskAycxvcgh6iAoigcvbwTtFjSfdod2x\n\nBitcoin\n\nLYB56d6TeMg6VmahcgfTZSALAQRcNRQUV\n\nLitecoin\n\n79965017478\n\nQiwi\n\nR064565691369\n\nWebMoney (Rubles)\n\nZ152913748562\n\nWebMoney (USD)\n\n88888888888888888888888888888888888888888888888888\n\nUnknown\n\nLength of 42\nand starts with\na \u20180\u2019\n\nLength of 106\nand starts with\n\u20184\u2019\n\nLength of 34\nand starts with\n\u20181\u2019\n\nLength of 34\nand starts with\n\u2018L\u2019\n\nLength of 11\nand starts with\n\u20188\u2019\n\nLength of 13\nand starts with\n\u2018R\u2019\n\nLength of 13\nand starts with\n\u2018Z\u2019\n\nLength of 13\nand starts with\n\u2018E\u2019\n\n\u00a0\n\u00a0\n\f410014474125403\n\nYandex Money\n\nLength of 15\nand starts with\n\u20184100\u2019\n\nTable 1. Replacement address lookup table hardcoded into ComboJack.\n\nComboJack shares some similarities in basic functionality with CryptoShu\ufb04er (https://www.kaspersky.com/blog/cryptoshu\ufb04er-bitcoin-\nstealer/19976/), which is a malware family discovered by Kaspersky in 2017. However whereas CryptoShu\ufb04er focused exclusively on\ncryptocurrencies, ComboJack also targets popular digital payment systems, such as WebMoney (USD, EUR, and RUB), and Yandex Money.\n\nConclusion\n\nWith the proliferation of Cryptomining malware, it is curious to see some actors take a di\ufb00erent route to acquiring web-based currency.\nCryptoshu\ufb04er in 2017 may have been only the beginning of simple, yet e\ufb00ective clipboard stealers like ComboJack. By targeting multiple\ncryptocurrencies and web based wallets, the author of ComboJack appears to be hedging his or her bets on which currency will boom and which\nwill bust. As the prices of cryptocurrencies continue to rise it is likely we will see more and more malware targeting cryptocurrencies, as it presents\nthe fastest way to the highest pro\ufb01t.\n\nPalo Alto Networks WildFire customers are protected from this threat through the following ways:\n\nComboJack malware is identi\ufb01ed as malicious and blocked via the Traps and WildFire products\nCustomers may monitor and track ComboJack (https://autofocus.paloaltonetworks.com/#/tag/Unit42.ComboJack) through the AutoFocus\ntag\n\nIOCs\n\nLure PDFs:\n\ndd8ba88df50de86e7bb9b6343313e48e1e3b8d1a84\ufb00ca0a06a203a2f027cfdc\n\nd3a5313a0070b8400b0d661f2515a0eb83e4e6110b98e9\ufb00b6618e457bf52714\n\n15e6984beea04bf2f26fbbe1e490c59d1f51ba7ad0dce3ac76cea21579ca694b\n\n325fd50143d6d975d9db18cf9a069c9107c3bfcad5a07653d53c0fc315ee27ab\n\nPayload:\n\nbd1b56b6814aae369b0593dfe71450e1b45cb288f752faa2622d1b189bc6b2d6\n\n228e8b728f7b714934f5ecfa6fd5de256d1d24f634a63f2fc4663c7cfb3b9d65\n\n05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136\n\nd92b4c622d3524f6d5ce8fe53d802c6a0c51fd1f56ac2b554daac24d7b4fb8ef\n\n4d96d8cfefd9cc3f86bd3ab7f054f0b0acef726a4c349359bf44d22952b4744d\n\n85c27addbf3a7234ac1e2922002fdef216994708bdda28f2ad6d3a7a1b32934e\n\nea5eb17c32767486c1b3a8ee7a8eacefab125c93414cdea97348c2ee96752f7e\n\na6807cf5ed53b34cc9513defcde56c8a956c3d574ee9f300b3a763a7c8287081\n\n8d8f497313ed797090ef552d44198f8c21f0a6ed261b30902d4d37478cd2efeb\n\n47f14c24212c32e686f0b9162530c4b966c9c\ufb00907e1920c096ad81d078f20cd\n\n05cbc6b1e98bc6f8935f95454ba214cccaf3a36c497126512669daba59a407a0\n\n8a6f75a4a58bdafed085fd640681a4c94eee54f1bfb6e5eb6dcf8eb7524d2a2e\n\n2ee9a1c554a774925f83428a0822b901d7b3ed81c247cb0d038ecc188d9f9149\n\nd0f6dcdb4f749490a7ef678e9006474c885fbb3d8e396a5c8f2150441bb34782\n\na10a5666ce31c7a3de760f33d93bd924354e7bac1f07bde9e3ac3da8e250eb6d\n\n98e896586ea71f80a2b0024ec86133bfa5163f01f4faa1b1f380f0a2ea128c2f\n\nf9b\ufb0008960484d5c97f075090b9843dc1d54839a4dabc514e8f97f809e1ceaf5\n\nc1cc9448ee5684698f7891911821a9eb86f56be8852adef613b2fab4636e7b36\n\nece82af6fa1e94904d62e86fe86810fe85b058e56a311ca24ac7667409c\ufb008c0\n\nGot something to say?\n\nLeave a comment...\n\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\fNotify me of followup comments via e-mail\n\nName (required)\n\nEmail (required)\n\nWebsite\n\nSUBMIT\n\nSUBSCRIBE TO NEWSLETTERS\n\nEmail\n\nCOMPANY\n\nCompany (https://www.paloaltonetworks.com/company)\n\nCareers (https://www.paloaltonetworks.com/company/careers)\n\nSitemap (https://www.paloaltonetworks.com/sitemap)\n\nReport a Vulnerability (https://www.paloaltonetworks.com/security-disclosure)\n\nLEGAL NOTICES\n\nPrivacy Policy (https://www.paloaltonetworks.com/legal-notices/privacy)\n\nTerms of Use (https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\nACCOUNT\n\nManage Subscription (https://www.paloaltonetworks.com/company/subscriptions)\n\nSUBSCRIBE\n\n\uf08c (https://www.linkedin.com/company/palo-alto-networks)   \uf082 (https://www.facebook.com/PaloAltoNetworks/)   \uf081 (https://twitter.com/PaloAltoNtwks)\n\n (https://ignite.paloaltonetworks.com/usa/?\n\nCampaignId=7010g000001IH8U&utm_content=Ignite18USA&utm_medium=390x90banner&utm_source=website)\n\n\u00a9 2016\u00a0Palo Alto Networks, Inc. All rights reserved.\n\nSALES > 866.320.4788 \uf101\n\nSEE A DEMO \uf101\n\nTAKE A TEST DRIVE  (HTTP://CONNECT.PALOALTONETWORKS.COM/VIRTUAL-UTD)\n\n\f"], "URLs": ["https://researchcenter.paloaltonetworks.com/tag/cve-2017-8579/),", "https://researchcenter.paloaltonetworks.com/tag/cryptocurren", "https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-", "https://www.proofpoint.com/us)", "https://researchcenter.paloaltonetworks.com/author/brandon-levene/)", "https://twitter.com/home?status=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-sure-ill-take-new-", "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8579)", "https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/03/ComboJackImage2.png)", "https://researchcenter.paloaltonetworks.com/aut", "https://researchcenter.paloaltonetworks.com/tag/combojack/),", "https://researchcenter.paloaltonetworks.com/tag/malware/)", "https://www.kaspersky.com/blog/cryptoshu", "https://researchcenter.paloaltonetworks.com/tag/cryptoshu"], "weight": 0.0}