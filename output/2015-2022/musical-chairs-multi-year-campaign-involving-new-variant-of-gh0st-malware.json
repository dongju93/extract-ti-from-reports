{"rule_id": 128, "name": "musical-chairs-multi-year-campaign-involving-new-variant-of-gh0st-malware", "description": "-", "references": [], "File_Names": ["nvzm.info", "card.exe", "vv.js", "surprised.exe", "Surprised.exe", "Girls.exe", "Piano.dll", "vvv.bat", "card.pdf"], "MD5_Hashes": ["8182a33cc1268c0c3b4e3d9a02d912c9", "9c01d71c9bf78d231a313c86540e284c"], "SHA1_Hashes": [], "SHA256_Hashes": ["73ae929dde6826306046d8db744da6e5150f5c508298726b634d39c279192ad0", "d3c8161f76d4187f32039b5557e22e5fb684c06aa3e145e813ee7a4e166cbf47", "f31b23dee1e047e5b472bca54c06594c2cca5adcebd2290f35b60cb2ebb3ee26", "e58eb692d3933dfda630f659d447d7c8026eaf32d35478bd7056515706eb1481", "61b77cada9c2a16daeb465e439cb3e38c857f1559455187469821893bf542666", "c256ca3514d23818cab28b61d1df52a513d1f2beda8c5e81c3336de762f9f3f4", "8dac9fa1ea29a90893a77f4d49c1393fa99a967e8af6a507037789041911de95", "b50544ad3341fbee60338f45bd4043450238a301e022c1010115a2003a970a23", "e297929c583c6f84727c312b937c43550d71fe2bca4f4138d53441c7e269cfa4", "1181e9bb8fbcf1ebad8b6a7f157b6cc71e9c996c3601baecc3a2f25ba27032ee", "88feda3120381216bc96a09e4b6e43e89d5776b5ca3b2d820710be0678f19867", "89968a9c846aad54cd78d7bfe704f0ab71f75d54b982540f594afdaa9100f4fc", "81c8ef33d1e6ebfaad55e20b1e715007aa310b6aa55903e427225648efbbb779", "d467504e8b8608b4fae334c426e8ac02f762993064bf1db20bb6090b42648648", "29726da0ebd8960cab09f91bb8fa37db27b1ca2a3897235c645d1896df10303b", "a34f37c19785b029bf690d53b89f910586660fb94abd8587bfe110c3db6856bc", "4306af9aa2b585dd07c4b114bc7e292f7f9ab06732ae7a9e7f4831b88127c85a", "20236c7a6c0c29664976ab943118477583545ed8461b14933b2d49cee10dd051", "96c301bfa09338740575c4758d558b12e338654b16fc4b9d2badb9610358bf63", "022ca8187bfb1f347a0e547417a8088a5cc0e38fd9aa51b464154fbcf4aa149c", "d36d80c5b9da830fd027cd219d9dabcedd73f5d2da5009b2661c4f0438773c3e", "f37dc918d8064671edcb28c12397c576d3b66b6da21e1670a1a9428f03fb8478", "09f24435e47be74f90d032c78a84fa37f06ce9452a6d3a75c263ae012a7ae626", "07cf20da1ef235ee98c25495bf9b845754f21ed105d5211001885fd2eea3210f", "8a2a5f155707109bc0a6f179f1a749b216504b373c765c8193a7dd958b17be7c", "20299a5fc850ec4cd1aceb7cf1987609c05fa08d59dd5ae79e15bc048c46685e", "acc340d986e720441ec5112746d3f94b248b44fe5d4c1da0fb866a3013384ad2", "76d97074410251347a9398a90e42e02866c30ba71303fe9cccf236ea229172a4", "a0fdb977b712e669aae28723f1a4b90735a5af9e92937558c9da8f62614a1a17", "9c547a7c523e367948d2c645407d0919053ef48292173efe263f3ccfdcdc8e92", "6adced734d5498bbcc9fc111ce43bd7fd8db098106eaa3cfc025de7ba6dc02a7", "4babcaf4694fb8207ea3774f6c2339a28c0ce5913fb9ac396a8e50efa75e10cd", "83e7aaf52e5f567349eee880b0626e61e97dc12b8db9966faf55a9921bac61da", "e60c25ee1404433e3f78e50f5edea11f186211148ce8e5abb22c1f01b76d96f3", "7b8a3efef6c4847697331badcdb0b306ceaa013233ce1c7ee8de8ae933c2d89d", "c608bb6f3723aad1608963e661c8fb80ace93f02f7d52f61a1355e9512676d62", "3a8ddb7b456332301d02222df48070f62e1e39a48e74f39ca8633028599ae250", "7eeba4a511cdeb6b48ca3d09b751be047aa553ea5f6c416494200d1aee520fe4", "fb8b4bc012d45ba78e721a6f73df77ac7838998109c388ced95c995a7e7303f8", "ed25e3d5c13f409242ded579c45f9c4bb4416c204e1ee16cf63f744cf2ccd62c", "da297e8bf799032e0a52c4535997abf30202f33ce9d4162139129463c386efcc", "f5c868d9ac4d18c9c88e181af9370769bf52928d04874d8c3142badf83f664e3", "a95933553fca054e08bd213b7f364b084ef19936a425d7260e08a8e7fdfd2ce6", "e737e2253f016ab65b521d4f4e7b2a06741fa2541c52f0994edfc1763a053910", "c76a817bcae00ec0ca86624b2e62458fec07a5682d92eb59568639fa0586bb1e", "f08f26a7026ba249d021ca21f097405a536771f38d94081731c0f7960177408b", "50f08f0b23fe1123b298cb5158c1ad5a8244ce272ea463a1e4858d12719b337f"], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u201d with the key \u201cnvidiake\u201d and\nvalue \u201cc:\\microsoft\\lib\\ke\\vv.js\u201d, as seen in Figure 8.\n\nFigure 8. AutoFocus view of registry key modi\ufb01cations made by Piano Gh0st to maintain\u0000\npersistence through system reboots\n\nThe \ufb01le \u201cvv.js\u201d in the registry key is a simple one-line JavaScript that executes the \u201cvvv.bat\u201d\u0000\n\ufb01le, as seen in the following:\u0000\n\n1 new ActiveXObject('Wscript.Shell').Run('cmd /c c:\\\\microsoft\\\\lib\\\\ke\\\\vvv.bat',0);\n\nThe \u2018vvv.bat\u2019 \ufb01le is a batch \ufb01le that executes the Piano.dll payload in the same way as the\u0000\u0000\ninitial dropper, using \u201crundll32.exe\u201d to call the \u201cmystart\u201d exported function, as seen in the\nfollowing:\n\n1 rundll32.exe  c:\\microsoft\\lib\\ke\\Piano.dll mystart\n\nAfter setting up the registry keys for persistence, the Gh0stRat sample begins communicating\nwith its command and control server using a custom network protocol. The magic tag used\nby this version of Gh0st is \u201cclarkclar1\u201d as seen in Figure 9. This variant also communicated\nwith a command and control server using the domain www.meitanjiaoyiwang[.]com, which is\nhosted by 98.126.67.114 on tcp port 200.\n\nFigure 9. Screenshot of Piano Gh0st variant using the \u201cclarkclar1\u201d magic tag.\n\nDetection and Prevention\n\nPalo Alto Networks WildFire detected the Gh0st malware, including the Piano Gh0st variant,\nas malicious based on the behavior the attack \ufb01les exhibit on an infected system.\u0000\n\nAdditionally, we have deployed threat prevention signatures to detect Piano Gh0st alongside\nour previously deployed signatures for earlier Gh0st variants. AutoFocus users can \ufb01nd more\u0000\n\n\finformation about this threat using the MusicalChairs tag.\n\nThe following indicators identify attacks using Piano Gh0st and the Musical Chairs campaign.\n\ntype\n\nvalue\n\nsha256 50f08f0b23fe1123b298cb5158c1ad5a8244ce272ea463a1e4858d12719b337f\n\nsha256 8dac9fa1ea29a90893a77f4d49c1393fa99a967e8af6a507037789041911de95\n\nsha256 f08f26a7026ba249d021ca21f097405a536771f38d94081731c0f7960177408b\n\nsha256 f5c868d9ac4d18c9c88e181af9370769bf52928d04874d8c3142badf83f664e3\n\nsha256 e60c25ee1404433e3f78e50f5edea11f186211148ce8e5abb22c1f01b76d96f3\n\nsha256 4babcaf4694fb8207ea3774f6c2339a28c0ce5913fb9ac396a8e50efa75e10cd\n\nsha256 d36d80c5b9da830fd027cd219d9dabcedd73f5d2da5009b2661c4f0438773c3e\n\nsha256 29726da0ebd8960cab09f91bb8fa37db27b1ca2a3897235c645d1896df10303b\n\nsha256 61b77cada9c2a16daeb465e439cb3e38c857f1559455187469821893bf542666\n\nsha256 a0fdb977b712e669aae28723f1a4b90735a5af9e92937558c9da8f62614a1a17\n\nsha256 73ae929dde6826306046d8db744da6e5150f5c508298726b634d39c279192ad0\n\nsha256 e297929c583c6f84727c312b937c43550d71fe2bca4f4138d53441c7e269cfa4\n\nsha256 55090a930b6c37f9\ufb00215793e950a4\ufb00b67f516fd0a14409b027f995d27da082\u0000\u0000\n\nsha256 a7afee2227\ufb003ee64695235c7eed214ee1d18c2b6e287616118b5f38fd6720dc\u0000\n\nsha256 4306af9aa2b585dd07c4b114bc7e292f7f9ab06732ae7a9e7f4831b88127c85a\n\nsha256 66b1260565e2243bba1436f43e986\ufb00741bd391305114d7bef891273e03abd72\u0000\n\nsha256 022ca8187bfb1f347a0e547417a8088a5cc0e38fd9aa51b464154fbcf4aa149c\n\nsha256 9b823f0d60e348707fbbc1da8b37b3c9cd5ea1f43277ba8069e302\ufb0005fee531\u0000\n\nsha256 c256ca3514d23818cab28b61d1df52a513d1f2beda8c5e81c3336de762f9f3f4\n\nsha256 7eeba4a511cdeb6b48ca3d09b751be047aa553ea5f6c416494200d1aee520fe4\n\nsha256 552\ufb0044540e944b3263fc8c32c7dba927f6e7f3f4489bb13b8ecc52c3fd40bf1\u0000\n\nsha256 e1290e92c5ca\ufb009631f4ebe53df27293b71df19b6b5435323332658ebaa9c6b6\u0000\n\nsha256 fb8b4bc012d45ba78e721a6f73df77ac7838998109c388ced95c995a7e7303f8\n\nsha256 20236c7a6c0c29664976ab943118477583545ed8461b14933b2d49cee10dd051\n\nsha256 da297e8bf799032e0a52c4535997abf30202f33ce9d4162139129463c386efcc\n\nsha256 4b7133e45f368cc0b6728830bc9e1219\ufb00318eb384caf5ecbb54e12e6e6c1925\u0000\n\nsha256 e737e2253f016ab65b521d4f4e7b2a06741fa2541c52f0994edfc1763a053910\n\nsha256 07cf20da1ef235ee98c25495bf9b845754f21ed105d5211001885fd2eea3210f\n\nsha256 d467504e8b8608b4fae334c426e8ac02f762993064bf1db20bb6090b42648648\n\n\fsha256 8a2a5f155707109bc0a6f179f1a749b216504b373c765c8193a7dd958b17be7c\n\nsha256 a95933553fca054e08bd213b7f364b084ef19936a425d7260e08a8e7fdfd2ce6\n\nsha256 6adced734d5498bbcc9fc111ce43bd7fd8db098106eaa3cfc025de7ba6dc02a7\n\nsha256 c608bb6f3723aad1608963e661c8fb80ace93f02f7d52f61a1355e9512676d62\n\nsha256 e58085656708d9759856325afb6cd67ec0\ufb007a126e27907efa2e91ef9a0\ufb00474\u0000\u0000\n\nsha256 bba343d4043ea3d170f4027546fad7f991b7ebce9e923dc42e16d88b570\ufb00167\u0000\n\nsha256 96c301bfa09338740575c4758d558b12e338654b16fc4b9d2badb9610358bf63\n\nsha256 d3c8161f76d4187f32039b5557e22e5fb684c06aa3e145e813ee7a4e166cbf47\n\nsha256 34dabb10ea595c773ae4f8c13b7d7fdb41927bc7052ef76204735bb\ufb00eda1c47\u0000\n\nsha256 9c547a7c523e367948d2c645407d0919053ef48292173efe263f3ccfdcdc8e92\n\nsha256 f31b23dee1e047e5b472bca54c06594c2cca5adcebd2290f35b60cb2ebb3ee26\n\nsha256 a764f76276e41ec49b388e8c7c53b602edcc29\ufb003ac8f8ab4b52913eb91934e3\u0000\n\nsha256 e58eb692d3933dfda630f659d447d7c8026eaf32d35478bd7056515706eb1481\n\nsha256 b50544ad3341fbee60338f45bd4043450238a301e022c1010115a2003a970a23\n\nsha256 09f24435e47be74f90d032c78a84fa37f06ce9452a6d3a75c263ae012a7ae626\n\nsha256 83e7aaf52e5f567349eee880b0626e61e97dc12b8db9966faf55a9921bac61da\n\nsha256 acc340d986e720441ec5112746d3f94b248b44fe5d4c1da0fb866a3013384ad2\n\nsha256 1181e9bb8fbcf1ebad8b6a7f157b6cc71e9c996c3601baecc3a2f25ba27032ee\n\nsha256 89968a9c846aad54cd78d7bfe704f0ab71f75d54b982540f594afdaa9100f4fc\n\nsha256 88feda3120381216bc96a09e4b6e43e89d5776b5ca3b2d820710be0678f19867\n\nsha256 f37dc918d8064671edcb28c12397c576d3b66b6da21e1670a1a9428f03fb8478\n\nsha256 3a8ddb7b456332301d02222df48070f62e1e39a48e74f39ca8633028599ae250\n\nsha256 7b8a3efef6c4847697331badcdb0b306ceaa013233ce1c7ee8de8ae933c2d89d\n\nsha256 ca63a159d58cb7b9b\ufb0057646b0e5bc9a61c51f4e08304d9d73c87c876f77b7f5\u0000\n\nsha256 76d97074410251347a9398a90e42e02866c30ba71303fe9cccf236ea229172a4\n\nsha256 c76a817bcae00ec0ca86624b2e62458fec07a5682d92eb59568639fa0586bb1e\n\nsha256 bdb89defb03055e962c6627e8baa0\ufb00d83dda81a1b239bc48e751c2ea5aa2b29\u0000\n\nsha256 81c8ef33d1e6ebfaad55e20b1e715007aa310b6aa55903e427225648efbbb779\n\nsha256 85894b6181535efe15ec5\ufb007575cee8975aa86ec611d94fb7709b54e5ccfc9f2\u0000\n\nsha256 ed25e3d5c13f409242ded579c45f9c4bb4416c204e1ee16cf63f744cf2ccd62c\n\nsha256 a34f37c19785b029bf690d53b89f910586660fb94abd8587bfe110c3db6856bc\n\nsha256 20299a5fc850ec4cd1aceb7cf1987609c05fa08d59dd5ae79e15bc048c46685e\n\n\fdomain meitanjiaoyiwang[.]com\n\ndomain yourbroiler[.]com\n\nip\n\nip\n\nip\n\nip\n\n98.126.67.114\n\n68.68.105.174\n\n98.126.121.202\n\n173.254.223.24\n\nmutex\n\nGlobal\\\\dafewewrw\n\n\ufb01lename\u0000Piano.dll\n\n\ufb01lename\u0000Beautiful Girls.exe\n\n\ufb01lename\u0000Pleasantly surprised.exe\n\n\ufb01lename\u0000amazon gift card.pdf.exe\n\n\ufb01lename\u0000Sexy Girls.exe\n\n\ufb01lename\u0000vv.js\n\n\ufb01lename\u0000vvv.bat\n\nemail\naddress\n\n596552@qq.com\n\nGot something to say?\n\nLeave a comment...\n\nNotify\nme\nof\nfollowup\ncomments\nvia\ne-\n\nmail\n\nName (required)\n\n \n \n \n \n \n \n\fName (required)\n\nEmail (required)\n\nWebsite\n\nSUBMIT\n\nSUBSCRIBE TO NEWSLETTERS\n\nEmail\n\nCOMPANY\n\nCompany\n\nCareers\n\nSitemap\n\nReport a Vulnerability\n\nLEGAL NOTICES\n\nPrivacy Policy\n\nTerms of Use\n\nACCOUNT\n\nManage Subscription\n\n\u00a9 2016 Palo Alto Networks, Inc. All rights reserved.\n\nSALES > 866.320.4788\n\nSUBSCRIBE\n\n \n \n\fSEE A DEMO\n\nTAKE A TEST DRIVE\n\n\f"], "URLs": [], "weight": 0.0}