{"rule_id": 51, "name": "rpt-apt30", "description": "-", "references": [], "File_Names": ["inf.log", "w.lN", "bak.txt", "ld.log", "ver.log", "SP.SYR", "keybd.exe", "1.htm", "UpdateMessenger.exe", "mouse.log", "ldjs.txt", "CTFM0N.exe", "WINWORD.EXE", "2012.doc", "NetEagleVer.txt", "ld.exe", "gov.bt", "creammemory.com", "updateapp.xml", "km153.com", "readme.lz", "update1.htm", "NetEagle.exe", "bluesixnine.com", "whatismyip.com", "www.mfa", "Services.exe", "autoapec.com", "Info.txt", "ldmap.txt", "VFP6.EXE", "18.indo", "WordPlug.exe", "msmsgr.exe", "MSN.lnk", "connect.gif", "SomeUpList.txt", "LiveUpdate.lnk", "myapp.txt", "SProc.dll", "MessengerPlug.exe", "NETEAGLE.EXE", "OtherInfo.txt", "maritimesecurity.asia", "SMulit.dll", "bigfixtools.com", "firefox.exe", "d.ini", "hostlist.txt", "ldupver.txt", "desktop.ini", "upnum.txt", "ld.ini", "nur.txt", "Netsvc.exe", "vers.ini", "SomeUpVer.txt", "exe.txt", "app.txt", "Temp.txt", "FoxProld.ini", "asean.org", "FILETIME.DAT", "FILETYPE.INI", "ccSvcHst.exe", "AUTORUN.INF", "msmsgs.exe", "ver.txt", "ieupdate.exe", "n09230945.asp", "w.lY", "MSDEV.EXE", "Studio.lnk", "SFrame.dll", "netsvc.exe", "path.ini", "pic1.bmp", "Dizhi.gif", "UpdateWord.exe", "WordForVista.exe", "MessengerForVista.exe", "visas.html", "MyDocument.doc", "wssfmgr.exe", "aseanm.com", "dizhi.gif", "SomeUpExe.txt", "LwxRsv.tem", "WINWORD.lnk", "msinm.exe", "CTFM0N.EXE", "nyc.com", "NameList.doc", "32.www", "allupdate.xml", "pic4.bmp", "STlnt.dll", "CTFM0N.xxx", "update.xml", "doc.log", "Update.htm", "pic2.bmp", "www.km", "visit.exe", "Wor.doc", "aseanindia.com", "plane.doc", "dir.log", "release11.pdf", "edih.txt"], "MD5_Hashes": ["65232a8d555d7c4f7bc0d7c5da08c593", "d38e02eac7e3b299b46ff2607dd0f288", "acb2ba25ef225d820ac8a5923b746cb8", "e62a63307deead5c9fcca6b9a2d51fb0", "948a53450e1d7dc7535ea52ca7d5bddd", "8022a4136a6200580962da94f3cdb905", "db3e5c2f2ce07c2d3fa38d6fc1ceb854", "afe8447990ecb9e1cd4086955b7db104", "a2e0203e665976a13cdffb4416917250", "414854a9b40f7757ed7bfc6a1b01250f", "40f47850c5ebf768fd1303a32310c73e", "59e055cee87d8faf6f701293e5830b5a", "8214b0e18fbcd5db6b008884e7685f2c", "af1c1c5d8031c4942630b6a10270d8f4", "71f25831681c19ea17b2f2a84a41bbfb", "f3c29a67a7b47e644e9d1a2a0516974e", "ad044dc0e2e1eaa19cf031dbcff9d770", "f97ec83d68362e4dff4756ed1101fea8", "11876eaadeac34527c28f4ddfadd1e8d", "1f64afa4069036513604cbf651e53e0d", "c6e388ee5269239070e5ad7336d0bf59", "d93026b1c6c828d0905a0868e4cbc55f", "c4dec6d69d8035d481e4f2c86f580e81", "a813eba27b2166620bd75029cc1f04b0", "4a41c422e9eb29f5d722700b060bca11", "550459b31d8dabaad1923565b7e50242", "a30bcf8bf956edbcbe0f8b6db835db26", "37e568bed4ae057e548439dc811b4d3a", "29395c528693b69233c1c12bef8a64b3", "853a20f5fc6d16202828df132c41a061", "df1799845b51300b03072c6569ab96d5", "f18be055fae2490221c926e2ad55ab11", "9c0cad1560cd0ffe2aa570621ef7d0a0", "dc95b0e8ecb22ad607fc912219a640c1", "4b8531d294c020d5f856b58a5a23b238", "a5ca2c5b4d8c0c1bc93570ed13dcab1a", "15304d20221a26a0e413fba4c5729645", "4ee00c46da143ba70f7e6270960823be", "b4ae0004094b37a40978ef06f311a75e", "8a88f8803e8db8baee537a175960cdbe", "44992068aab25daa1decae93b25060af", "6791254f160e98ac1f46b4d506b695ad", "8da9373fc5b8320fb04d6202ca1eb6f1", "4e5c116d874bbaaf7d6dadec7be926f5", "c95cd106c1fecbd500f4b97566d8dc96", "646e2cfa6aa457013769e2b89454acf7", "8ff473bedbcc77df2c49a91167b1abeb", "c9484902c7f1756b26244d6d644c9dd5", "1133fe501fa4691b7f52e53706c80df9", "e6035ec09025c1e349a7a0b3f41e90b1", "12e1dcd71693b6f875a98aefbd4ec91a", "ba80e3ad617e6998f3c4b003397db840", "2d75de9e1bb58fe61fd971bb720a49b7", "af504e86416c5f643e96f6e5e69566f0", "38a61bbc26af6492fc1957ac9b05e435", "0fcb4ffe2eb391421ec876286c9ddb6c", "4c6b21e98ca03e0ef0910e07cef45dac", "7b111e1054b6b929de071c4f48386415", "899f512f0451a0ba4398b41ed1ae5a6d", "5b2b07a86c6982789d1d85a78ebd6c54", "9c31551cd8087072d08c9004c0ce76c5", "ec3905d8e100644ae96ad9b51d701a7f", "95bfe940816a89f168cacbc340eb4a5f", "5b590798da581c894d8a87964763aa8b", "08f299c2d8cfe1ae64d71dfb15fe6e8d", "4154548e1f8e9e7eb39d48a4cd75bcd1", "cc06815e8d8c0083263651877decb44b", "b7b282c9e3eca888cbdb5a856e07e8bd", "5ae51243647b7d03a5cb20dccbc0d561", "49ee6365618b2a5819d36a48131e280c", "5d4f2871fd1818527ebd65b0ff930a77", "5ddbd80720997f7a8ff53396e8e8b920", "062fe1336459a851bd0ea271bb2afe35", "2a2b22aa94a59575ca1dea8dd489d2eb", "37aee58655f5859e60ece6b249107b87", "d2661543c3c456f5fafdd97e31aaff17", "b249bcf741e076f11b6c9553f6104f16", "a9e8e402a7ee459e4896d0ba83543684", "e3ae3cbc024e39121c87d73e87bb2210", "4c10a1efed25b828e4785d9526507fbc", "6e689351d94389ac6fdc341b859c7f6f", "428fc53c84e921ac518e54a5d055f54a", "6ee35da59f92f71e757d4d5b964ecf00", "b590c15499448639c2748ff9e0d214b2", "62e5d5e244059dc02654f497401615cc", "002e27938c9390a942cf4b4c319f1768", "8c713117af4ca6bbd69292a78069e75b", "0a4fdacde69a566f53833500a0d53a35", "bf8616bbed6d804a3dea09b230c2ab0c", "b2138a57f723326eda5a26d2dec56851", "40601cf29c1bbfe0942d1ac914d8ce27", "36a6a33cb4a13739c789778d9dd137ac", "010ca5e1de980f5f45f9d82027e1606c", "c90f798ccfbedb4bbe6c4568e0f05b68", "7d775a39ecd517cee4369c672e0e4da7", "3feef9a0206308ee299a05329095952a", "572c9cd4388699347c0b2edb7c6f5e25", "310a4a62ba3765cbf8e8bbb9f324c503", "0570066887f44bc6c82ebe033cad0451", "f054c0f8c5b4c2a5eb30a16ebe09d8d0", "139158fe63a0e46639cc20b754a7c38c", "09010917cd00dc8ddd21aeb066877aa2", "d8e68db503f4155ed1aeba95d1f5e3e4", "07bb30a2a42423e54f70af61e20edca3", "e26a2afaaddfb09d9ede505c6f1cc4e3", "b5546842e08950bc17a438d785b5a019", "65b984b198359003a5a3b8aaf91af234", "ed151602dea80f39173c2f7b1dd58e06"], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\Microsoft\\\nCurrentPnpSetup. If it exists and is set to 1, the malware switches to ", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\msmsgr\n\nData: C:\\Program Files\\Messenger\\msmsgr.exe\n\nNETEAGLE first attempts to retrieve the file allupdate.xml using the following HTTP request:\n\nGET /yzstmfa/allupdate.xml HTTP/1.1\n\nUser-Agent: [filename of malware]\n\nHost: www.autoapec.com\n\nCache-Control: no-cache\n\nThe file is saved to %DEFAULTUSERPROFILE%\\ieupdate.exe and executed.\n\nNETEAGLE then downloads hxxp://www.autoapec[.]com/yzstmfa/update.xml and decrypts the file \nwith the RC4 key ", "HKEY_CURRENT_USER\\\nSoftware\\Microsoft\\CurrentPnpSetup is deleted and the victims\u2019 hostname and IP are saved. \nA thread to switch the malware back to ", "HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf registry key:\n\n\u2022  lnk is set NTO/mol which is the encoded31 text MSN.lnk.\n\u2022  hostid is set to a random value that is used to uniquely identify the victim computer.\n\nThe malware creates a copy of itself in the folder <CSIDL_PROGRAMS>\\Messenger\\BIN as msmsgs.exe, \ncreating the folder if necessary. For persistence, BACKSPACE creates the Windows shortcut file MSN.lnk \nin <CSIDL_STARTUP> pointing to <CSIDL_PROGRAMS>\\Messenger\\BIN\\msmsgs.exe with the description \n", "HKEY_CURRENT_USER\\Software\\Microsoft\\\nCurrentHalInf. If it exists and is set to 1 the malware switches to ", "HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentPnpSetup registry key:\n\n\u2022  lnk is set XJOXPSE/mol which is the encoded text WINWORD.lnk\n\u2022  hostid is set to a random value (used to uniquely identify a victim host).\n\nThe malware then creates the directories <CSIDL_PROFILE>\\Microsoft Office and <CSIDL_PROFILE>\\\nMicrosoft Office\\BIN. The malware is copied to a temporary file whose path is obtained by appending \nthe .txt file extension to the current malware path and file name. The temporary file then is copied to \nthe newly created folder <CSIDL_PROFILE>\\Microsoft Office\\BIN as WINWORD.exe and the original \ntemporary file is deleted. For persistence, BACKSPACE creates the Windows shortcut file WINWORD.lnk \nin <CSIDL_STARTUP> or <CSIDL_COMMON_STARTUP> pointing to <CSIDL_PROFILE>\\Microsoft Office\\\nBIN\\WINWORD.EXE with the description ", "HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf, attempts to terminate the process identified \nby the registry data, and then exits.\n\nSimilar to switching to \u201cRun mode\u201d BACKSPACE conducts a series of checks to attempt to switch to \n", "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\ShipUp with the \nfollowing value and data:\n\nValue: lnk \nData: Wjtvbm!Tuvejp/mol\n\nThe data is the encoded name of the malware\u2019s shortcut file (in this case, \u201cVisual Studio.lnk\u201d); the \nhexadecimal value of each character in the original file name is incremented by one (so \u201cV\u201d (0x56) \nbecomes \u201cW\u201d (0x57) , etc.).\n\nSHIPSHAPE disables AutoRun and hides both hidden files and file extensions by setting the following \nregistry values:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\NoDriveTypeAutoRun = 0x9f\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden = 0x02\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt = 0x01\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Folder\\Hidden\\SHOWALL\\\nCheckedValue = 0x00\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Folder\\HideFileExt\\\nCheckedValue = 0xffffffff\n\nSHIPSHAPE searches for fixed and removable drives (DRIVE_FIXED, DRIVE_REMOVABLE). If a detected \ndrive is less than 10,000,000,000 bytes (10GB) in size or was attached to the system after SHIPSHAPE \nperformed its initial drive scan, SHIPSHAPE looks for the file ldupver.txt on the drive and parses the file \nfor version information if the file is present. If the version listed in the file is greater than the malware\u2019s \ncurrent version (", "HKEY_LOCAL_MACHINE\\Software\\\nMicrosoft\\ShipTr with the following value and data:\n\nValue: lnk\n\nData: WGQ7/mol\n\n53\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fSimilar to other APT30 malware, the data is the name of SPACESHIP\u2019s shortcut file, with each character \nincremented by one.\n\nSPACESHIP also creates the following directories:\n\n%HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\n%HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\\ldf\n\nSPACESHIP first scans for files matching the pattern ldmap*.* in %HOMEPATH%\\Documents\\Visual \nStudio 2005\\MSDEV\\FoxPro\\Docs\\ldf. If a file is not found or is too old, the malware deletes the files \nldmap.txt and Info.txt45  from %HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\\nDocs\\. The malware then recursively scans each directory and logs all files contained in each folder (file \nsize and last modified) in a new Info.txt file.\n\nSPACESHIP will look for configuration data stored in the file %HOMEPATH%\\My Documents\\Visual Studio \n2005\\MSDEV\\FoxPro\\ld.ini. The malware extracts the following keys from the sections:\n\n[DirMap]\nGetIt=[Integer]\n\n[Piece]\nSize=[Integer]\n\n[UpData]\nDirAndType=[String]\n\n[UpDataTime]\nDay=[Integer]\n\nSPACESHIP will scan the folders ", "HKLM\\Software\\Microsoft\\GetInf\n\nValue: pid\n\n55\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fData: [Encoded filename of implant]\n\nThe filename is encoded by incrementing the hex value of each ASCII character by one.\n\nFLASHFLOOD copies itself to the file C:~a, then copies that file to %SystemDrive%\\Program Files\\\nOutlook Express\\msinm.exe. The malware changes to the target directory, executes msinm.exe and \nexits.\n\nTo maintain persistence, FLASHFLOOD creates the following registry value:\n\nKey: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nValue: msinm.exe\n\nData: [Path to install]\n\nFLASHFLOOD attempts to read the file %WINDIR%\\FILETYPE.INI for a list of file patterns of interest. If \nthe file does not exist the malware uses the following default file extensions:\n\nTable 18: Default file extensions searched for by FLASHFLOOD\n\nFile Extension\n\nDocument Type\n\n.doc\n\n.docx\n\n.ldf\n\n.max\n\n.pdf\n\n.pgp\n\n.rhs\n\n.rtf\n\n.tif\n\n.wpd\n\nMicrosoft Word document\n\nMicrosoft Word document\n\nFile extension used by SPACESHIP for copied and encoded files\n\nAutodesk 3ds Max CAD file\n\nAdobe Acrobat Portable Document Format\n\nPretty Good Privacy\n\nunknown\n\nRich Text Format\n\nTagged Image Format graphics file\n\nWord Perfect Document\n\nFLASHFLOOD creates the following directories, used to store malware log data and copied files of \ninterest:\n\n%WINDIR%\\$NtUninstallKB885884$\\\n\n%WINDIR%\\$NtUninstallKB885884$\\FlashFiles\n\n%WINDIR%\\$NtUninstallKB885884$\\LastFiles\n\n%WINDIR%\\$NtUninstallKB885884$\\RecentFiles\n\n56\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fDuring initialization, FLASHFLOOD queries the registry value HKLM\\SYSTEM\\\nCurrentControlSet\\Services\\SENS\\Parameters\\ServiceDll and logs the result to \n%WINDIR%\\$NtUninstallKB885884$\\Info.txt.47 The file Info.txt is a general log file used by \nFLASHFLOOD to store information collected from the system.\n\nFLASHFLOOD also logs information stored in the Windows Address Book using the IAddrBook \ninterface.48  Information logged includes User, Nick, E-mail and Type.\n\nFLASHFLOOD parses the shortcut (.lnk) files from the user\u2019s ", "HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf; this data \nrepresents the path of a process to be terminated.\n\nIf the response from the server contains the ", "HKEY_CURRENT_USER\\\nSoftware\\Microsoft\\CurrentHalInf is deleted. The victim computer\u2019s hostname and IP are saved.\n\nA thread to switch the malware back to ", "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\GetMM\\\npid. If the value does not exist, the malware sets the registry value to the encoded malware process \nfilename (each filename character incremented by one).\n\nGEMCUTTER checks for the presence of the mutex MicrosoftGMMZJ to ensure only one copy of \nGEMCUTTER is executing. If the mutex doesn't exist, the malware creates it and continues execution; \notherwise, the malware signals the MicrosoftGMMExit event.\n\nThe malware performs cleanup by deleting the registry value with the same name as the malware \nfilename under the HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry \nkey and the file with the same name as the malware itself in the %sysdir% directory.\n\nIf GEMCUTTER is not running from %sysdir% as CTFM0N.xxx (the file extension is excluded in the check), \nthe malware copies itself to that location. The malware then starts a new process by providing %sysdir%\\\nCTFM0N.exe as the executable file path, and the current process exits.\n\nIf GEMCUTTER is running from %sysdir% as CTFM0N.xxx, the malware creates a new registry value \nunder HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, with the value and \ndata set to CTFM0N.EXE. The registry value HKEY_LOCAL_MACHINE\\Software\\Microsoft\\GetMM\\pid is set \nto the DUGN1O/fyf (CTFM0N.EXE with each character incremented by 1).\n\nGEMCUTTER checks for the existence of the mutex MicrosoftZj (associated with BACKSPACE). If the \nmutex doesn't exist, GEMCUTTER downloads a file from hxxp://www.lisword[.]com/HM/Update.htm \nand saves it under %windir% as netsvc.exe.  A new process is started using %windir%\\netsvc.exe55 as \nthe executable file path.\n\n59\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT \n\fAPPENDIX B    \nMD5 HASHES\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\nMD5 Hash\n\n002e27938c9390a942cf4b4c319f1768\n\n062fe1336459a851bd0ea271bb2afe35\n\n09010917cd00dc8ddd21aeb066877aa2\n\n0fcb4ffe2eb391421ec876286c9ddb6c\n\n12e1dcd71693b6f875a98aefbd4ec91a\n\n1f64afa4069036513604cbf651e53e0d\n\n29395c528693b69233c1c12bef8a64b3\n\n37e568bed4ae057e548439dc811b4d3a\n\n40f47850c5ebf768fd1303a32310c73e\n\n414854a9b40f7757ed7bfc6a1b01250f\n\n428fc53c84e921ac518e54a5d055f54a\n\n4c10a1efed25b828e4785d9526507fbc\n\n4c6b21e98ca03e0ef0910e07cef45dac\n\n4e5c116d874bbaaf7d6dadec7be926f5\n\n550459b31d8dabaad1923565b7e50242\n\n59e055cee87d8faf6f701293e5830b5a\n\n5ae51243647b7d03a5cb20dccbc0d561\n\n5b590798da581c894d8a87964763aa8b\n\n62e5d5e244059dc02654f497401615cc\n\n65232a8d555d7c4f7bc0d7c5da08c593\n\n853a20f5fc6d16202828df132c41a061\n\n95bfe940816a89f168cacbc340eb4a5f\n\n9c0cad1560cd0ffe2aa570621ef7d0a0\n\na5ca2c5b4d8c0c1bc93570ed13dcab1a\n\na9e8e402a7ee459e4896d0ba83543684\n\nacb2ba25ef225d820ac8a5923b746cb8\n\nMalware Family\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\n60\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fBelow are md5 hash values for a representative sample of APT30 malware.\n\nMD5 Hash\n\nb2138a57f723326eda5a26d2dec56851\n\nb590c15499448639c2748ff9e0d214b2\n\nb7b282c9e3eca888cbdb5a856e07e8bd\n\nba80e3ad617e6998f3c4b003397db840\n\nc95cd106c1fecbd500f4b97566d8dc96\n\nd38e02eac7e3b299b46ff2607dd0f288\n\nd8e68db503f4155ed1aeba95d1f5e3e4\n\nd93026b1c6c828d0905a0868e4cbc55f\n\ndb3e5c2f2ce07c2d3fa38d6fc1ceb854\n\ndf1799845b51300b03072c6569ab96d5\n\ne26a2afaaddfb09d9ede505c6f1cc4e3\n\ne3ae3cbc024e39121c87d73e87bb2210\n\ne62a63307deead5c9fcca6b9a2d51fb0\n\nec3905d8e100644ae96ad9b51d701a7f\n\ned151602dea80f39173c2f7b1dd58e06\n\n07bb30a2a42423e54f70af61e20edca3\n\n08f299c2d8cfe1ae64d71dfb15fe6e8d\n\n139158fe63a0e46639cc20b754a7c38c\n\n4a41c422e9eb29f5d722700b060bca11\n\n646e2cfa6aa457013769e2b89454acf7\n\n948a53450e1d7dc7535ea52ca7d5bddd\n\na2e0203e665976a13cdffb4416917250\n\nad044dc0e2e1eaa19cf031dbcff9d770\n\naf1c1c5d8031c4942630b6a10270d8f4\n\nc6e388ee5269239070e5ad7336d0bf59\n\nc9484902c7f1756b26244d6d644c9dd5\n\nMalware Family\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\n61\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fBelow are md5 hash values for a representative sample of APT30 malware.\n\nMD5 Hash\n\ncc06815e8d8c0083263651877decb44b\n\ndc95b0e8ecb22ad607fc912219a640c1\n\nf97ec83d68362e4dff4756ed1101fea8\n\n572c9cd4388699347c0b2edb7c6f5e25\n\n6e689351d94389ac6fdc341b859c7f6f\n\nb5546842e08950bc17a438d785b5a019\n\n010ca5e1de980f5f45f9d82027e1606c\n\n0570066887f44bc6c82ebe033cad0451\n\n0a4fdacde69a566f53833500a0d53a35\n\n1133fe501fa4691b7f52e53706c80df9\n\n2a2b22aa94a59575ca1dea8dd489d2eb\n\n2d75de9e1bb58fe61fd971bb720a49b7\n\n40601cf29c1bbfe0942d1ac914d8ce27\n\n44992068aab25daa1decae93b25060af\n\n49ee6365618b2a5819d36a48131e280c\n\n4b8531d294c020d5f856b58a5a23b238\n\n4ee00c46da143ba70f7e6270960823be\n\n5ddbd80720997f7a8ff53396e8e8b920\n\n65b984b198359003a5a3b8aaf91af234\n\n6791254f160e98ac1f46b4d506b695ad\n\n7b111e1054b6b929de071c4f48386415\n\n8022a4136a6200580962da94f3cdb905\n\n8214b0e18fbcd5db6b008884e7685f2c\n\n8da9373fc5b8320fb04d6202ca1eb6f1\n\n9c31551cd8087072d08c9004c0ce76c5\n\nMalware Family\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\nBACKSPACE\n\n62\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fAPPENDIX C    \nENDNOTES\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\nWhile binary compile times can be modified or faked, we believe that compile dates for APT30 malware are reliable. Given \nseveral hundred malware samples, the compile dates show a fairly regular distribution over the years 2005 \u2013 present. In \naddition, registration dates for the earliest known APT30 domains also support origins dating back to the same time frame.\n\nWe were able to verify that each file\u2019s icon type (Adobe or Word) was consistent with the letter used (p or \nw).  Although we were only able to identify one malicious document used to deploy a ZRLnk variant (md5 hash \nd2661543c3c456f5fafdd97e31aaff17), the document type (an RTF file, typically opened by Microsoft Word) was also \nconsistent with the version convention.\n\nWe did not have conclusive data to interpret the meaning of the last character \u2018N\u2019 and \u2018Y\u2019, present in some samples. Some \nevidence suggests that it may represent the inclusion or exclusion of additional malware features, such as the ability to \nbypass personal firewalls; this appears to be true for at least one variant of BACKSPACE (\u201cZj Listen\u201d).\n\nThe use of mutexes and events also supports version control, ensuring that the newer version of the malware executed \nduring the self-update process replaces the previous version.\n\nSee Appendix A for a detailed description of BACKSPACE malware.\n\nWhile the controller software refers to itself as \u201cNetEagle,\u201d it is used to manage backdoor clients for the malware we \ncall BACKSPACE (also known as \u201cLecna\u201d).  The malware we call NETEAGLE uses a different set of commands and is \nnot compatible with the \u201cNetEagle\u201d controller.  In an attempt to avoid confusion, we will refer to the controller as the \n\u201cBACKSPACE controller,\u201d since it is used to manage BACKSPACE clients.\n\nThis aligns with early BACKSPACE compile dates of 2005.\n\nBACKSPACE samples with md5 hash values acb2ba25ef225d820ac8a5923b746cb8 and \nc90f798ccfbedb4bbe6c4568e0f05b68 are two examples.\n\nAdditional paths with slight variations have also been observed in FLASHFLOOD, such as \n%WINDIR%\\$NtUninstallKB885884$.\n\nA controller that could be freely copied and distributed would erode the market for future custom software purchases.\n\nSee Appendix for detailed analysis of both BACKSPACE and NETEAGLE.\n\nFor example, the BACKSPACE B and Y commands; see Appendix for details.\n\nSee Appendix for detailed analysis.\n\nhttp://www.asean.org/asean/about-asean\n\nhttp://www.asean.org/news/item/eighteenth-asean-summit-jakarta-7-8-may-2011\n\nhttp://www.asean.org/news/asean-statement-communiques/item/joint-statement-the-seventh-asean-plus-three-labour-\nministers-meeting-7th-almm3-phnom-penh-11-may-2012\n\nhttp://maritimesecurity.asia/free-2/asean-2/asean-china-talk-on-east-sea/\n\nhttp://www.aseanindia.com/summit-2012/\n\nhttp://en.wikipedia.org/wiki/List_of_Secretaries-General_of_the_Association_of_Southeast_Asian_Nations\n\nhttp://www.asean.org/news/asean-secretariat-news/item/asean-today-2\n\nFor the \u201cZJ Listen\u201d variants, the \u201cY\u201d vs. \u201cN\u201d in the version number appears to differentiate between variants that attempt \nto bypass certain host-based firewalls by generating mouse-click events on dialog box buttons.  The \u201cY\u201d variants include \nthis feature; the \u201cN\u201d variants do not.\n\n63\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\f22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\nThe paths %WINDIR%\\$NtUninstallKB900727$ and %WINDIR%\\$NtUninstallKB885884$ are used by some variants of the \nFLASHFLOOD malware, one of three components believed to be used to steal data from air-gapped networks.\n\nTwo outliers were compiled in May 2011; those samples also used the aseanm.com C2 domain and may have been \ncreated to target the 18th ASEAN Summit.\n\nCSIDL (constant special item ID list) values are used to identify frequently used folders that may not have the same \npath on different Windows systems. CSIDL_TEMPLATES corresponds to the folder used to store document templates; \nfor example, C:\\Documents and Settings\\<username>\\Templates. See https://msdn.microsoft.com/en-us/desktop/\nbb762494%28v=vs.85%29.aspx for additional detail.\n\nThe threat actor can provide a target IP address or hostname with the \u2018(\u2018 command.\n\nMost \u201cZJ Listen\u201d samples were compiled on December 31, 2012 and share similar version numbers with the \u201cZJ Link\u201d \nsamples from April 2013 (e.g., version strings containing Lan2.2Lnk for \u201cZJ Listen\u201d and F2.2Lnk or F2.3Lnk for \u201cZJ Link\u201d).\n\nhttp://www.mfa.gov.bt/wp-content/uploads/2013/08/press-release11.pdf\n\nShear, Michael. \u201cWhite House Urges China to Act on Journalists\u2019 Visas\u201d. Jan 30, 2014. http://www.nytimes.\ncom/2014/01/31/world/asia/white-house-urges-china-to-act-on-journalists-visas.html\n\nBACKSPACE is also known as \u201cLecna\u201d and may be detected by security vendors by either name \u2013 e.g., Backdoor.APT.Lecna.\n\nComparison is generalized; individual samples may vary.\n\nThe hex representation of each ASCII character is incremented by one.  \u2018M\u2019 (0x4D) becomes \u2018N\u2019 (0x4E), \u2018.\u2019 (0x2E) \nbecomes \u2018/\u2019 (0x2F), etc.\n\nhttps://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx\n\nAnalysis of other BACKSPACE variants suggests that the firewall bypass features may be a modular capability that can \nbe compiled into different versions at will.  Preliminary analysis suggests that version numbers for some BACKSPACE \nvariants may include a \u201cY\u201d or an \u201cN\u201d to indicate the presence or absence of this feature.\n\nVersion information is the OSVERSIONINFO struct data returned by a call to GetVersionEx.\n\nAnalysis of other versions of BACKSPACE showed that Port3 may be used for an interactive remote command shell, but \nthat function was not supported in sample 6ee35da59f92f71e757d4d5b964ecf00.\n\nhttps://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx\n\nDue to limited availability of products localized for languages like Thai, Tagalog, or others used in the Southeast Asia \nregion, English and Chinese would likely be the most common versions used by organizations in that area.\n\nThe \u2018W\u2019 is overwritten by the malware version string. The version string is 5 bytes including the NULL character. It \nappears the beacon was intended to have a 4 byte version string. When copying the 2.18\\x00, the last \\x00 overwrites the \n\u2018W\u2019 character.\n\nPersistence may be provided by other files used to retrieve or install NETEAGLE; for example, the MILKMAID/\nORANGEADE droppers create a shortcut file to establish persistence for a second-stage file downloaded by their \nCREAMSICLE payloads.\n\nIt is possible that this behavior is configured within the binary at compile time, or has been otherwise modified in this version.\n\nSHIPSHAPE determines the disk size by TotalNumberOfBytes returned from GetDiskFreeSpace. The return value is \ntypically the size of the drive or, if quotas are enabled, the value is the size of the quota.\n\n64\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\f42\n\n43\n\n44\n\n45\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n54\n\n55\n\nBecause the copied executables are external to the SHIPSHAPE malware, their content or purpose is unknown.  FireEye \nbelieves that SHIPSHAPE may be used to copy tools such as SPACESHIP, which could then be transferred (via the \nremovable drive) to another victim computer.\n\nThe sample f18be055fae2490221c926e2ad55ab11, described here, targets folders and .doc/.docx files, although the sample \nb249bcf741e076f11b6c9553f6104f16 contains icons for a much broader range of file types within its resource section.\n\nThese are believed to be directories used by other pieces of the malware ecosystem.  The SPACESHIP sample analyzed \nbelow references both the \\msdn\\ and \\Recycled\\ directories on a removable drive; the FLASHFLOOD sample \nreferences \\$LDDATA$\\ and \\Recycled\\.\n\nInfo.txt is used as a log file where information associated with scanning and file information is kept.\n\nLikely an updated configuration file. Note the missing \\ in the directory path between FoxPro and ld.ini.)\n\nThe purpose of this activity is unclear.  SENS (the System Event Notification Service) can be used to support mobile \ncomputers or computers on high-latency networks.  See https://msdn.microsoft.com/en-us/library/windows/desktop/\ncc185680%28v=vs.85%29.aspx.\n\nSee https://msdn.microsoft.com/en-us/library/ms629649%28v=vs.85%29.aspx.\n\nSee https://msdn.microsoft.com/en-us/library/windows/desktop/ms724284%28v=vs.85%29.aspx.\n\nFLASHFLOOD determines the disk size using the TotalNumberOfBytes returned from GetDiskFreeSpace. The return \nvalue is typically the size of the drive or, if quotas are enabled, the value is the size of the quota.\n\nPresumably files in these directories were already archived, e.g., when copied to the drive by SPACESHIP.\n\nThe file \u201cChina MFA Press Briefing 29October 2012.doc\u201d (md5 hash f054c0f8c5b4c2a5eb30a16ebe09d8d0) is an example \nof an exploit document that drops ORANGEADE and the DLL variant of CREAMSICLE.\n\n<CSIDL_STARTUP> is a file system directory that corresponds to the user's Startup program group; for example,  \nC:\\Documents and Settings\\[user]\\Start Menu\\Programs\\Startup under Windows XP or  \nC:\\Users\\[user]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup under Vista/Windows 7.\n\nNetsvc.exe is presumably an updated backdoor, downloaded if the BACKSPACE mutexes are not found on the victim \nhost.\n\nNetsvc.exe is presumably an updated backdoor, downloaded if the BACKSPACE mutex is not found on the victim host.\n\n65\n\nAPT30 and the Mechanics of a Long-Running Cyber Espionage OperationSPECIAL REPORT\fTo download this or other  \n\nFireEye Threat Intelligence reports, \n\nvisit: www.fireeye.com/reports\n\nFireEye, Inc. |  1440 McCarthy Blvd. Milpitas, CA 95035  |  408.321.6300  |  877.FIREEYE (347.3393)  |  info@fireeye.com  |  www.fireeye.com\n\n\u00a9 2015 FireEye, Inc. All rights reserved. FireEye is a registered trademark of \nFireEye, Inc. All other brands, products, or service names are or may be trademarks \nor service marks of their respective owners. SP.SYR.EN-US.022015\n\n\f", "HKEY_CURRENT_USER\\Software\\\nMicrosoft\\CurrentPnpSetup is created and set to 1.\n\nIf BACKSPACE is successfully placed in \u201cRun mode\u201d it performs the following additional tasks:\n\nPrimary vs Backup C2 Domains\nThe malware sends an HTTP request to www.km153[.]com/ForZRLnk3z/bak.txt. If the response starts \nwith "], "URLs": ["http://www.mfa.gov.bt/wp-content/uploads/2013/08/press-release11.pdf", "https://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx", "http://www.asean.org/news/asean-secretariat-news/item/asean-today-2", "https://msdn.microsoft.com/en-us/library/windows/desktop/", "http://www.aseanindia.com/summit-2012/", "https://msdn.microsoft.com/en-us/library/ms629649%28v=vs.85%29.aspx.", "http://maritimesecurity.asia/free-2/asean-2/asean-china-talk-on-east-sea/", "http://www.nytimes.", "https://msdn.microsoft.com/en-us/library/windows/desktop/ms724284%28v=vs.85%29.aspx.", "http://www.asean.org/asean/about-asean", "http://en.wikipedia.org/wiki/List_of_Secretaries-General_of_the_Association_of_Southeast_Asian_Nations", "http://<c2_domain>/<path>/<file>,", "http://www.asean.org/news/item/eighteenth-asean-summit-jakarta-7-8-may-2011", "http://www.autoapec[.]com/", "https://msdn.microsoft.com/en-us/desktop/", "http://www.asean.org/news/asean-statement-communiques/item/joint-statement-the-seventh-asean-plus-three-labour-"], "weight": 0.0}