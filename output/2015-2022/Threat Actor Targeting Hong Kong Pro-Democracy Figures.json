{"rule_id": 355, "name": "Threat Actor Targeting Hong Kong Pro-Democracy Figures", "description": "-", "references": [], "File_Names": ["FYI.zip", "rtf.lnk", "siHost64.png", "GetCurrentRollback.exe", "threatrecon.nshc", "nshc.net", "siHost64.exe", "GetCurrentDeploy.dll"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with the registry name \u201csiHost64\u201d.\nOn October 31, the new version of the malware changed the registry name used to\n\u201cDropbox Update Setup\u201d.\nPerform AES encryption with CBC mode on uploaded \ufb01les with the key\n\u201cApmcJue1570368JnxBdGetr*^#ajLsOw\u201d and a random salt\nCheck in to the C2 server by creating an encrypted \ufb01le containing the operating system\nversion and architecture, date, computer name, and logged in user\nCheck for \ufb01les from the C2 server which contain encrypted arbitrary commands to be run,\nexecute that command, and create a new encrypted \ufb01le containing the results of the\nexecuted command.\n\nhttps://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/\n\n5/9\n\n\f12/3/2019\n\nThreat Actor Targeting Hong Kong Pro-Democracy Figures \u2013 ThreatRecon\n\nExample of the malware using the Dropbox\u00a0API to\u00a0check\u00a0in\n\nBased on the check in information from infected machines, it appears that there is a single\ninfected Hong Kong victim of interest to this threat actor connecting to the Dropbox app besides\nthe target we described at the start. The \ufb01les ex\ufb01ltrated from this victim appeared to be personal\ndocuments related to the victim traveling to the United States, business forms, and Christian\nhymns.\n\nBesides those ex\ufb01ltrated documents, the C2 server also appeared to host their next stage\nmalware such as two \ufb01les named \u201cGetCurrentRollback.exe\u201d and \u201cGetCurrentDeploy.dll\u201d.\n\u201cGetCurrentRollback.exe\u201d is a signed Microsoft executable which seems to be for upgrading the\nprevious Windows operating system version to Windows 10, and \u201cGetCurrentDeploy.dll\u201d likely\nbeing the name of the DLL which is side loaded. The \ufb01rst version of \u201cGetCurrentRollback.exe\u201d we\ncould \ufb01nd was since 2016 and the latest in 2019 November, which means all version might be\nexploitable by DLL Sideloading at \ufb01rst glance.\n\nhttps://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/\n\n6/9\n\n\f12/3/2019\n\nThreat Actor Targeting Hong Kong Pro-Democracy Figures \u2013 ThreatRecon\n\nA version of GetCurrentRollback.exe signed on November 13, 2019 is still vulnerable to DLL Sideloading\n\nConclusion\n\nBased on the victim pro\ufb01le and the ex\ufb01ltrated \ufb01les, it appears one of the intelligence requirements\nof the threat actor is to monitor people with relations to the Hong Kong protests, targeting either\nthem or the people around them. There are multiple possibilities for this requirements, with the\nmost likely being to understand the inner thoughts of pro-democracy movement, or to support or\nundermine the movement behind the scenes.\n\nUsing Dropbox and other legitimate services such as Google Drive and GitHub \nthroughout the attack life cycle is not a new concept for threat actors, allowing them to easily\nbypass network detection. To counter this threat, enterprises or teams within enterprises\nnowadays block or detect such Shadow IT services if they are not in of\ufb01cial use, but individual or\nnon-enterprise users which may be targeted by state sponsored threat actors rarely have this\nluxury.\n\nThe full report detailing each event together with IoCs (Indicators of Compromise) and\nrecommendations is available to existing NSHC ThreatRecon customers. For more information,\nplease contact\u00a0RA.global@nshc.net.\n\nhttps://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/\n\n7/9\n\n\f12/3/2019\n\nThreat Actor Targeting Hong Kong Pro-Democracy Figures \u2013 ThreatRecon\n\nMITRE ATT&CK Techniques\n\nThe following is a list of MITRE ATT&CK Techniques we have observed based on our analysis of\nthese and other related malware.\n\nInitial Access\n\nT1192 Spearphishing Link\n\nExecution\n\nT1204 User Execution\nT1218 Signed Binary Proxy Execution\nT1064 Scripting\n\nPersistence\n\nT1060 Registry Run Keys / Startup Folder\n\nDefense\u00a0Evasion\n\nT1140 Deobfuscate/Decode Files or Information\nT1036 Masquerading\nT1112 Modify Registry\nT1027 Obfuscated Files or Information\nT1218 Signed Binary Proxy Execution\nT1102 Web Service\n\nDiscovery\n\nT1083 File and Directory Discovery\nT1082 System Information Discovery\nT1033 System Owner/User Discovery\nT1124 System Time Discovery\n\nCollection\n\nT1005 Data from Local System\n\nCommand\u00a0and\u00a0Control\n\nT1043 Commonly Used Port\nT1132 Data Encoding\nT1071 Standard Application Layer Protocol\nT1032 Standard Cryptographic Protocol\nT1102 Web Service\n\nEx\ufb01ltration\n\nhttps://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/\n\n8/9\n\n\f12/3/2019\n\nThreat Actor Targeting Hong Kong Pro-Democracy Figures \u2013 ThreatRecon\n\nT1022 Data Encrypted\nT1041 Ex\ufb01ltration Over Command and Control Channel\n\nhttps://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/\n\n9/9\n\n\f"], "URLs": ["https://threatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activists/"], "weight": 0.0}