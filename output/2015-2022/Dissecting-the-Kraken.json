{"rule_id": 44, "name": "Dissecting-the-Kraken", "description": "-", "references": [], "File_Names": ["kraken.html", "0158.AH", "VBoxtray.exe", "Variant.Zusy", "gdatasoftware.com", "Exploit.CVE"], "MD5_Hashes": ["08E834B6D4123F0AEA27D042FCEAF992", "3917107778F928A6F65DB34553D5082A"], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows:\n\nThe malware repeatedly checks whether this entry is removed. In case the entry is removed,\nthe malware will create a new one. However, instead of removing it, we can simple rename\nthe path to the executable in order to switch off the persistence mechanism.\n\nSo, the malware does not have any clever persistence features either.\n\nFeature: \u201cPath & variable encrypted\u201d\n\nWe identified two kinds of \u201cencrypted\u201d data:\n\nSome paths are encoded using base64 algorithm, such as: JVdJTkRJUiUA (%WINDIR%)\nand JWFwcGRhdGElaa== (%appdata%)\n\nSome data is encrypted (RC4), such as the C&C  information:\n\nFeature: \u201cBitcoin monitor plugin\u201d\n\nThe Bitcoin monitor plugin is even more amusing. It is not advertised on the flyer but on the\nother website we found. The malware monitors the infected user\u2019s clipboard. If the user\ncopies a Bitcoin address to the clipboard, it will be replaced by an address pre-configured by\nthe botmaster. A Bitcoin address is an identifier of 26-35 alphanumeric characters which\nrepresent the owner of a Bitcoin wallet, for example something like\n\nhttps://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\n\nPage 5 of 7\n\n\f2015-05-08, 8:46 AM\n\n3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy.\n\nWe can easily imagine that the plugin\u2019s \u201ctest\u201d is prone to produce false positives, because\nany alphanumeric text copied by the user will be automatically changed without reason if it\nhas a length between 26 and 35 characters. Ok, we admit that the German word\n\u201cKraftfahrzeughaftpflichtversicherung\u201d (36) would not be harmed when copied, but what\nabout \u201cBundesausbildungsfoerderungsgesetz\u201d (34) or \u201cradioimmunoelectrophoresis\u201d (27)?\nJust kidding. But any string, from strong passwords to bank account numbers and more\ncould be affected.\n\nFeature: \u201cDownload & Execute\u201d, the next Step\n\nThis feature allows installing further malware on the affected PC in case the attackers decide\nthe current machine is interesting enough. \u201cKraken HTTP\u201d is only the first stage in this attack\nand can be seen as reconnaissance tool.\n\nAdministration Panel\n\nThe experts of the G DATA SecurityLabs had access to the panel used by \u201cKraken HTTP\u201d but\nthe source code is protected by a commercial packer called IonCube loader. Nevertheless, we\ncan reveal some screenshots of the administration panel which are available on the\nunderground. Note that some of the texts contain mistakes:\n\nhttps://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\n\nPage 6 of 7\n\n\f2015-05-08, 8:46 AM\n\nConclusion\n\nWe suppose that the Kraken botnet was developed by a beginner. The malware does not\ninclude advanced malware technologies and no groundbreaking innovations, even though\nthose were advertised. Many sensitive strings are not encrypted, such as installation paths,\nanti-virus listings, insults against the analysts and much more.\n\nTo sell the botnet malware, the author used a quite sexy marketing flyer, but, actually, the\nmalware turned out to be rather simple.\n\n\u201cKraken HTTP\u201d was said to be used during an espionage campaign against the energy sector,\nespecially against targets in the UAE. We have now identified a specific target from this\ngeographical region and have obtained one of the spear phishing emails used. Even though\nthe targets that are known by now are rather high-level targets, the malware code as well as\nits features is not advanced.\n\nWe are surprised to see this piece of code has been used carrying out targeted attacks rather\nthan broader criminal activities. It is not surprising that attackers use vulnerabilities that are\nolder, because, unfortunately, many computers are likely to be still out of date and so the\nattack works. Despite the fact that the vulnerability used is not a new one, the malware does\nnot have the common features that we saw during other targeted attack campaigns.\nCompared to incidents like Uroburos, the Kraken malware is not good enough to \u201ccatch the\nbig fish\u201d if we want to stick with to the metaphor. So, from the current point of view, there\nare three theories:\n\nThe attackers who developed the Kraken malware might have chosen to diversify their\nbusiness and chose to attack special interest targets themselves.\n\nThe attackers identified infected machines in the business sector and followed the tracks\nto see what else they might be able to get from the companies.\n\nThe actual espionage team voluntary chose to use a kind of usual and rather simply\nbotnet malware in order to distract analysts from seeing a deeper meaning behind this\nattack and make them disregard it as \u2018daily cybercrime business\u2019.\n\nAttached Files:\n\nkraken_illu_4c.jpg1.9 M\n\nkraken_illu_rgb.jpg411 K\n\nkraken_illu_web.jpg153 K\n\nback\n\n\u00a9 2007 - 2015 G Data Software AG. All rights reserved\n\n Contact | Imprint\n\nhttps://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\n\nPage 7 of 7\n\n\f"], "URLs": ["https://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html"], "weight": 0.0}