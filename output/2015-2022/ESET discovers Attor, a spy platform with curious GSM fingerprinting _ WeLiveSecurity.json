{"rule_id": 920, "name": "ESET discovers Attor, a spy platform with curious GSM fingerprinting _ WeLiveSecurity", "description": "-", "references": [], "File_Names": [], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\Mini\u2010\nmal registry keys are updated to execute the service even in Safe mode\nand Safe mode with networking.\n\nT1053 Scheduled\n\nPlugin 0x10 schedules a new task that loads the dispatcher on boot/logon.\n\nTask\n\nDe\u2010\nfense\nEva\u2010\nsion\n\nT1140 Deobfus\u2010\n\ncate/Decode\nFiles or\nInformation\n\nStrings are encrypted with a XOR cipher, using a hardcoded key.\nCon\ufb01guration data, log \ufb01les and plugins are encrypted using a hybrid en\u2010\ncryption scheme \u2013 Blow\ufb01sh-OFB combined with RSA.\n\nT1107\n\nFile Deletion\n\nThe collected \ufb01les and log \ufb01les are deleted after ex\ufb01ltration by plugin\n0x05.\n\nT1158 Hidden Files\nand\nDirectories\n\nThe attributes of log \ufb01les and directories are set to HIDDEN/SYSTEM/AR\u2010\nCHIVE (or combination of those).\n\nT1036 Masquerad\u2010\ning\n\nAttor\u2019s dispatcher disguises itself as a legitimate task (i.e., the task name\nand description appear legitimate).\n\nT1112 Modify\n\nAttor\u2019s dispatcher can modify the Run registry key.\n\nRegistry\n\nT1055 Process\nInjection\n\nT1108 Redundant\n\nAccess\n\nAttor\u2019s dispatcher injects itself into running processes, to gain higher privi\u2010\nleges and to evade detection. It avoids speci\ufb01c system and Symantec\nprocesses.\n\nBoth 32-bit and 64-bit versions of Attor\u2019s dispatcher are executed; also\nthey are injected into almost all processes.\nThere is a watchdog component, implemented in the dispatcher or as a\nseparate plugin, that reinstalls Attor if it has been removed.\n\nT1099\n\nTimestomp\n\nThe time of last access to \ufb01les and registry keys is manipulated after they\nhave been created/modi\ufb01ed.\n\nT1497 Virtualiza\u2010\ntion/Sand\u2010\nbox Evasion\n\nAttor can detect whether it is executed in some virtualized or emulated en\u2010\nvironments. If detected, it terminates itself immediately.\n\nhttps://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/\n\n12/14\n\n\f10/11/2019\n\nESET discovers Attor, a spy platform with curious GSM \ufb01ngerprinting | WeLiveSecurity\n\nTactic\n\nID\n\nName\n\nDescription\n\nCre\u2010\nden\u2010\ntial\nAc\u2010\ncess\n\nDis\u2010\ncov\u2010\nery\n\nCol\u2010\nlec\u2010\ntion\n\nCom\u2010\nmand\nand\nCon\u2010\ntrol\n\nT1056\n\nInput\nCapture\n\nUser credentials can be collected by plugin 0x07 via capturing keystrokes.\n\nT1083\n\nT1120\n\nFile and Di\u2010\nrectory\nDiscovery\n\nPeripheral\nDevice\nDiscovery\n\nPlugin 0x01 enumerates \ufb01les with speci\ufb01c extensions on all hard disk dri\u2010\nves and stores \ufb01le information in encrypted log \ufb01les.\n\nPlugin 0x01 collects information about inserted storage devices, modems\nand phone devices.\n\nT1082 System In\u2010\n\nAttor monitors the free disk space on the system.\n\nformation\nDiscovery\n\nT1123\n\nAudio\nCapture\n\nPlugin 0x03 is capable of recording audio using available input sound\ndevices.\n\nT1119\n\nAutomated\nCollection\n\nAttor automatically collects data about the compromised system.\n\nT115\n\nClipboard\nData\n\nPlugin 0x07 collects data stored in the Windows clipboard by using the\nOpenClipboard and GetClipboardData APIs.\n\nT1074 Data Staged Collected data is staged in a central upload directory prior to ex\ufb01ltration.\n\nT1056\n\nT1113\n\nInput\nCapture\n\nScreen\nCapture\n\nT1043 Commonly\nUsed Port\n\nPlugin 0x07 captures keystrokes pressed within the window of the process\nwhere Attor is injected.\n\nPlugin 0x02 captures screenshots of target applications.\n\nAttor uses port 21 for C&C communication.\n\nT1188 Multi-hop\n\nAttor uses Tor for C&C communication.\n\nProxy\n\nT1079 Multilayer\nEncryption\n\nAttor sends encrypted traf\ufb01c using Tor, which itself uses multiple layers of\nencryption.\n\nT1105 Remote File\n\nAttor can download additional plugins, updates and other \ufb01les.\n\nCopy\n\nT1071 Standard\n\nFTP protocol is used for C&C communication.\n\nApplication\nLayer\nProtocol\n\nT1032 Standard\n\nA combination of Blow\ufb01sh-OFB and RSA is used for data encryption.\n\nCrypto\u2010\ngraphic\nProtocol\n\nEx\ufb01l\u2010\ntration\n\nT1020 Automated\nEx\ufb01ltration\n\nEx\ufb01ltration of the collected data and log \ufb01les is done automatically by plug\u2010\nin 0x05.\n\nT1022 Data\n\nEncrypted\n\nAttor encrypts data with a combination of Blow\ufb01sh and RSA ciphers before\nsending it to the C&C server.\n\nhttps://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/\n\n13/14\n\n\f10/11/2019\n\nESET discovers Attor, a spy platform with curious GSM \ufb01ngerprinting | WeLiveSecurity\n\nTactic\n\nID\n\nName\n\nDescription\n\nAttor ex\ufb01ltrates data over the C&C channel.\n\nT1041 Ex\ufb01ltration\nOver Com\u2010\nmand and\nControl\nChannel\n\nZuzana Hromcov\u00e1 10 Oct 2019 - 11:30AM\n\nhttps://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/\n\n14/14\n\n\f", "HKEY_CURRENT_USER\\Environment"], "URLs": ["https://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/"], "weight": 0.0}