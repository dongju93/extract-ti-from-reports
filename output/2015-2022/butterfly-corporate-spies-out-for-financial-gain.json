{"rule_id": 497, "name": "butterfly-corporate-spies-out-for-financial-gain", "description": "-", "references": [], "File_Names": ["wlc.dat", "Bda9.tmp", "akmai.net", "20e8ad99287f7fc244651237cbe8292a.org", "CP.DAT", "d.dll", "nspool.exe", "LiveUpdater.exe", "dp.dat", "cloudprotect.eu", "FlashUtil.exe", "msvcse.exe", "RAS.DAT", "h2t.dat", "PC.DAT", "UPDT.DAT", "kerberos64.dll", "IASTOR32.EXE", "bj.dat", "RtlUpd.exe", "rtlupd.exe", "kerberos32.dll", "FLASHUTIL.EXE", "iastor32.dat", "nete.dat", "inst.dat", "LiveUpdate.exe", "mspool.exe", "INST.DAT", "NETE.EXE", "updt.dat", "nrouting.exe", "sh.exe", "kerberos32.DLL", "vaioupdter.exe", "h30026.drfx", "shred.exe", "twunk_64.exe", "bda9.tmp", "winsession.dll", "aapl.com", "updater.dat", "proxynt2.exe", "cudacrt.DLL", "iastor32.exe", "nvcplex.dat", "wevtsvc.dll", "S.evtx", "ddosprotected.eu", "clapi32.dll", "cudacrt.dll", "Liveupdater.exe", "file.csv", "ps.dat", "tasks.exe", "ltd.com", "iPhoneDevSDK.com", "system.evtx", "plog.dat", "corrupted_tofix.rar", "cp.dat", "pc.dat"], "MD5_Hashes": ["1d5f0018921f29e8ee2e666137b1ffe7", "a90e836e0a6f5551242a823a6f30c035", "a0132c45e8afe84091b7b5bf75da9037", "531f2014a2a9ba4ddf3902418be23b52", "95ffe4ab4b158602917dd2a999a8caf8", "20e8ad99287f7fc244651237cbe8292a"], "SHA1_Hashes": [], "SHA256_Hashes": ["add22794553e9f86faf6f5dace4d7bd4d6023dfe755c84988723a0dad00406b8", "25fe7dd1e2b19514346cb2b8b5e91ae110c6adb9df5a440b8e7bbc5e8bc74227", "cfacc5389683518ecdd78002c975af6870fa5876337600e0b362abbbab0a19d2", "2e5e14f12278294fbe71239e4b9002e74d961f6eb985229d5688fa809888baa7", "1a9f679016e38d399ff33efcfe7dc6560ec658d964297dbe377ff7c68e0dfbaf", "ece2d793bd809288d763e31036bc561bbc34452785eed64d39ef91e61f6ae741", "bc177e879fd941911eb2ea404febffa2042310c632d9922205949155e9b35cb6", "2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94", "53c77ee898139b26143bba450cfdb8c6fe385562195530b30555b11fd63c9166", "fba34e970c6d22fe46b22d4b35f430c78f43a0f4debde3f7cbcddca9e4bb8bbb", "9fab34fa2d31a56609b56874e1265969dbfa6c17d967cca5ecce0e0760670a60", "fd616d1298653119fb4fbd88c0d39b881181398d2011320dc9c8c698897848c4", "178b25ddca2bd5ea1b8c3432291d4d0b5b725e16961f5e4596fb9267a700fa2f", "4327ce696b5bce9e9b2a691b4e915796218c00998363c7602d8461dd0c1c8fbb", "1baac5d450fb5d6eb76731c7fb4af85ede2603b4fad8087e572e4818150edc3e", "6e62ee740e859842595281513dd7875d802a6d88bcbb7e21c1c5b173a9e2e196", "00a6d40ed77de5ff7c40449e58ab86b48d5318de0df9012aa459923a366ea6f6", "c54f31f190b06649dff91f6b915273b88ee27a2f8e766d54ee4213671fc09f90", "758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92", "9d077a37b94bf69b94426041e5d5bf1fe56c482ca358191ca911ae041305f3ed", "81955e36dd46f3b05a1d7e47ffd53b7d1455406d952c890b5210a698dd97e938", "90b5fec973d31cc149d0e2683872785fa61770deec6925006e9142374c315fde", "1677573bb02cc073e248e4a14334db90be8052d0b236e446e29582f50441fa33", "b49ad915beccbeeb9604ed511df0efc6cedc048c75b51806f8592031c2ca3208", "683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9", "8db5c2b645eee393d0f676fe457cd2cd3e4b144bbe86a61e4f4fd48d9de4aeae", "fcaab8f77e4c9ba922d825b837acfffc9f231c3abb21015369431afae679d644", "9bff19ca48b43b148ff95e054efc39882d868527cdd4f036389a6f11750adddc", "29906c51217d15b9bbbcc8130f64dabdb69bd32baa7999500c7a230c218e8b0a", "da41d27070488316cbf9776e9468fae34f2e14651280e3ec1fb8524fda0873de", "534004a473761e60d0db8afbc99390b19c32e7c5af3445ecd63f43ba6187ded4", "d15b8071994bad01226a06f2802cbfe86a5483803244de4e99b91f130535d972", "d652ed82d2f8e36156cbfeb7137765210e00a9e33c3827c4ef29d7e984a7d46a", "1c9af096e4c7daa440af136f2b1439089a827101098cfe25b8c19fc7321eaad9", "45f363e498312a34fa99af3c1cdd635fcebefaa3222dff348a9ab8ca25530797", "7aa1716426614463b8c20716acf8fd6461052a354b88c31ad2cc8b8a3b3e6868", "cee20c8de212bcce2fa77ba85686d668e997265e3b6d69a1adac578972aaf88a", "0ecfea8f338eb616ee41bb302a81c2abe6759e32edc3c348b6e81589fefb5587", "11b42a5b944d968cbfdaac5075d195cc4c7e97ba4ff827b75a03c44a3b4c179a", "a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c", "b81484220a46c853dc996c19db9416493662d943b638915ed2b3a4a0471cc8d8", "1c81bc28ad91baed60ca5e7fee68fbcb976cf8a483112fa81aab71a18450a6b0", "c224006b7d307a8e46be174085cff789823ab2901095c56b4e90d582877ebafb", "dfa52895a1093e3b5474107bd371b98242617e58dd30ba61977be6e6b57d869d", "0ac7b594aaae21b61af2f3aabdc5eda9b6811eca52dcbf4691c4ec6dfd2d5cd8", "48c0bd55e1cf3f75e911ef66a9ccb9436c1571c982c5281d2d8bf00a99f0ee1a", "6fb43afb191b09c7b62da7a5ddafdc1a9a4c46058fd376c045d69dd0a2ea71a6", "48c24314780bb9690e7014e01e53ca702cf8ba97aa72423607541a8437af26aa", "49e4198c94b80483302e11c2e7d83e0ac2379f081ee3a3aa32d96d690729f2d6", "3756ddcb5d52f938dd9e07d61fae21b70e665f01bbb2cbe04164e82892b86e2f", "cafc745e41dbb1e985ac3b8d1ebbdbafc2fcff4ab09ae4c9ab4a22bebcc74e39", "b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45", "819694a6a4f6f48604ee769dc303852799cd473cbda946cbcd6ba82d20ced668", "efbc082796df566261b07f51a325503231e5a7ce41617d3dfff3640b0be06162", "e86f6bd6bc6f631fe7a98faee5033dafe49655afc65a51dc3026a578f5285fdc", "2d3ea11c5aea7e8a60cd4f530c1e234a2aa2df900d90122dd2fcf1fa9f47b935", "2a8cb295f85f8d1d5aae7744899875ebb4e6c3ef74fbc5bfad6e7723c192c5cf", "36a73defccba5e53c955c75f4c2578e966cdfbad022d4384f7856a64c069b371", "c2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0", "dee31199fc026cea5824e3dd01f4e51801c3ffc7e313aef63862c41ddf422a6e", "37d9e8fc4dc389e121c76a53aa96b311da1beaecbc819095600dc2ee0c4f4eca", "5ab4c378fd8b3254808d66c22bbaacc035874f1c9b4cee511b96458fedff64ed", "8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a", "ccc851cbd600592f1ed2c2969a30b87f0bf29046cdfa1590d8f09cfe454608a5", "2bd5f7e0382956a7c135cdeb96edfdbccfcfc1955d26e317e2328ea83ace7cee", "88979438a208c873d5dd698eee3ca4c2c99b1d3828eabfe01e0cf593680d607d", "796b1523573c889833f154aeb59532d2a9784e4747b25681a97ec00b9bb4fb19", "fac197d47807c5d61ded7679c0f79084089085122b5cee70bfeb6547b840fd64", "14bfc2bf8a80a19ff2c1480f513c96b8e8adc89a8d75d7c0064f810f1a7a2e61", "54a8afb10a0569785d4a530ff25b07320881c139e813e58cb5a621da85f8a9f5", "2a959108855430fcd252a7ac87c5cbfc9aed9afd95af013ae4d1d395fb4c6980", "c8e2029d6d4fa2cbd4d120c289938476b7943fdfa689709af64bd3f270156212", "3cfdd3cd1089c4152c0d4c7955210d489565f28fb0af9861b195db34e7ad2502", "c83bb0330d69f6ad4c79d4a0ce1891e6f34091aecfeaf72cf80b2532268a0abc", "781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e", "eda52dbcd0afa845ba9cc7460ba36b2b9cac10e9533ac1ca63ced449376b679d", "e5d0169be787fcfbf9dabb766b7625802bbc46471d56730e446e6beba82aa581", "e8591c1caa53dee10e1ef748386516c16ab2ae37d9555308284690ea38ddf0c5", "d980a5f103104595b137a4d5d9a73f90821657d09bca0ec5cfc8ae52db096a0f"], "Registry_Entries": ["HKEY_LOCAL_MACHINE\\Microsoft\\WindowsNT\\\nCurrentVersion\\ProductId is not equal to a number of hashed values. It checks the hashed values of the registry \n\nPage 19\n\n\fButterfly: Corporate spies out for financial gain\n\nkeys in HKEY_LOCAL_MACHINE\\SOFTWARE against a list of hashes. It also checks the registry subkeysHKEY_\nLOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Disk\\Enum and HKEY_LOCAL_MACHINE\\HARDWARE\\\nDESCRIPTION\\System\\BIOS\\SystemProductName\n\n\u2018resolv\u2019 command\n\nWhen the resolv command line argument is set to a domain name, a domain name system (DNS) resolution \nrequest is made for that domain name with the current computer name and calculated UID value prepended to \nit.\n\nFor example, we observed the following:\n\nresolv=h30026.drfx.chickenkiller.com\n\nWhen the sample is run with resolv set to that value, the following DNS query was observed: \n\nthread-2d9f4de5.1401420000c29bfea70f49b94b825e3e7586ce61350.h30026.drfx.\nchickenkiller.com\n\nIn this query, \u201cthread-2d9f4de5\u201d is the computer name and \n\u201c1401420000c29bfea70f49b94b825e3e7586ce61350\u201d is the calculated UID value. It is possible that the \nattackers use this method to exfiltrate the UID value, as the value is used in the DGA algorithm.\n\nUID/UPDATE_ID calculation\n\nThe UID is a unique ID calculated by the malware, as the following example shows:\n\n1401420000c29bfea70f49b94b825e3e7586ce61350\n\nThis ID consists of the following elements:\n\n\u2022  14014: Hard-coded string in the malware. May be a version number\n\u2022  2: The operating system version\n\u2022  0: 0 indicates x86, 1 indicates x86_64\n\u2022  000c29bfea70: This is the last six bytes of the UUID generated by a call to rpcrt4!UuidCreateSequential. This \n\ncorresponds to the media access control (MAC) address of the infected computer.\n\u2022  f49b94b8: This is the first eight bytes of the volume serial number from a call to \n\nkernel32!GetVolumeInfomationW\n\n\u2022  25e3e758: This is a dword hash of the string \u201c[COMPUTER NAME]\\[USER NAME]\u201d using the current values \n\nfrom the computer name and user name\n\n\u2022  6ce61350: This is a hard-coded dword in the binary\n\nFor the operating system (the number at offset 5 in previous UID example), the complete table is:\n\n\u2022  0: Unknown/Error/Windows 8.1/Windows Server 2012 R2\n\u2022  1: Windows 2000\n\u2022  2: Windows XP\n\u2022  3: Windows 2003, Windows XP Pro x64, Windows Home Server, Windows 2003 R2\n\u2022  4: Windows Vista\n\u2022  5: Windows Server 2008\n\u2022  6: Windows 7\n\u2022  7: Windows Server 2008 R2, Windows Server 2012\n\u2022  8: Windows 8\n\nInstallation\n\nThe following registry subkeys may be used by Butterfly to maintain persistence: \n\n\u2022  HKEY_CURRENT_USER\\Software\\Adobe\\Preferences\n\u2022  HKEY_CURRENT_USER\\Software\\Adobe\\Options\n\u2022  HKEY_CURRENT_USER\\Software\\Adobe\\UID\n\nPage 20\n\n\fButterfly: Corporate spies out for financial gain\n\n\u2022  HKEY_CURRENT_USER\\Software\\Acer\\UPDATE_ID\n\u2022  HKEY_CURRENT_USER\\Software\\Acer\\Preferences\n\u2022  HKEY_CURRENT_USER\\Software\\Acer\\Options\n\u2022  HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Acer LiveUpdater (likely named \n\nLiveupdater.exe)\n\n\u2022  HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Adobe Flash Plugin Updater  \n\n(FlashUtil.exe)\n\nThe registry data stored in the \u201cPreferences\u201d and \u201cOptions\u201d subkeys are REG_BINARY keys and the data within is \nencrypted using RC4 and crypt32!CryptProtectData, as described previously. The registry data stored in the UID \nis not encrypted; it is stored in plain text.\n\nThe value of \u201cPreferences\u201d is the encrypted version of the first command line argument used to first start the \nmalware. For example, if the malware is launched as:\n\nFlashUtil.exe \u201chttp://[DOMAIN NAME].com /opts vm=2\u201d\n\nThe value of \u201cPreferences\u201d will be:\n\n\u201chttp://[DOMAIN NAME].com /opts vm=2.\u201d\n\nThe value of \u201cOptions\u201d is the URL from the command line argument, so for the previous example, the value \nwould be:\n\n\u201chttp://[DOMAIN NAME].com\u201d\n\nNetworking\n\nDGA Algorithm\n\nThe DGA computes a URL similar to the following:\n\n\u2022  http://jdk.MD5([MM].[YYYY].[UID AS WIDE-CHARACTER STRING]).org \n\n[MM] is the current month and [YYYY] is the current year. Note that the value of [UID AS WIDE-CHARACTER \nSTRING] is the value of the UID registry entry, but as a wide characters, so \u201c07.2014.140...\u201d would be \u201c0\\x007\\\nx00.\\x002\\x000\\x001\\x004\\x00.\\x001\\x004\\x000\\x00...\u201d for the purposes of the MD5 calculation.\n\nFor example, on July 22, 2014 on a system with the UID set to \n\u201c1401420000c29bfea70f49b94b825e3e7586ce61350\u201d, the DGA URL would be:\n\n\u2022  http://jdk.MD5(\\\u201907.2014.1401420000c29bfea70f49b94b825e3e7586ce61350\\\u2019).org\n\nFinally:\n\n\u2022  http://jdk.20e8ad99287f7fc244651237cbe8292a.org\n\nNote that some samples use HTTPS instead of HTTP.\n\nC&C commands\n\nThe following commands implement back door functionality.\n\n\u2022  cd: Changes current working directory\n\u2022  exec: Executes a file using cmd.exe\n\u2022  install: Sets the registry subkey for persistence. The registry subkey is only set if this command is sent\n\u2022  quit: Ends the back door session\n\u2022  sleeptime: Sets the sleep time between C&C queries\n\u2022  shred: Overwrites file multiple times to perform a forensic-safe delete. Only found in samples with a PE \n\ntimestamp in 2014\n\n\u2022  sysinfo: Gathers and reports system information\n\u2022  uninstall: Uninstalls itself\n\nPage 21\n\n\fButterfly: Corporate spies out for financial gain\n\n\u2022  update: Updates itself\n\u2022  url: Updates C&C URL in registry (although this feature appears to be disabled)\n\u2022  wget: Downloads file to infected computer\n\nDecryption keys\n\nThe following MD5s used the corresponding keys for decryption:\n\n\u2022  95ffe4ab4b158602917dd2a999a8caf8: 0xb4\n\u2022  531f2014a2a9ba4ddf3902418be23b52: 0xa9\n\u2022  a0132c45e8afe84091b7b5bf75da9037: 0xa9\n\u2022  1d5f0018921f29e8ee2e666137b1ffe7: 0xa9\n\nThere is a string in all of the binaries equal to \u201cla revedere\u201d, which is \u201cgoodbye\u201d in Romanian.\n\nHacktool help descriptions\n\nHacktool.BannerJack\n\nThe following information details the help output of Hacktool.BannerJack:\n\nUsage: ./banner-jack [options]\n-f: file.csv\n-s: ip start\n-e: ip end\n-p: port\n-t: thread numbers (optional, default 4)\n-v: verbose (optional)\n-d: daemonize (optional - not supported on win32)\n-T: timeout connect (optional, default %d secs)\n-R: timeout read (optional, default %d secs)\n\nHacktool.MultiPurpose\n\nThe following information is the help output of Hacktool.MultiPurpose:\n\nVersion: 1.5\n\nGeneral options\n---------------\n --install: install server on local host and load it\n --host <host>: hostname or IP (local host if not set)\n --password <password>: server password connection (mandatory)\n --forceload: load server on local host without test\n\nServer options\n--------------\n --cmd: server command:\n    dump: dump stuffz\n      --sam: fetch LM/NTLM hashes\n      --machines: fetch machines hashes\n      --history: fetch history for LM/NTLM hashes\n      --sh: fetch logon sessions hashes\n      --sp: fetch security packages cleartext passwords\n      --accounts: <account list>: with --sam, specify accounts to dump \n(comma separated)\n      --lsa: fetch LSA secrets\n\nPage 22\n\n\fButterfly: Corporate spies out for financial gain\n\n      --vnc: fetch VNC server password\n    pth <PID:USER:DOMAIN:NTLM>: change credentials of PID\n    startlog: start recording of loggon sessions\n    stoplog: stop recording of loggon sessions\n    getlog: retrieve stored loggon sessions\n    callback <IP:port>: create a callback to IP:host\n    ping: ping server\n    shred <file>: shred a file\n    remove: cancel null session, clean logs, wipe library\n    quit: unload library\n    reboot: reboot windows\n    info: show info (version, library path, etc.)\n    listevt: list events logs\n    showevt <file>[:num]: show <num> last entries in <file> events log \n(default num: 15)\n    last [num]: show last <num> login/logoff (default num: all)\n    cleanlast-user <user>: remove user from security logs\n    cleanlast-desc <word>: remove word from security logs (in description)\n    cleanlast-quit <1|0>: enable/disable cleaning ANONYMOUS LOGON entries \nbefore quit\n\nOutput options\n--------------\n --file <filename>: output filename to dump information in\n --compress: compress data (only used when file is set)\n --encrypt <key>: encrypt data (only used when file is set)\n\nMisc options\n------------\n --print <key>: print a compress and/or encrypted specified file\n --test445: test if port 445 is available on specified host\n --establishnullsession, --ens: establish a null session on specified host\n --cancelnullsession, --cns: cancel an established null session with a \nspecified host\n\nHacktool.Proxy.A\n\nThe following information details the help output of Hacktool.Proxy.A:\n\n-z ip/host : destination ip or host\n-P port    : destination port\n-x ip/host : proxy ip or host\n-Y port    : proxy port\n-C cmdline : commandline to exec\n-u user    : proxy username\n-p pass    : proxy password\n-n         : NTLM auth\n-v         : displays program version\n-m         : bypass mutex check\n--pleh     : displays help\n\nPage 23\n\n\fButterfly: Corporate spies out for financial gain\n\nHacktool.Eventlog\n\nThe following information details the help output of Hacktool.Eventlog:\n\n-z  Zap (kill) all processes with specified name\n -y  Dump logon/logoff events from Security channel (-t and -n optionals)\n -X  Secure self delete our program\n -x  Secure delete a file\n -w  Show all logs from a .evtx file (requires -f)\n -v  Enable verbose mode\n -t  Delta time (in hours\n -s  Dump logon/logoff events from System channel (-t and -n optionals)\n -r  RecordIds list, comma separated without spaces (\u201c1234,5678\u201d)\n -q  Query Mode\n -p  Filter with provider\n -n  Number of events to show (default 16, 0=all)\n -ll List all channels\n -l  List used channels\n -K  Match a keyword in XML data (case insensitive) from all channels\n -k  Match a keyword in XML data (case insensitive) from a specific channel\n -h  Help\n -f  Specify a .evtx file (system.evtx)\n -F  Flush all logs to disk\n -e  EventIds list, comma separated without spaces (\u201c1234,5678\u201d)\n -Dr Dump all logs from a channel or .evtx file (raw parser) (-c or -f)\n -D  Dump all logs from a channel .evtx file (requires -c or -f)\n -d  Delete mode (requires -e or -r)\n -c  Specify a channel (\u2018Security\u2019, \u2018System\u2019, \u2018Application\u2019, ...)\n\nYARA signatures\n\nThe following details are the YARA signatures related to this analysis:\n\nrule Bannerjack\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly BannerJack hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201cUsage: ./banner-jack [options]\u201d\n        $str _ 2 = \u201c-f: file.csv\u201d \n        $str _ 3 = \u201c-s: ip start\u201d\n        $str _ 4 = \u201c-R: timeout read (optional, default %d secs)\u201d\n\n     condition:\n        all of them\n}\n\nrule Eventlog\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly Eventlog hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201cwevtsvc.dll\u201d\n        $str _ 2 = \u201cStealing %S.evtx handle ...\u201d \n        $str _ 3 = \u201cElfChnk\u201d\n\nPage 24\n\n\fButterfly: Corporate spies out for financial gain\n\n        $str _ 4 = \u201c-Dr Dump all logs from a channel or .evtx file (raw\u201d\n\n     condition:\n        all of them\n}\n\nrule Hacktool\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201c\\\\\\\\.\\\\pipe\\\\winsession\u201d wide\n        $str _ 2 = \u201cWsiSvc\u201d wide\n        $str _ 3 = \u201cConnectNamedPipe\u201d\n        $str _ 4 = \u201cCreateNamedPipeW\u201d\n        $str _ 5 = \u201cCreateProcessAsUserW\u201d\n\n     condition:\n        all of them\n}\n\nrule Multipurpose\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly Multipurpose hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201cdump %d|%d|%d|%d|%d|%d|%s|%d\u201d\n        $str _ 2 = \u201ckerberos%d.dll\u201d\n        $str _ 3 = \u201c\\\\\\\\.\\\\pipe\\\\lsassp\u201d\n        $str _ 4 = \u201cpth <PID:USER:DOMAIN:NTLM>: change\u201d\n\n     condition:\n        all of them\n}\n\nrule Securetunnel\n{\n   meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly Securetunnel hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201cKRB5CCNAME\u201d\n        $str _ 2 = \u201cSSH _ AUTH _ SOCK\u201d\n        $str _ 3 = \u201cf:l:u:cehR\u201d\n        $str _ 4 = \u201c.o+=*BOX@%&#/^SE\u201d\n\n     condition:\n        all of them\n}\n\nrule Proxy\n\nPage 25\n\n \n    \n\fButterfly: Corporate spies out for financial gain\n\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly proxy hacktool\u201d\n\n    strings:\n        $str _ 1 = \u201c-u user    : proxy username\u201d\n        $str _ 2 = \u201c--pleh     : displays help\u201d\n        $str _ 3 = \u201c-x ip/host : proxy ip or host\u201d\n        $str _ 4 = \u201c-m         : bypass mutex check\u201d\n\n     condition:\n        all of them\n           }\n\nrule jiripbot _ ascii _ str _ decrypt\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly Jiripbot hacktool\u201d\n\n    strings:\n        $decrypt _ func = {\n            85 FF\n            75 03\n            33 C0\n            C3\n            8B C7\n            8D 50 01\n            8A 08\n            40\n            84 C9\n            75 F9\n            2B C2\n            53\n            8B D8\n            80 7C 3B FF ??\n            75 3E\n            83 3D ?? ?? ?? ?? 00\n            56\n            BE ?? ?? ?? ??\n            75 11\n            56\n            FF 15 ?? ?? ?? ??\n            C7 05 ?? ?? ?? ?? 01 00 00 00\n            56\n            FF 15 ?? ?? ?? ??\n            33 C0\n            85 DB\n            74 09\n            80 34 38 ??\n            40\n            3B C3\n            72 F7\n            56\n            FF 15 ?? ?? ?? ??\n            5E\n\nPage 26\n\n\fButterfly: Corporate spies out for financial gain\n\n            8B C7\n            5B\n            C3\n          }\n    condition:\n        $decrypt _ func\n}\n\nrule jiripbot _ unicode _ str _ decrypt\n{\n    meta:\n        author = \u201cSymantec Security Response\u201d\n        date = \u201c2015-07-01\u201d\n        description = \u201cButterfly Jiripbot Unicode hacktool\u201d\n\n    strings:\n        $decrypt = {\n            85 ??                        \n            75 03                        \n            33 C0                        \n            C3                           \n            8B ??                        \n            8D 50 02                     \n            66 8B 08                     \n            83 C0 02                     \n            66 85 C9                     \n            75 F5                        \n            2B C2                        \n            D1 F8                        \n            57                           \n            8B F8                        \n            B8 ?? ?? ?? ??\n            66 39 44 7E FE               \n            75 43                        \n            83 3D ?? ?? ?? ?? 00\n            53                           \n            BB ?? ?? ?? ??\n            75 11                        \n            53                           \n            FF 15 ?? ?? ?? ??\n            C7 05 ?? ?? ?? ?? 01 00 00 00\n            53                           \n            FF 15 ?? ?? ?? ??            \n            33 C0                        \n            85 FF                        \n            74 0E                        \n            B9 ?? 00 00 00               \n            66 31 0C 46                  \n            40                           \n            3B C7                        \n            72 F2                        \n            53                           \n            FF 15 ?? ?? ?? ??            \n            5B                           \n            8B C6                        \n            5F                           \n            C3   \n            }\n    condition:\n        $decrypt\n}\n\nPage 27\n\n\fButterfly: Corporate spies out for financial gain\n\nFile hashes \n\nMany of the hashes listed in Table 2 are for clean files which are used by the Butterfly attackers. Do not use any \nmarked with \u201cN/A\u201d or \u201cClean\u201d files in any automated detection system. They are provided merely as potential \nindicators of compromise, not as definitively malicious files. \n\nAny files that are marked as \u201cN/A\u201d were not retrievable by Symantec, but are believed to be used by the \nattackers.\n\nTable 2. File hashes of tools used by the Butterfly attackers, including filenames. (List includes clean files)\nSHA-256\n\nDescription\n\nFile name\n\n2a8cb295f85f8d1d5aae7744899875ebb4e6c3ef74fbc5bfad6e7723c192c5cf\n\nwinsession.dll\n\nHacktool\n\nda41d27070488316cbf9776e9468fae34f2e14651280e3ec1fb8524fda0873de\n\nbj.dat\n\n796b1523573c889833f154aeb59532d2a9784e4747b25681a97ec00b9bb4fb19\n\nbj.dat\n\nc54f31f190b06649dff91f6b915273b88ee27a2f8e766d54ee4213671fc09f90\n\n54a8afb10a0569785d4a530ff25b07320881c139e813e58cb5a621da85f8a9f5\n\n2bd5f7e0382956a7c135cdeb96edfdbccfcfc1955d26e317e2328ea83ace7cee\n\nc83bb0330d69f6ad4c79d4a0ce1891e6f34091aecfeaf72cf80b2532268a0abc\n\npc.dat\n\npc.dat\n\npc.dat\n\npc.dat\n\nHacktool.Bannerjack\n\nHacktool.Bannerjack\n\nHacktool.Multipurpose\n\nHacktool.Multipurpose\n\nHacktool.Multipurpose\n\nHacktool.Multipurpose\n\n178b25ddca2bd5ea1b8c3432291d4d0b5b725e16961f5e4596fb9267a700fa2f\n\nPC.DAT\n\nHacktool.Multipurpose\n\n9bff19ca48b43b148ff95e054efc39882d868527cdd4f036389a6f11750adddc\n\nPC.DAT\n\nHacktool.Multipurpose\n\ne8591c1caa53dee10e1ef748386516c16ab2ae37d9555308284690ea38ddf0c5\n\nclapi32.dll\n\nClean Cygwin DLL\n\nd15b8071994bad01226a06f2802cbfe86a5483803244de4e99b91f130535d972\n\nBda9.tmp. \n\nBackdoor.Jiripbot\n\n0ac7b594aaae21b61af2f3aabdc5eda9b6811eca52dcbf4691c4ec6dfd2d5cd8\n\nwlc.dat\n\nb81484220a46c853dc996c19db9416493662d943b638915ed2b3a4a0471cc8d8 wlc.dat\n\n49e4198c94b80483302e11c2e7d83e0ac2379f081ee3a3aa32d96d690729f2d6\n\nwlc.dat\n\nfcaab8f77e4c9ba922d825b837acfffc9f231c3abb21015369431afae679d644\n\nwlc.dat\n\n534004a473761e60d0db8afbc99390b19c32e7c5af3445ecd63f43ba6187ded4\n\na.exe\n\nHacktool.EventLog\n\nHacktool.EventLog\n\nHacktool.EventLog\n\nHacktool.EventLog\n\nBackdoor.Jiripbot\n\n534004a473761e60d0db8afbc99390b19c32e7c5af3445ecd63f43ba6187ded4\n\nFLASHUTIL.EXE\n\nBackdoor.Jiripbot\n\n758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\n\n683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9\n\n8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\n\nN/A\n\nN/A\n\nN/A\n\nBackdoor.Jiripbot\n\nBackdoor.Jiripbot\n\nBackdoor.Jiripbot\n\n14bfc2bf8a80a19ff2c1480f513c96b8e8adc89a8d75d7c0064f810f1a7a2e61\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\nc2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\nccc851cbd600592f1ed2c2969a30b87f0bf29046cdfa1590d8f09cfe454608a5\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\n2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\n6fb43afb191b09c7b62da7a5ddafdc1a9a4c46058fd376c045d69dd0a2ea71a6\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\n48c0bd55e1cf3f75e911ef66a9ccb9436c1571c982c5281d2d8bf00a99f0ee1a\n\nN/A\n\nBackdoor.Jiripbot\n\n781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e\n\nFlashUtil.exe\n\nBackdoor.Jiripbot\n\n1a9f679016e38d399ff33efcfe7dc6560ec658d964297dbe377ff7c68e0dfbaf\n\nLiveUpdater.exe\n\nBackdoor.Jiripbot\n\nb4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\n\nRtlUpd.exe\n\nBackdoor.Jiripbot\n\ncafc745e41dbb1e985ac3b8d1ebbdbafc2fcff4ab09ae4c9ab4a22bebcc74e39\n\nclapi32.dll\n\nClean Cygwin DLL\n\n25fe7dd1e2b19514346cb2b8b5e91ae110c6adb9df5a440b8e7bbc5e8bc74227\n\nrtlupd.exe\n\nBackdoor.Jiripbot\n\n8db5c2b645eee393d0f676fe457cd2cd3e4b144bbe86a61e4f4fd48d9de4aeae\n\nIASTOR32.EXE\n\nHacktool.Securetunnel\n\n9fab34fa2d31a56609b56874e1265969dbfa6c17d967cca5ecce0e0760670a60\n\niastor32.exe\n\nHacktool.Securetunnel\n\nbc177e879fd941911eb2ea404febffa2042310c632d9922205949155e9b35cb6\n\niastor32.exe\n\nHacktool.Securetunnel\n\n2d3ea11c5aea7e8a60cd4f530c1e234a2aa2df900d90122dd2fcf1fa9f47b935\n\nIASTOR32.EXE\n\nHacktool.Securetunnel\n\n81955e36dd46f3b05a1d7e47ffd53b7d1455406d952c890b5210a698dd97e938\n\niastor32.dat\n\nHacktool.Securetunnel\n\nPage 28\n\n\fButterfly: Corporate spies out for financial gain\n\n81955e36dd46f3b05a1d7e47ffd53b7d1455406d952c890b5210a698dd97e938\n\nIASTOR32.EXE\n\nHacktool.Securetunnel\n\n7aa1716426614463b8c20716acf8fd6461052a354b88c31ad2cc8b8a3b3e6868\n\nnrouting.exe\n\nHacktool.Securetunnel\n\n7aa1716426614463b8c20716acf8fd6461052a354b88c31ad2cc8b8a3b3e6868\n\nnspool.exe\n\nHacktool.Securetunnel\n\nefbc082796df566261b07f51a325503231e5a7ce41617d3dfff3640b0be06162\n\nupdt.dat\n\nHacktool.Securetunnel\n\ncfacc5389683518ecdd78002c975af6870fa5876337600e0b362abbbab0a19d2\n\nmspool.exe\n\nHacktool.Securetunnel\n\ncfacc5389683518ecdd78002c975af6870fa5876337600e0b362abbbab0a19d2\n\nnspool.exe\n\nHacktool.Securetunnel\n\na14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\n\ntwunk_64.exe\n\nHacktool.Securetunnel\n\na14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\n\nupdater.dat\n\nHacktool.Securetunnel\n\na14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\n\nUPDT.DAT\n\nHacktool.Securetunnel\n\n3756ddcb5d52f938dd9e07d61fae21b70e665f01bbb2cbe04164e82892b86e2f\n\npc.dat\n\nHacktool.Securetunnel\n\n3756ddcb5d52f938dd9e07d61fae21b70e665f01bbb2cbe04164e82892b86e2f\n\ntwunk_64.exe\n\nHacktool.Securetunnel\n\n90b5fec973d31cc149d0e2683872785fa61770deec6925006e9142374c315fde\n\nCP.DAT\n\nHacktool.Proxy.A\n\n1c81bc28ad91baed60ca5e7fee68fbcb976cf8a483112fa81aab71a18450a6b0\n\nmsvcse.exe\n\nHacktool.Proxy.A\n\n1c81bc28ad91baed60ca5e7fee68fbcb976cf8a483112fa81aab71a18450a6b0\n\nproxynt2.exe\n\nHacktool.Proxy.A\n\n45f363e498312a34fa99af3c1cdd635fcebefaa3222dff348a9ab8ca25530797\n\nb49ad915beccbeeb9604ed511df0efc6cedc048c75b51806f8592031c2ca3208\n\ncp.dat\n\nsh.exe\n\nHacktool.Proxy.A\n\nShred (Clean tool)\n\nb49ad915beccbeeb9604ed511df0efc6cedc048c75b51806f8592031c2ca3208\n\nshred.exe\n\nShred (Clean tool)\n\n1baac5d450fb5d6eb76731c7fb4af85ede2603b4fad8087e572e4818150edc3e\n\nkerberos32.dll\n\nc224006b7d307a8e46be174085cff789823ab2901095c56b4e90d582877ebafb\n\nnltest.exe\n\nc8e2029d6d4fa2cbd4d120c289938476b7943fdfa689709af64bd3f270156212\n\ncudacrt.dll\n\nece2d793bd809288d763e31036bc561bbc34452785eed64d39ef91e61f6ae741\n\nnvcplex.dat\n\ncee20c8de212bcce2fa77ba85686d668e997265e3b6d69a1adac578972aaf88a\n\nkerberos32.dll\n\ndee31199fc026cea5824e3dd01f4e51801c3ffc7e313aef63862c41ddf422a6e\n\ncudacrt.dll\n\n48c24314780bb9690e7014e01e53ca702cf8ba97aa72423607541a8437af26aa\n\ninst.dat\n\n48c24314780bb9690e7014e01e53ca702cf8ba97aa72423607541a8437af26aa\n\nnvcplex.dat\n\n00a6d40ed77de5ff7c40449e58ab86b48d5318de0df9012aa459923a366ea6f6\n\nINST.DAT\n\n2e5e14f12278294fbe71239e4b9002e74d961f6eb985229d5688fa809888baa7\n\nRAS.DAT\n\nadd22794553e9f86faf6f5dace4d7bd4d6023dfe755c84988723a0dad00406b8\n\nnete.dat\n\nadd22794553e9f86faf6f5dace4d7bd4d6023dfe755c84988723a0dad00406b8\n\nNETE.EXE\n\ne86f6bd6bc6f631fe7a98faee5033dafe49655afc65a51dc3026a578f5285fdc\n\nkerberos32.DLL\n\ne86f6bd6bc6f631fe7a98faee5033dafe49655afc65a51dc3026a578f5285fdc\n\nkerberos64.dll\n\n2a959108855430fcd252a7ac87c5cbfc9aed9afd95af013ae4d1d395fb4c6980\n\nps.dat\n\ndfa52895a1093e3b5474107bd371b98242617e58dd30ba61977be6e6b57d869d\n\nnvcplex.dat\n\nd980a5f103104595b137a4d5d9a73f90821657d09bca0ec5cfc8ae52db096a0f\n\ninst.dat\n\nd980a5f103104595b137a4d5d9a73f90821657d09bca0ec5cfc8ae52db096a0f\n\ntaskhost.exe\n\ne5d0169be787fcfbf9dabb766b7625802bbc46471d56730e446e6beba82aa581\n\ncudacrt.dll\n\n0ecfea8f338eb616ee41bb302a81c2abe6759e32edc3c348b6e81589fefb5587\n\ncudacrt.DLL\n\n37d9e8fc4dc389e121c76a53aa96b311da1beaecbc819095600dc2ee0c4f4eca\n\nplog.dat\n\n819694a6a4f6f48604ee769dc303852799cd473cbda946cbcd6ba82d20ced668\n\n88979438a208c873d5dd698eee3ca4c2c99b1d3828eabfe01e0cf593680d607d\n\npc.dat\n\ndp.dat\n\nfac197d47807c5d61ded7679c0f79084089085122b5cee70bfeb6547b840fd64\n\nvaioupdter.exe\n\n36a73defccba5e53c955c75f4c2578e966cdfbad022d4384f7856a64c069b371\n\ncudacrt.dll\n\n53c77ee898139b26143bba450cfdb8c6fe385562195530b30555b11fd63c9166\n\nh2t.dat\n\nd652ed82d2f8e36156cbfeb7137765210e00a9e33c3827c4ef29d7e984a7d46a\n\nINST.DAT\n\neda52dbcd0afa845ba9cc7460ba36b2b9cac10e9533ac1ca63ced449376b679d\n\ntasks.exe\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\n1677573bb02cc073e248e4a14334db90be8052d0b236e446e29582f50441fa33\n\n1c9af096e4c7daa440af136f2b1439089a827101098cfe25b8c19fc7321eaad9\n\nfd616d1298653119fb4fbd88c0d39b881181398d2011320dc9c8c698897848c4\n\nN/A\n\nN/A\n\nN/A\n\nBack door\n\nBack door\n\nBack door\n\nPage 29\n\n\fButterfly: Corporate spies out for financial gain\n\n9d077a37b94bf69b94426041e5d5bf1fe56c482ca358191ca911ae041305f3ed\n\n29906c51217d15b9bbbcc8130f64dabdb69bd32baa7999500c7a230c218e8b0a\n\n3cfdd3cd1089c4152c0d4c7955210d489565f28fb0af9861b195db34e7ad2502\n\n4327ce696b5bce9e9b2a691b4e915796218c00998363c7602d8461dd0c1c8fbb\n\n5ab4c378fd8b3254808d66c22bbaacc035874f1c9b4cee511b96458fedff64ed\n\nfba34e970c6d22fe46b22d4b35f430c78f43a0f4debde3f7cbcddca9e4bb8bbb\n\n11b42a5b944d968cbfdaac5075d195cc4c7e97ba4ff827b75a03c44a3b4c179a\n\n6e62ee740e859842595281513dd7875d802a6d88bcbb7e21c1c5b173a9e2e196\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nN/A\n\nBack door\n\nBack door\n\nBack door\n\nBack door\n\nBack door\n\nN/A\n\nN/A\n\nN/A\n\nC&C server details\n\nThe following IP addresses were used for C&C traffic using SSH over port 443:\n\n\u2022  46.183.217.132\n\u2022  46.165.237.75\n\u2022  217.23.3.112\n\u2022  178.162.197.9\n\nThe following C&C servers were used by Backdoor.Jiripbot and OSX.Pintsized:\n\n\u2022  ddosprotected.eu\n\u2022  drfx.chickenkiller.com\n\nThe following C&C domains were used by Butterfly-related back doors. They were also used to host exploits over \nHTTP:\n\n\u2022  digitalinsight-ltd.com\n\u2022  clust12-akmai.net\n\u2022  jdk-update.com\n\u2022  corp-aapl.com\n\u2022  cloudprotect.eu\n\nThe following shows the format of Backdoor.Jiripbot\u2019s DGA domains:\n\n\u2022  jdk\\.[a-f0-9]{32}\\.org e.g. jdk.20e8ad99287f7fc244651237cbe8292a.org\n\nPage 30\n\n\fAbout Symantec\nSymantec Corporation (NASDAQ: SYMC) is an information \nprotection expert that helps people, businesses and \ngovernments seeking the freedom to unlock the opportunities \ntechnology brings -- anytime, anywhere. Founded in April \n1982, Symantec, a Fortune 500 company, operating one of \nthe largest global data-intelligence networks, has provided \nleading security, backup and availability solutions for where \nvital information is stored, accessed and shared. The company\u2019s \nmore than 19,000 employees reside in more than 50 countries. \nNinety-nine percent of Fortune 500 companies are Symantec \ncustomers. In fiscal 2015, it recorded revenues of $6.5 billion. \n\nTo learn more go to www.symantec.com or connect with \nSymantec at: go.symantec.com/social/.\n\nFor specific country offices and contact numbers, please visit our website.Symantec World Headquarters350 Ellis St.Mountain View, CA 94043 USA+1 (650) 527-80001 (800) 721-3934www.symantec.comCopyright \u00a9 2015 Symantec Corporation. All rights reserved. Symantec, the Symantec Logo, and the Checkmark Logo are trademarks or registered trademarks of Symantec Corporation or its affiliates in the U.S. and other countries. Other names may be trademarks of their respective owners.Any technical information that is made available by Symantec Corporation is the copyrighted work of Symantec Corporation and is owned by SymantecCorporation. NO WARRANTY . The technical information is being delivered to you as is and Symantec Corporation makes no warranty as to its accuracy or use. Any use of the technical documentation or the information contained herein is at the risk of the user. Documentation may include technical or other inaccuracies or typographical errors. Symantec reserves the right to make changes without prior notice.\f"], "URLs": ["http://[DOMAIN", "http://jdk.MD5([MM].[YYYY].[UID", "http://jdk.20e8ad99287f7fc244651237cbe8292a.org", "http://jdk.MD5(\\"], "weight": 0.0}