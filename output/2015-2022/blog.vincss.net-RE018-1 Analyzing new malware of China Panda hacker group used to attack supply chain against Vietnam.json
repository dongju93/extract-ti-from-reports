{"rule_id": 749, "name": "blog.vincss.net-RE018-1 Analyzing new malware of China Panda hacker group used to attack supply chain against Vietnam", "description": "-", "references": [], "File_Names": ["eTOKCSP64.dll", "MFC42.dll", "authority.html", "mfco42d.dll", "w1.cab", "RegistereToken.exe", "eTOKCSP.dll", "smanager_ssl.dll", "mfc42.ids", "mfc42d.dll", "mfc42.idt", "xml_importer.py"], "MD5_Hashes": ["43CE409C21CAD2EF41C9E1725CA12CEA", "830DD354A31EF40856978616F35BD6B7", "C11E25278417F985CC968C1E361A0FB0"], "SHA1_Hashes": [], "SHA256_Hashes": ["6C1DB6C3D32C921858A4272E8CC7D78280B46BAD20A1DE23833CBE2956EEBF75", "97A5FE1D2174E9D34CEE8C1D6751BF01F99D8F40B1AE0BCE205B8F2F0483225C", "F659B269FBE4128588F7A2FA4D6022CC74E508D28EEE05C5AFF26CC23B7BD1A5"], "Registry_Entries": ["HKLM\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Svchost will be one of the following strings:  \u201cWinmadsEx\u201d,\n\u201cWinrsEx\u201d, \u201cVsssvrEx\u201d, \u201cPlugSvrEx\u201d, \u201cWaRpcEx\u201d, \u201cGuiSvrEx\u201d, \u201cWlanSvrEx\u201d,\n\u201cDisSvrEx\u201d, \u201cMediaSvrEx\u201d, \u201cNvdiaSvrEx\u201d.\n\nSince the function is also a bit long, only the main points are covered here:\n\nFigure 39. Create a registry key on a victim machine\n\n21/23\n\n\fFigure 40. Create service on victim machine\n\nThe RegistryCall function is a self-written function by hacker, it is a global function, also only\ndoing tasks with the Registry. From our point of view, hackers' programming styles are extremely\nmessy and inconsistent (maybe this is how they intentionally confusing), which made it difficult\nfor us to analyze. After registering as a Dll service, the Infect function completes and returns.\nMalware will exit because of the above call to exit(0) on OnInitDialog\n\nWe will provide .xml file containing analysis information on IDA so anyone interested in this\nmalware can use it to re-import IDA and Ghidra using Ghidra's plugin xml_importer.py. \n\n22/23\n\n\fThe IOCs of the malicious code have been noted in the article. You can write your own  .bat file or\nscript using PowerShell, VBS ... to find and remove this malware on the victim's computers.\n\nNote:\n\nOriginal smanager_ssl.dll\n\nMD5: C11E25278417F985CC968C1E361A0FB0\nSHA256:\nF659B269FBE4128588F7A2FA4D6022CC74E508D28EEE05C5AFF26CC23B7BD1A5\n\nnetapi32.dll (ie smanager_ssl.dll has updated CCInfo):\n\nMD5: 43CE409C21CAD2EF41C9E1725CA12CEA\nSHA256:\n6C1DB6C3D32C921858A4272E8CC7D78280B46BAD20A1DE23833CBE2956EEBF75\n\nClick here for Vietnamese version: Part 1, Part 2\n\nTr\u01b0\u01a1ng Qu\u1ed1c Ng\u00e2n (aka HTC)\n\nMalware Analysis - VinCSS (a member of Vingroup)\n\n23/23\n\n\f"], "URLs": [], "weight": 0.0}