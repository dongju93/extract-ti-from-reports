{"rule_id": 799, "name": "2020.11.19_-_Cybereason_vs_MedusaLocker_Ransomware", "description": "-", "references": [], "File_Names": ["wdswfsafe.exe", "QBIDPService.exe", "qzy.txt", "IO.File", "powersehll.exe", "MsDtSrvr.exe", "QBCFMonitorService.exe", "qbupdate.exe", "RAgui.exe", "QBW32.exe", "360se.exe", "QuickBooks.FCS", "supervise.exe", "qzy.bat", "QBDBMgr.exe", "Culture.exe", "fdlauncher.exe", "fdhost.exe", "Defwatch.exe", "httpd.exe", "360doctor.exe", "CMSTP.exe", "GDscan.exe", "axlbridge.exe", "RTVscan.exe", "bcdedit.exe", "tomcat6.exe", "wxServer.exe", "sqlmangr.exe"], "MD5_Hashes": ["196af729106b780db1c73428b5a5d68d"], "SHA1_Hashes": ["855b8aeb4160641ecea5710174086ee74d3e42c1", "99ef68421489ed3c5a46c6746e85b225ef554ca0", "6abac524387a106f73d9ddb5d8a84cb72dad1cdd", "fc31989737dcf21b73bc0956220852dfab2cb549", "69c1527fbd840eee87821328ecf1453984ddc73e", "da237c7bad052c9cb99cbab75b8bc2bdb23b3f65", "7ad1bf03b480ebd2b85b2bc5be4b9140b0ce6d4d", "02a0ea73ccc55c0236aa1b4ab590f11787e3586e", "7219f91bd5fb94128159d18956e1bd9132bf10e0", "e5162ede86712df1e602cbf1ca8b205ab113a931", "0bcf20885b50d64a876e7b46497b22689cb93d33", "78bcffb9ee6a7d29e18f66c0138aa3fd3a9225fa", "820d3dfe29368e3f16f2818e318805d78a6b7d3d", "0c1ce8017cfcc24927fff1b00606e8c83c4ebfa7", "3e5a80fe286834f6d5f0aaf014a420ec40ebad7d", "59c5977faf16b6abe18a177aa8979a0534b4425c", "86d92fc3ba2b3536893b8e753da9cbae70063a50", "eef59fd5b71487448bfd44270d909b1441cd537b", "283714fbd1cc3e54af1049f21397a83524a2f79f", "c87cd85d434e358b85f94cad098aa1f653d9cdbf", "b209dcdfdd030ae1944507fcd9ef0eaeabe22f21", "a35dd292647db3cb7bf60449732fc5f12162f39e", "2ac4359a7db288f07ed39f696e528cb379d2d979", "9f5a9707ba0fcd5b695be131dedfdfe3b2d359d9", "4bc8175c5fbe088297ec4eb3fa26acd8927530e2", "1bbda98348f0d8d58c6afccd50a76321d02919f9", "f3e66237577a690ee907deac9ffbf6074a85e7a5", "212e3254099967712c6690be11ae9d65a8966ffa", "0fe01b51818c6c7c1556bffb43976a5264b3cc43", "e03aedb8b9770f899a29f1939636db43825e95cf", "f968e5c2314e198f4c0c2a4596d13ee1b6482330"], "SHA256_Hashes": ["d33b09ddee82c5c439cb0c66e5c1dee9ad5259e912a3979b31c66622fb9d47ea", "e2c2a80cb4ecc511f30d72b3487cb9023b40a25f6bbe07a92f47230fb76544f4", "7af23ee3ad9d4822c371936037ff823a719c9ab877973e32690b0dadceb55792", "a8b84ab6489fde1fab987df27508abd7d4b30d06ab854b5fda37a277e89a2558", "7593b85e66e49f39feb3141b0d390ed9c660a227042686485131f4956e1f69ff", "e70a261143213e70ffa10643e17b5890443bd2b159527cd2c408dea989a17cfc", "590ea5fa2db24715d72c276c59434b38d21678d6dcabb41f0e370f6dc56ab26b", "104ffe0cc10413b8c3dd04fdc921f07c3cc55efba9a63ccdccf45e4012151c5f", "8b9bdc5cf5534d377a6201d1803a5aa0915b93c9df524307118fd61f361bdba2", "8597f458f1dcc5ecdf209d9c98b1f72c2fce2486236a3ae73adbe26fb6f9c671", "b1e97cd1ae60622ae83c56c9d15895a24405f949e4bb337e86159bcdd93e138e", "ed139beb506a17843c6f4b631afdf5a41ec93121da66d142b412333e628b9db8", "746c79b5b6030091c37251939690eee31d023de5303544b46032bf89580806e5", "50a334ff766b053dee01ee1e410eebc5a24144517c59f9317ec47be9b70f6c48", "5d4abf7721e27760bcac238c05ade2ccc5ee4a842ad3b488462b156a26c34407", "4ae110bb89ddcc45bb2c4e980794195ee5eb85b5261799caedef7334f0f57cc4", "f30d2204814204a2295cd5c703591e81cdfe63ee04b0e45d7ed76fe0db4a711b", "26a11fada1464069571d4114a6fe1b31ccec1c6b34bcdad649d8892348a1cf60", "678069f7847f4a839724fa8574b12619443bbfbc4d65d3d04c3f9aa1ba5fb37a", "fd24ff7e838fea836079c4554254768abdce32c4f46148c609a5a676c9e71103", "bae48fe24d140f4c1c118edbfaee4ab6446c173a0d0b849585a88db3f38f01b8", "81ca80c8275b0fdfeef2a816a7bf567f8e9a145b03ab96138c527af5c79bbec2", "fc12de55f162cd0645e6f7299f6160d1a3b4c3a665efaf4f8bd891d8139d159e", "d74e297ac85652d1f9c43ca98ff649d7770c155556ba94cf9e665ca645aded0c", "d90573cdf776f60a91dc57e8c77dd61adbdaaf205de29faf26afd138c520f487", "fb07649497b39eee0a93598ff66f14a1f7625f2b6d4c30d8bb5c48de848cd4f2", "abe330ec7e157293afee2d96489165d3aa0ed9a59252ecf4f3acfa3205ca9d15", "b1672fd7ef5f4419f5c74a0829645087e92437f766042bfa3325a2a96610f271", "aae247b1fe640f2c96cbfa508d18d475f3e4c8b29fa117a31d17ba0c4e5caa48", "4f5540d21d741634a4685f4ee8b9fec238a1251428d482bbded4afcc7461dc38", "40fbb2f6850213af595dd27231b06c498f87e62b50e8b883976900cc1afa75e1", "9814f9d8a8b129d745d74d3069da69aaf4187146327cb615108e9ed1b5d3c58e"], "Registry_Entries": ["HKLM\\System\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\BackupLP /f\n\nreg add HKLM\\System\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\BackupLP /ve /d \\", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CurrentVersion\\Policies\\System\n\n\u201cEnableLinkedConnections\u201d value is changed\n\nIt does that so it can connect to other adjacent hosts residing on the same network, and in addition, tries to ping the entire subnet to see which\nhosts are alive:\n\nPing sweep to find live hosts\n\nEncryption Whitelist Folders\n\nMedusaLocker avoids encrypting executable files as well as taking a whitelisting approach, and encrypts files in most folders with the exception\nof:\n\n%User Profile%\\AppData\n\n\\ProgramData\n\n\\Program Files\n\n\\Program Files (x86)\n\n\\AppData\n\n\\Application Data\n\n\\intel\n\n\\nvidia\n\n\\Users\\All Users\n\n\\Windows\n\nRansom Note\n\nAlthough the ransom note of MeduzaLocker states that data has been exfiltrated, we have not observed indications of such behavior at the\nmoment by the malware:\n\n4/7\n\n\fRansom note\n\nCybereason Detection and Prevention\n\nCybereason is able to both detect and prevent the execution of MedusaLocker using the powershell protection component:\n\nMalicious powershell script prevented\n\nAdditionally, when the Anti-Ransomware feature is enabled, behavioral detection techniques in the platform are able to detect the deletion of the\nshadow copies using vssadmin.exe, which will create a Malop for the ransomware behaviour:\n\nRansomware prevented\n\nMitre Att&ck Breakdown\n\nExecution\n\nPersistence\n\nPrivilege Escalation\n\nDefense Evasion\n\nLateral Movement\n\nImpact\n\nWindows Command\nShell\n\nWindows\nService\n\nBypass User Access\nControl\n\nDynamic-link Library\nInjection\n\nSMB/Windows Admin\nShares\n\nData Encrypted for\nImpact\n\n5/7\n\n\fPowershell\n\nScheduled\nTask\n\nIOCs\n\nMedusaLocker Executables\n\nSHA-256\n\n4ae110bb89ddcc45bb2c4e980794195ee5eb85b5261799caedef7334f0f57cc4\n\na8b84ab6489fde1fab987df27508abd7d4b30d06ab854b5fda37a277e89a2558\n\n7593b85e66e49f39feb3141b0d390ed9c660a227042686485131f4956e1f69ff\n\nbae48fe24d140f4c1c118edbfaee4ab6446c173a0d0b849585a88db3f38f01b8\n\nd90573cdf776f60a91dc57e8c77dd61adbdaaf205de29faf26afd138c520f487\n\ned139beb506a17843c6f4b631afdf5a41ec93121da66d142b412333e628b9db8\n\nd33b09ddee82c5c439cb0c66e5c1dee9ad5259e912a3979b31c66622fb9d47ea\n\n81ca80c8275b0fdfeef2a816a7bf567f8e9a145b03ab96138c527af5c79bbec2\n\nfb07649497b39eee0a93598ff66f14a1f7625f2b6d4c30d8bb5c48de848cd4f2\n\n678069f7847f4a839724fa8574b12619443bbfbc4d65d3d04c3f9aa1ba5fb37a\n\nd74e297ac85652d1f9c43ca98ff649d7770c155556ba94cf9e665ca645aded0c\n\n104ffe0cc10413b8c3dd04fdc921f07c3cc55efba9a63ccdccf45e4012151c5f\n\nabe330ec7e157293afee2d96489165d3aa0ed9a59252ecf4f3acfa3205ca9d15\n\n40fbb2f6850213af595dd27231b06c498f87e62b50e8b883976900cc1afa75e1\n\ne70a261143213e70ffa10643e17b5890443bd2b159527cd2c408dea989a17cfc\n\n9814f9d8a8b129d745d74d3069da69aaf4187146327cb615108e9ed1b5d3c58e\n\nfd24ff7e838fea836079c4554254768abdce32c4f46148c609a5a676c9e71103\n\nfc12de55f162cd0645e6f7299f6160d1a3b4c3a665efaf4f8bd891d8139d159e\n\nf30d2204814204a2295cd5c703591e81cdfe63ee04b0e45d7ed76fe0db4a711b\n\n8b9bdc5cf5534d377a6201d1803a5aa0915b93c9df524307118fd61f361bdba2\n\nb1672fd7ef5f4419f5c74a0829645087e92437f766042bfa3325a2a96610f271\n\naae247b1fe640f2c96cbfa508d18d475f3e4c8b29fa117a31d17ba0c4e5caa48\n\nb1e97cd1ae60622ae83c56c9d15895a24405f949e4bb337e86159bcdd93e138e\n\n8597f458f1dcc5ecdf209d9c98b1f72c2fce2486236a3ae73adbe26fb6f9c671\n\ne2c2a80cb4ecc511f30d72b3487cb9023b40a25f6bbe07a92f47230fb76544f4\n\n746c79b5b6030091c37251939690eee31d023de5303544b46032bf89580806e5\n\n590ea5fa2db24715d72c276c59434b38d21678d6dcabb41f0e370f6dc56ab26b\n\n50a334ff766b053dee01ee1e410eebc5a24144517c59f9317ec47be9b70f6c48\n\nSHA1\n\ne03aedb8b9770f899a29f1939636db43825e95cf\n\nc87cd85d434e358b85f94cad098aa1f653d9cdbf\n\n1bbda98348f0d8d58c6afccd50a76321d02919f9\n\n0c1ce8017cfcc24927fff1b00606e8c83c4ebfa7\n\n6abac524387a106f73d9ddb5d8a84cb72dad1cdd\n\n02a0ea73ccc55c0236aa1b4ab590f11787e3586e\n\n6/7\n\n \n \n \n \n\f212e3254099967712c6690be11ae9d65a8966ffa\n\n4bc8175c5fbe088297ec4eb3fa26acd8927530e2\n\n86d92fc3ba2b3536893b8e753da9cbae70063a50\n\n2ac4359a7db288f07ed39f696e528cb379d2d979\n\n820d3dfe29368e3f16f2818e318805d78a6b7d3d\n\n7219f91bd5fb94128159d18956e1bd9132bf10e0\n\n855b8aeb4160641ecea5710174086ee74d3e42c1\n\ne5162ede86712df1e602cbf1ca8b205ab113a931\n\na35dd292647db3cb7bf60449732fc5f12162f39e\n\n7ad1bf03b480ebd2b85b2bc5be4b9140b0ce6d4d\n\neef59fd5b71487448bfd44270d909b1441cd537b\n\n69c1527fbd840eee87821328ecf1453984ddc73e\n\n0fe01b51818c6c7c1556bffb43976a5264b3cc43\n\nf3e66237577a690ee907deac9ffbf6074a85e7a5\n\nda237c7bad052c9cb99cbab75b8bc2bdb23b3f65\n\n0bcf20885b50d64a876e7b46497b22689cb93d33\n\n78bcffb9ee6a7d29e18f66c0138aa3fd3a9225fa\n\nfc31989737dcf21b73bc0956220852dfab2cb549\n\n3e5a80fe286834f6d5f0aaf014a420ec40ebad7d\n\nf968e5c2314e198f4c0c2a4596d13ee1b6482330\n\nb209dcdfdd030ae1944507fcd9ef0eaeabe22f21\n\n9f5a9707ba0fcd5b695be131dedfdfe3b2d359d9\n\nMedusaLocker Batch\n\nSHA-256\n\n26a11fada1464069571d4114a6fe1b31ccec1c6b34bcdad649d8892348a1cf60\n\n4f5540d21d741634a4685f4ee8b9fec238a1251428d482bbded4afcc7461dc38\n\nSHA1\n\n99ef68421489ed3c5a46c6746e85b225ef554ca0\n\nMedusaLocker Powershell Loader\n\nSHA-256\n\n5d4abf7721e27760bcac238c05ade2ccc5ee4a842ad3b488462b156a26c34407\n\n7af23ee3ad9d4822c371936037ff823a719c9ab877973e32690b0dadceb55792\n\nSHA1\n\n59c5977faf16b6abe18a177aa8979a0534b4425c\n\n283714fbd1cc3e54af1049f21397a83524a2f79f\n\n7/7\n\n\f"], "URLs": ["https://gist.github.com/hfiref0x/196af729106b780db1c73428b5a5d68d"], "weight": 0.0}