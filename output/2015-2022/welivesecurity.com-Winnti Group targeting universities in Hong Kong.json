{"rule_id": 212, "name": "welivesecurity.com-Winnti Group targeting universities in Hong Kong", "description": "-", "references": [], "File_Names": ["hpqhvind.exe", "CLR.exe", "domain.tld", "hpqhvsei.dll", "Winnti.CA", "livehost.live", "NULL.dat", "wmplayer.exe"], "MD5_Hashes": [], "SHA1_Hashes": ["693f0bd265e7a68b5b98f411ecf1cd3fed3c84af"], "SHA256_Hashes": [], "Registry_Entries": ["HKLM\\SYSTEM\\ControlSet001\\services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\\\n{816381AB-1400-45E5-B560-B8E11C5988CF}\n\nValue:\nv2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=6|Profile=Public|LPort=13567|Name=Network\nDiscovery (TCP)|\n\nThe communication is then handled by the TCP module (200), which was previously\ndocumented by Kaspersky.\n\nWinnti malware was there as well\n\nIn addition to ShadowPad, the Winnti malware was found on some machines at these two\nuniversities at the end of October (i.e. two weeks before ShadowPad) in the file\nC:\\Windows\\System32\\oci.dll and is detected by ESET products as Win64/Winnti.CA.\n\nThe Winnti malware usually contains a configuration specifying a campaign ID and a C&C URL.\nOn all machines the campaign ID matches the name of the targeted university and the C&C\nURLs are:\n\nw[redacted].livehost.live:443\nw[redacted].dnslookup.services:443\n\nwhere the redacted part corresponds to the name of the targeted university.\n\nC&C URL format\n\nOne can observe that the C&C URL used by both Winnti and ShadowPad complies to the\nscheme [backdoor_type][target_name].domain.tld:443 where [backdoor_type] is a single letter\nwhich is either \u201cw\u201d in the case of the Winnti malware or \u201cb\u201d in the case of ShadowPad.\n\n8/11\n\n\fFrom this format, we were able to find several C&C URLs, including three additional Hong Kong\nuniversities\u2019 names. The campaign identifiers found in the samples we\u2019ve analyzed match the\nsubdomain part of the C&C server, showing that these samples were really targeted against\nthese universities.\n\nConclusion\n\nThe Winnti Group is still actively using one of its flagship backdoors, ShadowPad, this time\nagainst Hong Kong universities. In this campaign, the VMProtected launcher used with\nShadowPad, as well as with the PortReuse backdoor and skip-2.0, was replaced by a simpler\none. That these samples, in addition to having been found at these universities, contain\ncampaign IDs matching the universities\u2019 names and use C&C URLs containing the universities\u2019\nnames are good indications that this campaign is highly targeted.\n\nWe will continue to monitor new activities of the Winnti Group and will publish relevant\ninformation on our blog. For any inquiries, contact us at threatintel@eset.com. The IoCs are\nalso available in our GitHub repository.\n\nIndicators of Compromise (IoCs)\n\nESET detection names\n\nWin32/Shadowpad.C trojan\nWin64/Winnti.CA trojan\n\nFile names\n\n%ALLUSERSPROFILE%\\DRM\\CLR\\hpqhvsei.dll\n%ALLUSERSPROFILE%\\DRM\\CLR\\CLR.exe\nC:\\windows\\temp\\hpqhvsei.dll\nC:\\windows\\temp\\hpqhvind.exe\n%ALLUSERSPROFILE%\\DRM\\CLR\\hpqhvsei.dll\n%SYSTEM32%\\oci.dll\n%APPDATA%\\PAGM\\OEY\\XWWEYG\\WAOUE\n\nService display name\n\nclr_optimization_v4.0.30229_32\n\nC&C servers\n\n9/11\n\n\fb[org_name].dnslookup[.]services:443\nw[org_name].livehost[.]live:443\nw[org_name].dnslookup[.]services:443\n\nShadowPad launcher\n\nSimilar sample to avoid disclosing targeted universities.\n693f0bd265e7a68b5b98f411ecf1cd3fed3c84af\n\nMITRE ATT&CK techniques\n\nTactic\n\nID   \n\nName\n\nDescription\n\nPersistence T1050 New Service\n\nDefense\nEvasion\n\nT1073 DLL Side-Loading\n\nShadowPad persists as a service called\nclr_optimization_v4.0.30229_32.\n\nShadowPad\u2019s launcher is loaded by a\nlegitimate executable via DLL side-\nloading.\n\nT1055 Process Injection\n\nShadowPad is injected into a\nwmplayer.exe process.\n\nT1140 Deobfuscate/Decode\n\nFiles or Information\n\nT1027 Obfuscated Files or\nInformation\n\nT1143 Hidden Window\n\nShadowPad launcher uses XOR to decrypt\nthe payload. ShadowPad uses a custom\nalgorithm to decrypt strings and\nconfiguration.\n\nShadowPad shellcode is XOR-encoded\nand uses fake conditional jumps to hinder\ndisassembly. ShadowPad\u2019s strings and\nconfiguration are encrypted. It also uses\nAPI hashing.\n\nShadowPad is injected into a\nwmplayer.exe process started in a hidden\nwindow.\n\nDiscovery\n\nT1010 Application Window\nDiscovery\n\nShadowPad\u2019s keylogging module lists\napplication windows.\n\nT1083 File and Directory\nDiscovery\n\nShadowPad\u2019s RecentFiles module lists\nfiles recently accessed.\n\n10/11\n\n\fTactic\n\nID   \n\nName\n\nDescription\n\nCommand\nand\nControl\n\nT1071 Standard Application\nLayer Protocol\n\nShadowPad can use HTTP and HTTPS for\nC&C communications.\n\nT1043 Commonly Used\n\nShadowPad uses TCP:443 and UDP:443.\n\nPort\n\nT1065 Uncommonly Used\n\nShadowPad listens on port 13567.\n\nPort\n\nT1095 Standard Non-\n\nApplication Layer\nProtocol\n\nT1024 Custom\n\nCryptographic\nProtocol\n\nShadowPad can use UDP and TCP for\nC&C communications.\n\nShadowPad uses its own cryptographic\nprotocol for C&C communications.\n\nCollection\n\nT1056 Input Capture\n\nShadowPad has a keylogging module.\n\nT1113 Screen Capture\n\nShadowPad has a screenshot module.\n\nExfiltration\n\nT1022 Data Encrypted\n\nKeystrokes recorded by the keylogging\nmodule are stored encrypted on disk.\n\nMathieu Tartare 31 Jan 2020 - 11:30AM\n\n11/11\n\n\f"], "URLs": [], "weight": 0.0}