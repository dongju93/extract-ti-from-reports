{"rule_id": 862, "name": "between-hong-kong-and-burma", "description": "-", "references": [], "File_Names": [], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKLM\\SOFTWARE\\360Safe\\Liveup\n\ncurl\n\nHKCU\\Software\\360safe\n\nDefaultSkin\n\n\fHKLM\\SOFTWARE\\kingsoft\\Antivirus\n\nWorkPath\n\nHKLM\\SOFTWARE\\Avira\\Avira Destop\n\nPath\n\nHKLM\\SOFTWARE\\rising\\RAV\n\ninstallpath\n\nHKLM\\SOFTWARE\\JiangMin\n\nInstallPath\n\nHKLM\\SOFTWARE\\Micropoint\\Anti-Attack MP100000\n\nTable 3: Registry keys that fzyy.exe checks for before writing maindll.dll\n\nOnce all the \ufb01les are created, \u0000conhost.exe starts, loads SBieDll.dll, then ultimately loads maindll.dll and the \ufb01nal\u0000\n\npayload, which we have named UP007 (dll2.xor) due to an identi\ufb01er in the network traf\ufb01c. The primary function of UP007\u0000\u0000\n\nappears to be to log keystrokes to the %USERPROFILE%\\Local Settings\\Temp\\keylog\\ directory and send them to a remote\n\nserver.\n\nUP007 uses Windows Sockets to communicate with its command and control server (C2). While doing so, it sends a hardcoded\n\nHTTP header disguised as Microsoft Update traf\ufb01c. This is likely an attempt to escape notice by casual inspection of network traf\ufb01c.\u0000\u0000\n\nOn connection, UP007 downloads another payload directly from the C2 server. This secondary payload we have named\n\n\u201cDownLoad\u201d given the way it identi\ufb01es itself in the traf\ufb01c with the C2 server. This secondary payload is injected into memory. The\u0000\u0000\n\ninitial network traf\ufb01c observed from the UP007 sample is seen in Figure 3.\u0000\n\nFigure 3: Network capture of the initial communication by UP007.\n\nOnce the entire payload is received from the C2 server, UP007 sends basic system information such as operating system version,\n\nIP address, and username and the C2 responds with a \u201cREADY\u201d announcement (see Figure 4).\n\nFigure 4: Network capture of the infected system sending system information to the C2.\n\nThe secondary payload (DownLoad) initiates its own separate TCP connection with the C2 server. A sample of the network traf\ufb01c of\u0000\n\nthis secondary payload is seen in Figure 5.\n\n\fFigure 5: Network capture of DownLoad connection to the C2.\n\nUnfortunately, even though the connection with the C2 was established, we did not observe any further activity from this payload.\n\nHowever, DownLoad\u2019s strings show references to the following:\n\nthis is cmd\nthis is Desktop\n\nIt is possible these are in reference to additional components or capabilities of the malware. Further analysis is required to\n\ndetermine the function of these components.\n\nUP007 Command and Control Infrastructure\n\nThe command and control server for the UP007 sample is hosted on Hong Kong provider New World Telecom at the IP address\n\n59.188.12[.]123. Passive DNS data from PassiveTotal indicates that the domain name yeaton.xicp[.]net pointed to this IP\n\nfrom January 8 2016 to March 19 2016. In their recent report ASERT notes that the domain: yeaton.xicp[.]net was used to\n\nadvertise a Chinese VPN service in 2012. However, as ASERT explains given the long period between the use of the domain for\n\nadvertising and the recent threat activity the past uses of the domain may not be related to the threat actors.\n\nUP007 Samples and Variations\n\nIn November 2013, an exploit document (MD5: 983333e2c878a62d95747c36748198f0) was uploaded to various malware sites with\n\nthe \ufb01lename \u0000\u4e2d\u56fd\u56fd\u5bb6\u5b89\u5168\u59d4\u5458\u4f1a\u673a\u6784\u8bbe\u7f6e\u548c\u2f08\u5458\u540d\u5355\u63d0\u524d\u66dd\u5149\n\n.docx (which translates to \u201cChinese National Security Council\u2019s\n\nInstitutional Structure and Member list\u201d) and 131106 minutes.docx. Instead of receiving the Stage 2 binary in the C2 protocol as\n\nin the recent UP007 sample, the November 2013 sample directly requested ok.exe via an HTTP GET request to\n\n103.19.85[.]89. The ok.exe sample communicated with tenday.mysecondarydns[.]com which resolved to\n\n103.19.85[.]89. It was signed with a certi\ufb01cate with serial number \u000004 DE 6E CB 4B A2 A5 54 2B 5E 0C 71 EE FD 2A\n\nAA.\n\nOne year later, in November 2014, another instance of the UP007 dropper (MD5: e2ac89b5c820fc598b92a635a7d8bc33) signed\n\nwith a certi\ufb01cate using the serial number \u00003A 72 A8 34 FB EC E5 4F A5 E5 2F 67 BA 63 4D CA was uploaded to\n\nVirusTotal. According to VirusTotal, this \ufb01le was observed being hosted at \u0000http://103.19.85[.]89/chin.jpg. The \ufb01nal\u0000\n\npayload was designed to communicate with the same host for command and control.\n\nIn August 2015, an instance of the UP007 dropper (MD5: 639c7239f40d95f677a99abb059e8338) signed with the same certi\ufb01cate\u0000\n\n(Serial: 5D 11 78 4F B8 17 65 02 3F 89 A4 F4 24 3F E1 A9) as fzyy.exe was uploaded to VirusTotal spotted in the\n\nwild as http://hkemail.f3322[.]org/32.zip. This sample communicated with hk2[.]upupdate[.]cn which resolved to\n\n103.27.108[.]122 at the time of analysis.\n\nThe samples detailed in Table 4 were identi\ufb01ed by import hash and other structural similarities related to the UP007 dropper. They\u0000\n\nwere uploaded to VirusTotal by the same submitter on November 14, 2014 and February 27, 2015. They were signed with the same\n\n3A 72...4D CA and 5D 11...E1 A9 certi\ufb01cates, respectively.\u0000\n\nMD5\n\nImport Hash\n\nC2\n\n\f21455a5c2496e2603f6ba911fbaaed80 820438f3f1efede11425a9cc13ae2dbd hihihihihahaha.vicp[.]cc\n\n(113.204.17[.]59)\n\nbe378f3d66ecd38cda09508015de71f7 820438f3f1efede11425a9cc13ae2dbd 172.16.10[.]124\n\nTable 4: UP007 Variants\n\nThe RAR archive detailed in Table 5 reportedly drops the same \ufb01les responsible for loading the UP007 sample. It also \u0000reportedly\n\ncommunicates with 59.188.12[.]123. We have not been able to obtain this sample directly.\n\nMD5\n\nFile Name\n\nC2\n\n19866e7566373028799abd6844ac16d1 QiHua.rar 219.133.40[.]1,\n\n59.188.12[.]123\n\nTable 5: UP007 Variants\n\nSLServer Malware Family\n\nThe SLServer sample we received was also recently analyzed and reported by PwC. It was presented in an overview of threat\n\nactors making use of the recent Taiwanese presidential election in email lures to entice targets to open malicious documents. As\n\nnoted by PwC, this \ufb01le is a self-extracting archive ultimately responsible for downloading a binary from a website that was likely\u0000\n\ncompromised. Like PwC, we were unable to obtain the \ufb01nal \u0000Keyainst.exe binary due to the behaviour of the C2 during the time of\n\nanalysis.\n\nBased on common behavioural characteristics and shared C2 it appears the downloaded \ufb01le analyzed by PwC was \u0000MD5:\n\ne5e7dcbda781dd0bf5f5da3cccdb094d. This sample was referred to as SunOrcal by PwC. This name was based on a folder\n\nmisspelling. We refer to the malware family as SLServer due to a resource dialog in the \ufb01le (see Figure 6).\u0000\n\nAnother recently observed instance of this malware found on VirusTotal (MD5: cfcd2a90e87156e1a811f9c7b0051002) was\n\ndesigned to communicate with the same C2 server and contains the following debug path:\n\nFigure 6: SLServer dialog resource.\n\ne:\\Working\\SVNProject\\SLServer\\SLServer2.0\\release\\SLServer.pdb\n\nInterestingly, according to VirusTotal, the previously mentioned UP007 dropper fzyy.exe was also observed hosted as wthk.txt\n\nat the same URL as this downloaded SLServer sample. The precise timeframes during which these samples were hosted and\n\nchanged remains unknown. Table 6 shows the timestamps of their initial upload to VirusTotal.\n\nFile Name Malware Family\n\nMD5\n\nFirst Submission Time\n\nwzget.exe SLServer\n\ne5e7dcbda781dd0bf5f5da3cccdb094d 2016-01-07 19:03:25 UTC\n\nfzyy.exe\n\nUP007\n\nd579d7a42ff140952da57264614c37bc 2016-01-08 05:21:18 UTC\n\nTable 6: Times for Sample Upload to VirusTotal\n\nSLServer \u2013 Possible Second Stage\n\n\fThe SLServer sample (MD5: e5e7dcbda781dd0bf5f5da3cccdb094d) calls \u201cFunctionWork\u201d from a DLL:\n\nOn VirusTotal we discovered a \ufb01le named \u0000javaupdata.dll (MD5: <7332245f67b6b8a256ab22a6496b4536), which exports a\n\nfunction by the same name. Strings in the SLServer sample also reference a \ufb01le by this name. When executed, this \u0000DLL contacts\n\n210.61.12[.]153 using SSL. This host is the same one pointed to by the SLServer\u2019s C2 domain, safetyssl.security-\n\ncenters[.]com. Interestingly, while the 210.61.12[.]153 host did not respond to the SLServer connections during analysis\n\ntime, the host did accept the SSL connections from javaupdata.dll. Further analysis of this \ufb01le is ongoing.\u0000\n\nSLServer Command and Control Infrastructure\n\nThe SLServer C2 server: safetyssl.security-centers[.]com resolved to the IP address: 210.61.12[.]153 at the time of\n\nanalysis. This IP is hosted in Taiwan on the hosting provider Chunghwa Telecom, speci\ufb01cally their Data Communication Business\u0000\n\nGroup offering. It appears to host the site of a Taiwanese auto parts manufacturer, Yowjung Autoparts. This site may have been\n\neither compromised or copied from a legitimate source.\n\nThe domain name security-centers.com was registered on September 11 2015 by the e-mails: janmiller-\n\ndomain@googlemail[.]com and an_ardyth@123mail[.]org. Using Passive DNS data we \ufb01nd the following subdomains\u0000\n\nwere used in the time period after domain registration:\n\nsafetyssl.security-centers[.]com\ncomputer.security-centers[.]com\nsecurity-centers[.]com\nwww.security-centers[.]com\n\nThe domain computer.security-centers[.]com was a C2 server previously reported by ASERT related to a sample of the\n\nTrochilus RAT analyzed in the report. ASERT retrieved that sample from the compromised Myanmar Union Election Commission\n\nwebsite. The other subdomains (www and the the top level security-centers[.]com) are likely the default IP addresses for\n\nGoDaddy registered domains. The hosting information for this infrastructure is presented in the Figure 7.\n\nFigure 7: Hosting infrastructure over time for *.security-centers[.]com\n\n\fSLServer Samples and Variations\n\nWe discovered three additional SLServer samples using VirusTotal.  We list the hash, submission time, as well as C2 domains\n\nassociated with the sample in Table 7.\n\nMD5\n\nFirst Submission\n\nC2\n\nd07b2738840ce3419df651d3a0a3a246 2016-02-25 01:14:15 www.olinaodi[.]com\n\n(74.126.181[.]10)\n\n397021af7c0284c28db65297a6711235 2016-02-22 18:30:19 safetyssl.security-centers[.]com\n\n(210.61.12[.]153)\n\ndc195d814ec16fe91690b7e949e696f6\n\n2016-02-17 11:32:02 www.olinaodi[.]com\n\n(74.126.181[.]10)\n\ncfcd2a90e87156e1a811f9c7b0051002\n\n2015-11-09 05:20:33 safetyssl.security-centers[.]com\n\n(211.255.32[.]130)\n\nTable 7: SLServer Variants Overview\n\nRecent Campaign Connections\n\nIn January 2016, Arbor Networks released a report titled \u201cUncovering the Seven Pointed Dagger\u201d in which they discuss a series of\n\nsix RAR \ufb01les hosted on the Myanmar election commission website on 20 October 2015. The focus of the report was on the\u0000\n\ndiscovery of the new Trochilus RAT. However, one of the RAR \ufb01les was noted as unknown malware. This sample (\u0000Security-\n\nPatch-Update.exe, MD5: 82896b68314d108141728a4112618304) is also UP007, signed with the 5D 11 78 4F B8 17 65\n\n02 3F 89 A4 F4 24 3F E1 A9 certi\ufb01cate and con\ufb01gured to communicate with \u0000\u000059.188.12[.]123 directly over port 8008,\n\nidentical to fzyy.exe mentioned above. In this instance, if any of the previously discussed registry keys were present, the sample\n\nwill execute the dropped runas.exe binary. Given this execution, nvsvc.exe is likely also an older component. As discussed\n\nabove the UP007 sample we analyzed shares the same C2 (computer.security-centers[.]com) as the Trochilus RAT\n\nsample reported by ASERT.\n\nIn November 2015, Palo Alto Networks reported on a newly discovered trojan referred to as Bookworm. They revealed a campaign\n\nfocused on the targeting of government entities in Thailand. The campaign used a malware family known as FFRAT, and the sample\n\ndescribed in the report connected to the domain hkemail.f3322[.]org for command and control. In August 2015, the same\n\ndomain was reportedly used to host an instance of UP007 as well.\n\nFinally, the relationship between the SLServer C2 www.olinaodi[.]com and our previous research into the Surtr malware family was\n\nhighlighted by PwC through the overlap in the toucan6712@163[.]com registrant. We tracked malware campaigns using the\n\nSurtr family that have targeted Tibetan organizations since 2013.\n\nConclusion\n\nThis latest espionage campaign against Hong Kong activists appears to be connected to a broader set of targets, and operations.\n\nThe recent detailed reporting by ASERT makes it clear that the UP007 malware family has been found in previous campaigns\n\ntargeting Burmese interests. In addition, the campaigns share some C2 infrastructure with previous operations against targets in\n\nThailand and the Tibetan community. The domain registration connections between SLServer infrastructure and Surtr infrastructure\n\nalso suggests some level of potential coordination between campaigns targeting Hong Kong groups and the Tibetan community.\n\nDespite these connections, it is unclear if these campaigns are being conducted by the same threat actor.\n\nWe cannot exclude the possibility that distinct operators have a degree of sharing of tools and infrastructure. Alternatively, security\n\nresearcher Ned Moran has articulated a concept of a \u201cdigital quartermaster,\u201d to refer to an actor that supplies threat infrastructure\n\nand malware development resources to multiple groups. While these scenarios are plausible, we do not have enough data to\n\nproperly assess these competing hypotheses, or to make conclusive statements about the identity of the threat actors.\n\nWhat is clear from our analysis is that civil society groups across Asia continue to be targeted by persistent and organized cyber\n\nespionage campaigns. Civil society often lack the resources and awareness to defend against these operations and closer attention\n\nto the threats they face is needed.\n\nAcknowledgements\n\nSpecial thanks to Valkyrie-X Security Research Group and ASERT. We are grateful to Jason Q. Ng and Kun Cleo Zhang for\n\ntranslation assistance, and Adam Senft, John Scott-Railton, and Ron Deibert for comments.\n\n\fThis research was supported by the John D and Catherine T. MacArthur Foundation and the William and Flora Hewlett Foundation.\n\nIndicators of Compromise\n\nYara signatures are available for the UP007 and SLServer malware families here\n\nMD5 Hashes\n\nd579d7a42ff140952da57264614c37bc\n\nd8becbd6f188e3fb2c4d23a2d36d137b\n\n09ddd70517cb48a46d9f93644b29c72f\n\nf70b295c6a5121b918682310ce0c2165\n\nf80edbb0fcfe7cec17592f61a06e4df2\n\nd8ede9e6c3a1a30398b0b98130ee3b38\n\nce8ec932be16b69ffa06626b3b423395\n\n6a541de84074a2c4ff99eb43252d9030\n\ne0eb981ad6be0bd16246d5d442028687\n\n639c7239f40d95f677a99abb059e8338\n\nd07b2738840ce3419df651d3a0a3a246\n\n397021af7c0284c28db65297a6711235\n\ndc195d814ec16fe91690b7e949e696f6\n\ncfcd2a90e87156e1a811f9c7b0051002\n\nIP Addresses\n\n59.188.12[.]123\n\n210.61.12[.]153\n\nDomains\n\nsafetyssl.security-centers[.]com\n\ncomputer.security-centers[.]com\n\nhkemail.f3322[.]org\n\nwww.olinaodi[.]com\n\ntenday.mysecondarydns[.]com\n\n\u00a9 Citizenlab 2016 |  \n\nContact\n\nRSS\n\n  |  \n\n \n\f"], "URLs": [], "weight": 0.0}