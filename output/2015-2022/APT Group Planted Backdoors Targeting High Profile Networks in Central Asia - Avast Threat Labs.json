{"rule_id": 139, "name": "APT Group Planted Backdoors Targeting High Profile Networks in Central Asia - Avast Threat Labs", "description": "-", "references": [], "File_Names": ["index.asp", "gent.dll", "logon.dll", "netlogon.cfg", "yuemt.zzux", "Yokel64.exe", "base.dll", "pcaudit.bat", "installer.exe", "avast.io", "mktz64.dll", "tion.dll", "mktzx64.pdb", "Microcin_Technical_4PDF_eng_\ufb01nal_s.pdf", "sqllauncher.dll", "svchost.dll", "logsupport.dll", "WZ9JuN00.tmp", "irmon.dll"], "MD5_Hashes": ["FC525C9683E8FE067095BA2DDC971889"], "SHA1_Hashes": [], "SHA256_Hashes": ["fc66353fb26fd82227700beb47c4fa90118cea151eb1689fd8bf48e93fda71d0", "2A42F500D019A64970E1C63D48EEFA27727F80FE0A5B13625E0E72A6EC98B968", "d5c1e947d84791ac8e6218652372905ddb7d3bc84ff04e709d635f60e7224688", "2615e5585a5db77b973c74e0a87551978a9322c820362a148a995e571923b59c", "170008187EBCEF183E792513608B82572FAF0AAEB33212BFA44736439453218F", "61e4c91803d0d495681400fb9053b434f4852fdad1a305bbcec45ee0b2926d6a", "3a3b05a08180013a37fbdbe65e3fe017440c1cb34289647ef1f60316964ef6a9", "383A2D8F421AD2F243CBC142E9715C78F867A114B037626C2097CB3E070F67D6", "bbc5a9a49757abdbfcaca22f3b2a8b7e79f61c30d31812a0ccc316536eb58ca3", "1395B863AE5697EA5096F4E2EBEF54FC20D5380B6921F8835D1F030F2BA16A40"], "Registry_Entries": ["HKLM\\Software\\Microsft\\Windows\\CurrentVersion\\Internet Settings.\n\nBased on what we saw in the code, the backdoor is also capable of accepting various commands\nfrom the C&C server. These commands allow the backdoor to manipulate \ufb01les (move, read,\ndelete, check existence), manipulate processes (create, terminate, retrieve parent, and process\nID) and Windows services (start, stop, check), execute console commands, remove itself, and\nmore. Some of these commands (read/check \ufb01le, check services, check processes) also send\ndata back to C&C. The infected device can also be commanded by C&C to act as a proxy or\nlisten on a speci\ufb01c port on every network interface.\n\nInterestingly, the backdoor has a set of commands speci\ufb01cally targeting \ufb01les with .tu and .tut \ufb01le\nextension. These commands may similarly check for their existence, send their content back to\nthe C&C, and modify their content (append or rewrite by data given by the C&C server).\n\nOther tools\n\nLateral Movement via Mimikatz\n\nhttps://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asia/\n\n5/9\n\n\f5/15/2020\n\nAPT Group Planted Backdoors Targeting High Pro\ufb01le Networks in Central Asia - Avast Threat Labs\n\nfc66353fb26fd82227700beb47c4fa90118cea151eb1689fd8bf48e93fda71d0\n\nMimikatz is an open source project by a French security researcher named Benjamin Delpy which\nstarted in 2007. It is a robust tool that exploits various Windows authentication schemes and\ndumps credential-related data from a Windows Local Security Account database. For these\nreasons it is often misused by a wide spectrum of APT actors such as the Lazarus Group or\nTelebots.\n\nThe Mimikatz version used in this campaign has a two-stage installation mechanism (installer.exe\ninstalling Yokel64.exe and mktz64.dll), and contains a PDB string\n\u201cE:\\2018_\\MimHash\\mimikatz\\Bin\\mktzx64.pdb\u201d. Calling a mktz64.dll exported function\nMktzDumpbyInjection inside our testing virtual machine yields the following output:\n\n#1 domain = MSEDGEWIN10, user = Administrator\n,nthash=FC525C9683E8FE067095BA2DDC971889\n\u00a0#2 domain = MSEDGEWIN10, user = IEUser ,\nnthash=FC525C9683E8FE067095BA2DDC971889\n\nLateral Movement via WMI\n\n2615e5585a5db77b973c74e0a87551978a9322c820362a148a995e571923b59c\n\nThe lateral movement via WMI is done with a \ufb01le that parses its own \ufb01lename, which we\u00a0suspect\nuses the following format: \u201c@@<ComputerName>,<UserName>,<Password>,.exe\u201d. Afterwards,\nthe data described in the \ufb01lename is extracted and used to establish a remote console to a\ncomputer identi\ufb01ed by the retrieved name. Afterwards, Windows Management Instrumentation\n(WMI) is leveraged to set a strict proxy security, leading to the encryption of arguments of each\nremote procedure call, and allowing the server to access local resources. Then WMI is used\nagain to retrieve the Win32_Process class which in turn is used to create a process with given\nparameters. At the end, it terminates itself.\n\nGh0st RAT\n\n3a3b05a08180013a37fbdbe65e3fe017440c1cb34289647ef1f60316964ef6a9\n\nGh0st RAT is an old well-known backdoor, predominantly associated with East-Asian attackers. It\nis commonly assumed that its source code is widely available. Its presence is often indicated by a\n\ufb01le named rastls.dll, using an export DLL name svchost.dll and containing a string Gh0st. A string\nuwqixgze} is used as a placeholder for the C&C domain.\n\nThe version we\u2019ve seen in this campaign tries to connect to https://yuemt.zzux[.]com.\n\nhttps://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asia/\n\n6/9\n\n\f5/15/2020\n\nAPT Group Planted Backdoors Targeting High Pro\ufb01le Networks in Central Asia - Avast Threat Labs\n\nFigure 4: Gh0st RAT malware\n\nCode Similarities\n\nWhile analyzing one of the \ufb01les, we noticed that it has several correlations to the Microcin sample\nfrom 2017, the BYEBY sample from 2017, and Vicious Panda: The COVID campaign from 2020.\nFigure 5 below provides a comparison of the decryption loop used to decrypt the main\ncon\ufb01guration data of the \ufb01rst backdoor.\n\nFigure 5: Part of code used to decipher the main con\ufb01guration data\n\nhttps://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asia/\n\n7/9\n\n\f5/15/2020\n\nAPT Group Planted Backdoors Targeting High Pro\ufb01le Networks in Central Asia - Avast Threat Labs\n\nName of\n\ufb01le\n\nSHA256\n\nirmon.dll 170008187EBCEF183E792513608B82572FAF0AAEB33212BFA44736439453218F\n\n383A2D8F421AD2F243CBC142E9715C78F867A114B037626C2097CB3E070F67D6\n\n2A42F500D019A64970E1C63D48EEFA27727F80FE0A5B13625E0E72A6EC98B968\n\ncrypt\u2010\nbase.dll\n\nNWC\u2010\nWork\u2010\nsta\u2010\ntion.dll\n\nnwsapa\u2010\ngent.dll\n\n92315CDCDD3ECDAFBAC1D46EF872AAA333E1EA159D662CB61C4\u2010\nFA029D3896DF7\n\nConclusion\n\nAvast reported its \ufb01ndings to the local CERT team and reached out to the telecommunications\ncompany. We have not heard back from either organization.\n\nAvast has recently protected users in Central Asia from further attacks using the samples we\nanalyzed. This, along with tying elements of the samples we discovered back to attacks carried\nout on other countries, makes me assume the group is still active.\u00a0\n\nI would like to thank Peter Kalnai from ESET for working with me on the analysis, Luk\u00e1\u0161 Obrdl\u00edk,\nand Adolf St\u0159eda from Avast for helping me with this research, as well as Alexey Shulmin from\nKaspersky for his support.\n\nIndicators of Compromise (IoC)\n\n\u00a0Repository:\u00a0https://github.com/avast/ioc/tree/master/Microcin\n\u00a0List of SHA-256:\u00a0https://github.com/avast/ioc/blob/master/Microcin/samples.sha256\n\nReferences\n\nVasily Berdnikov, Dmitry Karasovsky, Alexey Shulmin: \u201cMicrocin malware\u201d, Kaspersky Labs 2017-\n9-25 https://media.kasperskycontenthub.com/wp-\ncontent/uploads/sites/43/2018/03/07170759/Microcin_Technical_4PDF_eng_\ufb01nal_s.pdf\n\nJosh Grunzweig, Robert Falcone: \u201cThreat Actors Target Government of Belarus Using CMSTAR\nTrojan\u201d, Palo Alto Networks, September 2017, https://unit42.paloaltonetworks.com/unit42-threat-\nactors-target-government-belarus-using-cmstar-trojan/\n\nCheckpoint Research: \u201cVicious Panda: The COVID Campaign\u201d, 2020-03-12\nhttps://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/\n\nAvast Threat Intelligence https://github.com/avast/ioc\n\nhttps://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asia/\n\n8/9\n\n\f5/15/2020\n\nAPT Group Planted Backdoors Targeting High Pro\ufb01le Networks in Central Asia - Avast Threat Labs\n\nESET Threat Intelligence https://github.com/eset/malware-ioc\n\nDhia Mahjoub, Jeremiah O\u2019Connor, Thibault Reuille, Thomas Mathew: \u201cPhishing, Spiking, and\nBad Hosting\u201d, Cisco Umbrella Blog, 2015-09-14\n\nhttps://umbrella.cisco.com/blog/2015/09/14/phishing-spiking-and-bad-hosting/\n\nhttps://github.com/gentilkiwi/mimikatz\n\nhttps://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asia/\n\n9/9\n\n\f"], "URLs": ["https://decoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro", "https://yuemt.zzux[.]com.", "https://github.com/avast/ioc/tree/master/Microcin", "https://github.com/eset/malware-ioc", "https://umbrella.cisco.com/blog/2015/09/14/phishing-spiking-and-bad-hosting/", "https://github.com/gentilkiwi/mimikatz", "https://unit42.paloaltonetworks.com/unit42-threat-", "http://www.google.com/index.asp", "https://github.com/avast/ioc", "https://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/", "https://github.com/avast/ioc/blob/master/Microcin/samples.sha256"], "weight": 0.0}