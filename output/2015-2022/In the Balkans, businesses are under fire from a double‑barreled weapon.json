{"rule_id": 338, "name": "In the Balkans, businesses are under fire from a double\u2011barreled weapon", "description": "-", "references": ["CVE-2018-20250"], "File_Names": ["ZPDGU.exe", "ZPDGV.exe", "yandex.ru", "winmihc.exe", "llc.amo", "ZPDG.pdf", "preserve.exe", "stg.cfg", "AUG_1031.exe", "winmmon64.dll", "pks.rs", "winchk32.exe", "smart.php", "weather.php", "Zakon.pdf", "winmihc4.cmd", "MIP1023.pdf", "winmmon.dll", "winchk64.exe", "list.ru", "Preserve.exe", "uprava.hr", "dekol.php", "mihcupdate.cmd", "Stav.exe", "MIP1023.exe", "ZPDGI.exe", "Zakon.exe", "weather.cmd", "kversion.php", "slowbeerltd.in", "ZPDGE.exe", "rutils.com", "newmail.ru", "Stav.pdf", "bbportal.info", "ZPDGA.exe", "rfusclient.exe", "zagreb.php", "serk.exe", "WindowsConnect.exe", "hide.exe", "qip.ru", "inbox.ru", "pufbih.ba", "weather.exe", "PreservS.exe", "AUG_1031.pdf", "serk.bat", "rutserv.exe", "ZPDGO.exe"], "MD5_Hashes": [], "SHA1_Hashes": ["BEEF0EE9397B01855C6DAA2BFF8002DB4899B121", "A56A299A8EEF9F4FF082184F66FAD1B76C7CACB8", "7AA3D6EA4736C3BF627DB1837B9C8D2B29D7AB8D", "21EE61874F299661AECC5453F4D6D0EC5380DAD0", "C90B5471BBA3293C0A0E6829A81FBE2EB10B42B2", "9F2C6A44453E882098B17B66DE70C430C64C3B26", "270F1FA36365273F14D89EE852D8A438A594CD05", "CEA70DB7FB8E851EF0D6A257A41C9CEE904345B5", "576EF0057982DE87CA029C736706E840031A27F4", "A5ACE8F90C33CBDB12D398C0F227EC48F99551BF", "DFDFCC61770425A8D1520550C028D1DF2861E53F", "FFE23D510A24DB27C1C171D2BAF1FBEB18899039", "A15AB505B79B88A9E868C95CE544942403C58CB6", "38E7FCD6038E688DEC9F1AF9D2D222B9BBC03A8C", "C9B592BD7B69995C75CD5B1E4261B229C27FB479", "F3BC2F436693B61FED7FA7DDF8BC7F27618F24F3", "AB311B53591C6625335B9B791676A44538B48821", "E0007A2E0E9AE47DD028029C402D7D0A08EBBC25", "5CC4F248595268A0C9988DAEE3F0F8F9F5AC0A7F", "B248E43BAB127D8E1E466821B96B7B7ECF37CB78", "400FF3FD5BEF94DCBEAE24B5B8A6632DCD1D22A6", "446D3FBAE9889FE59AFAD02C6FB71D8838C3FC67", "0BD6C70B7E2320F42F0CFC2A79E161614C7C4F66", "DBE0E084B2A8CE4711C3DF4E62E8062234BF6D3B", "CE7092FF909E9380CC647C3350AA3067E40C36A9", "CF7A8AFAC141E162A0204A49BAD0A49C259B5A45", "42F70DAA8C75E97551935D2370142C8904F5A20D", "BC6F31D5EBC71FF83BACC0B4471FDEFC206B28D0", "AA4AD783DFE3CC6B0B9612814ED9418253203C50", "A5A05BA6E24226F1BC575CBC12B9FC59F6039312", "F06CB000F9A25DDE791C7E5BC30917C74A8F2876", "FA19E71F9A836EA832B5D738D833C721D776781A", "7BF564891089377809D3F0C2C9E25FD087F5F42B", "09D18CD045285A753BCF4F42C6F10AF76913546A", "30BA2213BE4355D619E20DA733F27F59DA7B937E", "B8F67BB5682B26ACD5969D9C6AC7B45FE07E79E1", "21DE3EB6F39DF4DBBF2D1FE4B6467AAE3D9FBEBD", "88C3FDA42768C5B465FD680591639F2CDC933283", "6EF16FAA19FC4CEF66C4C1B66E58FB9CFFD8098E", "6E27F7C61230452555B52B39AB9F51D42C725BED", "3B88D4047FA2B8F8FA6241320D81508EB676EA7A", "7A41B912A3F99370DF4CD3791C91467E23B2AA82", "032884A46430039ED4E38518AA20742B79AB2678", "AEDF43347AF24D266EC5D471723F4B30B4ACC0D0", "A8A5980DE35FBF580497B43EF7E8499E004F9F38", "CD1BC431F53E9CFF8204279CDF274838DE8EBB61", "13D8664B438DA278CEB9C8593AE85023432054CD", "400438EB302886FD064274188647E6653E455EED", "730E20EE7228080A7F90A238D9E65D55EDD84301", "C90756A3C6F6DC34E12BABF5F26543510AACE704", "8888014C16732CD5136A8315127BA50BB8BB94ED", "C8CBBC175451A097E605E448F94C89D3E050ACD5", "C3813734D3BFC07E339C05417055A1A106E2FBBD", "E56189FE86C9537C28099518D4F4EA2E42EF9EEE", "038ECEB80597DE438D8194F8F57245EB0239FF4B", "8722441FF3678D154C89E312DB1A54951DD21C3F", "2A1BB4BB455D3238A01E121165603A9B58B4D09D", "E95C651C539EAF73E142D1867A1A96098A5E219F", "7BA4D127C6CD6B5392870F0272C7045C9932DB17", "9EA0C6A17EE4EB23371688972B7F4E6D4D53F3C8", "6C83ABE56219CA656B71AA8C109E0955061DA536", "37A2A15C52CAA7D63AF86778C2DD1D2D81D4A270", "73E0A62F1AAAB3457D895B4B1E6E2119B8B8D167", "46E4B456729CF659527D2697BD8518E67B5A0056", "B4A847D7AAC4164CF90EA585E4842CBF938B26CF", "DEEA26F5AF918CEC406B4F12184F0CAB2755B602", "CD82D898A3CEA623179456D9AE5FAD1FB5DA01A0", "3E8AF08F2C64D9D305A129FDEA6B24ED3D8D9484", "5A3201048D8D9D696102A3C3B98DA99C2CC4FF1F", "C2F9FFDF518DA9E037F76902746DE89C2E2821E8", "555844CA5CD40DFC27778C2D3B6AFA43D1B76685", "3C1FF7BBE8BC2BE9E5531FFAD25B18F03C51CF6B", "6D53E7B5099CE11ACA176519620E8064D4FF9AD0", "F6030AE46DC2CEF9C68DA1844F7DCEA4F25A90A3", "685314454A7D7987B38ADD2EDDBAC3DB9E78464F", "E918192D2B5C565A9B2756A1D01070C6608F361C", "6A5CA3B9EE0A048F0AEE1E99CBF3943D84F597FF", "34CE3FBEE3C487F4F467B9E8EB36844BB5ACB465", "02225C58A0800A8FFFE82F7614695FDEEB75C8B3", "B77CFFF0E359946029120DD642505BC0A9713ECC", "0F7A95C89911E3DE9205FF6AA03E1A4FCE6BC551", "8852647B1C1A2EFA4F25FEA393D773F9FF94D6FA", "421F52733D334BE32C899670426C06CB72D92CDE", "F26C663D5F6F534543A7C42B02254C98BB4EC0D5", "9F48E109675CDB0A53400358C27853DB48FCD156", "97926E2A7514D4078CF51EAC069A014309E607F1", "28F152154F6E6074EA0DE34214102119C8589583", "ECEEE01F4E8051F544062AE37D76A3DF2921DF82", "17EA62EBC5F86997FD7E303FBBFF3E343DA38FCC", "C6E62A113E95705F9B612CDBF49DAC6BAD2073BD", "BFE3F5CEC25181F1B6852E145013E548B920651E", "1C03ED1ADF4B4E786EFC00F3D892217FAAAFB268", "030DC8C3832F664FA10EFA3105DFF0A9B6D48911", "B18222E93D25649BC1B67FAB4F9BF2B4C59D9A1A", "7CEC39AC6A436577E02E7E8FE8226A00E58564CB", "D8D27C742DA87292EF19A197594193C2C5E5F845", "64E3A46BF393936A79478C891654C1070CEC42D1", "006B8EF615550BA731A30FA83B0E03CD16D2A92D", "C268CAB6D8EC267EEE463672809FAAEE99C2F446", "3170B45FB642301687A3A320282099B9D7B7F0F2", "4D46FB773C02A9FF98E998DA4F0777FB5D9F796B", "E00C309E3FE09248B8AFCFF29FC1A79445C913DA", "60EB2A19EC63FF36D13F472EC0E6A594C2778CE6", "AC5383306459CE8CD19BFF412875F093B40427C6", "500A447A187240706C059C16366FEDF1AA13EA77", "BE8A582360FB16A4B515CD633227D6A002D142FA", "510C93D3DC620B17500C10369585F4AF7CF3CE0D", "3927B48D315F6712D33166A3B278B7835E76A6A9", "963CF321740C4EF606FEC65FCE85FB3A9A6223AC", "CDBB74CA0960F2E8631D49ACABF2CEA878AE35B8", "8D9A804B1433A05216CFE1D4E61CE5EB092A3505", "15EC88015FB554302DB131258C8C11C9E46209D4", "4F8BA64DA7EA16A7CE5AA2C83BBFCE1C8646E424", "A1DEA762DD4329E77FE59526D4ABC0E15DE2BBBC", "1E0C4A5F0FF2E835D12C3B6571AE6000E81A014B", "BAD38D474D5CAAAC27082E6F727CAE269F64CF3C", "8F85738534158DB9C600A29B9DED8AC85C3DE8C1"], "SHA256_Hashes": [], "Registry_Entries": ["HKEY_CURRENT_USER\\SOFTWARE\\Mi\u2010\ncrosoft\\Windows NT\\CurrentVersion\\Windows] registry key under the \u201cload\u201d entry. Adds\nexception for the RDS to the local \ufb01rewall. Executes itself again in the main mode (no\narguments).\n\n/inj\n\nInjects the userland rootkit library into processes, as speci\ufb01ed in the con\ufb01guration \ufb01le\n\n(none) Main mode. Executes the 64-bit version of itself (if applicable), injects the userland rootkit,\nexecutes the RDS and hides the window by changing its coordinates to values outside the\nscreen.\nAnother thread captures pressed keystrokes.\n\nThe main part of the BalkanRAT malware is a copy of the Remote Utilities software for remote\naccess. Instead of using the of\ufb01cial version, BalkanRAT deploys a copy signed by a certi\ufb01cate of\nthe attacker.\n\nThe client side of the RDS running on the victim\u2019s computer must know the unique ID and the\npassword, both generated on the server side, to connect to the server. The RDS deployed by\nBalkanRAT is con\ufb01gured in such a way that the password is the same for all victims, and the\ngenerated unique ID is sent to the attacker\u2019s email address by the tool itself.\n\nSince the tool BalkanRAT misuses is legitimate, it leverages the genuine Remote Utilities\u2019\ninfrastructure for this communication (rutils.com, server.rutils.com); due to this, the\ncommunication may seem legitimate to the user \u2013 and to security products.\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n8/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nAs a result, the attacker has obtained credentials to access the compromised computer via the\nRemote Utilities software. Using this tool, they can broadcast the screen to monitor the activity of\nthe user and manually take over the compromised computer.\n\nFigure 6. A window the victim never sees. With a legitimate copy of Remote Utilities, this\nwindow is visible; however, BalkanRAT will hide it using the GUI hider feature.\n\nTo remain stealthy, BalkanRAT uses the GUI hider feature. In most samples (some older ones are\nan exception), it is implemented as an AutoHotKey script, compiled into an executable \ufb01le so that\nit can be run on a computer even if AutoHotKey is not installed there. The purpose of this script is\nto hide the tray icon of the RDS client.\n\nFigure 7. AutoHotKey script embedded in the resource section of the executable\n\nAnother notable feature used by BalkanRAT to stay hidden is the ability to hide processes from\nthe user.\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n9/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nTo achieve this, userland rootkit libraries are injected in processes hardcoded in the con\ufb01guration\n\ufb01le. The userland rootkit hooks the NtQuerySystemInformation function for the process in which it\nis injected. In case SystemProcessInformation is queried, it \ufb01lters out all entries for processes\nwith the names speci\ufb01ed in the con\ufb01guration \ufb01le. As a result, conventional task manager utilities\nwill not display the processes the attackers want to keep hidden from the user.\n\nFigure 8. With the userland rootkit injected, some processes are missing in the list (left). Without the rootkit, the processes\nare visible (right).\n\nNaturally, the list of processes that will be hidden contain mostly ones belonging to BalkanRAT.\nHowever, we have also seen names like \u201cweather.exe\u201d or \u201cpreserve.exe\u201d in the list \u2013 which belong\nto the BalkanDoor backdoor. This \ufb01nding supports the belief these two tools are indeed used\ntogether.\n\nConclusion\n\nBoth BalkanRAT and BalkanDoor have some interesting tricks up their sleeves and each of them\nseparately pose a signi\ufb01cant risk to the victims. If used together as a toolset, they make an even\nmore powerful weapon \u2013 the more the campaign we have discovered targets accounting, a\nfunction that is critical for organizations.\n\nThe campaign targeting accountants in the Balkans shows some similarities with a campaign\naimed at Ukrainian notaries reported in 2016. (The only source we have been able to \ufb01nd\ndescribing it is in Russian.) In that case, the attackers\u2019 goal was to take control over a notary\ncomputer and issue some illegal operation on behalf of the notary.\n\nJust as attackers may con\ufb01rm a fraudulent transaction on behalf of a notary, they may perform a\nfraudulent transaction while impersonating a manager in a company\u2019s \ufb01nancial department.\n\nTo stay safe, business users \u2013 and their employers \u2013 should follow basic cybersecurity rules: be\ncautious about emails and scrutinize their attachments and links, keep their software updated and\nuse a reputable security solution.\n\nIndicators of Compromise (IoCs)\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\nESET detection names\n\n10/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nWin32/BalkanDoor.A\nWin32/BalkanDoor.B\nWin32/BalkanRAT.A\nWin32/BalkanRAT.B\nWin64/BalkanRAT.A\nWin64/BalkanRAT.B\n\nSHA-1\n\nBalkanDoor \u2013 executable \ufb01les\n\n02225C58A0800A8FFFE82F7614695FDEEB75C8B3\n3E8AF08F2C64D9D305A129FDEA6B24ED3D8D9484\n400FF3FD5BEF94DCBEAE24B5B8A6632DCD1D22A6\n576EF0057982DE87CA029C736706E840031A27F4\n5CC4F248595268A0C9988DAEE3F0F8F9F5AC0A7F\n60EB2A19EC63FF36D13F472EC0E6A594C2778CE6\n7AA3D6EA4736C3BF627DB1837B9C8D2B29D7AB8D\nAC5383306459CE8CD19BFF412875F093B40427C6\n\nBalkanRAT \u2013 executable and auxiliary \ufb01les\n\n006B8EF615550BA731A30FA83B0E03CD16D2A92D\n030DC8C3832F664FA10EFA3105DFF0A9B6D48911\n032884A46430039ED4E38518AA20742B79AB2678\n09D18CD045285A753BCF4F42C6F10AF76913546A\n0F7A95C89911E3DE9205FF6AA03E1A4FCE6BC551\n13D8664B438DA278CEB9C8593AE85023432054CD\n17EA62EBC5F86997FD7E303FBBFF3E343DA38FCC\n1C03ED1ADF4B4E786EFC00F3D892217FAAAFB268\n15EC88015FB554302DB131258C8C11C9E46209D4\n21DE3EB6F39DF4DBBF2D1FE4B6467AAE3D9FBEBD\n21EE61874F299661AECC5453F4D6D0EC5380DAD0\n270F1FA36365273F14D89EE852D8A438A594CD05\n30BA2213BE4355D619E20DA733F27F59DA7B937E\n3170B45FB642301687A3A320282099B9D7B7F0F2\n38E7FCD6038E688DEC9F1AF9D2D222B9BBC03A8C\n3927B48D315F6712D33166A3B278B7835E76A6A9\n3C1FF7BBE8BC2BE9E5531FFAD25B18F03C51CF6B\n421F52733D334BE32C899670426C06CB72D92CDE\n46E4B456729CF659527D2697BD8518E67B5A0056\n4F8BA64DA7EA16A7CE5AA2C83BBFCE1C8646E424\n500A447A187240706C059C16366FEDF1AA13EA77\n555844CA5CD40DFC27778C2D3B6AFA43D1B76685\n5A3201048D8D9D696102A3C3B98DA99C2CC4FF1F\n64E3A46BF393936A79478C891654C1070CEC42D1\n685314454A7D7987B38ADD2EDDBAC3DB9E78464F\n6C83ABE56219CA656B71AA8C109E0955061DA536\n6E27F7C61230452555B52B39AB9F51D42C725BED\n6EF16FAA19FC4CEF66C4C1B66E58FB9CFFD8098E\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n11/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\n730E20EE7228080A7F90A238D9E65D55EDD84301\n73E0A62F1AAAB3457D895B4B1E6E2119B8B8D167\n7BA4D127C6CD6B5392870F0272C7045C9932DB17\n7BF564891089377809D3F0C2C9E25FD087F5F42B\n8852647B1C1A2EFA4F25FEA393D773F9FF94D6FA\n8D9A804B1433A05216CFE1D4E61CE5EB092A3505\n8F85738534158DB9C600A29B9DED8AC85C3DE8C1\n963CF321740C4EF606FEC65FCE85FB3A9A6223AC\n97926E2A7514D4078CF51EAC069A014309E607F1\n9EA0C6A17EE4EB23371688972B7F4E6D4D53F3C8\n9F2C6A44453E882098B17B66DE70C430C64C3B26\nA1DEA762DD4329E77FE59526D4ABC0E15DE2BBBC\nA56A299A8EEF9F4FF082184F66FAD1B76C7CACB8\nA5ACE8F90C33CBDB12D398C0F227EC48F99551BF\nAA4AD783DFE3CC6B0B9612814ED9418253203C50\nAB311B53591C6625335B9B791676A44538B48821\nAEDF43347AF24D266EC5D471723F4B30B4ACC0D0\nB18222E93D25649BC1B67FAB4F9BF2B4C59D9A1A\nB8F67BB5682B26ACD5969D9C6AC7B45FE07E79E1\nBAD38D474D5CAAAC27082E6F727CAE269F64CF3C\nBEEF0EE9397B01855C6DAA2BFF8002DB4899B121\nBFE3F5CEC25181F1B6852E145013E548B920651E\nC268CAB6D8EC267EEE463672809FAAEE99C2F446\nC2F9FFDF518DA9E037F76902746DE89C2E2821E8\nC3813734D3BFC07E339C05417055A1A106E2FBBD\nC8CBBC175451A097E605E448F94C89D3E050ACD5\nC90756A3C6F6DC34E12BABF5F26543510AACE704\nC90B5471BBA3293C0A0E6829A81FBE2EB10B42B2\nCD1BC431F53E9CFF8204279CDF274838DE8EBB61\nCD82D898A3CEA623179456D9AE5FAD1FB5DA01A0\nCDBB74CA0960F2E8631D49ACABF2CEA878AE35B8\nCE7092FF909E9380CC647C3350AA3067E40C36A9\nCEA70DB7FB8E851EF0D6A257A41C9CEE904345B5\nCF7A8AFAC141E162A0204A49BAD0A49C259B5A45\nDEEA26F5AF918CEC406B4F12184F0CAB2755B602\nDFDFCC61770425A8D1520550C028D1DF2861E53F\nE0007A2E0E9AE47DD028029C402D7D0A08EBBC25\nE00C309E3FE09248B8AFCFF29FC1A79445C913DA\nE95C651C539EAF73E142D1867A1A96098A5E219F\nECEEE01F4E8051F544062AE37D76A3DF2921DF82\nF06CB000F9A25DDE791C7E5BC30917C74A8F2876\nF26C663D5F6F534543A7C42B02254C98BB4EC0D5\nF3BC2F436693B61FED7FA7DDF8BC7F27618F24F3\nF6030AE46DC2CEF9C68DA1844F7DCEA4F25A90A3\nFA19E71F9A836EA832B5D738D833C721D776781A\nFFE23D510A24DB27C1C171D2BAF1FBEB18899039\n\nRemote Utilities (otherwise legitimate releases signed by attackers\u2019\ncerti\ufb01cates)\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n12/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\n038ECEB80597DE438D8194F8F57245EB0239FF4B\n2A1BB4BB455D3238A01E121165603A9B58B4D09D\n34CE3FBEE3C487F4F467B9E8EB36844BB5ACB465\n3B88D4047FA2B8F8FA6241320D81508EB676EA7A\n400438EB302886FD064274188647E6653E455EED\n42F70DAA8C75E97551935D2370142C8904F5A20D\n446D3FBAE9889FE59AFAD02C6FB71D8838C3FC67\n4D46FB773C02A9FF98E998DA4F0777FB5D9F796B\n510C93D3DC620B17500C10369585F4AF7CF3CE0D\n6A5CA3B9EE0A048F0AEE1E99CBF3943D84F597FF\n6D53E7B5099CE11ACA176519620E8064D4FF9AD0\n7CEC39AC6A436577E02E7E8FE8226A00E58564CB\n8888014C16732CD5136A8315127BA50BB8BB94ED\nA5A05BA6E24226F1BC575CBC12B9FC59F6039312\nB77CFFF0E359946029120DD642505BC0A9713ECC\nBC6F31D5EBC71FF83BACC0B4471FDEFC206B28D0\nBE8A582360FB16A4B515CD633227D6A002D142FA\nC6E62A113E95705F9B612CDBF49DAC6BAD2073BD\nD8D27C742DA87292EF19A197594193C2C5E5F845\nDBE0E084B2A8CE4711C3DF4E62E8062234BF6D3B\nE56189FE86C9537C28099518D4F4EA2E42EF9EEE\nE918192D2B5C565A9B2756A1D01070C6608F361C\n\nScripts\n\n0BD6C70B7E2320F42F0CFC2A79E161614C7C4F66\n7A41B912A3F99370DF4CD3791C91467E23B2AA82\nA15AB505B79B88A9E868C95CE544942403C58CB6\nA8A5980DE35FBF580497B43EF7E8499E004F9F38\nB248E43BAB127D8E1E466821B96B7B7ECF37CB78\n\nCon\ufb01guration \ufb01les\n\n28F152154F6E6074EA0DE34214102119C8589583\n37A2A15C52CAA7D63AF86778C2DD1D2D81D4A270\nB4A847D7AAC4164CF90EA585E4842CBF938B26CF\n\nDecoy PDF \ufb01les\n\n1E0C4A5F0FF2E835D12C3B6571AE6000E81A014B\n8722441FF3678D154C89E312DB1A54951DD21C3F\n88C3FDA42768C5B465FD680591639F2CDC933283\n9F48E109675CDB0A53400358C27853DB48FCD156\nC9B592BD7B69995C75CD5B1E4261B229C27FB479\n\nMisused certi\ufb01cates\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n13/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nAMO-\nK\u00a0Limit\u2010\ned Lia\u2010\nbility\nCompa\u2010\nny\n\nValm\u2010\npak,\nTOV\n\nValm\u2010\npak,\nTOV\n\n3D\nPEO\u2010\nPLE\nLIMIT\u2010\nED\n\nADUNIK\nLTD\n\nllc.amo-\nk@list.ru\n\n2015/07/30\n\n2016/07/28\n\n4E36C4D10F1E3D820058E4D45\n1C4A7B77856BDB3\n\nEx\u2010\npired\n\ntov-\nvalpak@mail.ru\n\n2016/04/10\n\n2017/04/01\n\n17D50E2DBBAF5F8F60BF\u2010\nFE1B90F4DD52FDB44A09\n\nRe\u2010\nvoked\n\n-\n\n-\n\n-\n\n2016/08/22\n\n2017/11/04\n\n4A362020F1AFD3B\u2010\nD0C67F12F55A5754D2E70338C\n\nRe\u2010\nvoked\n\n2017/11/05\n\n2018/11/06\n\n936EDFB338D458F\u2010\nBACB25FE557F26AA3E101506E\n\nEx\u2010\npired\n\n2017/10/11\n\n2018/10/12 E7DF448539D1E2671D\u2010\n\nCF787CF368AAC2ED8F5698\n\nEx\u2010\npired\n\nSLOW\nBEER\nLTD\n\nadministrator@\nslowbeerltd.in\u2010\nfo\n\n2019/01/25\n\n2019/12/18\n\n2359D644E48759F43993D34885\n167FECAFD40022\n\nRe\u2010\nvoked\n\nFile names\n\nBalkanDoor\n\nDropper: Zakon.exe\nBackdoors: weather.exe, winmihc.exe, Preserve.exe, PreservS.exe, WindowsConnect.exe\nScripts: weather.cmd, winmihc4.cmd, mihcupdate.cmd\nDecoy PDF \ufb01le: Zakon.pdf\n\nBalkanRAT\n\nDroppers: ZPDGI.exe, ZPDGV.exe, ZPDGE.exe, ZPDGO.exe, ZPDGU.exe, ZPDGA.exe,\nPonovljeni-Stav.exe, AUG_1031.exe, MIP1023.exe\nCon\ufb01guration \ufb01le: stg.cfg\nDecoy PDF \ufb01les: ZPDG.pdf, Ponovljeni-Stav.pdf, AUG_1031.pdf, MIP1023.pdf\nCore component: winchk32.exe, wininit.exe, hide.exe, winchk64.exe\nRDS: rutserv.exe, rfusclient.exe\nUserland rootkit: winmmon.dll, winmmon64.dll\nGUI hider components: serk.bat, serk.exe\n\nFolder names\n\n%WINDIR%\\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8\n%WINDIR%\\29D451CF-3548-4486-8465-A23029B8F6FA\n%WINDIR%\\B1EDD68E-6AD8-4A7E-91A1-3C30903B8DD4\n%APPDATA%\\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8\n%APPDATA%\\29D451CF-3548-4486-8465-A23029B8F6FA\n%APPDATA%\\B1EDD68E 6AD8 4A7E 91A1 3C30903B8DD4\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n14/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nC&C servers\n\nhttp://bestfriendsroot[.]com/smart.php\nhttp://bestfriendsroot[.]com/weather.php\nhttp://bestfriendsroot[.]com/zagreb.php\nhttp://consaltingsolutionshere[.]com/smart.php\nhttp://consaltingsolutionshere[.]com/weather.php\nhttp://consaltingsolutionshere[.]com/zagreb.php\nhttp://dogvipcare[.]net/kversion.php\nhttp://hvar.dogvipcare[.]net/dekol.php\nhttp://kimdotcomfriends[.]com/smart.php\nhttp://kimdotcomfriends[.]com/weather.php\nhttp://kimdotcomfriends[.]com/zagreb.php\nhttp://limosinevipsalon[.]com/kversion.php\nhttp://luxembourgprotections[.]com/kversion.php\nhttp://malmevipbikes[.]se/kversion.php\nhttp://split.malmevipbikes[.]se/dekol.php\nhttp://zagreb.porezna-uprava[.]com/dekol.php\n\nEmail addresses used to ex\ufb01ltrate Remote Utilities credentials\n\nb.klokov@inbox.ru\ngalkin.valentin.83@bk.ru\ngligorijmaskov@mail.ru\nivan.aslanov@newmail.ru\nivan.tatarov@qip.ru\nmelikov.viktor@yandex.ru\nmr.aleksandrandreev@mail.ru\ntest@bbportal.info\ntgerik@list.ru\nvladzlobin@list.ru\n\nMITRE ATT&CK techniques\n\nBalkanRAT\n\nInitial\nAc\u2010\ncess\n\nExecu\u2010\ntion\n\nT1192 Spearphish\u2010\n\nBalkanRAT is distributed via emails that contain links to malware.\n\ning Link\n\nT1059 Command-\nLine\nInterface\n\nBalkanRAT uses cmd.exe to execute \ufb01les.\n\nT1106 Execution\n\nthrough API\n\nBalkanRAT uses ShellExecuteExW and LoadLibrary APIs to ex\u2010\necute other malware components.\n\nT1064 Scripting\n\nBalkanRAT uses batch scripts for malware installation and\nexecution.\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n15/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nT1204 User\n\nExecution\n\nBalkanRAT relies on the victim to execute the initial in\ufb01ltration.\nThe malware is disguised as PDF documents with misleading\nnames, in order to entice the intended victim to click on it.\n\nPersis\u2010\ntence\n\nT1060 Registry Run\nKeys / Start\u2010\nup Folder\n\nBalkanRAT uses the following Registry Run key to establish per\u2010\nsistence: [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Win\u2010\ndows NT\\CurrentVersion\\Windows], \u201cload\u201d.\n\nPrivi\u2010\nlege\nEsca\u2010\nlation\n\nDe\u2010\nfense\nEva\u2010\nsion\n\nT1134 Access To\u2010\nken\nManipulation\n\nBalkanRAT is able to impersonate the logged-on user using Du\u2010\nplicateTokenEx or ImpersonateLoggedOnUser APIs.\n\nT1116 Code\n\nBalkanRAT is digitally signed with code-signing certi\ufb01cates.\n\nSigning\n\nT1140 Deobfus\u2010\n\ncate/Decode\nFiles or\nInformation\n\nT1089 Disabling\n\nSecurity\nTools\n\nT1112 Modify\n\nRegistry\n\nT1027 Obfuscated\n\nFiles or\nInformation\n\nBalkanRAT decrypts and decompresses some of its\ncomponents.\n\nBalkanRAT is capable of adding exceptions to the local \ufb01rewall,\nusing its COM interface.\n\nBalkanRAT modi\ufb01es the\n[HKEY_CURRENT_USER\\Software\\Usoris\\Remote\nUtilities\\Server\\Parameters] registry key to store con\ufb01guration of\nthe RDS\n\nSome components of BalkanRAT are compressed and then en\u2010\ncrypted by a XOR cipher.\n\nT1055 Process\nInjection\n\nBalkanRAT injects a userland rootkit library into processes of\ntask manager utilities.\n\nT1108 Redundant\n\nAccess\n\nOperators of BalkanRAT have been seen deploying a second\nmalicious tool (BalkanDoor) to preserve remote access in case\nBalkanRAT is removed.\n\nT1014 Rootkit\n\nBalkanRAT uses a userland rootkit that hooks the NtQuerySys\u2010\ntemInformation function to hide the presence of malicious\nprocesses.\n\nT1143 Hidden\nWindow\n\nBalkanRAT uses 3 rd party remote desktop software and hides\nits window and tray icon in order to hide it from the user.\n\nDis\u2010\ncovery\n\nT1082 System In\u2010\n\nformation\nDiscovery\n\nCollec\u2010\ntion\n\nT1056\n\nInput\nCapture\n\nBalkanRAT collects the computer name and the language set\u2010\ntings from the compromised machine.\n\nBalkanRAT is capable of logging pressed keystrokes.\n\nT1219 Remote Ac\u2010\n\ncess Tools\n\nBalkanRAT has misused legitimate remote desktop software for\nremote access.\n\nCom\u2010\nmand\nand\nCon\u2010\ntrol\n\nBalkanDoor\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n16/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nInitial\nAc\u2010\ncess\n\nExe\u2010\ncution\n\nPer\u2010\nsis\u2010\ntence\n\nPrivi\u2010\nlege\nEsca\u2010\nlation\n\nDe\u2010\nfense\nEva\u2010\nsion\n\nT1192 Spearphis\nhing Link\n\nBalkanDoor is distributed via emails that contain links to download\nmalware.\n\nT1059 Com\u2010\n\nBalkanRAT uses cmd.exe to create a remote shell.\n\nmand-Line\nInterface\n\nT1106 Execution\n\nthrough\nAPI\n\nT1203 Exploita\u2010\n\ntion for\nClient\nExecution\n\nBalkanRAT uses ShellExecuteExW and LoadLibrary APIs to exe\u2010\ncute \ufb01les.\n\nBalkanDoor can be distributed as an ACE archive disguised as a\nRAR archive, exploiting CVE-2018-20250 vulnerability in WinRAR\nto execute malicious code.\n\nT1064 Scripting\n\nBalkanDoor uses batch scripts for malware installation and\nexecution.\n\nT1035 Service\n\nBalkanDoor\u2019s backdoor can be executed as a service.\n\nExecution\n\nT1204 User\n\nExecution\n\nBalkanDoor relies on the victim to execute the initial in\ufb01ltration. The\nmalware is disguised as PDF documents or RAR archives with mis\u2010\nleading names, in order to entice the intended victim to click on it.\n\nT1050 New\n\nService\n\nBalkanDoor can be installed as a new service, mimicking legitimate\nWindows services.\n\nT1060 Registry\n\nRun Keys\n/ Startup\nFolder\n\nT1134 Access\n\nToken\nManipula\u2010\ntion\n\nBalkanDoor can be installed in the Registry Run key, or dropped in\nthe Startup folder.\n\nBalkanDoor is able to create a process under the security context of\na different user, using DuplicateTokenEx, SetTokenInformation or\nCreateProcessAsUserW APIs.\n\nT1116 Code\n\nBalkanDoor is digitally signed with code-signing certi\ufb01cates.\n\nSigning\n\nT1107\n\nFile\nDeletion\n\nBalkanDoor deletes \ufb01les with backdoor commands after the com\u2010\nmands have been executed.\n\nT1158 Hidden\n\nFiles and\nDirectories\n\nBalkanDoor sets attributes of its \ufb01les to HIDDEN, SYSTEM and\nREADONLY.\n\nT1036 Mas\u2010\n\nquerading\n\nBalkanDoor can be installed as a service with names mimicking le\u2010\ngitimate Windows services.\n\nT1108 Redun\u2010\n\ndant\nAccess\n\nOperators of BalkanDoor have been seen deploying a second mali\u2010\ncious tool (BalkanRAT) to preserve remote access in case Balkan\u2010\nDoor is removed.\n\nDis\u2010\ncovery\n\nT1082 System\nInforma\u2010\ntion\nDiscovery\n\nBalkanDoor collects the computer name from the compromised\nmachine.\n\nT1113 Screen\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\nCapture\n\nCol\u2010\nlection\n\nBalkanDoor can capture screenshots of the compromised machine.\n\n17/18\n\n\f8/15/2019\n\nIn the Balkans, businesses are under \ufb01re from a double-barreled weapon | WeLiveSecurity\n\nCom\u2010\nmand\nand\nCon\u2010\ntrol\n\nT1043 Commonly\nUsed Port\n\nBalkanDoor uses ports 80 and 443 for C&C communication.\n\nT1090 Connec\u2010\n\ntion Proxy\n\nBalkanDoor is capable of identifying a con\ufb01gured proxy server if\none exists and then using it to make HTTP requests.\n\nT1008 Fallback\n\nBalkanDoor can communicate over multiple C&C hosts.\n\nChannels\n\nT1071 Standard\nApplica\u2010\ntion Layer\nProtocol\n\nBalkanDoor uses HTTP or HTTPS for network communication.\n\nZuzana Hromcov\u00e1 14 Aug 2019 - 11:30AM\n\nhttps://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/\n\n18/18\n\n\f"], "URLs": ["http://malmevipbikes[.]se/kversion.php", "http://dogvipcare[.]net/kversion.php", "http://split.malmevipbikes[.]se/dekol.php", "http://luxembourgprotections[.]com/kversion.php", "http://kimdotcomfriends[.]com/smart.php", "http://consaltingsolutionshere[.]com/smart.php", "http://consaltingsolutionshere[.]com/weather.php", "http://bestfriendsroot[.]com/zagreb.php", "http://kimdotcomfriends[.]com/zagreb.php", "http://zagreb.porezna-uprava[.]com/dekol.php", "http://limosinevipsalon[.]com/kversion.php", "http://consaltingsolutionshere[.]com/zagreb.php", "http://kimdotcomfriends[.]com/weather.php", "http://bestfriendsroot[.]com/smart.php", "http://hvar.dogvipcare[.]net/dekol.php", "http://bestfriendsroot[.]com/weather.php", "https://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/"], "weight": 0.0}