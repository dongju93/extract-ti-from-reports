{"rule_id": 382, "name": "Report_Shamoon_StoneDrill_final", "description": "-", "references": [], "File_Names": ["usbvideo324.pnf", "rrasrv.exe", "sfmsc.exe", "power.exe", "Test.tmp", "gpget.exe", "page.php", "clean.exe", "T.tmp", "wcscript.exe", "FileInfoStp.txt", "netimm173.pnf", "ntertmgr32.exe", "netx.exe", "regsys.exe", "dvdquery.exe", "msinit.exe", "Stp.exe", "netinit.exe", "findfile.exe", "dnslookup.exe", "rdsadmin.exe", "pt.exe", "ntnw.exe", "ntfrsutil.exe", "iissrv.exe", "ntssrvr32.exe", "caclsrv.exe", "Check_Exist.php", "ntssrvr64.exe", "T.vbs", "sigver.exe", "LaunchWinApp.exe", "key8854321.pub", "FileInfo.txt", "dfrag.exe", "eservic.com", "event.exe", "smbinit.exe", "ipsecure.exe", "T.bat", "Inject.wmyv", "sacses.exe", "routeman.exe", "ntdsutl.exe", "DRDISK.SYS", "bd891.tmp", "fsutl.exe", "ctrl.exe", "certutl.exe", "Inject.wmyt"], "MD5_Hashes": ["2cd0a5f1e9bcce6807e57ec8477d222a", "6bebb161bc45080200a204f0a1d6fc08", "9d40d04d64f26a30da893b7a30da04eb", "ac8636b6ad8f946e1d756cd4b1ed866d", "7772ce23c23f28596145656855fd02fc", "fb21f3cea1aa051ba2a45e75d46b98b8", "af053352fe1a02ba8010ec7524670ed9", "6dd571b84470ad9caad30a6a6acf491e", "8fbe990c2d493f58a2afa2b746e49c86", "7edd88dd4511a7d5bcb91f2ff177d29d", "e3a82d1db3ae8b189d2e1e0a22d6c82f", "da3d900f8b090c705e8256e1193a18ec", "7946788b175e299415ad9059da03b1b2", "d01781f1246fd1b64e09170bd6600fe1", "38f3bed2635857dc385c5d569bbc88ac", "5446f46d89124462ae7aca4fce420423", "d30cfa003ebfcd4d7c659a73a8dce11e", "8712cea8b5e3ce0073330fd425d34416", "697c515a46484be4f9597cb4f39b2959", "1493d342e7a36553c56b2adea150949e", "ec010868e3e4c47239bf720738e058e3", "ac4d91e919a3ef210a59acab0dbb9ab5", "dc79867623b7929fd055d94456be8ba0", "ac3c25534c076623192b9381f926ba0d", "271554cff73c3843b9282951f2ea7509", "8e67f4c98754a2373a49eaf53425d79a", "efab909e4d089b8f5a73e0b363f471c1", "33a63f09e0962313285c0f0fb654ae11", "8405aa3d86a22301ae62057d818b6b68", "baa9862b027abd61b3e19941e40b1b2d", "0ccc9ec82f1d44c243329014b82d3125", "6a7bff614a1c2fd2901a5bd1d878be59", "b4ddab362a20578dc6ca0bc8cc8ab986", "c843046e54b755ec63ccb09d0a689674", "00c417425a73db5a315d23fac8cb353f", "aae531a922d9cca9ddca3d98be09f9df", "5bac4381c00044d7f4e4cbfd368ba03b", "42f883d029b47f9d490a427091da3f5d", "940cee0d5985960b4ed265a859a7c169", "41f8cd9ac3fb6b1771177e5770537518", "7f399a3362c4a33b5a58e94b8631a3d5", "548f6b23799f9265c01feefc6d86a5d3", "63443027d7b30ef0582778f1c11f36f3"], "SHA1_Hashes": [], "SHA256_Hashes": ["69530d78c86031ce32583c6800f5ffc629acacb18aac4c8bb5b0e915fc4cc4db", "4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6", "c7fc1f9c2bed748b50a599ee2fa609eb7c9ddaeb9cd16633ba0d10cf66891d8a", "62aabce7a5741a9270cddac49cd1d715305c1d0505e620bbeaec6ff9b6fd0260", "eaee62a8238189e8607b24c463a84c83c2331a43b034484972e4b302bd3634d9", "105ee777ad31a58301310719b49c7b6a7e957823e4dabbfeaa6a14e313008c1b", "47bb36cd2832a18b5ae951cf5a7d44fba6d8f5dca0a372392d40f51d1fe1ac34", "394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b", "61c1c8fc8b268127751ac565ed4abd6bdab8d2d0f2ff6074291b2d54b0228842", "128fa5815c6fee68463b18051c1a1ccdf28c599ce321691686b1efa4838a2acd", "772ceedbc2cacf7b16ae967de310350e42aa47e5cef19f4423220d41501d86a5", "bf79622491dc5d572b4cfb7feced055120138df94ffd2b48ca629bb0a77514cc"], "Registry_Entries": ["HKCR\\%ProgId_val%\\shell\\open\\command \n\n4.  The malware then checks to ensure the browser is not LaunchWinApp.exe or is \n\ncompiled for the 64-bit architecture, in which case the path of \n\u201c%PROGRAM_FILESX86%\\Internet Explorer\\iexplore.exe\u201d is used instead.  \n5.  The default browser is then started and the wiper module is injected into the running \n\nbrowser memory.  \n\n6.  After the successful start of the wiper module, the following script is dropped and \n\nexecuted: \u201c%temp%\\C-Dlt-C-Org-T.vbs\u201d \n\n7.  Another temporary file is dropped \u201c%temp%\\C-Dlt-C-Trsh-T.tmp\u201d which contains the \n\nname of the Injector module; this file is deleted after execution is completed. \n\nWScript.Sleep(10 * 1000) \nOn Error Resume Next \nSet WshShell = CreateObject(", "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v Stp /f\u201d \n\nNext, the file C:\\ProgramData\\InternetExplorer\\FileInfoStp.txt is deleted and replaced by the \ncommand: \n\ncmd /c Copy /Y ", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\n\\system. \n\n2.  If the RemoteRegistry system service is disabled and doesn't run on the target system, \n\nthe worm reconfigures this service to be auto-started and then starts it immediately. If \nthe connection to a remote registry is unsuccessful, the worm repeats the connection \nattempt with a hardcoded set of stolen domain administrator credentials. The worm then \nsearches for remote \u201c\\windows\\system32\\csrss.exe\u201d files by prepending this path with \nthe victim machine\u2019s IP as well as system shares: ", "HKCU\\SOFTWARE\\Microsoft\\\nWindows\\CurrentVersion\\Run \n/v Stp /f \n\nThen drop and run C-Un-C-Instl-T.bat with body: \nping 1.1.1.1 -n 5 -w 2000 > nul \nRMDIR /S /Q "], "URLs": ["http://www.eservic.com/"], "weight": 0.0}