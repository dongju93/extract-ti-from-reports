{"rule_id": 184, "name": "taiwant-election-targetting.html", "description": "-", "references": [], "File_Names": ["SunJavaUpdata.exe", "SunJavaUpdataData.lnk", "www.pwc", "blogspot.co", "vecome.exe", "123mail.org", "ka4281x3.log", "wp_ixeshe.pdf", "taiwanthinktank.org", "mhtml.html", "APT.pdf", "IEChecker.exe", "googlemail.com", "iuso.exe", "6EC5.tmp", "wthk.exe", "\u7a0b20160105.xls"], "MD5_Hashes": ["6da1abd5d7ed21a3328d9fdfaf061f24", "2b3a8734a57604e98e6c996f94776086", "7fbdd7cb8b46291e944fcecd5f97d135", "1fd33fe7c2800225bfc270f9ae053b65", "415f5752bf5182b9d108d7478ba950f9", "fb498e6a994d6d53b80c53a05fc2da36", "393dafa8bd5e30334d2cbf23677e1d2e", "44758b9a7a6cafd1b8d1bd4c773a2577", "6b3804bf4a75f77fec98aeb50ab24746", "791931e779a1af6d2e1370e952451aea"], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\Software\\rar\\e\n\nHKCU\\Software\\rar\\s\n\nHKCU\\Software\\rar\\data\n\nHKCU\\Software\\rar\\ActiveSettings\n\nHKCU\\Software\\Classes\\VirtualStore\\MACHINE\\Software\\rar\\e\n\nThe malware establishes persistence by setting an Autorun key called  ctfmon to ensure  IEChecker.exe is\nexecuted on startup.\n\n2015 Information security\n\nbreaches survey\nThe results are in\n\nFigure 3: An AutoRun key is set by the ctfmon process to ensure IEChecker.exe is executed on startup.\n\nThe malware also beacons to the command and control (C2)  192.225.226[.]98 on port 8080 by sending TCP\nSYN packets approximately every 30 seconds.\n\nDynCalc/Numbered Panda/APT12\nThe second sample we came across was an executable named  \u7e3d\u7d71\u8faf\u8ad6\u6703\u5f8c\uff1a\u2ea0\u773e\u653f\u9ee8\u2f40\u6301\u8da8\u52e2\u8b8a\u5316\n(791931e779a1af6d2e1370e952451aea) which translates to \u201cPost presidential debate: support for people\u2019s\npolitical parties changes\u201d. The sample was submitted to VirusTotal by a user in Taiwan on 11th January 2016, five days\nbefore the presidential election.\n\n.exe\n\nFigure 4: Malware was submitted to Virustotal on 11 th January 2016 by a user in Taiwan.\n\nThe binary uses the standard Microsoft Word icon, shown below, to trick users into thinking the file is a legitimate\nMicrosoft Word Document.\n\nFigure 5: The malicious binary with a Word icon.\n\nOn execution, the binary creates a file called  ka4281x3.log in the same directory as the original binary; this file\ncontains encoded data. The naming convention of this file has been reported as distinctive to the IXESHE[3] and the\nrelated Etumbot[4] malware family, and it is based on the behavioral similarity with other Etumbot samples (e.g.\n2b3a8734a57604e98e6c996f94776086) that we believe this attack is associated with APT12.\n\nAside from the .log file, a decoy document is also created and displayed to the victim as shown below. Research on\nthe content of the decoy document shows that the content is likely to have been taken from a presentation with\n\nthe same title, \u201c\u7e3d\u7d71\u8faf\u8ad6\u6703\u5f8c\uff1a\u2ea0\u773e\u653f\u9ee8\u2f40\u6301\u8da8\u52e2\u8b8a\u5316\n\n\u201d, originally written by TaiwanThinkTank. [5] The figure below\n\nshows the same content from the presentation being used in the decoy document. The lack of formatting in the decoy\ndocument suggests that the attacker simply copied and pasted the content from the PDF to create a new Word\ndocument. The similarity of the content is as shown below:\n\nFigure 6: The original presentation from the Taiwan Thinktank [6] titled \u201c \u7e3d\u7d71\u8faf\u8ad6\u6703\u5f8c\uff1a\u2ea0\u773e\u653f\u9ee8\u2f40\u6301\u8da8\u52e2\u8b8a\u5316\n\n\u201d\n\nwith a slide showing the results from the latest opinion poll (left) and the decoy document dropped by the\n\n \n \n \n \n\fIXESHE/Etumbot sample (right).\n\nThe malware then drops a binary called vecome.exe into %Appdata%\\Roaming\\Location and installs an Autorun\nkey to ensure the dropped binary is executed on startup.\n\nFigure 7: An Autorun key is installed to ensure vecome.exe is executed on startup.\n\nSimilar to other IXESHE/Etumbot samples, the malware drops six temporary files in the  %temp% folder:\n\nFigure 8: Six temporary files created by the IXESHE/Etumbot sample.\n\nThe malware communicates with the C2  201.21.94[.]135 on port 443 over SSL. The SSL certificate used is\nassociated with the email address exam@google.com[7] and has the serial   00 8b be a3 a0 a9 1b 1c 78 .\n\nFigure 9: SSL certification is associated with the email address  exam@google.com.\n\nSunOrcal and Surtr\n\nThe last sample we have identified using the Taiwan election theme was a malicious Microsoft Word document named\n2016\u7e3d\u7d71\u9078\u8209\u2ea0\u60c5\u4e2d\u2f3c\u9810\u6e2c\u503c\n.doc (09ddd70517cb48a46d9f93644b29c72f). The content of this file contains two\nblank squares (Figure 10) however, once a self-extracting archive (SFX) is dropped, a separate decoy document is\ndisplayed which contains one line of text that mentions the presidential election.\n\n \n \n \n \n\fFigure 10: The malicious document used to drop a self-extracting archive in  %temp% (top) and the subsequent\ndecoy document displayed to the victim (bottom).\n\nHowever, the sentence is nonsensical and it reads as if the attacker simply concatenated a few unrelated lines\ntogether. Interestingly, a search for the sentences revealed that it had been used as the title of a spear phishing email\nsent to a number of politicians and activists in Hong Kong including James To[8], Tommy Cheung[9] and Joshua\nWong.[10] Wong is a well-known student activist in Hong Kong and he publicly announced on Facebook on 6 th\nJanuary 2016 that he had received the spear phishing email but was not tricked into opening the .rar attachment\n(Figure 11), which shares the same filename as the document file referenced in Figure 10.\n\nFigure 11: A well-known student activist in Hong Kong claimed to have received a spear phishing email with\nan attachment named \u201c2016\u7e3d\u7d71\u9078\u8209\u2ea0\u60c5\u4e2d\u2f3c\u9810\u6e2c\u503c\ndecoy document dropped by the analysed sample.\n\n.rar\u201d. The email title is identical to the line shown in the\n\nExamining the EXIF data of the decoy document dropped by our sample shows that the document was created on the\nsame day as the spear phishing email was sent.\n\nFigure 12: EXIF data of the decoy document highlight the similarity in timing of the attack.\n\nGiven similarities in the theme and text used in the spear phish, as well as the timing of the campaign against the\nHong Kong activist and the creation time of the decoy document, we believe both attacks are likely to be the same.\n\nReturning to the analysis of our sample, once the lure document is executed, a self-extracting archive is dropped and\nexecuted. The archive contains three files, a batch script, a copy of the wget binary and a further binary called\niuso.exe.\n\nFigure 13: The dropped self-extracting archive.\n\nOnce executed, the binaries are dropped in the  %programdata% directory and the batch script is executed to\ndownload the second stage malware from a compromised host kcico[.]com.\n\nFigure 14: Batch script used to download the malware from a compromised website.\n\n \n \n \n \n\fThe downloaded binary wthk.exe is then executed and two new nested directories are generated in\n%programdata%: \u201cJavame\u201d and \u201csun orcal\u201d. Based on the use of this unique folder name \u201c sun orcal\u201d which\ndates back to as early as 2013[11] and which appears to be a misspelling of Sun Oracle, we refer to this malware as\nSunOrcal.\n\nBelow are the full nested paths:\n\nC:\\ProgramData\\Javame\\Java\\Jre\\helper\\113507\n\nC:\\ProgramData\\sun orcal\\java\\JavaUpdata\n\nC:\\ProgramData\\sun orcal\\java\\SunJavaUpdata\n\nOnce wthk.exe is executed, it clones itself to  \\sun orcal\\java\\SunJavaUpdata as a file called\nSunJavaUpdata.exe. In addition, a shortcut called  SunJavaUpdataData.lnk is created in the Javame folder\nwhich points to the malware SunJavaUpdata.exe.\n\nThe purpose of this shortcut became clear when we examined the changes made to the registry. The malware\nmodifies the startup key at HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User\nShell Folder\\ to point to the  \\Javame\\Java\\Jre\\helper\\113507 directory, causing Explorer to execute the\nshortcut when it first loads and which in effect ensures the malware is executed on startup.\n\nFigure 15: SunOrcal persistence mechanism.\n\nAs shown in the batch script, once  wthk.exe has finished executing,  iuso.exe is then executed. Examining the\ncode of this binary shows that the sole purpose of this binary is to sleep for one minute and then execute a binary in\n%programdata% called Keyainst.exe. Unfortunately, we were unable to retrieve this binary.\n\nExamining the network traffic generated by  SunJavaUpdata.exe, we find that the malware communicates with the\nC2 domain safety.security-centers[.]com which resolved to the IP address  210.61.12[.]153 at\n\nthe time of writing. According to DomainTools [12], the domain  security-centers[.]com is associated with two\nemail addresses:\n\nRegistrant email: an_ardyth@123mail.org\n\nAdmin/tech email: janmiller-domain@googlemail.com\n\nInterestingly, the malware stores the C2 in the registry key at  HKCU\\Software\\Google\\info:\n\nFigure 16: C2 information and campaign code stored in registry.\n\nThe figure also shows what appears to be a campaign code \u201c wthkdoc0106\u201d with \u201cwthk\u201d being the malware name,\n\u201cdoc\u201d being the type of document used for malware delivery and \u201c0106\u201d denoting 6th January which is the date of the\nattack, as shown in Figure 11 and Figure 12.\n\nAside from the campaign code, the malware also has a hardcoded mutex \u201c M&BX^DSF&DA@F\u201d:\n\n \n \n \n\fFigure 17: Hardcoded mutex  M&BX^DSF&DA@F.\n\nAnother interesting observable from the malware sample is a call to a DLL function,  FunctionWork, which is\nhardcoded in the malware.\n\nFigure 18: SunOrcal malware calls a function called  FunctionWork which is hardcoded in the malware.\n\nAlthough we were unable to find direct overlap in network infrastructure used by our SunOrcal sample and other threat\nactors, we were able to identify other SunOrcal samples which have shared network infrastructure with the Surtr\nmalware, previously reported by Citizen Labs[13] back in 2013.\n\nIn particular, by finding samples that create the same folder names \u201c javame\u201d and \u201csun orcal\u201d, we came across the\nfollowing SunOrcal samples which shares the same mutex, folder structure, registry paths and calls the DLL function\n\u201cFunctionWork\u201d:\n\n6b3804bf4a75f77fec98aeb50ab24746 (C2: www.olinaodi[.]com)\n\n1fd33fe7c2800225bfc270f9ae053b65 (C2: www.eyesfeel256[.]com)\n\n397021af7c0284c28db65297a6711235 (C2: safetyssl.security-centers[.]com)\n\n415f5752bf5182b9d108d7478ba950f9 (C2: www.eyesfeel256[.]com)\n\nLooking at the WHOIS information of  olinaodi[.]com and eyesfeel256[.]com show that they are registered\nwith the same email address toucan6712@163.com. A reverse WHOIS lookup on the email address returned a total\nof fourteen domains, the majority of which follow related themes such as fly, dream, eyes and feel.\n\nParticularly interesting is flyoutside[.]com which was reported by Citizen Lab in 2013 as a C2 domain associated\nwith the Surtr malware. The Surtr samples associated with this C2 are:\n\n7fbdd7cb8b46291e944fcecd5f97d135\n\n44758b9a7a6cafd1b8d1bd4c773a2577\n\n6da1abd5d7ed21a3328d9fdfaf061f24\n\n \n \n\fFigure 19: List of domains registered using the email address toucan6712@163.com.\n\nBased on the use of the same registrant email address that is associated with only a small number of domains with\nrelated themes in addition to the targeting of Tibet and Hong Kong, both of which are autonomous regions that have\nbeen problematic to China\u2019s internal security, we believe with high confidence that both SunOrcal and Surtr RATs are\nused by the same threat actor. Based on the creation date of some of the domains, we believe the threat actor has\nbeen active as early as 2010.\n\nConclusion\n\nSpear phishing has long been one of the most common and effective ways in which an attacker can deliver malware\non to victim machines to compromise target organisations. The success or failure of this technique relies on the ability\nof attackers to trick victims into opening the malicious attachment and this is why high-profile events and headlines are\noften used as lures.\n\nAs with other high-profile events, the Taiwanese presidential election in January was no different. In this blog post, we\nhave shown that three distinct espionage threat actors have used the election as theme to lure their victims into\nopening the malicious documents. This highlights the importance of security awareness training to ensure staff\nmembers, particularly those with access to sensitive information, remain vigilant in order to help defend against well-\ncrafted spear-phishing attacks.\n\nMichael Yip | Cyber Threat Detection & Response\n +44 (0)20 78043900\n\n @michael_yip \n\n[1] http://www.bloomberg.com/news/articles/2015-12-20/taiwan-opposition-hacked-as-china-s-cyberspies-step-up-attacks-iif2vmh1\n\n[2] See http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/ and, more\n\nrecently, http://researchcenter.paloaltonetworks.com/2015/06/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-\n\nwebsite/\n\n[3] http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf\n\n[4] http://www.arbornetworks.com/blog/asert/wp-content/uploads/2014/06/ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-\n\nEtumbot-APT.pdf\n\n[5] www.taiwanthinktank.org/english/welcome\n\n[6] http://www.taiwanthinktank.org/chinese/page/5/71/3074/0\n\n[7] Note that it is possible to provide a fake address when creating a SSL certificate and so this does not necessarily mean that the attacker\n\ncontrols this email address.\n\n[8] https://en.wikipedia.org/wiki/James_To\n\n[9] https://zh.wikipedia.org/wiki/%E5%BC%B5%E7%A7%80%E8%B3%A2\n\n[10] https://en.wikipedia.org/wiki/Joshua_Wong_(activist)\n\n[11] http://contagiodump.blogspot.co.uk/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html\n\n[12] https://whois.domaintools.com/security-centers.com\n\n[13] https://citizenlab.org/2013/08/surtr-malware-family-targeting-the-tibetan-community/\n\n \n \n \n \n\f\u00ab Cyber security - Are you ready for the new data privacy world? | Main\n\nComments\n\nPost a comment\n\nComments are moderated and will not appear until the author has approved them.\n\nIf you have a TypeKey or TypePad account, please Sign in\n\nName*\n\nEmail*\n\nWebsite\n\n\u00a9 2012-2016 PwC. All rights reserved. PwC refers to the PwC network and/or one or more of its member firms, each of which is a separate legal entity. Please see www.pwc.com/structure for further\ndetails.\n\nPrivacy Statement\n\nCookies info\n\nLegal Disclaimer\n\nProvision of Services\n\nDiversity\n\n \n\f"], "URLs": ["https://whois.domaintools.com/security-centers.com", "http://www.bloomberg.com/news/articles/2015-12-20/taiwan-opposition-hacked-as-china-s-cyberspies-step-up-attacks-iif2vmh1", "https://citizenlab.org/2013/08/surtr-malware-family-targeting-the-tibetan-community/", "https://en.wikipedia.org/wiki/James_To", "http://www.taiwanthinktank.org/chinese/page/5/71/3074/0", "http://researchcenter.paloaltonetworks.com/2015/06/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-", "https://zh.wikipedia.org/wiki/%E5%BC%B5%E7%A7%80%E8%B3%A2", "http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/", "http://contagiodump.blogspot.co.uk/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html", "https://en.wikipedia.org/wiki/Joshua_Wong_(activist)", "http://www.arbornetworks.com/blog/asert/wp-content/uploads/2014/06/ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-"], "weight": 0.0}