{"rule_id": 969, "name": "The Gorgon Group Slithering Between Nation State and Cybercrime", "description": "-", "references": [], "File_Names": ["2999.asp", "new.vbs", "Senate.doc", "svchost32.docx", "zloading.doc", "15.doc", "m25.doc", "testa.doc", "swift.doc", "44.doc", "16.doc", "xchange.doc", "ISI.doc", "14.doc", "ObjectSystem.NeT", "1s.exe", "root.doc", "z.doc", "5.doc", "zxloading.doc", "19.doc", "62.doc", "zloadings.doc", "11.doc", "Confidential.doc", "30.docx", "m.doc", "s.doc", "uae.doc", "kalu.doc", "12.doc", "FM.doc", "6.doc", "18.doc", "Fighter.xlam", "20.doc", "COPY.doc", "RPe.Test", "snoop.do", "7.doc", "khm.vbs", "participants.xlam", "4.doc", "April.doc", "zik.doc", "mm.doc", "10.doc", "4601.asp", "Roll.doc", "Families.ppam", "9.doc"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["446e1c80102c8b9662d66d44525cb9f519369061b02446e0d4cd30cd26d79a25", "5e805a88294f6d25d55103d19d13e798e01ad70e6b89e9c58db5d468cc63b3d5", "84ed59953f57f5927b9843f35ca3c325155d5210824d3b79b060755827b51f72", "649e3922ec53d5b195ed23aac08148faeb561f47e891b1e6ff60a2a9df4fea17", "690fc694b0840dbabb462ae46eb836777420b3354e53a6944a2e169b965b0bec"], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\@RANDOM@\n\nThe main behavior carried out by this Trojan involves obtaining an embedded executable,\nhollowing the current Trojan, writing the new embedded executable to the process memory\nand calling a specific function in the newly written payload. The embedded payload written\nto process memory exists in the \u201cR\u201d resource and called function in the new payload is\nnamed \u201cRPe.Test.Work\u201d. The function will take another executable embedded in the initial\nTrojan as a resource named \u201cM\u201d, which it attempts to inject into the following process to\nexecute:\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\cvtres.exe\n\nWhile it\u2019s configured to inject into cvtres.exe, the Trojan is also capable of injecting its code\ninto the following process as well:\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe\n\nEmbedded injector Trojan\n\nThe R payload discussed above is nothing more than an injector Trojan, which accepts a\npath to an executable and a buffer of code to inject into the process as arguments. The R\npayload will create a process using the supplied path using the CreateProcessA API\nfunction. The payload then finds the base address of the newly created process using the\nGetThreadContext API function, and then calls NtUnmapViewOfSection to hollow the\nprocess. The payload then calls the VirtualAllocEx API to create a buffer in the newly\nhollowed process and the WriteProcessMemory API to write the supplied data buffer that\ncontains the code to inject to this newly created buffer. The payload then sets EIP to the\nentry point of the newly injected code using the SetThreadContext API, and finally calls the\nNtAlertResumeThread API function to run the injected code.\n\nEmbedded Downloader Trojan\n\nThe M payload (referenced previously along with the R payload, above) injected and\nexecuted within the memory space of the other process is a downloader Trojan. This\nspecific downloader appears to have been created using a VB2Exe tool, as the functional\ncode that carries out the downloading functionality exists as a VBScript embedded within\nthe payload. The payload extracts this VBScript from a resource and saves it to a file that it\nextracts from another resource. The filename used to save the VBScript is \u201ckhm.vbs\u201d,\nwhich is eventually run using \u201cwscript\u201d. The VBScript has a SHA256 has of\n649e3922ec53d5b195ed23aac08148faeb561f47e891b1e6ff60a2a9df4fea17, which calls\ntwo PowerShell commands to download and execute a payload and downloading and\nopening of a decoy document. The payload is downloaded from the following location and\nsaved to \u201c%PUBLIC%\\svchost32.exe\u201d:\n\nhxxp://lokipanelhostingpanel[.]gq/work/kh/1s.exe\n\nThe decoy document is downloaded from\nhxxp://lokipanelhostingpanel[.]gq/work/kh/1.docx and saved to\n\u201c%PUBLIC%\\svchost32.docx\u201d. When opened, the decoy document shows the following\n\n22/28\n\n\fcontent, which contains the image and copied text from a news article titled \u201cTop civil-\nmilitary body rejects Nawaz\u2019s controversial statement on Mumbai attacks,\u201d as seen in the\nfollowing screenshot:\n\nFigure 16. Decoy document downloaded by malware\n\nFinal Payload\n\nThe final payload is a dropper Trojan that installs the NanoCore RAT. The author of this\npayload (SHA256:\n690fc694b0840dbabb462ae46eb836777420b3354e53a6944a2e169b965b0bec) appears\nto have used an open source tool called \u201cSaransh Email System\u201d as a basis of this tool,\nwhich was likely downloaded from hxxp://www.a1vbcode[.]com/app-4601.asp. Much like\nthe original payload, this tool uses if/else statements to skip the legitimate code in the\nSaransh Email System source to run the malicious functions, which have the same method\nnames as the original tool and follow the same call sequence:\n\n1.  Form1.Speed\n2.  Form1.diomadnfagaghagh\n3.  Form1.fjcsERIfjfiojsGHIsdifjksi\n4.  Form1.gsgjIDJIGJIGJIGJIFDOSpl\n5.  Form1.FJaioefgkaoeK\n\n23/28\n\n\fThis chain of functions eventually loads a resource named \u2018GSrdofjksrgj\u2019, which the tool\ndecrypts using the same algorithm and key as in the initial payload:\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\nbyte[]array4=newbyte[]\n{\n19,\n129,\n43,\n37,\n56,\n65,\n255,\n75,\n111,\n19,\n211,\n120,\n0,\n49,\n126,\n248\n};\n\nThe decrypted payload has a SHA256 hash of\n5e805a88294f6d25d55103d19d13e798e01ad70e6b89e9c58db5d468cc63b3d5, which is a\nvariant of the NanoCore remote administration tool. This variant of NanoCore was\nconfigured to communicate with the following IP address as its C2 server over TCP port\n6666:\n\n115.186.136[.]237\n\nBitly short URLs and expanded domains\n\nShort Bitly URL\n\nExpanded URL\n\nhttp://bit[.]ly/Loaloding\n\nhttp://www.asaigoldenrice[.]com/daq/doc/2.doc\n\nhttp://bit[.]ly/Loadingnnsa\n\nhttp://onedrivenet[.]xyz/work/docnew/4.doc\n\nhttp://bit[.]ly/2JmQLW6\n\nhttp://stemtopx[.]com/work/doc/13.doc\n\nhttp://bit[.]ly/2JsruKm\n\nhttp://stemtopx[.]com/work/doc/4.doc\n\nhttp://bit[.]ly/2GUaY49\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/3.doc\n\nhttp://bit[.]ly/Loadingnns\n\nhttp://onedrivenet[.]xyz/work/docnew/4.doc\n\nhttp://bit[.]ly/2Im2IOF\n\nhttp://panelonetwothree[.]ml/zico/doc/doc8/zloadings.doc\n\nhttp://bit[.]ly/primeload\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/1.doc\n\nhttp://bit[.]ly/loader2018\n\nhttp://asaigoldenrice[.]com/sim/new.doc\n\nhttp://bit[.]ly/2xZ1kO6wdscsac\n\nhttp://stemtopx[.]com/work/doc/3.doc\n\nhttp://bit[.]ly/2M2bIYh\n\nhttp://stemtopx[.]com/work/doc/root.doc\n\nhttp://bit[.]ly/2r9PSIv\n\nhttp://stevemike-fireforce[.]info/work/doc/11.doc\n\nhttp://bit[.]ly/Loadiendg\n\nhttp://www.0-day[.]us/img/doc/6.doc\n\n24/28\n\n\fhttp://bit[.]ly/2rpmJKsrdtrdtdfysersger\nstrdFCGRDR\n\nhttp://stevemikeforce[.]com/work/doc/7.doc\n\nhttp://bit[.]ly/2Fu4ZSfloading\n\nhttp://panelonetwothree[.]ml/zico/xe/snoop/ocsnoop/snoop.do\nc\n\nhttp://bit[.]ly/2HloaderqVbva\n\nhttp://diamondfoxpanel[.]ml/doc/1/11.doc\n\nhttp://bit[.]ly/Loardising\n\nhttp://onedrivenet[.]xyz/work/docnew/12.doc\n\nhttp://bit[.]ly/2JB3KXD\n\nhttp://stemtopx[.]com/work/doc/8.doc\n\nhttp://bit[.]ly/1_loadingH7TvJa\n\nhttp://diamondfoxpanel[.]ml/doc/1.doc\n\nhttp://bit[.]ly/Loadijging\n\nhttp://onedrivenet[.]xyz/work/docnew/8.doc\n\nhttp://bit[.]ly/Laodiingplease\n\nhttp://onedrivenet[.]xyz/work/docnew/13.doc\n\nhttp://bit[.]ly/2HvQBirEam832ASADx\n\nhttp://stevemike-fireforce[.]info/work/dola/3.doc\n\nhttp://bit[.]ly/2I5T7b9hgvgvjcVYVY\n\nhttp://stevemikeforce[.]com/work/doc/6.doc\n\nhttp://bit[.]ly/paymentsuae\n\nhttp://brevini-france[.]cf/xp/doc/swift.doc\n\nhttp://bit[.]ly/Laodingipleasewait\n\nhttp://www.asaigoldenrice[.]com/daq/doc/10.doc\n\nhttp://bit[.]ly/loadingxxxx\n\nhttp://www.asaigoldenrice[.]com/daq/doc/4.doc\n\nhttp://bit[.]ly/2Gmziko\n\nhttp://zupaservices[.]info/doc/z.doc\n\nhttp://bit[.]ly/2sQhJOO\n\nhttp://stemtopx[.]com/work/doc/6.doc\n\nhttp://bit[.]ly/laodinfokqaw\n\nhttp://stevemike-fireforce[.]info/work/doc/5.doc\n\nhttp://bit[.]ly/loadrinfing\n\nhttp://www.asaigoldenrice[.]com/daq/doc/15.doc\n\nhttp://bit[.]ly/2JaBgAS\n\nhttp://acorn-paper[.]com/administrator/help/7.doc\n\nhttp://bit[.]ly/2loadingqlOQcM\n\nhttp://diamondfoxpanel[.]ml/doc/4/44.doc\n\nhttp://bit[.]ly/loardding\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/11.doc\n\nhttp://bit[.]ly/loidaring\n\nhttps://www.0-day[.]us/img/doc/5.doc\n\nhttp://bit[.]ly/LoadingPleaseWait\n\nhttp://www.asaigoldenrice[.]com/daq/doc/20.doc\n\nhttp://bit[.]ly/2HJv5Ud\n\nhttp://stevemike-fireforce[.]info/work/doc/1.doc\n\nhttp://bit[.]ly/Loading13\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/13.doc\n\nhttp://bit[.]ly/2Lzpjp1\n\nhttp://stemtopx[.]com/work/doc/19.doc\n\nhttp://bit[.]ly/tt_seafood\n\nhttp://acorn-paper[.]com/administrator/help/en-GB/8.doc\n\nhttp://bit[.]ly/Lording\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/7.doc\n\nhttp://bit[.]ly/loadingsmins\n\nhttp://www.asaigoldenrice[.]com/daq/doc/1.doc\n\nhttp://bit[.]ly/2_loadingJwkhJA\n\nhttp://diamondfoxpanel[.]ml/doc/7.doc\n\nhttp://bit[.]ly/Laodiingpleasesa\n\nhttp://onedrivenet[.]xyz/work/docnew/13.doc\n\nhttp://bit[.]ly/2tnW5lu\n\nhttp://stemtopx[.]com/work/newdoc/1.doc\n\nhttp://bit[.]ly/tt_loading\n\nhttp://acorn-\npaper[.]com/administrator/components/com_templates/4.doc\n\n25/28\n\n\fhttp://bit[.]ly/2wzkloading\n\nhttp://panelonetwothree[.]ml/zico/doc/zloading.doc\n\nhttp://bit[.]ly/Loadingans\n\nhttp://onedrivenet[.]xyz/work/docnew/14.doc\n\nhttp://bit[.]ly/2r9jLcQloading\n\nhttp://panelonetwothree[.]ml/zico/doc/zik.doc\n\nhttp://bit[.]ly/loadingpleasewairrs\n\nhttp://stevemike-fireforce[.]info/work/dola/2.doc\n\nhttp://bit[.]ly/2arubabKmpgwP\n\nhttp://panelonetwothree[.]ml/iran/uae/done/oc/uae.doc\n\nhttp://bit[.]ly/2HAwzmN3290293sadjok\nwwadjoW\n\nhttp://stevemike-fireforce[.]info/work/doc/12.doc\n\nhttp://bit[.]ly/loadingasz\n\nhttp://0-day[.]us/img/doc/10.doc\n\nhttp://bit[.]ly/ntissa2vFamys\n\nhttp://acorn-\npaper[.]com/images/locations/thumbnails/oc/m.doc\n\nhttp://bit[.]ly/2IgzmRxEmasidE9kEjidlE http://panelonetwothree[.]ga/work/doc/3.doc\n\nhttp://bit[.]ly/2JqmuWp\n\nhttp://stemtopx[.]com/work/doc/16.doc\n\nhttp://bit[.]ly/load242HmFqZ6\n\nhttp://panelonetwothree[.]ml/simon/exp/oc/mm.doc\n\nhttp://bit[.]ly/2L17QGqloading\n\nhttp://panelonetwothree[.]ml/zico/doc/doc8/zxloading.doc\n\nhttp://bit[.]ly/2MarX5t\n\nhttp://stemtopx[.]com/work/doc/9.doc\n\nhttp://bit[.]ly/Loadingnix\n\nhttp://www.asaigoldenrice[.]com/daq/doc/3.doc\n\nhttp://bit[.]ly/2HyVGGy_loading\n\nhttp://panelonetwothree[.]ml/iran/uae/done/oc1/uae.doc\n\nhttp://bit[.]ly/2H8euros\n\nhttp://acorn-\npaper[.]com/administrator/components/com_templates/views/\n2.doc\n\nhttp://bit[.]ly/2I2mUBFstthdhtrhdtyftfyj http://stevemikeforce[.]com/work/doc/8.doc\n\nhttp://bit[.]ly/Loininding\n\nhttp://www.0-day[.]us/img/doc/8.doc\n\nhttp://bit[.]ly/2F02ZRq\n\nhttp://stevemike-fireforce[.]info/work/doc/2.doc\n\nhttp://bit[.]ly/Loadingpleasewait\n\nhttp://onedrivenet[.]xyz/work/docnew/19.doc\n\nhttp://bit[.]ly/2jE36KjhvjhgkHJHKLHGF\nHJ\n\nhttp://stevemikeforce[.]com/work/doc/3.doc\n\nhttp://bit[.]ly/Waitpleasewait\n\nhttp://stevemike-fireforce[.]info/work/doc/8.doc\n\nhttp://bit[.]ly/Loiading\n\nhttp://fast-cargo[.]com/images/file/newvbs/doc/1.doc\n\nhttp://bit[.]ly/Loadingplasewaitsm\n\nhttp://stevemike-fireforce[.]info/work/doc/3.doc\n\nhttp://bit[.]ly/2jCTHCNasiudhasdASdy7\n656basdu\n\nhttp://stevemikeforce[.]com/work/doc/2.doc\n\nhttp://bit[.]ly/loadingpleaswaitrr\n\nhttp://stevemike-fireforce[.]info/work/doc/4.doc\n\nhttp://bit[.]ly/Loadingnsi\n\nhttp://onedrivenet[.]xyz/work/docnew/2.doc\n\nhttp://bit[.]ly/2JRUNKh\n\nhttp://www.stemtopx[.]com/work/newdoc/3.doc\n\nhttp://bit[.]ly/2Hload25YdU19\n\nhttp://panelonetwothree[.]ml/simon/exp/oc/25/m25.doc\n\nhttp://bit[.]ly/2lording\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/8.doc\n\nhttp://bit[.]ly/2M9lLL6\n\nhttp://stemtopx[.]com/work/doc/15.doc\n\n26/28\n\n\fhttp://bit[.]ly/Loggeding\n\nhttp://fast-cargo[.]com/images/file/newvbs/doc/4.doc\n\nhttp://bit[.]ly/Loadingwaitplez\n\nhttp://stevemike-fireforce[.]info/work/doc/10.doc\n\nhttp://bit[.]ly/ASDj23234j4oDj3234Sdm\nk\n\nhttp://stevemike-fireforce[.]info/work/doc/5.doc\n\nhttp://bit[.]ly/2JloadingspWgLs2\n\nhttp://acorn-\npaper[.]com/components/com_content/models/oc/s.doc\n\nhttp://bit[.]ly/Loadingpleasewaitnn\n\nhttp://stevemike-fireforce[.]info/work/dola/4.doc\n\nhttp://bit[.]ly/2sPe3wZrdtrdytd\n\nhttp://stemtopx[.]com/work/doc/2.doc\n\nhttp://bit[.]ly/LAdooing\n\nhttp://onedrivenet[.]xyz/work/docnew/6.doc\n\nhttp://bit[.]ly/LoadIng\n\nhttp://guelphupholstery[.]com/images/yupsia/doc/62.doc\n\nhttp://bit[.]ly/2JnMVQz\n\nhttp://stemtopx[.]com/work/doc/14.doc\n\nhttp://bit[.]ly/DocumentIsLoadingPleas\newait\n\nhttp://stemtopx[.]com/work/i/2.doc\n\nhttp://bit[.]ly/2HVD1Bh\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/4.doc\n\nhttp://bit[.]ly/2uoqexc\n\nhttp://zupaservices[.]info/doc/1.doc\n\nhttp://bit[.]ly/2vXgnqdASdj2929iqwSdu\n9iw9i\n\nhttp://stevemike-fireforce[.]info/work/doc/13.doc\n\nhttp://bit[.]ly/4_loadingEwHlnA\n\nhttp://diamondfoxpanel[.]ml/doc/4.doc\n\nhttp://bit[.]ly/lLoadingl9\n\nhttp://fast-cargo[.]com/images/file/vb/VBS/doc/9.doc\n\nhttp://bit[.]ly/LlLoadinG\n\nhttps://www.0-day[.]us/img/doc/2.doc\n\nhttp://bit[.]ly/2kTPwmFdrwfdtsfdfyr\n\nhttp://stemtopx[.]com/work/doc/1.doc\n\nhttp://bit[.]ly/2G34tww\n\nhttp://fast-\ncargo[.]com/old/images/file/vb/VBS/smon/doc/testa.doc\n\nhttp://bit[.]ly/2HvQBir\n\nhttp://stevemike-fireforce[.]info/work/dola/3.doc\n\nhttp://bit[.]ly/golden_uae\n\nhttp://fast-\ncargo[.]com/old/images/file/vb/VBS/smon/doc/xchange.doc\n\nhttp://bit[.]ly/pele2HROHp1\n\nhttp://acorn-\npaper[.]com/images/locations/thumbnails/z/oc/z.doc\n\nhttp://bit[.]ly/2rlqLDBMSloading\n\nhttp://panelonetwothree[.]ml/iran/uae/done/oc2/uae.doc\n\nhttp://bit[.]ly/2JDUVMC\n\nhttp://stemtopx[.]com/work/doc/11.doc\n\nhttp://bit[.]ly/2K1GYVgtyfctftfTFTYFUF\ntufutfu\n\nhttp://stevemikeforce[.]com/work/doc/11.doc\n\nhttp://bit[.]ly/2Jr4dby\n\nhttp://stemtopx[.]com/work/doc/18.doc\n\nhttp://bit[.]ly/2M9I8z4\n\nhttp://stemtopx[.]com/work/newdoc/2.doc\n\nhttp://bit[.]ly/ASD8239ASdmkWi38AS\n\nhttp://stevemike-fireforce[.]info/work/dola/4.doc\n\nhttp://bit[.]ly/LoadingPelasewaits\n\nhttp://stevemike-fireforce[.]info/work/docnew/2.doc\n\nhttp://bit[.]ly/2JnNtG7\n\nhttp://stemtopx[.]com/work/doc/17.doc\n\n27/28\n\n\fhttp://bit[.]ly/shawclk2HZJXOr\n\nhttp://panelonetwothree[.]ml/simon/exp/25exp/26/doc/final/26\n.doc\n\nhttp://bit[.]ly/loadijgng\n\nhttp://onedrivenet[.]xyz/work/docnew/9.doc\n\nhttp://bit[.]ly/PleaseWaitLoading\n\nhttp://www.asaigoldenrice[.]com/daq/doc/7.doc\n\nhttp://bit[.]ly/Loadinger\n\nhttp://onedrivenet[.]xyz/work/docnew/1.doc\n\nhttp://bit[.]ly/Workingwait\n\nhttp://onedrivenet[.]xyz/work/docnew/21.doc\n\nhttp://bit[.]ly/Loadingplzwait\n\nhttp://www.asaigoldenrice[.]com/daq/doc/5.doc\n\nhttp://bit[.]ly/2HuOFBQ\n\nhttp://stemtopx[.]com/work/doc/5.doc\n\nhttp://bit[.]ly/LoadingPleasewait1\n\nhttp://onedrivenet[.]xyz/work/docnew/20.doc\n\nhttp://bit[.]ly/LlOrRinding\n\nhttp://www.0-day[.]us/img/doc/11.doc\n\nhttp://bit[.]ly/Loadingwaitplzz\n\nhttp://onedrivenet[.]xyz/work/docnew/16.doc\n\nhttp://bit[.]ly/2HWdrzTgfufuyfkCTYTD\nFYTgtfutf\n\nhttp://bit[.]ly/2KHEnRKxestrhdyhdDTD\nRDTRthdydy\n\nhttp://stevemikeforce[.]com/work/doc/12.doc\n\nhttp://stevemikeforce[.]com/work/doc/10.doc\n\nhttp://bit[.]ly/unkwonas\n\nhttp://asaigoldenrice[.]com/sim/new.vbs\n\nhttp://bit[.]ly/Laodiingpleasewait\n\nhttp://onedrivenet[.]xyz/work/docnew/13.doc\n\nhttp://bit[.]ly/wordxchange\n\nhttp://asaigoldenrice[.]com/sim/doc/kalu.doc\n\nhttp://bit[.]ly/Loadsinfpleasewait\n\nhttp://onedrivenet[.]xyz/work/docnew/30.docx\n\nhttp://bit[.]ly/Loardsing\n\nhttp://www.0-day[.]us/img/doc/7.doc\n\nhttp://bit[.]ly/2ImbyrQ\n\nhttp://acorn-paper[.]com/administrator/6.doc\n\nhttp://bit[.]ly/LoadingPleasewait\n\nhttp://onedrivenet[.]xyz/work/docnew/20.doc\n\nDomains\n\nFor a list of domains encountered in use by malware throughout this campaign, please\nrefer to the following file.\n\nHashes\n\nFor a list of all hashes of malware encountered during this campaign, please refer to the\nfollowing file.\n\n28/28\n\n\f", "HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\publisher\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\publisher\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\publisher\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\publisher\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\publisher\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\VBAWarnings\n\nThe macro also attempts to disable protections provided by the Protected View capability\nwithin Word, Excel, and PowerPoint by setting the following registry keys to a value of 1:\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n1\n0\n1\n1\n1\n2\n1\n3\n1\n4\n1\n5\n1\n6\n1\n7\n1\n8\n1\n9\n2\n0\n2\n1\n2\n2\n\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesIn\nPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachements\nInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocatio\nnsInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesIn\nPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachements\nInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocatio\nnsInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesIn\nPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachements\n\n18/28\n\n\fInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocatio\nnsInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesIn\nPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachements\nInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocatio\nnsInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesIn\nPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachements\nInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocatio\nnsInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInP\nV\n\n2\n3\n2\n4\n2\n5\n2\n6\n2\n7\n2\n8\n2\n9\n3\n0\n3\n1\n3\n2\n3\n3\n3\n4\n3\n5\n3\n6\n3\n7\n3\n8\n3\n9\n4\n0\n4\n1\n4\n2\n4\n3\n4\n4\n4\n5\n\nFirst Stage Payload\n\nThe payload installed by the macro is a downloader Trojan written in VB.NET that\ndownloads a secondary payload and decoy document. It appears the author of this\ndownloader used the source code from an open source tool called \u201cSales System\nApplication\u201d, which is freely available at hxxp://www.a1vbcode[.]com/app-2999.asp. We\nbelieve the author of the downloader uses this Sales System Application to provide a\nlegitimate look to their malicious payload. The malware author adds their own code to the\napplication to run their malicious code before calling the legitimate functions that display\nthe graphical user interface. The following functions are called when the application\nattempts to initialize the menu:\n\n19/28\n\n\f1\n2\n3\n4\n\nETransaksi.Speed();// Legitimate class, but method is the firs\nt\nwrapped functionthat leads tomalicious code\nProjectData.EndApp();// Closes the application before rest of\nlegitimate Sales System Application functions are called\n\nThe \u201cSpeed\u201d method in the legitimate ETransaksi class contains legitimate code from the\nSales System Application; however, the author of this tool includes this code in an if/else\nconstruct that bypasses these instructions by setting a false flag to skip the legitimate code\nand execute the next step to the malicious code. The following code example shows the\nfalse flag being set (5 > 115) and the ETransaksi.diomadnfagaghagh method being called:\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\nintnum=5;\nintnum2=155;\nboolflag=num>num2;\nif(flag)\n{\n<legitimate Sales System Application code>\n}\nelse\n{\nNewLateBinding.LateCall(ETransaksi.diomadnfagaghagh(),null,"], "URLs": ["http://stemtopx[.]com/work/doc/1.doc", "http://bit[.]ly/primeload", "http://bit[.]ly/tt_loading", "http://panelonetwothree[.]ml/iran/uae/done/oc1/uae.doc", "http://bit[.]ly/Loadijging", "http://www.asaigoldenrice[.]com/daq/doc/4.doc", "http://diamondfoxpanel[.]ml/doc/4/44.doc", "http://bit[.]ly/lLoadingl9", "http://acorn-paper[.]com/administrator/help/en-GB/8.doc", "http://bit[.]ly/Workingwait", "http://fast-cargo[.]com/images/file/newvbs/doc/1.doc", "http://bit[.]ly/pele2HROHp1", "http://stevemikeforce[.]com/work/doc/6.doc", "http://www.asaigoldenrice[.]com/daq/doc/15.doc", "http://diamondfoxpanel[.]ml/doc/1/11.doc", "http://bit[.]ly/Loggeding", "http://bit[.]ly/Loadingans", "http://bit[.]ly/loadingpleaswaitrr", "http://bit[.]ly/2F02ZRq", "http://panelonetwothree[.]ga/work/doc/3.doc", "http://bit[.]ly/2Gmziko", "http://bit[.]ly/Loardising", "http://bit[.]ly/unkwonas", "http://bit[.]ly/wordxchange", "http://bit[.]ly/2rlqLDBMSloading", "http://bit[.]ly/2_loadingJwkhJA", "http://stemtopx[.]com/work/doc/3.doc", "http://bit[.]ly/2JRUNKh", "http://bit[.]ly/LoadingPleasewait", "http://bit[.]ly/2lording", "http://onedrivenet[.]xyz/work/docnew/21.doc", "http://bit[.]ly/LoadingPleasewait1", "http://onedrivenet[.]xyz/work/docnew/14.doc", "http://bit[.]ly/2Jr4dby", "http://bit[.]ly/Loadingplzwait", "http://asaigoldenrice[.]com/sim/new.vbs", "http://bit[.]ly/2JsruKm", "http://bit[.]ly/2MarX5t", "http://onedrivenet[.]xyz/work/docnew/9.doc", "http://stemtopx[.]com/work/doc/2.doc", "http://bit[.]ly/DocumentIsLoadingPleas", "http://bit[.]ly/Loardsing", "http://stevemikeforce[.]com/work/doc/12.doc", "http://diamondfoxpanel[.]ml/doc/7.doc", "http://bit[.]ly/loidaring", "http://fast-cargo[.]com/images/file/newvbs/doc/4.doc", "http://diamondfoxpanel[.]ml/doc/4.doc", "http://bit[.]ly/2HuOFBQ", "http://bit[.]ly/Loaloding", "http://bit[.]ly/Laodiingplease", "http://onedrivenet[.]xyz/work/docnew/2.doc", "http://stevemikeforce[.]com/work/doc/11.doc", "http://bit[.]ly/loadingxxxx", "http://stemtopx[.]com/work/doc/5.doc", "http://bit[.]ly/Loiading", "http://bit[.]ly/ASDj23234j4oDj3234Sdm", "http://bit[.]ly/2HvQBirEam832ASADx", "http://fast-cargo[.]com/images/file/vb/VBS/doc/13.doc", "http://bit[.]ly/2JqmuWp", "http://stemtopx[.]com/work/doc/14.doc", "http://onedrivenet[.]xyz/work/docnew/8.doc", "http://fast-cargo[.]com/images/file/vb/VBS/doc/7.doc", "http://www.asaigoldenrice[.]com/daq/doc/3.doc", "http://stemtopx[.]com/work/doc/18.doc", "http://bit[.]ly/LlOrRinding", "http://bit[.]ly/Loadiendg", "http://panelonetwothree[.]ml/iran/uae/done/oc/uae.doc", "http://bit[.]ly/2JnNtG7", "http://bit[.]ly/2Fu4ZSfloading", "http://diamondfoxpanel[.]ml/doc/1.doc", "http://bit[.]ly/LoadingPelasewaits", "http://fast-cargo[.]com/images/file/vb/VBS/doc/8.doc", "http://stevemike-fireforce[.]info/work/dola/4.doc", "http://stevemikeforce[.]com/work/doc/3.doc", "http://panelonetwothree[.]ml/zico/doc/zik.doc", "http://bit[.]ly/loadrinfing", "http://stevemike-fireforce[.]info/work/doc/10.doc", "http://fast-cargo[.]com/images/file/vb/VBS/doc/1.doc", "http://panelonetwothree[.]ml/simon/exp/25exp/26/doc/final/26", "http://onedrivenet[.]xyz/work/docnew/16.doc", "http://bit[.]ly/2Lzpjp1", "http://brevini-france[.]cf/xp/doc/swift.doc", "http://www.0-day[.]us/img/doc/7.doc", "http://bit[.]ly/1_loadingH7TvJa", "http://panelonetwothree[.]ml/zico/xe/snoop/ocsnoop/snoop.do", "http://onedrivenet[.]xyz/work/docnew/19.doc", "http://stemtopx[.]com/work/newdoc/2.doc", "http://www.asaigoldenrice[.]com/daq/doc/1.doc", "http://onedrivenet[.]xyz/work/docnew/13.doc", "http://bit[.]ly/Loadingpleasewait", "http://bit[.]ly/2G34tww", "http://bit[.]ly/2HWdrzTgfufuyfkCTYTD", "http://www.asaigoldenrice[.]com/daq/doc/10.doc", "http://bit[.]ly/Waitpleasewait", "http://bit[.]ly/2HvQBir", "http://bit[.]ly/2rpmJKsrdtrdtdfysersger", "http://bit[.]ly/loadingpleasewairrs", "http://acorn-paper[.]com/administrator/6.doc", "http://bit[.]ly/2H8euros", "http://bit[.]ly/2IgzmRxEmasidE9kEjidlE", "http://bit[.]ly/2I2mUBFstthdhtrhdtyftfyj", "http://zupaservices[.]info/doc/1.doc", "http://stevemike-fireforce[.]info/work/dola/2.doc", "http://bit[.]ly/2JloadingspWgLs2", "http://www.asaigoldenrice[.]com/daq/doc/20.doc", "http://onedrivenet[.]xyz/work/docnew/6.doc", "http://bit[.]ly/LoadIng", "http://guelphupholstery[.]com/images/yupsia/doc/62.doc", "http://bit[.]ly/Loininding", "http://bit[.]ly/golden_uae", "http://bit[.]ly/loadijgng", "http://bit[.]ly/Loadsinfpleasewait", "http://stevemike-fireforce[.]info/work/doc/12.doc", "http://stevemikeforce[.]com/work/doc/8.doc", "http://bit[.]ly/2r9PSIv", "http://bit[.]ly/2jCTHCNasiudhasdASdy7", "http://bit[.]ly/2K1GYVgtyfctftfTFTYFUF", "http://bit[.]ly/Loadingnsi", "http://bit[.]ly/Lording", "http://bit[.]ly/paymentsuae", "http://bit[.]ly/2kTPwmFdrwfdtsfdfyr", "http://panelonetwothree[.]ml/iran/uae/done/oc2/uae.doc", "http://bit[.]ly/2xZ1kO6wdscsac", "http://bit[.]ly/2HyVGGy_loading", "http://bit[.]ly/Loadingwaitplzz", "http://stemtopx[.]com/work/doc/root.doc", "http://acorn-", "http://stevemikeforce[.]com/work/doc/2.doc", "http://bit[.]ly/Loadingpleasewaitnn", "http://bit[.]ly/2HVD1Bh", "http://stemtopx[.]com/work/doc/17.doc", "http://stemtopx[.]com/work/doc/8.doc", "http://panelonetwothree[.]ml/zico/doc/doc8/zxloading.doc", "http://www.0-day[.]us/img/doc/8.doc", "http://bit[.]ly/2KHEnRKxestrhdyhdDTD", "http://bit[.]ly/2L17QGqloading", "http://bit[.]ly/loader2018", "http://bit[.]ly/Loadingnnsa", "http://onedrivenet[.]xyz/work/docnew/4.doc", "http://bit[.]ly/LoadingPleaseWait", "http://bit[.]ly/ASD8239ASdmkWi38AS", "http://bit[.]ly/2JB3KXD", "http://stevemike-fireforce[.]info/work/doc/5.doc", "http://bit[.]ly/2M9I8z4", "http://stemtopx[.]com/work/doc/4.doc", "http://bit[.]ly/shawclk2HZJXOr", "http://bit[.]ly/Loadingnns", "http://bit[.]ly/2sQhJOO", "http://fast-cargo[.]com/images/file/vb/VBS/doc/4.doc", "http://stevemike-fireforce[.]info/work/doc/13.doc", "http://www.asaigoldenrice[.]com/daq/doc/2.doc", "http://zupaservices[.]info/doc/z.doc", "http://bit[.]ly/Loadingnix", "http://bit[.]ly/ntissa2vFamys", "http://bit[.]ly/loardding", "http://bit[.]ly/PleaseWaitLoading", "http://fast-", "http://bit[.]ly/laodinfokqaw", "http://panelonetwothree[.]ml/zico/doc/zloading.doc", "http://bit[.]ly/2M2bIYh", "http://bit[.]ly/2tnW5lu", "http://bit[.]ly/2vXgnqdASdj2929iqwSdu", "http://bit[.]ly/Loadingwaitplez", "http://www.stemtopx[.]com/work/newdoc/3.doc", "http://bit[.]ly/tt_seafood", "http://bit[.]ly/2HJv5Ud", "http://bit[.]ly/4_loadingEwHlnA", "http://stevemikeforce[.]com/work/doc/7.doc", "http://bit[.]ly/Laodiingpleasesa", "http://stemtopx[.]com/work/doc/11.doc", "http://onedrivenet[.]xyz/work/docnew/20.doc", "http://stemtopx[.]com/work/i/2.doc", "http://stemtopx[.]com/work/doc/15.doc", "http://stevemike-fireforce[.]info/work/dola/3.doc", "http://bit[.]ly/2M9lLL6", "http://panelonetwothree[.]ml/simon/exp/oc/25/m25.doc", "http://stemtopx[.]com/work/doc/6.doc", "http://www.asaigoldenrice[.]com/daq/doc/7.doc", "http://lokipanel", "http://stevemike-fireforce[.]info/work/doc/8.doc", "http://stemtopx[.]com/work/doc/13.doc", "http://stevemike-fireforce[.]info/work/doc/4.doc", "http://bit[.]ly/Loadinger", "http://stemtopx[.]com/work/doc/9.doc", "http://www.0-day[.]us/img/doc/11.doc", "http://bit[.]ly/loadingasz", "http://bit[.]ly/2r9jLcQloading", "http://bit[.]ly/Loadingplasewaitsm", "http://bit[.]ly/Laodingipleasewait", "http://bit[.]ly/2HloaderqVbva", "http://stevemike-fireforce[.]info/work/docnew/2.doc", "http://bit[.]ly/2ImbyrQ", "http://bit[.]ly/2I5T7b9hgvgvjcVYVY", "http://asaigoldenrice[.]com/sim/new.doc", "http://www.0-day[.]us/img/doc/6.doc", "http://bit[.]ly/loadingsmins", "http://bit[.]ly/2Hload25YdU19", "http://stevemike-fireforce[.]info/work/doc/1.doc", "http://bit[.]ly/2HAwzmN3290293sadjok", "http://bit[.]ly/2JaBgAS", "http://onedrivenet[.]xyz/work/docnew/12.doc", "http://stevemike-fireforce[.]info/work/doc/11.doc", "http://bit[.]ly/2sPe3wZrdtrdytd", "http://bit[.]ly/2jE36KjhvjhgkHJHKLHGF", "http://bit[.]ly/Laodiingpleasewait", "http://bit[.]ly/2uoqexc", "http://onedrivenet[.]xyz/work/docnew/30.docx", "http://bit[.]ly/2JmQLW6", "http://bit[.]ly/2wzkloading", "http://acorn-paper[.]com/administrator/help/7.doc", "http://bit[.]ly/Loading13", "http://bit[.]ly/2JnMVQz", "http://panelonetwothree[.]ml/simon/exp/oc/mm.doc", "http://fast-cargo[.]com/images/file/vb/VBS/doc/9.doc", "http://stemtopx[.]com/work/newdoc/1.doc", "http://bit[.]ly/2arubabKmpgwP", "http://www.asaigoldenrice[.]com/daq/doc/5.doc", "http://asaigoldenrice[.]com/sim/doc/kalu.doc", "http://stemtopx[.]com/work/doc/19.doc", "http://panelonetwothree[.]ml/zico/doc/doc8/zloadings.doc", "http://bit[.]ly/2loadingqlOQcM", "http://bit[.]ly/LlLoadinG", "http://bit[.]ly/2Im2IOF", "http://fast-cargo[.]com/images/file/vb/VBS/doc/3.doc", "http://stevemikeforce[.]com/work/doc/10.doc", "https://www.0-day[.]us/img/doc/5.doc", "http://0-day[.]us/img/doc/10.doc", "http://onedrivenet[.]xyz/work/docnew/1.doc", "http://stevemike-fireforce[.]info/work/doc/3.doc", "http://bit[.]ly/2JDUVMC", "http://bit[.]ly/LAdooing", "http://fast-cargo[.]com/images/file/vb/VBS/doc/11.doc", "http://stevemike-fireforce[.]info/work/doc/2.doc", "http://bit[.]ly/load242HmFqZ6", "http://bit[.]ly/2GUaY49", "https://www.0-day[.]us/img/doc/2.doc", "http://stemtopx[.]com/work/doc/16.doc"], "weight": 0.0}