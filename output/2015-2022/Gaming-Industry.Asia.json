{"rule_id": 447, "name": "Gaming-Industry.Asia", "description": "-", "references": [], "File_Names": ["gxxservice.com", "xigncodeservice.com", "up_base.php", "Common_Include.php", "Winnti.BN", "cscsrv.dll", "common.php", "dwmsvc.dll", "snmpsvc.dll", "infestexe.com", "Common_bsod.php", "Winnti.AG", "iassrv.dll", "powfsvc.dll", "sspisvc.dll", "namu.wiki", "mprsvc.dll", "slcsvc.dll", "nlasrv.dll", "racsvc.dll"], "MD5_Hashes": [], "SHA1_Hashes": ["dac0bd8972f23c9b5f7f8f06c5d629eac7926269", "a260dcf193e747cee49ae83568eea6c04bf93cb3", "7f73def251fcc34cbd6f5ac61822913479124a2a", "a045939f53c5ad2c0f7368b082aa7b0bd7b116da", "bb4ab0d8d05a3404f1f53f152ebd79f4ba4d4d81", "dde82093decde6371eb852a5e9a1aa4acf3b56ba", "44260a1dfd92922a621124640015160e621f32d5", "8272c1f41f7c223316c0d78bd3bd5744e25c2e9f", "7cf41b1acfb05064518a2ad9e4c16fde9185cd4b", "4256fa6f6a39add6a1fa10ef1497a74088f12be0"], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ImageFlag\n\nWhen the payload is started, the registry value is queried and execution is aborted if set. Perhaps\nthe attackers are trying to reduce the load from their C&C servers by avoiding callbacks from\nuninteresting victims.\n\nSecond stage\n\nBased on ESET telemetry, one of the second stage payload delivered to victims is Win64/Winnti.BN.\nAs far as we can tell, its dropper was downloaded over HTTPS from api.goallbandungtravel[.]com.\nWe have seen it installed as a Windows service and as a DLL in C:\\Windows\\System32 using the\nfollowing file names:\n\ncscsrv.dll\ndwmsvc.dll\niassrv.dll\nmprsvc.dll\nnlasrv.dll\npowfsvc.dll\nracsvc.dll\nslcsvc.dll\nsnmpsvc.dll\nsspisvc.dll\n\nThe samples we have analyzed were actually quite large, each of them about 60 MB. This is,\nhowever, only for appearance because the real size or the PE file is between 63 KB and 72 KB,\ndepending on the version. The malware files simply have lots of clean files appended to them. This is\nprobably done by the component that drops and installs this malicious service.\n\nOnce the service runs, it appends the extension .mui to its DLL path, reads that file and decrypts it\nusing RC5. The decrypted MUI file contains position-independent code at offset 0. The RC5 key is\nderived from the hard drive serial number and the string \u201cf@Ukd!rCto R$.\u201d \u2014 we were not able to\nobtain any MUI files nor the code that installs them in the first place. Thus, we do not know the\nexact purpose of this malicious service.\n\nRecent versions of the malware include an \u201cauto-update\u201d mechanism, using C&C server\nhttp://checkin.travelsanignacio[.]com. That C&C server served the latest version of the MUI files\nencrypted with a static RC5 key. The C&C server was not responding during our analysis.\n\nTargets\n\nLet\u2019s start with who is not targeted. Early in the payload, the malware checks to see if the system\nlanguage is Russian or Chinese (Figure 5). In either case, the malware stops running. There is no way\naround this: the attackers are simply not interested in computers configured with those languages.\n\n4/7\n\n\fFigure 5 Language checks before running the payload\n\nDistribution statistics\n\nESET telemetry shows victims are mostly located in Asia, with Thailand having the largest part of the\npie. Given the popularity of the compromised application that is still being distributed by its\ndeveloper, it wouldn\u2019t be surprising if the number of victims is in the tens or hundreds of thousands.\n\nConclusion\n\nSupply-chain attacks are hard to detect from the consumer perspective. It is impossible to start\nanalyzing every piece of software we run, especially with all the regular updates we are encouraged\nor required to install. So, we put our trust in software vendors that the files they distribute don\u2019t\ninclude malware. Perhaps that\u2019s the reason multiple groups target software developers:\ncompromising the vendor results in a botnet as popular as the software that is hacked. However,\nthere is a downside of using such a technique: once the scheme is uncovered, the attacker loses\ncontrol and computers can be cleaned through regular updates.\n\nWe do not know the motives of the attackers at this point. Is it simply financial gain? Are there any\nreasons why the three affected products are from Asian developers and for the Asian market? Do\nthese  attackers use a botnet as part of a larger espionage operation?\n\n5/7\n\n\fESET products detect this threat as Win32/HackedApp.Winnti.A, Win32/HackedApp.Winnti.B, the\npayload as Win32/Winnti.AG, and the second stage as Win64/Winnti.BN.\n\nIndicators of Compromise (IoCs)\n\nCompromised file samples (Win32/HackedApp.Winnti.A and B)\n\nSHA-1\n\nCompile Time (UTC)\n\nRC4 key\n\nPayload SHA-\n1\n\n7cf41b1acfb05064518a2ad9e4c16fde9185cd4b\n\nTue Nov 13 10:12:58 2018\n\n1729131071\n\n8272c1f4\n\n7f73def251fcc34cbd6f5ac61822913479124a2a Wed Nov 14 03:50:18\n\n19317120\n\n44260a1d\n\n2018\n\ndac0bd8972f23c9b5f7f8f06c5d629eac7926269\n\nTue Nov 27 03:05:16 2018\n\n1729131071\n\n8272c1f4\n\nSome hashes were redacted per request from one of the vendor. If for a particular reason you need\nthem, reach out to us at threatintel@eset.com.\n\nPayload Samples (Win32/Winnti.AG)\n\nSHA-1\n\nC&C server URL\n\na045939f53c5ad2c0f7368b082aa7b0bd7b116da\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php\n\na260dcf193e747cee49ae83568eea6c04bf93cb3\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php\n\ndde82093decde6371eb852a5e9a1aa4acf3b56ba\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/common.php\n\n8272c1f41f7c223316c0d78bd3bd5744e25c2e9f\n\nhttps://nw.infestexe[.]com/version/last.php\n\n44260a1dfd92922a621124640015160e621f32d5\n\nhttps://dump.gxxservice[.]com/common/up/up_base.php\n\nSecond stage samples (Win64/Winnti.BN)\n\nDropper delivered by api.goallbandungtravel[.]com.\n\nSHA-1\n\nCompile Time\n(UTC)\n\nC&C server URL prefix\n\n4256fa6f6a39add6a1fa10ef1497a74088f12be0\n\n2018-07-25 10:13:41 None\n\nbb4ab0d8d05a3404f1f53f152ebd79f4ba4d4d81\n\n2018-10-10 09:57:31\n\nhttp://checkin.travelsanignacio[.]com\n\nMITRE ATT&CK matrix\n\nID\n\nDescription\n\nT1195 Supply Chain Compromise\n\nT1050 New Service\n\nT1022 Data Encrypted\n\nT1079 Multilayer Encryption\n\nT1032 Standard Cryptographic Protocol (RC4,\n\nRC5)\n\n6/7\n\n\fID\n\nDescription\n\nT1043 Commonly Used Port (80,443)\n\nT1009 Binary Padding\n\nMarc-Etienne M.L\u00e9veill\u00e9 11 Mar 2019 - 11:27AM\n\n7/7\n\n\f"], "URLs": ["https://www.facebook.com/infest.[in].[th]", "https://dump.gxxservice[.]com/common/up/up_base.php", "https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php", "https://bugcheck.xigncodeservice[.]com/Common/Lib/common.php", "http://checkin.travelsanignacio[.]com.", "https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php", "http://checkin.travelsanignacio[.]com", "https://namu.wiki/[w]/XIGNCODE"], "weight": 0.0}