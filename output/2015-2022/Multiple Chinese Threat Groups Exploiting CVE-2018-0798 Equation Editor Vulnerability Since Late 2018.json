{"rule_id": 283, "name": "Multiple Chinese Threat Groups Exploiting CVE-2018-0798 Equation Editor Vulnerability Since Late 2018", "description": "-", "references": ["CVE-2018-0798"], "File_Names": ["logo.png", "3.doc", "VPCP.doc", "CApp.php", "BNG.doc", "\u0436\u0430\u0433\u0441\u0430\u0430\u043b\u0442.doc", "c\u1ee5c.doc", "loge.otzo", "Team.doc", "ChromeApp.vbs", "UnIB490.bat", "17.doc", "studies.rtf", "cclerr.wll", "anh.doc", "e.ll", "word.exe", "s.bin", "test.doc", "20181217.doc", "UnIB4A0.bat", "Flag.dat", "APP.doc", "nghi.doc", "IntelGraphicsController.exe", "con\ufb01g.ini"], "MD5_Hashes": ["10348b56b0e3466f9f9fa62bda081c98", "4642e8712c8ada8d56bd36416abb4808", "8621ff472360600ec2a6f7d61a66eeb8", "923d60f3e63c95021f9e99f943fcfbbc", "b82e0ac46f6b812c83a3954038814cce", "6d2e6a61eede06fa9d633ce151208831", "40cfeb699d239652dd4a79c18b1c7366", "4eb14eb23d50b4c7ee768038172f9794", "f333194c19730d6f82ab858210327051", "a5a4046989fa0f99c2076aec3ea0ab2a", "0764ecc46463fb10952d54515c73e6fc", "8408641cfbcdb53e1e6802f07ea32f11", "2ef069d0e3bb636d2d969d3e6a4d5039", "e004daf8e09b56940d6ca6e51974498b", "f1dcf1b2376360c9f0c23f1fb9f4355a", "6bdc73a2fc8506d9e842fc7b7a4123db", "595e30b0c794f47fd768b24ae9caf210", "f0424ed16b435f0c7c802f3a17cbd9de", "bb7aba40c6fc76291fd1cf2c4c558e9f", "a497426d0f65877947e92a14b8a086af", "bcbea5b25356d768fd826e0376268ff5", "e228045ef57fb8cc1226b62ada7eee9b", "36796fabb76eb946d211a2fcf5820929", "ac0eac22ce12eac9ee15ca03646ed70c", "6930bd66a11e30dee1ef4f57287b1318", "600e14e4b0035c6f0c6a344d87b6c27f", "a02712c6cefb532e7928a781fe8d8592", "827c7048c269645ce36546c01c01f93f", "109d51899c832287d7ce1f70b5bd885d", "29027a6d2a38a9a954c1e1315439baf9", "6614a8776692c982ad766d23b2a5ea29", "B72448AF5F58E70C225AB6525126CF8B", "5982ba16356ee8118e4cdbe54d182b11", "2868447eebdf897bdd6b7ce2a18f4609", "7b9d386280da1b840f1b32b85ce74278", "84fca27bc75f40194c95534b07838d6c", "e137b95f6149a8639f6d18e286a0a55f", "0827f48e883f5a59f1c4bf70c98dc42a", "47353a86ea58df3714870e5755056d97", "5271a5ddf476af87c6f833638375c72f", "9AD1DBA92734A53489180788A6B21856", "019debaee6fdf9a9f872277563f0d9ee", "fc47442f175ff7e312a4aa4f5c8745b8", "264cee1c1854698ef0eb3a141912db40", "0e8d3ae263fae7775ccc744a5c0c4dc1", "31283ad09bc7cf618c32a1c893163891", "b2bce665c9bcdf0d3d04dc7ce5e30f79", "51c35cb62a0ad294979b0645e5aa4376", "a99efd6b4b69c55774a16ae157cd20b9", "c65b73dde66184bae6ead97afd1b4c4b", "d648c374439cf5fe9df8dc59eb472067", "67682e25939dce4406f55b6c0c741c0e", "a37df9b230c9d05210613b3c2916328f", "b3f8abe274cb6a5926bd5c3fc2168997", "8f1ab1f96b8322c9e02d87a431a98823", "b72448af5f58e70c225ab6525126cf8b", "853136f00e87a1ab3e2fc3acb309573e", "21d0f19abd15d65aa755e89e55157ae7", "f1824bd902251314a4fd5506caced48b", "af7f59b2b197d454ab8c8a7b0bc371a2", "1690766e844034b3c2ab4f853bd59df7", "a94db3001c0c3fa3cf40bc7fdf9d21b7"], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IntelGraphicsController\n\nFigure 11: Windows Autorun key set for persistence.\n\n5. Drops two batch \ufb01les in the %TEMP% folder named as UnIB490.bat &\n\nUnIB4A0.bat\n\n6. The batch \ufb01les are used to clean up the word document and \u201c.wll\u201d \ufb01le.\n\nFigure 12: Batch script for clearing traces of malicious activities.\n\nPayload MD5: B72448AF5F58E70C225AB6525126CF8B\nC2: 217.69.8[.]255\n\nhttps://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018\n\n12/15\n\n\f7/4/2019\n\nMultiple Chinese Threat Groups Exploiting CVE-2018-0798 Equation Editor Vulnerability Since Late 2018 | Anomali\n\nSample MD5: 6930bd66a11e30dee1ef4f57287b1318 (Emissary Panda)\n\nOn opening the RTF document drops embedded OLE package as \u201cs.bin\u201d in the\n%TEMP% directory. The equation editor loads the bin \ufb01le directly into its memory space\nas code and jumps to it. The code in \u201cs.bin\u201d \ufb01le extracts and load a DLL. It then creates a\ndirectory \u201cC:\\Program Files (x86)\\pcawhere\u201d and writes a \ufb01le named \u201ccon\ufb01g.ini\u201d with a\nunique identi\ufb01er for the victim. After successful execution of malicious code, it tries to\nsend the unique identi\ufb01er of the victim machine to the C2 138.68.133.211 via POST\nrequest over HTTPS.\n\nFigure 13: C2 network communication with victim GUID\n\nThe OLE object had an interesting source path \u201cC:\\\\Users\\\\Iran\\\\Desktop\\\\s.bin\u201d\n\nFigure 14: OLE object shows the originating user name as \u2018Iran\u2019.\n\nC2: 138.68.133.211\nURL: 138.68.133.211:443/ajax\n\nConclusion\n\nAnalysis of the Royal Road weaponizer has resulted in the discovery that multiple\nChinese threat groups started utilizing CVE-2018-0798 in their RTF weaponizer. This\n\ufb01nding con\ufb01rms that the groups, as mentioned in our previous report, are sharing the\nsame exploit supply chain. The groups appear to have been using the Microsoft\nvulnerability exploit exclusively for approximately six months before it began appearing in\ncommodity-malware campaigns. This may indicate that the Chinese groups sold the\nexploit after using it in their malicious campaigns.\n\nhttps://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018\n\n13/15\n\n\f7/4/2019\n\nMultiple Chinese Threat Groups Exploiting CVE-2018-0798 Equation Editor Vulnerability Since Late 2018 | Anomali\n\nThese \ufb01ndings also suggest that the threat groups have robust exploit developing\ncapabilities because CVE-2018-0798 is not widely reported on and it is typically not\nincorporated into publicly available weaponizers.\n\nThreatstream enterprise users can read a more detailed analysis here.\n\nIOCs\n\nFile Hashes (MD5):\ne228045ef57fb8cc1226b62ada7eee9b\n019debaee6fdf9a9f872277563f0d9ee\n0764ecc46463fb10952d54515c73e6fc\n0827f48e883f5a59f1c4bf70c98dc42a\n0e8d3ae263fae7775ccc744a5c0c4dc1\n10348b56b0e3466f9f9fa62bda081c98\n109d51899c832287d7ce1f70b5bd885d\n1690766e844034b3c2ab4f853bd59df7\n21d0f19abd15d65aa755e89e55157ae7\n264cee1c1854698ef0eb3a141912db40\n2868447eebdf897bdd6b7ce2a18f4609\n29027a6d2a38a9a954c1e1315439baf9\n2ef069d0e3bb636d2d969d3e6a4d5039\n31283ad09bc7cf618c32a1c893163891\n36796fabb76eb946d211a2fcf5820929\n40cfeb699d239652dd4a79c18b1c7366\n4642e8712c8ada8d56bd36416abb4808\n47353a86ea58df3714870e5755056d97\n4eb14eb23d50b4c7ee768038172f9794\n51c35cb62a0ad294979b0645e5aa4376\n5271a5ddf476af87c6f833638375c72f\n595e30b0c794f47fd768b24ae9caf210\n5982ba16356ee8118e4cdbe54d182b11\n600e14e4b0035c6f0c6a344d87b6c27f\n6614a8776692c982ad766d23b2a5ea29\n67682e25939dce4406f55b6c0c741c0e\n6930bd66a11e30dee1ef4f57287b1318\n6bdc73a2fc8506d9e842fc7b7a4123db\n6d2e6a61eede06fa9d633ce151208831\n7b9d386280da1b840f1b32b85ce74278\n827c7048c269645ce36546c01c01f93f\n8408641cfbcdb53e1e6802f07ea32f11\n84fca27bc75f40194c95534b07838d6c\n853136f00e87a1ab3e2fc3acb309573e\n8621ff472360600ec2a6f7d61a66eeb8\n8f1ab1f96b8322c9e02d87a431a98823\n923d60f3e63c95021f9e99f943fcfbbc\na02712c6cefb532e7928a781fe8d8592\na37df9b230c9d05210613b3c2916328f\n\nhttps://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018\n\n14/15\n\n\f7/4/2019\n\nMultiple Chinese Threat Groups Exploiting CVE-2018-0798 Equation Editor Vulnerability Since Late 2018 | Anomali\n\na497426d0f65877947e92a14b8a086af\na5a4046989fa0f99c2076aec3ea0ab2a\na94db3001c0c3fa3cf40bc7fdf9d21b7\na99efd6b4b69c55774a16ae157cd20b9\nac0eac22ce12eac9ee15ca03646ed70c\naf7f59b2b197d454ab8c8a7b0bc371a2\nb2bce665c9bcdf0d3d04dc7ce5e30f79\nb3f8abe274cb6a5926bd5c3fc2168997\nb72448af5f58e70c225ab6525126cf8b\nb82e0ac46f6b812c83a3954038814cce\nbb7aba40c6fc76291fd1cf2c4c558e9f\nbcbea5b25356d768fd826e0376268ff5\nc65b73dde66184bae6ead97afd1b4c4b\nd648c374439cf5fe9df8dc59eb472067\ne004daf8e09b56940d6ca6e51974498b\ne137b95f6149a8639f6d18e286a0a55f\nf0424ed16b435f0c7c802f3a17cbd9de\nf1824bd902251314a4fd5506caced48b\nf1dcf1b2376360c9f0c23f1fb9f4355a\nf333194c19730d6f82ab858210327051\nf34514118eb4689560cd6c0c654f26d9\nfc47442f175ff7e312a4aa4f5c8745b8\n\nNetwork IOCs:\n185.234.73[.]4\n138.68.133[.]211\nVvcxvsdvx.dynamic-dns[.]net\nloge.otzo[.]com\n\nAbout the Author\n\nAnomali Labs\n\nCopyright 2019 ANOMALI. \nAll Rights Reserved.\n\nhttps://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018\n\n15/15\n\n\f"], "URLs": ["https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018"], "weight": 0.0}