{"rule_id": 528, "name": "Operation-Potao-Express_final_v2", "description": "-", "references": [], "File_Names": ["Wedding_invitation.exe", "WordAirpost.net", "updater.dll", "PasswordStealer.dll", "mntexpress.com", "diskscanner.dll", "Screen.dll", "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u0435.exe", "WorldAirPost.com", "FilePathStealer.dll", "Poker2.dll", "camprainbowgold.ru", "poolwaterslide2011.ru", "KeyLog2Runner.dll", "WordAirpost.com", "truecryptrussia.ru", "GetAllSystemInfo.dll", "worldairpost.net", "uTorrent.exe", "WorldAirPost.net", "worldairpost.com"], "MD5_Hashes": ["0453B96EB039AFD6C9988C8CB698E7C9"], "SHA1_Hashes": ["04DE076ACF5394375B8886868448F63F7E1B4DB9", "CDDDE7D44EFE12B7252EA300362CF5898BDC5013", "E2B2B2C8FB1996F3A4A4E3CEE09028437A5284AE", "A655020D606CA180E056A5B2C2F72F94E985E9DB", "9BE3800B49E84E0C014852977557F21BCDE2A775", "71A5DA3CCB4347FE785C6BFFF7B741AF80B76091", "1B3437C06CF917920688B25DA0345749AA1A4A46", "4AC999A1C54AE6F54803023DC0FCF126CB77C854", "5D4724FBA02965916A15A50A6937CDB6AB609FDD", "D8837002A04F4C93CC3B857F6A42CED6C9F3B882", "86E3276B03F9B92B47D441BCFBB913C6C4263BFE", "CC3ECFB822D09CBB37916D7087EB032C1EE81AEE", "642BE4B2A87B47E77814744D154094392E413AB1", "4EE82934F24E348696F1C813C24797618286A70C", "84A70CDC24B68207F015D6308FE5AD13DDABB771", "DB966220463DB87C2C51C19303B3A20F4577D632", "0AE4E6E6FA1B1F8161A74525D4CB5A1808ABFAF4", "526C3263F63F9470D08C6BA23E68F030E76CAAF3", "850C9F3B14F895AAA97A85AE147F07C9770FB4C7", "52E59CD4C864FBFC9902A144ED5E68C9DED45DEB", "BB0500A24853E404AD6CA708813F926B90B38468", "D88C7C1E465BEA7BF7377C08FBA3AAF77CBF485F", "A62E69EF1E4F4D48E2920572B9176AEDB0EEB1C6", "FF6F6DCBEDC24D22541013D2273C63B5F0F19FE9", "A4D685FCA8AFE9885DB75282516006F5BC56C098", "94BBF39FFF09B3A62A583C7D45A00B2492102DD7", "CE7F96B400ED51F7FAB465DEA26147984F2627BD", "56F6AC6197CE9CC774F72DF948B414EED576B6C3", "5BEA9423DB6D0500920578C12CB127CBAFDD125E", "324B65C4291696D5C6C29B299C2849261F816A08", "9666AF44FAFC37E074B79455D347C2801218D9EA", "4332A5AD314616D9319C248D41C7D1A709124DB2", "FBB399568E0A3B2E461A4EB3268ABDF07F3D5764", "2CDD6AABB71FDB244BAA313EBBA13F06BCAD2612", "791ECF11C04470E9EA881549AEBD1DDED3E4A5CA", "BA35EDC3143AD021BB2490A3EB7B50C06F2EA40B", "7664C490160858EC8CFC8203F88D354AEA1CFE43", "8839D3E213717B88A06FFC48827929891A10059E", "5BE1AC1515DA2397A7C52A8B1DF384DD938FA714", "422B350371B3666A0BD0D56AEAAD5DEC6BD7C0D0", "971A69547C5BC9B711A3BB6F6F2C5E3A46BF7B29", "B0413EA5C5951C57EA7201DB8BB1D8C5EF42AA1E", "48904399F7726B9ADF7F28C07B0599717F741B8B", "E400E1DD983FD94E29345AABC77FADEB3F43C219", "224A07F002E8DFB3F2B615B3FA71166CF1A61B6D", "8BE74605D90ED762310241828340900D4B502358", "BCC5A0CE0BCDFEA2FD1D64B5529EAC7309488273", "CC9BDBE37CBAF0CC634076950FD32D9A377DE650", "5C52996D9F68BA6FD0DA4982F238EC1D279A7F9D", "2531F40A1D9E50793D04D245FD6185AAEBCC54F4", "18DDCD41DCCFBBD904347EA75BC9413FF6DC8786", "73A4A6864EF68C810C7C699ED51B759CF1C4ADFB", "BB7A089BAE3A4AF44FB9B053BB703239E03C036E", "88D703ADDB26ACB7FBE35EC04D7B1AA6DE982241", "54FEDCDB0D0F47453DD65373378D037844E813D0", "81EFB422ED2631C739CC690D0A9A5EAA07897531", "37A3E77BFA6CA1AFBD0AF7661655815FB1D3DA83", "9654B6EA49B7FEC4F92683863D10C045764CCA86", "12240271E928979AB2347C29B5599D6AC7CD6B8E", "7FBABEA446206991945FB4586AEE93B61AF1B341", "BA5AD566A28D7712E0A64899D4675C06139F3FF0", "F347DA9AAD52B717641AD3DD96925AB634CEB572", "900AD432B4CB2F2790FFEB0590B0A8348D9E60EB", "181E9BCA23484156CAE005F421629DA56B5CC6B5", "EC0563CDE3FFAFF424B97D7EB692847132344127", "F1C9BC7B1D3FD3D9D96ECDE3A46DFC3C33BBCD2B", "E15834263F2A6CCAE07D106A71B99FE80A5F744B", "A9CB079EF49CEE35BF68AC80534CBFB5FA443780", "59C07E5D69181E6C3AFA7593E26D33383722D6C5", "1B278A1A5E109F32B526660087AEA99FB8D89403", "DCBD43CFE2F490A569E1C3DD6BCA6546074FD2A1", "E6D2EF05CEDCD4ABF1D8E3BCAF48B768EAC598D7", "4D5E0808A03A75BFE8202E3A6D2920EDDBFC7774", "76DA7B4ABC9B711AB1EF87B97C61DD895E508232", "5B30ECFD47988A77556FE6C0C0B950510052C91E", "B80A90B39FBA705F86676C5CC3E0DECA225D57FF", "F6F290A95D68373DA813782EF4723E39524D048B", "82F48D7787BDE5B7DEC046CBEF99963EEEB821A7", "855CA024AFBA0DC09D336A0896318D5CC47F03A6", "C02878A69EFDE20F049BC380DAE10133C32E9CC9", "9D584DE2CCE6B654E62573938C2C824D7CC7D0EB", "EB86615F539E35A8D3E4838949382D09743502BF", "639560488A75A9E3D35E4C0D9C4934295072DD89", "F8BCDAD02DA2E0223F45F15DA4FBAB053E73CF6E", "C96C29252E24B3EEC5A21C29F7D9D30198F89232", "2341139A0BC4BB80F5EFCE63A97AA9B5E818E79D", "856802E0BD4A774CFFFE5134D249508D89DCDA58", "8BD2C45DE1BA7A7FD27E43ABD35AE30E0D5E03BC", "A96B3D31888D267D7488417AFE68671EB4F568BD", "92A459E759320447E1FA7B0E48328AB2C20B2C64", "C1D8BE765ADCF76E5CCB2CF094191C0FEC4BF085", "CEBAB498E6FB1A324C84BA267A7BF5D9DF1CF264"], "SHA256_Hashes": [], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run] %LUID%\n\nWin32/Potao \u2013 Architecture\n\nThe Potao trojan features a modular architecture and its functionality can be expanded with \nadditional downloadable plugins.\n\nplugin\n\nplugin\n\nplugin\n\nexplorer.exe\n\nC&C\n\nchrome.exe\niexplore.exe\nSkype.exe\nOpera.exe\n\ufb01refox.exe\nuTorrent.exe\nsafari.exe\n\n\\\\.\\pipe\\\\%name%\n\nFigure 24 \u2013 Win32/Potao architecture\n\n17\n\n\fWhen the malware is installed, its main DLL will be injected into the explorer.exe process. After \nhaving passed a mutex check, this instance will try to inject itself into the address space of several \nrunning legitimate and Internet-facing processes (browsers, Skype and uTorrent). With this setup, \nthe\u00a0instance injected within explorer.exe is responsible for loading and communicating with the \nPotao plugins, while the instances within the Internet-facing processes takes care of communication \nwith the C&C server. The two instances communicate via a named pipe.\n\nPlugins overview\n\nThe Potao main DLL only takes care of its core functionality; the actual spying functions are \nimplemented in the form of downloadable modules. The plugins are downloaded each time \nthe\u00a0malware starts, since they aren\u2019t stored on the hard drive.\n\nWin32/Potao supports two types of plugins. The first type is Full Plugin9 and its export function is \ncalled Plug. The second is Light Plugin with an export function Scan. The difference between the two \ntypes is how they execute and return desired information. Full plugins run continuously until the \ninfected system is restarted, while Light plugins terminate immediately after returning a buffer with \nthe information they harvested off the victim\u2019s machine.\n\nIt is worth mentioning that some of the plugins we observed during our monitoring of the Potao \nbotnet were signed with a certificate issued to \u201cGrandtorg\u201d:\n\nFigure 25 \u2013 GrandTorg certificate details\n\nThe name \u201cGrand Torg\u201d sounds like \u201cGreat Market\u201d in Russian, a rather common term; we \nweren\u2019t able to identify an institution with that name. The certificate Serial Number is: \n0453B96EB039AFD6C9988C8CB698E7C9 and its effective Revocation Time: Aug 19 00:00:00 \n2014 GMT\n\nSince the Revocation Time is the same as the Valid from time, all signatures made with this certificate \nhave been rendered invalid after the revocation request was issued. This strongly suggests that \nthe certificate has only been used for nefarious purposes, as opposed to having been stolen from a \nlegitimate company.\n\nTable 1 contains a list of Potao plugins that we have encountered10.\n\n9)  \u201cFull Plugin\u201d and \u201cLight Plugin\u201d are terms used by the actual malware authors in debug builds of the trojan.\n10)  It is quite possible that we have not seen all existing plugins, so the list may be incomplete.\n\n18\n\n\fFilename\n\nType\n\nGetAllSystemInfo.dll\n\nLight\n\nGetAllSystemInfo.dll\n\nLight\n\nFilePathStealer.dll\n\nFull\n\ntask-diskscanner.dll\n\nFull\n\nKeyLog2Runner.dll\n\nFull\n\nDescription\n\nCollects various kinds of system information, including: system \nidentifying information, proxy and language settings, lists of \nprocesses, installed software, recently opened files, and so on.\n\nThis plugin contains different functionality from the other plugin \nwith the same file name. It collects browsing history from Google \nChrome, Mozilla Firefox and Opera.\n\nEnumerates all drives and creates a list of potentially interesting \nfiles: images and documents. The plugin searches for files with \nthe following extensions: JPG, BMP, TIFF, PDF, DOC, DOCX, XLS, \nXLSX, ODT, ODS.\n\nLike the FilePathStealer.dll plugin, this one also enumerates \npotentially interesting files. It looks for document extensions and \ncommon history, settings and cookie files belonging to Internet \nbrowsers. After the search, the found files are sent to the C&C.\n\nLogs key strokes & clipboard data from most common Internet \nbrowsers and Skype.\n\nPasswordStealer.dll\n\nLight\n\nDecrypts and steals passwords and settings from different \nbrowsers and email clients.\n\nScreen.dll\n\nPoker2.dll\n\nLight\n\nLight\n\nCaptures screenshots.\n\nDisables spreading through USB drives, deletes specific Registry \nkeys, and kills processes belonging to the malware.\n\nloader-updater.dll\n\nLight\n\nUpdates the trojan.\n\nTable 1 \u2013 Win32/Potao plugins\n\nC&C communication protocol\n\nThe Win32/Potao samples that we\u2019ve analyzed contained several different C&C IP addresses \nencrypted in their bodies. For example one sample had the following hard-coded list of IPs, after \ndecryption:\n\n87.106.44.200:8080\n62.76.42.14:443\n62.76.42.14:8080\n94.242.199.78:443\n178.239.60.96:8080\n84.234.71.215:8080\n67.103.159.141:8080\n62.76.184.245:80\n62.76.184.245:443\n62.76.184.245:8080\n\nThe malware randomly picks one of these IP addresses and makes an attempt to establish a \nconnection. As can be seen from the ports in the list above, the HTTP or HTTPs protocols can be used \nfor communication with the remote server.\n\nThe communication uses strong cryptography in two stages. The first stage is the key exchange and \nthe second stage is the actual exchange of data. This simple yet secure communication scheme is \nexplained in Figure 26.\n\n19\n\n\fMALWARE\n\nhas embeded\nin its code:\n\nRSA-2048\npublic key\n\nconnection attempt\n\nC&C SERVER\n\npossesses:\n\nRSA-2048\nprivate key\n\nveri\ufb01es the signature with  \n\nthe RSA-2048 public key\n\nRSA-2048\npublic key\n\nobtains new \n\nRSA-2048\npublic key\n\ngenerates new \n\nAES-256\nsymmetric key\n\nencrypts it with the \nnew RSA-2048 public key \n\nAES-256\nsymmetric key\n\nRSA-2048\npublic key\n\nRSA-2048 private key\n\nRSA-2048\npublic key\n\ndecrypts it with its\nRSA-2048 private key \n\nAES-256\nsymmetric key\n\nobtains the  \n\nAES-256\nsymmetric key\n\nencrypts the request data \nwith AES-256 symmetric key \n\n14\n\ndecrypts the request data \n\nREQUEST DATA\n\n13\n\nREQUEST DATA\n\nFigure 26 \u2013 Potao key exchange and C&C communication scheme\n\n20\n\ngenerates new&signs it with its RSA-2048private key  \n  \n  \n  \n  \n  \n\fWhen the malware first contacts the C&C server (1) it sends a POST-request as shown in the example \nin Figure 27. The data sent is encapsulated using the XML-RPC protocol. Interestingly, the used \nmethodName value 10a7d030-1a61-11e3-beea-001c42e2a08b is always present in Potao traffic that \nwe\u2019ve analyzed.\n\nFigure 27 \u2013 Initial POST request sent to C&C\n\nAfter receiving the request the C&C server generates an RSA-2048 public key (2) and signs this \ngenerated key with another, static RSA-2048 private key (3).\n\nFigure 28 shows an example server response (4):\n\nFigure 28 \u2013 C&C server response with base64-encoded RSA-2048-signed generated RSA-2048 public key\n\nWhen the malware receives this new RSA-2048 key it performs a signature verification using a \ncorresponding static public key, which is embedded in the binary (5). If the signature is correct then \nthe newly-received generated public key (6) will be used to encrypt the next step in communication.\n\n21\n\n\fThe embedded static RSA-2048 public key:\n\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApiLYPP8Z2BPuAqq4IzJ9\nTdSwDFl7IcuHidKRrxyEl8YtbD0rqmPhBL1R50gl5/rUYuT87rhWhvBGUTXxRv4u\nGa7YIs9r0ymdQtmjAXDvbY01U51mK+Hm7894diVBhQ46sznudrJSz82VJXzbZ9NN\nfBUFiDQFj5DijnZJfeR/Jb/DD9oRT+UJNeV1KIQeLZDUFHkC+Vp837roAprSyJpR\n005EtiBgSQ7KO9GSKqxqzE5htdMX74n4kwmw/vRGi/c66a7/XlvCW1l0SWxowXO0\nxqje04bbjzF9CINcvDBuVxlFznCOw5+1MUlO38lHJEpTrrQKSeMBSqMPunVF25At\nKQIDAQAB\n-----END PUBLIC KEY-----\n\nIn the second stage the malware generates a symmetric AES-256 key (7). This AES session key is \nencrypted with the newly received RSA-2048 public key (8) and sent to the C&C server (9).\n\nThe actual data exchange (13) after the key exchange is then encrypted using symmetric \ncryptography, which is faster, with the AES-256 key (12).\n\nLeaving aside the trojan\u2019s implementation of cryptography the actual communication protocol is \nvery simple. The malware sends an encrypted request to the server, as illustrated by the following \n(decrypted) example:\n\nid=4699807581825067201mapt&code=0&sdata=ver:5.1.2600 lv:2.8.0002 comp:COMPUTER \nadm:1 x:0 p:firefox.exe&md5=&dlen=0\n\nThis request contains a computer ID, campaign ID, OS version, version of malware, computer name, \ncurrent privileges, OS architecture (64 or 32bits) and also the name of the current process.\n\nThe server responds with the following data:\n\ncode=%CMD%&data=%PAYLOAD_BASE64_ENCODED%&dlen=%PAYLOAD_LENGTH%&md5=%MD5%\n\nThe code value represents the type of command that the bot is instructed to execute. The possible \ncommands are listed in Table 2:\n\nCommand\n\nDescription\n\n2\n\n3\n\n4\n\nDrop executable to %TEMP% and execute via CreateProcess function\n\nExecute plugin module\n\nDrop executable to %TEMP% and execute via ShellExecuteEx function\n\n0 or 8 or any other\n\nDummy command\n\nTable 2 \u2013 Win32/Potao C&C commands\n\nSpreading via USB\n\nIn several spreading campaigns, the Potao gang has used an additional vector to disseminate the \nmalware: through USB drives.\n\nWhile so-called Autorun-worms11 used to be quite common, Win32/Potao took a different approach \nto USB infections. Instead of dropping an autorun.inf file to the root folder of removable drives, the \nUSB spreading component of Potao uses a different, simple yet effective trick to store its executable \non the USB media. The code responsible for USB infections will copy the Win32/Potao dropper into \nthe root directory of all removable media drives. The filename is selected to match the disk label and \nthe icon for removable media devices is used. At the same time, all other files and folders that were \nalready present on the drive have their attributes set to Hidden and System.\n\n11)  Worms that misused the Windows AutoPlay functionality through autorun.inf files\n\n22\n\n\fFigure 29 \u2013 Trick for spreading via USB removable media\n\nIn effect, with the default Windows settings of hiding file extensions, the user will only see a disk \ndrive icon with the same label as the actual USB drive in Windows Explorer. This social engineering \ntrick has fooled a number of victims into \u201cwillingly\u201d running the malware.\n\nWin32/Potao anti-reverse engineering techniques\n\nThe Potao trojan implements several tricks to make the analysis of the malware harder for reverse-\nengineers. One of them is using hashes of WinAPI functions instead of their names:\n\nFigure 30 \u2013 Loading WinAPI functions through hashes\n\nThis trick is commonly used among various malware families in different implementations; the Potao \nmalware uses the MurmurHash2 algorithm for computing the hashes of the API function names.\n\nAnother trick implemented in the malware is encryption of strings. The decompiled decryption \nalgorithm is shown in Figure 31.\n\n23\n\n\fFigure 31 \u2013 String decryption algorithm\n\nThe strings are encrypted using an XOR operation with 4-byte length key. This key may be different \nin different samples.\n\nWIN32/FAKETC \u2013 FAKE TRUECRYPT ANALYSIS\n\nThe malware described in this section is a different family altogether from Win32/Potao. In this \nsection we describe how the trojanized version of the open-source TrueCrypt software is used to \nexfiltrate files from the espionage victims\u2019 encrypted drives. The relation to Potao is explained in an \nearlier section of the whitepaper.\n\nFigure 32 \u2013 Win32/FakeTC detections by country since June 2015, according to ESET LiveGrid\n\n24\n\n\fFigure 33 shows the interface of the trojanized Russian TrueCrypt application.\n\nFigure 33 \u2013 Trojanized Russian TrueCrypt\n\nThe malicious program code within the otherwise functional TrueCrypt software runs in its own \nthread. This thread, created at the end of the Mount function, enumerates files on the mounted \nencrypted drive, and if certain conditions are met, it connects to the C&C server, ready to execute \ncommands from the attackers.\n\nThe backdoor functionality is only contained within the application\u2019s GUI modules; the digitally signed \nTrueCrypt drivers remained intact.\n\nThe conditions that must be satisfied before the bot contacts the C&C server for commands are:\n\n\u2022  The number of files on the encrypted drive has to be greater than 10\n\u2022  The encrypted drive must have been mounted at least 4 times\n\nThe available commands are listed in Table 3:\n\nCommand\n\nDescription\n\nSleep for 1 second\n\nCollect Windows version, Computer name, Username\n\nEnumerate files on all disks (skipping C:\\Windows and *.exe, *.dll)\n\nidle\n\nwho\n\nlist\n\nlistContainer\n\nEnumerate files on mounted container\n\nrep\n\nfile\n\nfilem\n\nre\n\nrd\n\nSteal password for encrypted container\n\nSteal file\n\nSteal file by mask\n\nDownload and execute file\n\nDownload and execute DLL file (plugin) without storing on disk\n\nTable 3 \u2013 Win32/FakeTC C&C commands\n\n25\n\n\fAs can be seen from the available commands, the Win32/FakeTC malware is a fully featured \nespionage trojan with the ability to extend its capabilities with downloadable plugins. Also, the \nimplemented stealth techniques \u2013 serving the trojanized version only to selected targets, and only \nactivating the malicious functionality for active, long-term TrueCrypt users \u2013 are probably the \nreasons why the malware has been undetected for so long.\n\nCONCLUSION\n\nIn the previous pages we have presented our findings based on ESET detection telemetry and our \nanalysis of Win32/Potao and Win32/FakeTC samples. Potao is another example of targeted espionage \nmalware, a so-called APT, to use the popular buzzword, although technically the malware is not \nparticularly advanced or sophisticated.\n\nOn the contrary, the Potao gang has demonstrated that long-running, effective cyber-espionage can \nbe carried out through carefully devised tricks and social-engineering, without the need for exploits. \nExamples of notable Potao dissemination techniques, some of which were previously unseen, or at \nleast relatively uncommon, include the use of highly-targeted spear-phishing SMS messages to drive \npotential victims to malware download sites and USB worm functionality that tricked the user into \n\u2018willingly\u2019 executing the trojan.\n\nBut perhaps the most intriguing discovery was the connection to the trojanized Russian version of \npopular TrueCrypt encryption software and the truecryptrussia.ru website that both served TrueCrypt \nwith an added backdoor to selected targets, and also acted as a malware C&C server.\n\nAll of the findings presented in this paper indicate very \u201cAPT-like\u201d behavior and specific targeting of \nvictims by the Potao operators. The open question remains: who might be interested in spying on \nboth Ukrainian government and military entities, a news agency, members of a Ponzi scheme popular \nin Russia and Ukraine, and other victims \u2013 known and unidentified?\n\nSince we don\u2019t like to speculate without hard evidence, we\u2019ll leave the question of attribution for an \nopen discussion. Nevertheless, the facts are that several high-value Ukrainian targets were targeted \nby the malware, along with a significant number of victims in other CIS countries, including Russia.\n\n26\n\n\fAPPENDIX A \u2013 COMPARISON WITH BLACKENERGY (THE \nTROJAN USED BY THE SANDWORM / QUEDAGH GROUP)\n\n1st appearance\n\n2011\n\n2007\n\nPotao\n\nBlackEnergy\n\nESET detection \nname\n\nAliases\n\nTargeting\n\nMost targeted \ncountries\n\nNotable targets\n\nDistribution \nvectors\n\nWin32/Potao\n\nWin32/Rootkit.BlackEnergy\n\nSapotao, node69\n\nSandworm, Quedagh\n\nTargeted, mass-spreading debug \nversions\n\nTargeted, but also detected on \ncomputers of a large number of \nvictims\n\nUkraine, Russia, Georgia\n\nUkraine, Poland\n\nUkrainian government & military \ninstitutions, news agency, members \nof MMM pyramid scheme, and others\n\nUkrainian government & military \ninstitutions, companies and \nindividuals in Ukraine and Poland\n\nSpear-phishing, SMS, postal websites, \nexecutables masquerading as Word \nor Excel docs, USB worm, trojanized \nTrueCrypt\n\nSpear-phishing, documents with \nexploits (RTF CVE-2014-1761, PPTS \nCVE-2014-4114, \u2026), executables \nmasquerading as Word or Excel docs, \nparasitic virus, network spreading, \ninfected Juniper installers, Java, \nTeamViewer, \u2026\n\nArchitecture\n\nModular with downloadable plugins Modular with downloadable plugins\n\nDiscovered plugins File stealer, system information \n\ncollector, password stealer, screen \ngrabber, key logger, malware updater, \nUSB worm component\n\nFile stealer, system information \ncollector, password stealer, screen \ngrabber, key logger, malware \nupdater, network discovery & remote \nexecution, parasitic infector, system \ndestroyer, remote login, and so on.\n\nYes, including 0-days (CVE-2014-4114)\n\nYes, in early versions. Not in \nBlackEnergy Lite (v3) variant.\n\nWindows MUI abuse, bypassing \nUAC through shims (MACT), config \nas X.509 certificate, remote access \nwhen TeamViewer installed, use of \nPowerPoint 0-day exploit (CVE-\n2014-4114) for spreading, trojan-\ndownloaders for SCADA ICS systems\n\nno\n\nno\n\nTrojanized TrueCrypt, USB spreading \nmechanism, DLL export function \nname patch\n\nUse of exploits\n\nRootkit, driver \ncomponent\n\nNotable \ntechniques and \nfeatures\n\nC&C \ncommunication \nencryption\n\nAES and RSA-2048\n\nModified RC4\n\nTable 4 \u2013 Similarities and differences between Win32/Potao and Win32/Rootkit.BlackEnergy\n\n27\n\n\fAPPENDIX B \u2013 DETAILS OF WIN32/POTAO SAMPLES & \nCAMPAIGNS\n\nMain DLL PE timestamp\n\nMain DLL Version\n\nCampaign ID \n\nApr 27 09:13:23 2012\n\nMay 12 14:01:30 2012\n\nJun 13 09:11:58 2012\n\nOct 22 13:35:02 2012\n\nNov 13 14:54:20 2012\n\nDec 05 10:37:14 2012\n\nApr 28 11:10:29 2013\n\nMay 30 10:42:17 2013\n\nJun 26 16:53:02 2013\n\nJul 02 12:28:08 2013\n\nAug 27 14:26:59 2013\n\nOct 15 09:31:32 2013\n\nOct 16 09:55:46 2013\n\nOct 18 16:10:47 2013\n\nNov 19 11:14:04 2013\n\nNov 19 11:31:59 2013\n\nFeb 19 09:30:06 2014\n\nApr 08 12:40:43 2014\n\nAug 21 10:54:56 2014\n\nAug 21 14:58:34 2014\n\nSep 02 12:39:46 2014\n\nSep 02 14:22:20 2014\n\nOct 10 12:38:22 2014\n\nOct 15 15:16:44 2014\n\nOct 15 15:22:49 2014\n\nOct 15 15:26:19 2014\n\nOct 15 15:51:31 2014\n\nOct 31 14:58:01 2014\n\nNov 07 14:10:38 2014\n\nNov 10 13:00:43 2014\n\nNov 11 13:46:58 2014\n\nNov 13 11:14:22 2014\n\nNov 19 11:16:33 2014\n\nNov 20 12:29:01 2014\n\nNov 20 12:32:06 2014\n\nNov 21 13:09:55 2014\n\nDec 06 09:31:38 2014\n\nDec 08 13:51:03 2014\n\nDec 15 12:05:05 2014\n\nDec 17 10:02:00 2014\n\nDec 18 09:58:06 2014\n\nDec 18 12:53:18 2014\n\n0\n\n2\n\n2\n\n2.3\n\n2.4\n\n2.4\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.6\n\n2.7\n\n2.6\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.7\n\n2.8.0001\n\n2.8.0001\n\n2.8.0001\n\n2.8.0001\n\n2.8.0001\n\n2.8.0001\n\n28\n\n00km\n\nmmmL\n\nNMMM\n\nGEUN\n\n_NAK\n\nANOS\n\n2804\n\n_nal\n\n_b01\n\nsb01\n\nperm\n\no003\n\nsb02\n\npsih\n\nber1\n\nus11\n\nt001\n\nap01\n\nrk02\n\nrk02\n\nmt01\n\nmtu2\n\nmt01\n\ntk02\n\ncomm\n\nrk02\n\nmtu2\n\nmt01\n\nrk03\n\nmtu3\n\nudif\n\nvou0\n\nrk03\n\nudif\n\nmtu3\n\nrk03\n\nmt10\n\nrk0S\n\nrk0S\n\nmtuS\n\nudi2\n\nrko3\n\n\fMain DLL PE timestamp\n\nMain DLL Version\n\nCampaign ID \n\nJan 20 15:23:34 2015\n\nJan 20 15:27:46 2015\n\nJan 23 10:39:28 2015\n\nFeb 17 13:07:24 2015\n\nFeb 17 13:30:10 2015\n\nMar 03 16:26:36 2015\n\nMar 06 13:33:07 2015\n\nMar 13 12:42:14 2015\n\nApr 16 13:18:08 2015\n\nApr 23 15:43:31 2015\n\nApr 28 08:27:04 2015\n\nMay 20 09:27:20 2015\n\nMay 20 10:21:14 2015\n\nJun 18 10:55:49 2015\n\nJul 16 18:26:08 2015\n\nJul 20 09:16:21 2015\n\n2.8.0001\n\n2.8.0001\n\n2.8.0001\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\n2.8.0002\n\nvouF\n\ndpcF\n\ndpcu\n\ndpcF\n\nrk0F\n\nufbi\n\nufbi\n\ndpcF\n\nmapt\n\nmapt\n\nmapt\n\nmapF\n\ntk03\n\nmapt\n\nmapt\n\nbhaz\n\nTable 5 \u2013 Win32/Potao sample details\n\n29\n\n\fAPPENDIX C \u2013 INDICATORS OF COMPROMISE (IOC)\n\nUsers of ESET security software are fully protected from the Potao malware described in this \npaper. Additionally, ESET will provide further information regarding this threat to any individuals or \norganizations that may be infected \u2013 either currently or in the past.\n\nContact email: threatintel@eset.com\n\nFor convenience, we also uploaded the Potao IOCs to github: https://github.com/eset/malware-ioc/\ntree/master/potao\n\nSHA1 hashes:\n\nEarly Potao versions:\n\n8839D3E213717B88A06FFC48827929891A10059E\n\n5C52996D9F68BA6FD0DA4982F238EC1D279A7F9D\n\nCE7F96B400ED51F7FAB465DEA26147984F2627BD\n\nD88C7C1E465BEA7BF7377C08FBA3AAF77CBF485F\n\n81EFB422ED2631C739CC690D0A9A5EAA07897531\n\n18DDCD41DCCFBBD904347EA75BC9413FF6DC8786\n\nE400E1DD983FD94E29345AABC77FADEB3F43C219\n\nEB86615F539E35A8D3E4838949382D09743502BF\n\n52E59CD4C864FBFC9902A144ED5E68C9DED45DEB\n\n642BE4B2A87B47E77814744D154094392E413AB1\n\nDebug versions:\n\nBA35EDC3143AD021BB2490A3EB7B50C06F2EA40B\n\n9D584DE2CCE6B654E62573938C2C824D7CC7D0EB\n\n73A4A6864EF68C810C7C699ED51B759CF1C4ADFB\n\n1B3437C06CF917920688B25DA0345749AA1A4A46\n\nDroppers with decoy documents:\n\nFBB399568E0A3B2E461A4EB3268ABDF07F3D5764\n\n4D5E0808A03A75BFE8202E3A6D2920EDDBFC7774\n\nBCC5A0CE0BCDFEA2FD1D64B5529EAC7309488273\n\nF8BCDAD02DA2E0223F45F15DA4FBAB053E73CF6E\n\n2CDD6AABB71FDB244BAA313EBBA13F06BCAD2612\n\n9BE3800B49E84E0C014852977557F21BCDE2A775\n\n4AC999A1C54AE6F54803023DC0FCF126CB77C854\n\n59C07E5D69181E6C3AFA7593E26D33383722D6C5\n\nE15834263F2A6CCAE07D106A71B99FE80A5F744B\n\nA62E69EF1E4F4D48E2920572B9176AEDB0EEB1C6\n\n900AD432B4CB2F2790FFEB0590B0A8348D9E60EB\n\n856802E0BD4A774CFFFE5134D249508D89DCDA58\n\nA655020D606CA180E056A5B2C2F72F94E985E9DB\n\n04DE076ACF5394375B8886868448F63F7E1B4DB9\n\n30\n\n\fDroppers from postal websites:\n\n94BBF39FFF09B3A62A583C7D45A00B2492102DD7\n\nF347DA9AAD52B717641AD3DD96925AB634CEB572\n\nA4D685FCA8AFE9885DB75282516006F5BC56C098\n\nCC9BDBE37CBAF0CC634076950FD32D9A377DE650\n\nB0413EA5C5951C57EA7201DB8BB1D8C5EF42AA1E\n\n0AE4E6E6FA1B1F8161A74525D4CB5A1808ABFAF4\n\nEC0563CDE3FFAFF424B97D7EB692847132344127\n\n639560488A75A9E3D35E4C0D9C4934295072DD89\n\nUSB-spreaders:\n\n850C9F3B14F895AAA97A85AE147F07C9770FB4C7\n\nBB0500A24853E404AD6CA708813F926B90B38468\n\n71A5DA3CCB4347FE785C6BFFF7B741AF80B76091\n\n7664C490160858EC8CFC8203F88D354AEA1CFE43\n\n92A459E759320447E1FA7B0E48328AB2C20B2C64\n\nBB7A089BAE3A4AF44FB9B053BB703239E03C036E\n\nDB966220463DB87C2C51C19303B3A20F4577D632\n\n37A3E77BFA6CA1AFBD0AF7661655815FB1D3DA83\n\n181E9BCA23484156CAE005F421629DA56B5CC6B5\n\nA96B3D31888D267D7488417AFE68671EB4F568BD\n\n224A07F002E8DFB3F2B615B3FA71166CF1A61B6D\n\n5D4724FBA02965916A15A50A6937CDB6AB609FDD\n\n8BE74605D90ED762310241828340900D4B502358\n\n5BE1AC1515DA2397A7C52A8B1DF384DD938FA714\n\n56F6AC6197CE9CC774F72DF948B414EED576B6C3\n\nF6F290A95D68373DA813782EF4723E39524D048B\n\n48904399F7726B9ADF7F28C07B0599717F741B8B\n\n791ECF11C04470E9EA881549AEBD1DDED3E4A5CA\n\nE2B2B2C8FB1996F3A4A4E3CEE09028437A5284AE\n\n5B30ECFD47988A77556FE6C0C0B950510052C91E\n\n4EE82934F24E348696F1C813C24797618286A70C\n\nB80A90B39FBA705F86676C5CC3E0DECA225D57FF\n\n971A69547C5BC9B711A3BB6F6F2C5E3A46BF7B29\n\nC1D8BE765ADCF76E5CCB2CF094191C0FEC4BF085\n\n2531F40A1D9E50793D04D245FD6185AAEBCC54F4\n\n31\n\n\fOther droppers:\n\nD8837002A04F4C93CC3B857F6A42CED6C9F3B882\n\nBA5AD566A28D7712E0A64899D4675C06139F3FF0\n\nFF6F6DCBEDC24D22541013D2273C63B5F0F19FE9\n\n76DA7B4ABC9B711AB1EF87B97C61DD895E508232\n\n855CA024AFBA0DC09D336A0896318D5CC47F03A6\n\n12240271E928979AB2347C29B5599D6AC7CD6B8E\n\nA9CB079EF49CEE35BF68AC80534CBFB5FA443780\n\n1B278A1A5E109F32B526660087AEA99FB8D89403\n\n4332A5AD314616D9319C248D41C7D1A709124DB2\n\n5BEA9423DB6D0500920578C12CB127CBAFDD125E\n\nPlugins:\n\n2341139A0BC4BB80F5EFCE63A97AA9B5E818E79D\n\n8BD2C45DE1BA7A7FD27E43ABD35AE30E0D5E03BC\n\n54FEDCDB0D0F47453DD65373378D037844E813D0\n\nCC3ECFB822D09CBB37916D7087EB032C1EE81AEE\n\nF1C9BC7B1D3FD3D9D96ECDE3A46DFC3C33BBCD2B\n\n9654B6EA49B7FEC4F92683863D10C045764CCA86\n\n526C3263F63F9470D08C6BA23E68F030E76CAAF3\n\nE6D2EF05CEDCD4ABF1D8E3BCAF48B768EAC598D7\n\nCEBAB498E6FB1A324C84BA267A7BF5D9DF1CF264\n\n324B65C4291696D5C6C29B299C2849261F816A08\n\nC96C29252E24B3EEC5A21C29F7D9D30198F89232\n\nCDDDE7D44EFE12B7252EA300362CF5898BDC5013\n\n84A70CDC24B68207F015D6308FE5AD13DDABB771\n\nFake TrueCrypt setup:\n\n82F48D7787BDE5B7DEC046CBEF99963EEEB821A7\n\n9666AF44FAFC37E074B79455D347C2801218D9EA\n\nC02878A69EFDE20F049BC380DAE10133C32E9CC9\n\n7FBABEA446206991945FB4586AEE93B61AF1B341\n\nFake TrueCrypt extracted exe:\n\nDCBD43CFE2F490A569E1C3DD6BCA6546074FD2A1\n\n422B350371B3666A0BD0D56AEAAD5DEC6BD7C0D0\n\n88D703ADDB26ACB7FBE35EC04D7B1AA6DE982241\n\n86E3276B03F9B92B47D441BCFBB913C6C4263BFE\n\n32\n\n\fDomain names:\n\ntruecryptrussia.ru\n\nmntexpress.com\n\nworldairpost.com\n\nworldairpost.net\n\ncamprainbowgold.ru\n\npoolwaterslide2011.ru\n\nIP addresses of C&C servers:\n\n78.47.218.234\n\n95.86.129.92\n\n115.68.23.192\n\n67.18.208.92\n\n37.139.47.162\n\n212.227.137.245\n\n62.76.189.181\n\n87.106.44.200\n\n62.76.42.14\n\n94.242.199.78\n\n178.239.60.96\n\n84.234.71.215\n\n67.103.159.141\n\n62.76.184.245\n\n83.169.20.47\n\n148.251.33.219\n\n98.129.238.97\n\n195.210.28.105\n\n198.136.24.155\n\n46.165.228.130\n\n192.154.97.239\n\n5.44.99.46\n\n188.240.46.1\n\n81.196.48.188\n\n74.54.206.162\n\n69.64.72.206\n\n74.208.68.243\n\n46.163.73.99\n\n193.34.144.63\n\n103.3.77.219\n\n119.59.105.221\n\n188.40.71.188\n\n188.40.71.137\n\n108.179.245.41\n\n64.40.101.43\n\n190.228.169.253\n\n194.15.126.123\n\n188.127.249.19\n\n33\n\n\f"], "URLs": ["https://github.com/eset/malware-ioc/"], "weight": 0.0}