{"rule_id": 758, "name": "ESET_Okrum_and_Ketrican", "description": "-", "references": [], "File_Names": ["wnzip.exe", "gpd.exe", "Drives.exe", "tif.exe", "nets.exe"], "MD5_Hashes": [], "SHA1_Hashes": ["2D4713A598831E8F913857729CF4C193CA7B9B2E", "844E710D85DD63AA5BF245CEE94C1CC872429BD3", "054EB61F2CE6DEB4FE011335CD88EBA530B8D09A", "858A9E32DBF619C68E1325590E87670E940B0E45", "86513FE43F2F2D2C486D6265C9098315E774F791", "5FBAFB71CFDF0C93E19882630D05F37C1F756CBF", "6BF0923577FE5939DEA66F466B74683AE2EBBC3E", "1CDC632E0A26F39E527ACF7B1CDECD829A6A2B3D", "4636E5FB97AFA68F60BE9247F5EB9684CA9CDBA6", "77369D3735B3B2C24CCAA93ECAA903D816EA9CD9", "7581337DB29E092101E4FD692D01AA26D65FA40A", "48F8BAFB334C6980FB578C09D7297A4B7F5E09E2", "673F513186C5EFB465EBA1DFCEDE61979972F7FE", "8D7E503D972C03C0F87F2D6F6EF65F1381D21BC6", "58DEA3A56DE1D95353230BE9BBBA582599AFE624", "09B7999160C5D0DC9A7443F0FC248B6C23BC0724", "4C1198F726ACAD7AF78B36F250A128D5E3C52D8C", "10BD61F3FB03632E270FEF3AB6515677405A472F", "D3A96C0FA84BFEE826E175D4664116A169D15D4E", "3FC6F7F66EEDA71B53C32B2086A4D737C94C4BCF", "A426BCC6317F0D49F0F0B68091E8161C512E22C3", "007AB8DF56EC7E9D18A71EC6D15D36912258D94F", "FE2BF0A613482A40CCF84157361054EE77C07960", "DD753FCBAD4BE31066F278585D14C411DB3D7795", "371B14F8BFD9B5DB098139E7FE2EBD4381CB259C", "1C7559C57606B359EEB57F0416FE0B2784C01395", "D3D0DED17D0029DFD90DA2AE74ADA885779E8926", "83A2F4F0E6DFFDFF5420048D9B37011FC50D45B4", "F0E2C3AF0297C80C0A14E95E151FC7DC319ACFC3", "D7DFB547033B82765F8B0A6B70A22A4EC204D7A8", "809C53F71549D83ED8AB5BAB312249212F6F4149", "1D271F22798313650C91C6FC34551CC8492A2019", "233FF39DDE5A13CBF78EC1E9C020CF3CF18084E7", "B49EDC05658907C888074905CE234BF3CF58D8A0", "AD740FD11688B2B39072C7024679CC22878E2619", "65E3947144F6A3C31BC88E445514A83FCB331AFD", "F42A9D85ABE04E721461FE2B52DDC9E0EA411D9E", "43A4CC528134E218B9CEC2FF0C24B5912BF5C032", "E9D01DA30DA5FAE2EE333A8E446F0232E60AD8D9", "94E6CB95585DBB59A61EC4029BC7EBB30BBA57E5", "9D41B44AF5BAAF581C0D9D7BEF466213BD8BE01A", "AB7F63649BBC53E45DEEB7269BEBD54815AE9E27", "1730D90FFB888877EA2F18198BCC592087218E9A", "2748A2928B6A4A528709ABA20AEF93D1EC9010F9", "3314780AB1C782D1B226BEAEE9DE16E9BEB00FD0", "A23EE1F17B746C1907293C7F8155E3E7DE135648", "38299BCF0BA25E331939683597F161A3D7121A26", "C1C89A1A1779515EC1DFD0EFFF293615D523279E"], "SHA256_Hashes": [], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell \n\nFolders]\n\nThe Shell Folders registry key is only supported by Windows for backwards compatibility and is not the \nrecommended way to access these folders  It is a rather unusual technique to use this key and that links \n\nthe samples used in operation Ke3chang to the samples discovered in 2015 \n\n4.1.2  ANTI-EMULATION/ANTI-SANDBOX TRICK\n\nOne of the artifacts shared among the analyzed samples is a heuristic to detect an emulated \nenvironment or a sandbox  The GetTickCount function is called before and after a loop with \n999,999,990 iterations of incrementing a value  If the returned value doesn\u2019t change between calls, \n\nemulation or a sandbox is detected and the process terminates itself \n\nAccording to the FireEye report, at least one of the BS2005 samples from operation Ke3chang contained \n\nthe very same heuristic  We were able to locate the same heuristic in all Ketrican backdoors discovered \n\nin 2015, as Figure 8 depicts \n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f13\n\nFigure 8 // A trick to detect an emulated environment or a sandbox \n\n4.1.3  NETWORK COMMUNICATION\n\nJust like the BS2005 family, the 2015 Ketrican samples control the Internet Explorer browser process \nusing the IWebBrowser2 COM interface, to make their network communication look legitimate  Data is \nencrypted and encoded, and sent using the HTTP protocol \n\nThe response from the server is an HTTP page with backdoor commands and arguments included in a \n\nhidden input field   This data is expected to have a specific format that varies across the samples, but \n\nthe same pattern is used, as shown in Figure 9 \n\nFigure 9 // Specific format of data received from the C&C server in samples \nfrom operation Ke3chang (left) and 2015 Ketrican samples\n\n4.1.4  DATA TRANSFORMATION\n\nIn the BS2005 malware samples, a specific two-step transformation is used for the data before it is sent \n\nto a remote server  First, the data is encrypted with a custom algorithm and then it is URL-safe, base64 \n\nencoded, meaning that all \u201c+\u201d characters are replaced with \u201c*\u201d characters, which allows the data to be \n\ntransmitted as a part of the URL \n\nIn one of the samples, the following encryption algorithm is used:\n\n\u2022  Each byte has 0x27 plus its positional index byte added to it\n\n\u2022  The byte is then XORed with its positional index byte\n\nThe same transformation is used in other samples from operation Ke3chang, except that constants \n\nother than 0x27 are used  In the samples discovered in 2015, the malware authors continued with this \n\npractice, as shown in Figure 10  Ketrican 2015 backdoors also use the combination of encryption and this \n\nURL-safe, base64 encoding and similarly vary the encryption method \n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f14\n\nIn some of the samples, a similar weak-encryption algorithm is used except that the constant is \n\nsubtracted instead of being added  In yet other samples, the encryption algorithm has been changed to \n\nAES \n\nFigure 10 // Encryption algorithm used in a BS2005 sample and in a Ketrican backdoor discovered in 2015 \n\n4.1.5  FURTHER ATTRIBUTION CONSIDERATIONS\n\nOur conclusions about the backdoors discovered in 2015 were also confirmed in a later Palo Alto \n\nNetworks report about a malware family they call TidePool, which included two of the samples we \nanalyzed8  The Palo Alto Network researchers claim the TidePool malware family is an evolution of \n\nBS2005 malware family, which is in accordance with our findings \n\nHowever, this fact alone would not be enough to attribute the malware samples detected in 2015 to \n\nthe Ke3chang group, since we have to consider the possibility of malware reuse between different APT \n\ngroups  As also stated in the FireEye report, the source code used in operation Ke3chang is likely shared \n\namong different developers or teams of developers  Thus, we cannot assume that anybody who uses \n\nthis malware is automatically the Ke3chang group \n\nNevertheless, we can confirm that the threat actor behind the samples discovered in 2015 had the same \n\nobjectives and targeted the same type of organizations as the Ke3chang threat actor \u2013 diplomatic \n\norganizations and missions  This leads us to believe the group behind the Ketrican samples ESET \n\ndiscovered in 2015 is indeed the same actor that was behind operation Ke3chang \n\n4.2  Ke3chang activity in 2017 \u2013 Ketrican\n\nThe Ketrican samples from 2015 described in the previous section and Okrum samples from 2017 could \n\neasily look like being part of two independent operations targeted against the same organizations  \n\nHowever, we discovered a direct link between the two malware families - one of the Okrum backdoors9 \n\nwas used to drop a 2017 Ketrican sample10 \n\nThis dropped backdoor had a PE Timestamp set to Aug 08 2017 that, according to our telemetry, appears \n\nto be valid  Our analysis showed it was \u2013 again \u2013 an evolution of backdoors used in operation Ke3chang, \n\nexhibiting the same coding style with several improvements  At some point, the attackers appear to \n\nhave switched the Okrum backdoor to a freshly compiled Ketrican sample \n\nThe samples detected in 2017 closely resemble BS2005 backdoors from operation Ke3chang  The same \n\nset of commands and methods of network communication are supported, and the main features remain \n\nunchanged \n\n8  SHA-1: 2748A2928B6A4A528709ABA20AEF93D1EC9010F9, 809C53F71549D83ED8AB5BAB312249212F6F4149\n9  SHA-1: 1D271F22798313650C91C6FC34551CC8492A2019\n10  SHA-1: D3BFB10DB08C6828C3001C1F825ED6A6BF6F6E01\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f15\n\nAgain, the authors continued to update the same parts of code as we have witnessed before  The \nspecial folder used as a working directory was updated to a new value (from Local Appdata/Local \nSettings to Templates/AppData) \n\nBefore the collected data is sent to a C&C server (using the very same technique as in the BS2005 \n\nmalware), it undergoes the same transformation where encryption is combined with the same URL-safe \n\nbase64 encoding  The encryption routine was updated to AES or RC4 \n\nThe authors also continue to use campaign names to keep track of the ongoing operations and to \n\nidentify victims  Table 5 lists the IoCs extracted from the Ketrican samples detected in 2017 \n\nSHA-1\n\nPE Timestamp\n\nC&C server\n\nURI\n\nCampaign Name\n\n58DEA3A56DE1D95353230BE9BBBA582599AFE624\n\n2009-01-14\n\nforcan hausblow[ ]com\n\nFE2BF0A613482A40CCF84157361054EE77C07960\n\n2016-12-19\n\nlogin allionhealth[ ]com\n\n-\n\n-\n\nblue\n\nlogin\n\nD3BFB10DB08C6828C3001C1F825ED6A6BF6F6E01\n\n2017-08-08\n\nbuy babytoy-online[ ]com\n\nregion\n\nfvejautoexp\n\n2C8B145EF5AC177C99DFCB8C0221E30B3A363A96\n\n2017-08-08\n\nnewflow babytoy-online[ ]com\n\n-\n\nblue\n\nD8AA9E4918E464D00BA95A3E28B8707A148EC4D7\n\n2017-08-09\n\nbuy babytoy-online[ ]com\n\nregion\n\nfvejautoexp\n\n9D41B44AF5BAAF581C0D9D7BEF466213BD8BE01A\n\n2017-08-10\n\npress premlist[ ]com\n\nF2BFDA51BDA3EE57878475817AF6E5F24FFBBB28\n\n2017-08-23\n\nitems babytoy-online[ ]com\n\n-\n\n-\n\npress\n\nblue\n\nTable 5 // IoCs extracted from the analyzed Ketrican samples discovered by ESET in 2017\n\n4.3  Ke3chang activity in 2017 \u2013 RoyalDNS \n\nIn 2017, the entities affected by the Ketrican 2015 and Okrum backdoors were targeted with a variation \n\nof the RoyalDNS malware, which has already been attributed to the Ke3chang group  Its main \n\ncharacteristic is using the DNS protocol to communicate with the C&C server \n\nThe RoyalDNS sample from the NCC Group report was compiled on June 3, 2017 while the data in the \n\nPE header of the newly discovered sample point to a more recent date, September 25, 2017  Both \n\nof the samples export the same functions, as seen in Figure 11, and use the very same rare type of \n\ncommunication with the C&C server \n\nFigure 11 // The functions exported by the RoyalDNS backdoors\n\nTo communicate with the C&C server, a list of locally configured DNS servers is retrieved, and then \n\nthe malware queries for specific TXT records of a C&C domain  The response from the DNS server \n\nencapsulates the backdoor commands  An example of such a DNS query packet is illustrated in Figure \n\n12  The new RoyalDNS sample uses a different domain name than the original one:\n\n\u2022  menorustru[ ]com\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f16\n\nFigure 12 // DNS query as a method to communicate with the C&C server\n\n4.4  Ke3chang activity in 2018 \u2013 Ketrican\n\nIn 2018, we discovered new Ketrican samples  Among all the versions of the Ketrican backdoors we\u2019ve \n\nfound, these have evolved the most \n\nAn option to load a DLL was added to the traditional set of supported commands  The encryption \n\nalgorithm has been replaced with the XOR cipher (volume serial number of the C volume is used as the \n\nkey) \n\nThe 2018 Ketrican backdoors use the same method of network communication as the samples from \nthe BS2005 family \u2013 a combination of an HTTP request made via an instance of IWebBrowser2 COM \nobject and response HTML pages with hidden input fields  What is different is that instead of using the \nCoCreateInstance API function to create the COM object instance directly, a registration-free COM \ntechnique is used \n\nFinally, the 2018 Ketrican backdoors share another feature common for Ke3chang group backdoors  They \n\nare known to modify specific registry keys and values in order to weaken some security settings of the \n\ncompromised machine, which can help them further extend their malicious capabilities to provide those \n\nnot available via the backdoor itself \n\nFor example, Internet Explorer Enhanced Security configuration can be disabled by setting the following \n\nregistry value:\n\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\\n\nZoneMap]\n\n\u201cIEHarden\u201d = 0\n\nBy setting this value, prevention of script execution and other valuable protections are disabled \n\nThis is not a new feature; the same set of registry keys is changed in BS2005 and Tidepool malware families, \n\nand in the Ketrican samples discovered in 2015, 2017 and 2018  The samples from 2018 are, however, the \n\nfirst ones to use PowerShell scripts to modify the keys  The older versions of the malware used registry \nAPI functions or the reg.exe utility for that \n\nSHA-1\n\nPE Timestamp\n\nC&C server\n\nURI\n\nCampaign Name\n\nC1C89A1A1779515EC1DFD0EFFF293615D523279E\n\n2018-02-01\n\ndsmanfacture privatedns[ ]org\n\n09B7999160C5D0DC9A7443F0FC248B6C23BC0724\n\n2018-07-17\n\ncompatsec[ ]com\n\n6BF0923577FE5939DEA66F466B74683AE2EBBC3E\n\n2018-07-17\n\ncompatsec[ ]com\n\n-\n\n-\n\n-\n\n-\n\n-\n\n-\n\nTable 6 // IoCs extracted from 2018 Ketrican samples\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE \n\f17\n\n4.5  Ke3chang activity in 2019 \u2013 Ketrican\n\nIn March 2019, we detected two new Ketrican samples, one of which was similar to the 2018 Ketrican \n\nbackdoor, and the other that has evolved from it  The previous Ketrican samples and the samples \n\ndetected in 2019 largely overlap in commands, network communication, and obfuscation  The 2019 \n\nversion also modifies the same rare combination of registry values as all earlier Ketrican samples, which \n\nis explained in the section above  \n\nThere is one noteworthy difference between the previous Ketrican samples and the 2019 ones: instead \nof executing a new cmd.exe process for each PowerShell command (i e  to change every registry value), \nthere is only one instance of the process, which communicates with the malware over anonymous \n\npipes \n\nSHA-1\n\nPE Timestamp\n\nC&C server\n\nURI\n\nCampaign Name\n\nD98D258C234F5CEAD43FD897613B2EA2669AA7C0\n\n2019-01-28\n\nchart healthcare-internet[ ]com\n\nCE94EC2CFB23D8C662F558C69B64104C78B9D098\n\n2019-04-25\n\ninicializacion[ ]com\n\n-\n\n-\n\n-\n\ncion\n\nTable 7 // IoCs extracted from 2019 Ketrican samples\n\n5  CONCLUSION\n\nThe Ke3chang APT group (a k a  APT15) has rightfully been on the radar of security researchers because \n\nof its decade-long operation, targeting high-value victims such as diplomatic entities, and other \n\ngeopolitical aspects associated with them \n\nWhile ESET does not engage in attribution of these activities to a particular nation-state, we do attempt \n\nattribution of individual malware-driven cyberattacks to a particular APT group  \n\nIn this paper we have documented the previously unknown malware, Okrum, detected by ESET in \n\nSlovakia, Belgium, Chile, Guatemala and Brazil, documented other suspected Ke3chang activity (using \n\nthe Ketrican and RoyalDNS malware families), and provided evidence that drives us to the conclusion \n\nthat all of this is indeed the work of the Ke3chang threat actor \n\nJust like other known Ke3chang malware, Okrum is not technically complex, but we can certainly \n\nsee that the malicious actors behind it were trying to remain undetected by using tactics such as \n\nembedding the malicious payload within a legitimate PNG image, employing several anti-emulation and \n\nanti-sandbox tricks, as well as making frequent changes in implementation  As for the analyzed Ketrican \n\nsamples, these show visible evolution and code improvements from 2015 to 2019  \n\nWhat remains to be answered is how the malware was distributed to the victim machines  \n\nESET will continue to track the malicious activities of the Ke3chang threat group  \n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f18\n\n6  INDICATORS OF COMPROMISE (IOCS)\n\n6.1  Okrum\n\n6.1.1  ESET DETECTION NAMES\n\n\u2022  Win32/Okrum A\n\n\u2022  Win32/Okrum B\n\n\u2022  Win32/Okrum C\n\n\u2022  Win32/Okrum D\n\n\u2022  Win32/Okrum E\n\n\u2022  Win32/Okrum F\n\n\u2022  Win32/Okrum G\n\n\u2022  Win32/Okrum H\n\n\u2022  Win32/Okrum I\n\n6.1.2  SHA-1\n\n\u2022 1CDC632E0A26F39E527ACF7B1CDECD829A6A2B3D\n\n\u2022 1D271F22798313650C91C6FC34551CC8492A2019\n\n\u2022 371B14F8BFD9B5DB098139E7FE2EBD4381CB259C\n\n\u2022 38299BCF0BA25E331939683597F161A3D7121A26\n\n\u2022 48F8BAFB334C6980FB578C09D7297A4B7F5E09E2\n\n\u2022 5FBAFB71CFDF0C93E19882630D05F37C1F756CBF\n\n\u2022 8D7E503D972C03C0F87F2D6F6EF65F1381D21BC6\n\n\u2022 A426BCC6317F0D49F0F0B68091E8161C512E22C3\n\n\u2022 AD740FD11688B2B39072C7024679CC22878E2619\n\n\u2022 F0E2C3AF0297C80C0A14E95E151FC7DC319ACFC3\n\n\u2022 F42A9D85ABE04E721461FE2B52DDC9E0EA411D9E\n\n6.1.3  C&C SERVERS\n\n\u2022  finance globaleducat[ ]com\n\n\u2022  support slovakmaps[ ]com\n\n\u2022  misiones soportesisco[ ]com\n\n6.1.4  MUTEX NAMES\n\n\u2022  qDJsxrGpPacRndLdsdIoqesGBv\n\n\u2022  SnpcnSHPPxsdfcwzEkmtdv\n\n\u2022  zSpgnEHPPcvAltcFzlIscD\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f19\n\n6.2  Ketrican\n\n6.2.1  ESET DETECTION NAMES\n\n\u2022  Win32/Ketrican A\n\n\u2022  Win32/Ketrican B\n\n\u2022  Win32/Ketrican C\n\n\u2022  Win32/Ketrican D\n\n\u2022  Win32/Ketrican E\n\n\u2022  Win32/Ketrican F\n\n\u2022  Win32/Ketrican G\n\n\u2022  Win32/Ketrican H\n\n\u2022  Win32/Ketrican I\n\n\u2022  Win32/Ketrican J\n\n\u2022  Win32/Ketrican K\n\n\u2022  Win32/Ketrican L\n\n\u2022  Win32/Ketrican M\n\n\u2022  Win32/Ketrican N\n\n\u2022  Win32/Ketrican O\n\n\u2022  Win32/Ketrican P\n\n\u2022  Win32/Ketrican Q\n\n\u2022  Win32/Ketrican R\n\n\u2022  Win32/Ketrican S\n\n\u2022  Win32/Ketrican T\n\n6.2.2  KETRICAN 2015\n\n6.2.2.1  SHA-1\n\n\u2022 054EB61F2CE6DEB4FE011335CD88EBA530B8D09A\n\n\u2022 10BD61F3FB03632E270FEF3AB6515677405A472F\n\n\u2022 1730D90FFB888877EA2F18198BCC592087218E9A\n\n\u2022 1C7559C57606B359EEB57F0416FE0B2784C01395\n\n\u2022 233FF39DDE5A13CBF78EC1E9C020CF3CF18084E7\n\n\u2022 2748A2928B6A4A528709ABA20AEF93D1EC9010F9\n\n\u2022 43A4CC528134E218B9CEC2FF0C24B5912BF5C032\n\n\u2022 4636E5FB97AFA68F60BE9247F5EB9684CA9CDBA6\n\n\u2022 4C1198F726ACAD7AF78B36F250A128D5E3C52D8C\n\n\u2022 65E3947144F6A3C31BC88E445514A83FCB331AFD\n\n\u2022 7581337DB29E092101E4FD692D01AA26D65FA40A\n\n\u2022 77369D3735B3B2C24CCAA93ECAA903D816EA9CD9\n\n\u2022 809C53F71549D83ED8AB5BAB312249212F6F4149\n\n\u2022 844E710D85DD63AA5BF245CEE94C1CC872429BD3\n\n\u2022 86513FE43F2F2D2C486D6265C9098315E774F791\n\n\u2022 94E6CB95585DBB59A61EC4029BC7EBB30BBA57E5\n\n\u2022 A23EE1F17B746C1907293C7F8155E3E7DE135648\n\n\u2022 AB7F63649BBC53E45DEEB7269BEBD54815AE9E27\n\n\u2022 B49EDC05658907C888074905CE234BF3CF58D8A0\n\n\u2022 D3A96C0FA84BFEE826E175D4664116A169D15D4E\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f20\n\n\u2022 D3D0DED17D0029DFD90DA2AE74ADA885779E8926\n\n\u2022 D7DFB547033B82765F8B0A6B70A22A4EC204D7A8\n\n\u2022 DD753FCBAD4BE31066F278585D14C411DB3D7795\n\n6.2.2.2  C&C servers\n\n\u2022  center nmsvillage[ ]com\n\n\u2022  control mimepanel[ ]org\n\n\u2022  daily huntereim[ ]com\n\n\u2022  dream zepotac[ ]com\n\n\u2022  dyname europemis[ ]com\n\n\u2022  item amazonout[ ]com\n\n\u2022  promise miniaturizate[ ]org\n\n\u2022  rain nmsvillage[ ]com\n\n\u2022  store ufmsecret[ ]org\n\n\u2022  translate europemis[ ]com\n\n\u2022  view beleimprensa[ ]org\n\n\u2022  wind deltimesweb[ ]com\n\n6.2.3  KETRICAN 2017\n\n6.2.3.1  SHA-1\n\n\u2022 2C8B145EF5AC177C99DFCB8C0221E30B3A363A96\n\n\u2022 58DEA3A56DE1D95353230BE9BBBA582599AFE624\n\n\u2022 9D41B44AF5BAAF581C0D9D7BEF466213BD8BE01A\n\n\u2022 D3BFB10DB08C6828C3001C1F825ED6A6BF6F6E01\n\n\u2022 D8AA9E4918E464D00BA95A3E28B8707A148EC4D7\n\n\u2022 F2BFDA51BDA3EE57878475817AF6E5F24FFBBB28\n\n\u2022 FE2BF0A613482A40CCF84157361054EE77C07960\n\n6.2.3.2  C&C servers\n\n\u2022  buy babytoy-online[ ]com\n\n\u2022  forcan hausblow[ ]com\n\n\u2022  items babytoy-online[ ]com\n\n\u2022  login allionhealth[ ]com\n\n\u2022  newflow babytoy-online[ ]com\n\n\u2022  press premlist[ ]com\n\nNote: We have not detected samples using the following C&C servers. We extracted them by observing the \n\nsimilarities in the C&C infrastructure used by the malware.\n\n\u2022  grek freetaxbar[ ]com\n\n\u2022  items burgermap[ ]org \n\n\u2022  upcv inciohali[ ]com\n\n\u2022  www1 sanpaulostat[ ]com\n\n\u2022  cv livehams[ ]com\n\n\u2022  info audioexp[ ]com\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f21\n\n6.2.4  KETRICAN 2018\n\n6.2.4.1  SHA-1\n\n\u2022 09B7999160C5D0DC9A7443F0FC248B6C23BC0724\n\n\u2022 6BF0923577FE5939DEA66F466B74683AE2EBBC3E\n\n\u2022 C1C89A1A1779515EC1DFD0EFFF293615D523279E\n\n6.2.4.2  C&C servers\n\n\u2022  compatsec[ ]com\n\n\u2022  dsmanfacture privatedns[ ]org\n\n6.2.5  KETRICAN 2019\n\n6.2.5.1  SHA-1\n\n\u2022 D98D258C234F5CEAD43FD897613B2EA2669AA7C0\n\n\u2022 CE94EC2CFB23D8C662F558C69B64104C78B9D098\n\n6.2.5.2  C&C servers\n\n\u2022  chart healthcare-internet[ ]com\n\n\u2022  inicializacion[ ]com\n\n6.3  RoyalDns\n\n6.3.1  ESET DETECTION NAMES\n\n\u2022  Win32/RoyalDNS A\n\n\u2022  Win32/RoyalDNS B\n\n6.3.2  SHA-1\n\n\u2022 CE94EC2CFB23D8C662F558C69B64104C78B9D098\n\n6.3.3  C&C SERVERS\n\n\u2022  menorustru[ ]com\n\n7  MITRE ATT&CK TECHNIQUES (OKRUM)\n\nTactic\n\nID\n\nName\n\nDescription\n\nT1059\n\nCommand-Line Interface\n\nOkrum\u2019s backdoor uses cmd.exe to execute arbitrary commands \n\nExecution\n\nT1064\n\nScripting\n\nThe backdoor uses batch scripts to update itself to a newer version \n\nT1035\n\nService Execution\n\nT1050\n\nNew Service\n\nThe Stage 1 loader creates a new service named NtmsSvc to execute the \npayload \n\nTo establish persistence, Okrum installs itself as a new service named \nNtmSsvc \n\nT1060\n\nRegistry Run Keys / Startup Folder\n\nOkrum establishes persistence by creating a  lnk shortcut to itself in the \nStartup folder \n\nPersistence\n\nT1053\n\nScheduled Task\n\nThe installer component tries to achieve persistence by creating a scheduled \ntask \n\nT1023\n\nShortcut Modification\n\nOkrum establishes persistence by creating a  lnk shortcut to itself in the \nStartup folder \n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\f1.  Deobfuscate/Decode Files or \n\nInformation\n\n22\n\nTactic\n\nID\n\nName\n\nDescription\n\nPrivilege \nEscalation\n\nT1134\n\nAccess Token Manipulation\n\nOkrum can impersonate a logged on user\u2019s security context using a call to \nthe ImpersonateLoggedOnUser API \n\nT1140\n\nDeobfuscate/Decode Files or \nInformation\n\nThe Stage 1 loader decrypts the backdoor code, embedded within the loader \nor within a legitimate PNG file  A custom XOR cipher or RC4 is used for \ndecryption \n\nT1107\n\nFile Deletion\n\nOkrum\u2019s backdoor deletes files after they have been successfully uploaded \nto C&C servers \n\nT1158\n\nHidden Files and Directories\n\nBefore exfiltration, Okrum\u2019s backdoor uses hidden files to store logs and \noutputs from backdoor commands  \n\nDefense \nEvasion\n\nT1066\n\nIndicator Removal from Tools\n\nOkrum underwent regular technical improvements to evade antivirus \ndetection \n\nT1036\n\nMasquerading\n\nOkrum establishes persistence by adding a new service NtmsSvc with the \ndisplay name Removable Storage in an attempt to masquerade as a \nlegitimate Removable Storage Manager \n\nT1027\n\nObfuscated Files or Information\n\nOkrum's payload is encrypted and embedded within the Stage 1 loader, or \nwithin a legitimate PNG file  \n\nT1497\n\nVirtualization/Sandbox Evasion\n\nThe Stage 1 loader performs several checks on the victim's machine to avoid \nbeing emulated or executed in a sandbox \n\nCredential \nAccess\n\nT1003\n\nCredential Dumping\n\nOkrum was seen using MimikatzLite and modified Quarks PwDump to \nperform credential dumping \n\nT1083\n\nFile and Directory Discovery\n\nOkrum was seen using DriveLetterView to enumerate drive information \n\nT1082\n\nSystem Information Discovery\n\nOkrum collects computer name, locale information, and information about \nthe OS and architecture \n\nDiscovery\n\nT1016\n\nT1049\n\nSystem Network Configuration \nDiscovery\n\nOkrum collects network information, including host IP address, DNS and \nproxy information \n\nSystem Network Connections \nDiscovery\n\nOkrum used NetSess to discover NetBIOS sessions \n\nT1033\n\nSystem Owner/User Discovery\n\nOkrum collects the victim user name \n\nT1124\n\nSystem Time Discovery\n\nOkrum can obtain the date and time of the compromised system \n\nCollection\n\nT1056\n\nInput Capture\n\nOkrum was seen using a keylogger tool to capture keystrokes \n\nT1002\n\nData Compressed\n\nOkrum was seen using a RAR archiver tool to compress data \n\nExfiltration\n\nT1022\n\nData Encrypted\n\nOkrum uses AES encryption and base64 encoding of files before exfiltration \n\nT1041\n\nExfiltration Over Command and \nControl Channel\n\nData exfiltration is done using the already opened channel with the C&C \nserver \n\nT1043\n\nCommonly Used Port\n\nOkrum uses port 80 for C&C \n\nT1090\n\nConnection Proxy\n\nOkrum identifies a proxy server if it exists and uses it to make HTTP \nrequests \n\nT1132\n\nData Encoding\n\nThe communication with the C&C server is base64 encoded \n\nT1001\n\nData Obfuscation\n\nThe communication with the C&C server is hidden in the Cookie and Set-\nCookie headers of HTTP requests \n\nT1071\n\nStandard Application Layer Protocol\n\nOkrum uses HTTP for communication with its C&C \n\nT1032\n\nStandard Cryptographic Protocol\n\nOkrum uses AES to encrypt network traffic  The key can be hardcoded or \nnegotiated with the C&C server in the registration phase \n\nCommand \nAnd Control\n\nOKRUM AND KETRICAN // AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITYTLP: WHITE\fABOUT ESET \n\nFor 30 years, ESET\u00ae has been developing industry-leading IT security software and services for \n\nbusinesses and consumers worldwide  With solutions ranging from endpoint and mobile security, \n\nto encryption and two-factor authentication, ESET\u2019s high-performing, easy-to-use products give \n\nconsumers and businesses the peace of mind to enjoy the full potential of their technology  ESET \n\nunobtrusively protects and monitors 24/7, updating defenses in real time to keep users safe and \n\nbusinesses running without interruption  Evolving threats require an evolving IT security company  \n\nBacked by R&D centers worldwide, ESET becomes the first IT security company to earn 100 Virus \n\nBulletin VB100 awards, identifying every single \u201cin-the-wild\u201d malware without interruption since 2003  \n\nFor more information, visit www eset com or follow us on  LinkedIn, Facebook and Twitter \n\n\f"], "URLs": [], "weight": 0.0}