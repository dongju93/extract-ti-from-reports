{"rule_id": 656, "name": "201912_Report_Operation_Wacao", "description": "-", "references": [], "File_Names": ["tap.tmp", "clisock.Poll", "UserKey.txt", "ret.txt", "jexinv4.jsp", "iie.log", "__exec.bat", "user.txt", "checkadmin.exe", "DeflatedStream.Read", "host.txt", "ver.jsp", "srvsock.Send", "mrteeh.tmp", "zos.exe", "getos.py", "DC.AD", "iie.txt", "blog.csdn", "xx.txt", "srvsock.Poll", "sersock.Send", "cb.exe", "execute.bat", "dnscmd.exe", "psexec.py", "targ.ip", "tunnel.jsp", "mimilsa.log", "za.exe", "zww.txt", "sslsock.Read", "Result.txt", "mrt.ini", "smbexec.py", "zaw.txt", "zoo.exe", "sersock.Poll", "sslstr.Read", "10.txt", "OAKMZ.txt", "iie.exe", "dir.exe", "OAKMZ.vbs", "config.xml", "readthedocs.io", "clisock.Send", "targ.port", "zao.exe", "CliSock.Send", "SocketShutdown.Both", "devmgr.dll", "aia.exe", "nb.exe", "rs.txt"], "MD5_Hashes": ["23824e4dbcca5a1791dc32983fc77dc3", "8de3b2eac3fa25e2cf9042d1b952f0d9", "daae92a8a506273ebe2afdb506e7c335", "16deb16dfd9808711e69b3ad5cfff2b0", "1de345ac33ac117eaea697b36a180864", "b2b0e311932b34ad923e5e934ab9b08e", "c701faa6187c85fdadb4406544ffc546", "ae415b1a09d3b6eec483aeb716a3b40f", "e22418fb27619a63393c541516624ba4", "103f5678030d88620af3c14fa4f6ffa8", "bfdae0e61bb4e780e3c1d5cd77e0682b", "14f3514feb74a943b17596ebf0811eb0", "fdba8a1e7624f4e14267366e4f83afc4", "8f16f93f4d587952aa33f91b295f3808"], "SHA1_Hashes": ["55f07648c001c54c8261e789b7dcfbcd02837241", "23a2ce6ef6d1a49303760d8e9413d60335048ade", "e7178e9d4aaefe0978c57e2bdd32491d68f37e7e", "a7c14f6bd15010b502570bd0e528223be604df88", "ac577ff095d6fdbb06886b22e8bb5b6bfbb096ff", "31b429da1c5bb55c544e07e5ee44215d39afddb1", "4b7ba900acd6564afeff44250b91903c0c9ea504", "67ce68d8f76edd886e66415bb038a81fd6009b7f", "91cd4c1918a788d158a1f15a9e5c2dff177db64f", "5fea5b85beed1e2792e9fb74180ae002cdb14ff1", "da6a3327d7912001c1c296c99579bc3c3933b6d2", "1741c747bffaa270de66db5064852a0826f51d9a", "23b1c6b81fd7d4d6ea0bc81109ce886a45967180", "022f971c233f69dd6daf43da9f64985c42aad737"], "SHA256_Hashes": ["08f87f8c64a4c98b0e99592a436d601249feeaec4a2c4effbf69a166e4f592a0", "29d5933c18826b00bc075623740c00c00057ff897580bea3362674f6ec1cbe10", "5d01150ade4b302b9fd765fd0fb70aa17ee9cb9fcb219c2d270fd90ad8d01188", "3016ea94e3c5bd7f9d8e503b1817491bcf9e2ee5bb82fc106aa5d692dd0ff5c6", "2047e464627e36410b3458e23062f23eecbd383e7854b55b497ec8db017c0d5e", "75ac4478c1729d1b5434724cf0c2bd53cc5940d251a4ca07b17c239c8f62da8d", "e959c1eee16fcc512392fedd2704c7051742260f335f9b2d9f37fe23b3bde47d", "d43251480775f224517f484686bc7ca39e532d900b86ebf6ed37da8ee13534a4", "459910699497f2efe921a197e365fd5938af55378b3b20d2867ce171036fb675", "6972ba198ed0d30de9f66be5777ecdba2d657078f138325ee6db225c20b29e6e", "5cf61c0b865fd2ab897c72ff2cc01ac4c31ea9c50ecc3d47693f3482fd8f91d4", "c109ddd4f43bc38a50b07b4fc22fe568cced4fb4d8c5bd71546407c2c6219048", "a4a448d40aa8b4ff1d18de7a84b7fbc4c41c00062a56cd7c74ac443b61438f47", "b2162d4cbeee907d1af13918900e6e4f13232d00915563d841aa7c904d94589c"], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\<username>\\PuTTY\\Sessions\\\n\n6.7.9  Remote System Discovery\nThe actor often checks for the availability of systems using the ping command:  \n\n/c cd /d c:\\temp & ping <internal IP address> -n 1\n\n6.7.10  System Information Discovery\nTo retrieve information of interest to the actor a custom VBS script is used. This script contains \nseveral functions to retrieve the following information:\n\u2022  Volume drives and the type of drives (Removable disk, network disk, local disk etc.)\n\u2022  Administrators\n\u2022  Device information (Manufacturer, Model etc.)\n\u2022 \n\u2022  Recently executed software (MuiCache)\n\u2022  Running processes\n\nInstalled software\n\n34 | Fox-IT | Operation Wocao\n\n\fMore information on this specific script can be found in chapter 5.4.\n\n6.7.11  Security Software Discovery\nLikely, as a result from the VBS reconnaissance script, described in chapter 5.4, the actor identifies \nsecurity software. During one incident response case where Carbon Black (Response) agents were \ndeployed, the actor identified the agent and repeatedly checked newly compromised systems for the \npresence of this incident response tool, as can be seen in the examples below:  \n\n/c cd /d c:\\windows\\temp & tasklist /v|find ", "HKLM\\SYSTEM\\\\ControlSet001\\\\Control\\\\SecurityProviders\\\\WDigest\n\n6.5.5  Obfuscated Files or Information\nCommands executed via PowerShell are encoded or compressed, using Base64, zlib and XOR. Below \nare some examples.  \n\npowershell -exec bypass -enc \n\nJgAgAHsASQBtAHAAbwByAHQALQBNAG8AZAB1AGwAZQAgAGMAOgBcAHQAZQBtAHAAXABpAGsALgBwAHMAMQA7ACAA \n\nRwBlAHQALQBEAG8AbQBhAGkAbgBVAHMAZQByACAALQBTAFAATgAgAHwAIABHAGUAdAAtAEQAbwBtAGEAaQBuAFMA \n\nUABOAFQAaQBjAGsAZQB0ACAALQBPAHUAdABwA HUAdABGAG8AcgBtAGEAdAAgAEgAYQBzAGgAYwBhAHQAfQA= > \n\nrs.txt\n\nFox-IT | Operation Wocao | 29 \n\n\f$DeflatedStream = New-Object IO.Compression.DeflateStream([IO.MemoryStream]\n\n[Convert]::FromBase64String\n\n($encfile),[IO.Compression.CompressionMode]::Decompress)\n\nfunction format([string]$source){$tt = "], "URLs": ["https://powersploit.readthedocs.io/en/latest/Recon/Invoke-Kerberoast/", "https://github.com/SecureAuthCorp/impacket", "https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1", "https://github.com/BloodHoundAD/BloodHound", "https://github.com/sensepost/reGeorg/blob/master/tunnel.jsp", "https://github.com/BloodHoundAD/BloodHound/wiki/Data-Collector", "https://github.com/HarmJ0y/KeeThief", "https://github.com/joaomatosf/jexboss", "https://github.com/SecureAuthCorp/impacket/issues/108).", "https://blog.csdn.net/ts__cf/article/details/47659829"], "weight": 0.0}