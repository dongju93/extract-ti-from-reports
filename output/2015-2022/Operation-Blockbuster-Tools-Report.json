{"rule_id": 988, "name": "Operation-Blockbuster-Tools-Report", "description": "-", "references": [], "File_Names": ["download.boho", "AdobeUpdaterPrefs.dat", "McShield.exe", "FrameworkService.exe", "naPrdMgr.exe", "UdaterUI.exe", "boho.or", "zawq.bat", "mscorsw.exe", "iphapi.dll", "shstat.exe", "IconCache.dat"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": [], "Registry_Entries": ["HKLM\\SYSTEM\\\nCurrentControlSet\\services\\McShield\\ImagePath and then replacing the McShield.exe binary with itself. \nThis ensures that upon reboot, TangoDelta will load rather than the legitimate McAfee McShield.exe binary.\n\nWith the McAfee processes terminated and TangoDelta replacing the legitimate McShield.exe file, TangoDelta \ndisconnects from the Process Hacker driver and removes it from memory before deleting the driver\u2019s service from the \nWindows services database. TangoDelta then activates the new McShield.exe binary by reactivating the McShield \nservice before generating and executing a suicide script to remove the original TangoDelta binary.\n\n2 \n2   \n\n Wen Jia Liu. \u201cOverview \u2013 Process Hacker\u201d http://processhacker.sourceforge.net/. Accessed 27 November 2015.\n McAfee. \u201cProcess description and load order for VirusScan Enterprise and McAfee Agent\u201d. https://kc.mcafee.com/corporate/index?page=content&id=KB65784&pmv=print 29 September 2015\n\n16\n\nOperation Blockbuster:  Tools Report\fThe suicide script that TangoDelta generates is nearly identical to that of WhiskeyAlfa-One. The only difference \nbetween the suicide scripts is the superfluous strcpy(buffer, ", "HKLM\\Software\\Microsoft\\CurrentVersion\\Run\\Mozilla Update is added \nand set to the path of the newly copied KiloAlfa binary with the \u2013run command line argument added. If the registry key \ninsertion is unsuccessful, KiloAlfa attempts to insert the same key and value within the current user hive (HKCU). \n\nIf KiloAlfa is activated without any arguments, the persistence functionality attempts to run KiloAlfa under all users logged \ninto the victim\u2019s machine through terminal services. By calling WTSEnumerateSessionsA to get a list of all currently \nactive Windows Terminal Services sessions, KiloAlfa uses the list of active terminal sessions to determine if explorer.exe \nis running under the session (to eliminate non-interactive user sessions); KiloAlfa then obtains the token of the user of the \nsession and calls CreateProcessAsUserA to activate the newly installed KiloAlfa binary (mscorsw.exe) with the \u2013run \ncommand line argument. KiloAlfa then activates mscorsw.exe with the \u2013run argument for the console session.\n\nAfter installing KiloAlfa as mscorsw.exe and activating the new binary for all active users, KiloAlfa generates and \nexecutes a suicide script to remove the initial instance of itself. The suicide script is saved to %TEMP%\\AUTOEXEO.bat and \ntakes the form presented in Figure 2-1. The script is constructed one line at a time using string concatenation and saved \nvia WriteFile before CreateProcess is called to execute the script. It is worth noting that KiloAlfa and IndiaFoxtrot \nshare the same suicide generation script code in both functionality and the script itself. Additionally, KiloAlfa and \nIndiaFoxtrot also use AUTOEXEO.bat as the suicide script\u2019s filename.\n\n@echo off\n:R1\ndel /a "], "URLs": ["http://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf", "http://go.microsoft.com/fwlink/?linkid=121488.", "http://processhacker.sourceforge.net/.", "https://kc.mcafee.com/corporate/index?page=content&id=KB65784&pmv=print"], "weight": 0.0}