{"rule_id": 753, "name": "CrashOverride-01", "description": "-", "references": [], "File_Names": ["104.dll", "Crash104.dll", "CrashOPCClientDemo.dll", "iec104.log", "CrashD2MultiCommService.exe", "opc.exe", "DRAGOS.COM", "Crash61850.dll", "payload.dll", "configuration.ini", "Launcher.exe"], "MD5_Hashes": [], "SHA1_Hashes": ["f6c21f8189ced6ae150f9ef2e82a3a57843b587d", "5a5fafbc3fec8d36fd57b075ebf34119ba3bff04", "b92149f046f00bb69de329b8457d32c24726ee00", "94488f214b165512d2fc0438a581f5c9e3bd4d4c", "8e39eca1e48240c01ee570631ae8f0c9a9637187", "b335163e6eb854df5e08e85026b2c3518891eda8", "79ca89711cdaedb16b0ccccfdcfbd6aa7e57120a", "2cb8230281b86fa944d3043ae906016c8b5984d9", "cccce62996d578b984984426a024d9b250237533"], "SHA256_Hashes": [], "Registry_Entries": ["HKLM\\SYSTEM\\CurrentControlSet\\Ser-\nvices\\<target_service_name>\\ImagePath \n<path to malware>\n\nHost\n\nSHA1 File Hash\n\nF6C21F8189CED6AE150F9E-\nF2E82A3A57843B587D\n\nHost\n\nSHA1 File Hash\n\nCCCCE62996D-\n578B984984426A024D9B250237533\n\nName given to service start\n\nExternal C2 server [DEC 2016] (likely \nTOR node at time of attack)\n\nExternal C2 server [DEC 2016] (likely \nTOR node at time of attack)\n\nExternal C2 server [DEC 2016] (likely \nTOR node at time of attack)\n\nDefault user agent string used in C2 \nif unable to get system default user \nagent string\n\nCommand line arguments used to \nlaunch custom port scanner observed \nwith malware. Command line logging \nrequired to track.\n\nChange in Service Image Path in the \nsystem registry to point to malware \nallowing malware to restart on system \nreboot.\n\nTraffic to <internalIP>:3128, HTTP \nCONNECT to 5.39.218.152:443. Back-\ndoor/RAT. \n\nTraffic to <internalIP>:3128, HTTP \nCONNECT to 5.39.218.152:443. Back-\ndoor/RAT.\n\nICS Kill Chain Impact\nStage 2: Install\n\nRecon\n\nStage 2: Install\n\nStage 2: Install\n\nRecon\n\nRecon\n\nStage 2: C2\n\nStage 2: C2\n\nRemote Access\n\nRemote Access\n\nStage 2: C2\n\nRemote Access\n\nStage 2: C2\n\nRemote Access\n\nStage 2: C2\n\nRemote Access\n\nStage 2: Develop\n\nRecon\n\nStage 2: Installa-\ntion\n\nPersistence\n\nPhase2: C2\n\nRemote Access\n\nPhase2: C2\n\nRemote Access\n\nHost\n\nSHA1 File Hash\n\n8E39ECA1E48240C01EE570631AE8F-\n0C9A9637187\n\nBackdoor/RAT Proxy + HTTP CON-\nNECT to 93.115.27.57:443. \n\nPhase2: C2\n\nRemote Access\n\nHost\n\nSHA1 File Hash\n\n2CB8230281B86FA944D3043AE-\n906016C8B5984D9\n\nBackdoor/RAT Proxy + HTTP CON-\nNECT to 195.16.88.6:443 \n\nPhase2: C2\n\nRemote Access\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations\fHost\n\nSHA1 File Hash\n\n79CA89711CDAEDB16B0CCCCFD-\nCFBD6AA7E57120A\n\nHost\n\nSHA1 File Hash\n\n94488F214B165512D2FC0438A581F-\n5C9E3BD4D4C\n\nHost\n\nSHA1 File Hash\n\n5A5FAFBC3FEC8D36FD57B075EBF-\n34119BA3BFF04\n\nHost\n\nSHA1 File Hash\n\nB92149F046F00BB69DE329B8457D-\n32C24726EE00\n\nLauncher for payload DLL. Takes input as \nthree command line parameters \u2013 work-\ning directory, module, and config file.\n\nModule for 104 effect. Exports 'Crash' \nwhich is invoked by launcher. Functional-\nity requires config file. \n\nWiper module, wipes list of files by \nextension, removes system processes, \nand makes registry changes to prevent \nsystem boot. \n\nWiper module, wipes list of files by \nextension, removes system processes, \nand makes registry changes to prevent \nsystem boot. \n\nStage 2: Attack\n\nLoss of Control\n\nStage 2: Attack\n\nLoss of Control\n\nStage 2: Attack\n\nDestruction\n\nStage 2: Attack\n\nDestruction\n\nSHA1 File Hash\n\nB335163E6EB854DF5E08E85026B-\n2C3518891EDA8\n\nCustom-built port scanner. \n\nStage 2: Develop\n\nRecon\n\nSHA1 File Hash\n\n7FAC2EDDF22FF692E1B4E-\n7F99910E5DBB51295E6\n\nOPC Data Access protocol enumeration \nof servers and addresses \n\nStage 2: Attack\n\nLoss of Control\n\nSHA1 File Hash\n\nECF6ADF20A7137A84A1B319C-\nCAA97CB0809A8454 \n\nIEC-61850 enumeration and address \nmanipulation\n\nStage 2: Attack\n\nLoss of Control\n\nOPC Data Access protocol enumeration \nof servers and addresses \n\nIEC-61850 enumeration and address \nmanipulation\n\nWiper module, wipes list of files by \nextension, removes system processes, \nand makes registry changes to prevent \nsystem boot. \n\nStage 2: Attack\n\nLoss of Control\n\nStage 2: Attack\n\nLoss of Control\n\nStage 2: Attack\n\nDestruction\n\nIEC-104 module\n\nWiper module\n\nOPC DA Module\n\nStage 2: Attack\n\nLoss of Control\n\nStage 2: Attack\n\nDestruction\n\nStage 2: Attack\n\nLoss of Visibility\n\nHost\n\nHost\n\nHost\n\nHost\n\nHost\n\nHost\n\nHost\n\nHost\n\nFilename\n\nopc.exe\n\nFilename\n\n61850.exe\n\nFilename\n\nhaslo.exe\n\nFilename\n\nFilename\n\n104.dll\n\nhaslo.dat\n\nOPC Server\n\nOPC Group\n\nAabdul\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations\fYara Rules\nAlso found at https://github.com/dragosinc/CRASHOVERRIDE\n\nimport \u201cpe\u201d\n\nimport \u201chash\u201d\n\nrule dragos_crashoverride_exporting_dlls\n\n{\n\n}\n\nmeta:\n\ndescription = \u201cCRASHOVERRIDE v1 Suspicious Export\u201d\n\nauthor = \u201cDragos Inc\u201d\n\ncondition:\n\npe.exports(\u201cCrash\u201d) & pe.characteristics\n\nrule dragos_crashoverride_suspcious\n\n{\n\nmeta:\n\ndescription = \u201cCRASHOVERRIDE v1 Wiper\u201d\n\nauthor = \u201cDragos Inc\u201d\n\nstrings:\n\n$s0 = \u201cSYS_BASCON.COM\u201d fullword nocase wide\n\n$s1 = \u201c.pcmp\u201d fullword nocase wide\n\n$s2 = \u201c.pcmi\u201d fullword nocase wide\n\n$s3 = \u201c.pcmt\u201d fullword nocase wide\n\n$s4 = \u201c.cin\u201d fullword nocase wide\n\ncondition:\n\npe.exports(\u201cCrash\u201d) and any of ($s*)\n\n}        \n\n30\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\fYARA Rules\n\nrule dragos_crashoverride_name_search {\n\nmeta:\n\ndescription = \u201cCRASHOVERRIDE v1 Suspicious Strings and Export\u201d\n\nauthor = \u201cDragos Inc\u201d\n\nstrings:\n\n$s0 = \u201c101.dll\u201d fullword nocase wide\n\n$s1 = \u201cCrash101.dll\u201d fullword nocase wide\n\n$s2 = \u201c104.dll\u201d fullword nocase wide\n\n$s3 = \u201cCrash104.dll\u201d fullword nocase wide\n\n$s4 = \u201c61850.dll\u201d fullword nocase wide\n$s5 = \u201cCrash61850.dll\u201d fullword nocase wide\n\n$s6 = \u201cOPCClientDemo.dll\u201d fullword nocase wide\n\n$s7 = \u201cOPC\u201d fullword nocase wide\n\n$s8 = \u201cCrashOPCClientDemo.dll\u201d fullword nocase wide\n\n$s9 = \u201cD2MultiCommService.exe\u201d fullword nocase wide\n\n$s10 = \u201cCrashD2MultiCommService.exe\u201d fullword nocase wide\n\n$s11 = \u201c61850.exe\u201d fullword nocase wide\n\n$s12 = \u201cOPC.exe\u201d fullword nocase wide\n\n$s13 = \u201chaslo.exe\u201d fullword nocase wide\n\n$s14 = \u201chaslo.dat\u201d fullword nocase wide     \n\ncondition:\n\nany of ($s*) and pe.exports(\u201cCrash\u201d)\n\n}\n\n31\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n        \n\fYARA Rules\n\nrule dragos_crashoverride_hashes {\n\n    meta:\n\n        description = \u201cCRASHOVERRIDE Malware Hashes\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    condition:\n\n        filesize < 1MB and\n\n        hash.sha1(0, filesize) == \u201cf6c21f8189ced6ae150f9ef2e82a3a57843b587d\u201d or  \n\n        hash.sha1(0, filesize) == \u201ccccce62996d578b984984426a024d9b250237533\u201d or \n\n        hash.sha1(0, filesize) == \u201c8e39eca1e48240c01ee570631ae8f0c9a9637187\u201d or \n\n        hash.sha1(0, filesize) == \u201c2cb8230281b86fa944d3043ae906016c8b5984d9\u201d or \n        hash.sha1(0, filesize) == \u201c79ca89711cdaedb16b0ccccfdcfbd6aa7e57120a\u201d or  \n\n        hash.sha1(0, filesize) == \u201c94488f214b165512d2fc0438a581f5c9e3bd4d4c\u201d or\n\n        hash.sha1(0, filesize) == \u201c5a5fafbc3fec8d36fd57b075ebf34119ba3bff04\u201d or\n\n        hash.sha1(0, filesize) == \u201cb92149f046f00bb69de329b8457d32c24726ee00\u201d or\n\n        hash.sha1(0, filesize) == \u201cb335163e6eb854df5e08e85026b2c3518891eda8\u201d\n\n}\n\n32\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations        \n\fYARA Rules\n\nrule dragos_crashoverride_moduleStrings { \n\nmeta:\n\ndescription = \u201cIEC-104 Interaction Module Program Strings\u201d\n\nauthor = \u201cDragos Inc\u201d\n\nstrings: \n\n$s1 = \u201cIEC-104 client: ip=%s; port=%s; ASDU=%u\u201d nocase wide ascii \n\n$s2 = \u201c MSTR ->> SLV\u201d nocase wide ascii \n\n$s3 = \u201c MSTR <<- SLV\u201d nocase wide ascii \n\n$s4 = \u201cUnknown APDU format !!!\u201d nocase wide ascii \n\n$s5 = \u201ciec104.log\u201d nocase wide ascii \n\ncondition: \n\nany of ($s*)\n\n}\n\nrule dragos_crashoverride_configReader\n\n{\n\n    meta:\n\n        description = \u201cCRASHOVERRIDE v1 Config File Parsing\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    strings:\n\n        $s0 = { 68 e8 ?? ?? ?? 6a 00 e8 a3 ?? ?? ?? 8b f8 83 c4 ?8 }\n\n        $s1 = { 8a 10 3a 11 75 ?? 84 d2 74 12 }\n\n        $s2 = { 33 c0 eb ?? 1b c0 83 c8 ?? }\n\n        $s3 = { 85 c0 75 ?? 8d 95 ?? ?? ?? ?? 8b cf ?? ?? }\n\n    condition:\n\n        all of them\n\n}\n\n33\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n        \n\fYARA Rules\n\nrule dragos_crashoverride_weirdMutex\n\n{\n\n    meta:\n\n        description = \u201cBlank mutex creation assoicated with CRASHOVERRIDE\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    strings:\n\n        $s1 = { 81 ec 08 02 00 00 57 33 ff 57 57 57 ff 15 ?? ?? 40 00 a3 ?? ?? ?? 00 \n85 c0 }\n\n        $s2 = { 8d 85 ?? ?? ?? ff 50 57 57 6a 2e 57 ff 15 ?? ?? ?? 00 68 ?? ?? 40 00}\n\n    condition:\n\n        all of them\n\n}\n\nrule dragos_crashoverride_serviceStomper\n\n{\n\n    meta:\n\n        description = \u201cIdentify service hollowing and persistence setting\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    strings:\n\n        $s0 = { 33 c9 51 51 51 51 51 51 ?? ?? ?? }\n\n        $s1 = { 6a ff 6a ff 6a ff 50 ff 15 24 ?? 40 00 ff ?? ?? ff 15 20 ?? 40 00 }\n\n    condition:\n\n        all of them\n\n}\n\n34\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations \n        \n\fYARA Rules\n\nrule dragos_crashoverride_wiperModuleRegistry\n\n{\n\n    meta:\n\n        description = \u201cRegistry Wiper functionality assoicated with CRASHOVERRIDE\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    strings:\n\n        $s0 = { 8d 85 a0 ?? ?? ?? 46 50 8d 85 a0 ?? ?? ?? 68 68 0d ?? ?? 50 }\n\n        $s1 = { 6a 02 68 78 0b ?? ?? 6a 02 50 68 b4 0d ?? ?? ff b5 98 ?? ?? ?? ff 15 \n04 ?? ?? ?? }\n\n        $s2 = { 68 00 02 00 00 8d 85 a0 ?? ?? ?? 50 56 ff b5 9c ?? ?? ?? ff 15 00 ?? \n?? ?? 85 c0 }\n    condition:\n\n        all of them\n\n}\n\nrule dragos_crashoverride_wiperFileManipulation\n\n{\n\n    meta:\n\n        description = \u201cFile manipulation actions associated with CRASHOVERRIDE wip-\ner\u201d\n\n        author = \u201cDragos Inc\u201d\n\n    strings:\n\n        $s0 = { 6a 00 68 80 00 00 00 6a 03 6a 00 6a 02 8b f9 68 00 00 00 40 57 ff 15 \n1c ?? ?? ?? 8b d8 }\n\n        $s2 = { 6a 00 50 57 56 53 ff 15 4c ?? ?? ?? 56 }\n\n    condition:\n\n        all of them\n\n}\n\n35\n\nCRASHOVERRIDE: Threat to the Electic Grid Operations \n        \n\f"], "URLs": ["https://github.com/dragosinc/CRASHOVERRIDE"], "weight": 0.0}