{"rule_id": 493, "name": "Poking the Bear Three-Year Campaign Targets Russian Critical Infrastructure", "description": "-", "references": [], "File_Names": ["trstorg.ru", "FakeNet.exe", "s05.test", "1.cmd", "SetLogin1Connect.exe", "gFwd.exe", "\u043e\u0437\u043d\u0430\u043a\u043e\u043c\u043b\u0435\u043d\u0438\u0435.doc", "rosneft.ru", "module.exe", "5Ccmd.exe", "ApMsgFwd.exe", "bas.php", "Review.doc", "infrastructure.html", "buffer.php", "key.php"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["b65125ee14f2bf12a58f67c623943658dd457e5b40b354da0975d7615fe9d932", "7a7a139b55cd5ddcbcb8f91be1d2a247d42243d2d4a595252851987075a4338d", "c12e50e7c9162d8c690d3474400fe2f5d0a9c2903adbd2837d3a9023ba86fb79", "4f6de2c6d6c80b459f0bdb88cf2ce22e44ad4f3045909cbd8c1fb7632956fb63", "d31ee9ca7eb1d0fce0f688938269c7200c982f0f13daa9d40a4ce0824de6cc18", "dcec00c780cb71b955e32231d5340e90e51c3c1828262ec7cfa239e431accf5b", "68ab10ca4f823d0246822f102c412430e0a57e2026b3f0a1fd97f200e9e0e707", "302866c5209e8f0b0b78bbc3411e38777de9ca59a8e1c6fa0ffdf7e35aecb2aa", "27614102c5386333ecd43bb086752397726783f4d1e7fe0c1735686b5199a623", "0556aca3b5f3a4797ca36150a4b1423ec42a6827749599395d35e369f6df5568", "a077c085dccb900ddab2542b4b332f7c43b3674c71d5cd11afdd2861b6fec2b8", "7bb9f72436bcbb5fcb190ebc2cce77e1ea41ba0e6614bf2347b4514e7d65da4a", "1847f578bb25fc980f8dd4112e746df0e60531012083ffbd1f294d9b19f01e26", "11e8692a2d2995b105591c42fcd7a0427223f2a6b16f8e6614820024cb3415f4", "cb1cb113de38ae4ea1312d133d485769ecb38f2a9306f497788cd8fbb6fc4707", "9949d5d1adb4a44463363c04678dbff0d45aeff740c754aff0c3d7b54d26016d", "aa8dc9ad33ffb69b19d2d685e302888eb557a0159c15689c0eb36b6e649c4f3a", "8f7cf81d8bfb3780b48693020a18071a9fd382d06b0b7932226b4d583b03c3af", "c0b090eca76ccff3b8e7da9a3d94418d0102277a40b1dadf7fd9096ddd668e79", "10c5bf2733b7147c3663baa597b2e960069edcadf794d1ec299dfcbab489dfe1", "6e476a2ef02986a13274fb2a126ed60a1ede252919d6993de03622aaa7fe6228", "736aa303b35ee23204e0e7d48cb31f77605234609c2b3d89a054b7c3ec2c0544", "63d8f1566b5d0fa6459a89a0d48a163b8a356bdf2c0bec4c648b253bd8f36bb9", "93b2e268ca5b8fede64edc0da7195adebbe8fa490de96b5eec1489b7868710f3", "c8ca5e80d3f14102fd81b0fda54120d6ce9519a72b9d3aca23cf9b5cc8c93549", "51bc34307923d83b795319877924c9ed926366758d4662c36dce58f3a1ae20bb"], "Registry_Entries": ["HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ApMsgFwd.exe\u201d.\n\nThe backdoor had the ability to upload and download files, manipulate files and folders,\ncompress and decompress files using ZLIB, enumerate drive information and host\ninformation, elevate privileges, capture screenshots and webcam pictures, block and/or\nsimulate user input, log keystrokes, and manipulate processes on the infected system.\n\nDirectives from the C2 were randomly broken up by the character \u201c_\u201d in an attempt to likely\nevade HIDS and NIDS signatures such as the command \u201cST_A_RT_FI_LE\u201d.\n\nLater versions of RedControle used randomized strings broken up by the same \u201c_\u201d\ncharacter to further hinder signature-based analysis and reverse engineering efforts. In the\nsample Cylance researchers analyzed, the initial connection looked something like this:\n\nWhere the string in BLUE was sent by the C2 server and the string in RED was sent by the\nvictim as an initial check in containing the IP address and a unique victim identifier. The\nbackdoor operated using a series of threads which were designed to segment different\nbackdoor functionality into autonomous threads which ran based on different pre-defined\nDelphi-based timers.\n\nThe backdoor appeared to be a mishmash of different authorship with the keylogger\nportion containing Portuguese language strings and other functions related to process\nmanipulation containing references to Slavic language strings. These strings were\neventually removed or obfuscated in later versions.\n\nThe Dropper\n\nCylance identified an executable dropper:\n\nb65125ee14f2bf12a58f67c623943658dd457e5b40b354da0975d7615fe9d932\n\nThe dropper planted a version of RedControle on the system as well as another interesting\nbinary while showing the potential victim a nice picture of a holiday present. The dropper\nwas relatively uninteresting; however, a Sticky Keys backdoor would also be placed on the\nsystem, which warranted additional analysis.\n\nDropper SHA256 Hash:\nb65125ee14f2bf12a58f67c623943658dd457e5b40b354da0975d7615fe9d932\n\nAssociated RedControle SHA256:\n8f7cf81d8bfb3780b48693020a18071a9fd382d06b0b7932226b4d583b03c3af\n\nAssociated StickyKeys SHA256:\n\n5/14\n\n\f6e476a2ef02986a13274fb2a126ed60a1ede252919d6993de03622aaa7fe6228\n\nThe dropper created two executable files within the folder\n\u201c%ALLUSERSPROFILE%\\Documents\u201d, \u201csvhost.exe\u201d and \u201csystem.exe\u201d and created two\nassociated Run keys to maintain persistence for both executables. The program\n\u201csvhost.exe\u201d was the aforementioned RedControle variant with network callbacks to the\ndomain \u201ctrstorg[.]ru\u201d and the IP address \u201c83.166.243[.]48\u201d.\n\nThe \u201csystem.exe\u201d file was a StickyKeys backdoor programmed in Delphi. It first opened\nTCP port 3389 in the Windows Firewall and then set the following Registry Keys:\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution\nOptions\\sethc.exe\\Debugger -> C:\\WINDOWS\\system32\\taskmgr.exe\nHKLM\\System\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections ->\nnull value\n\nThe file was primarily responsible for enabling RDP on the target system and performing a\nsticky keys hijack to point to the legitimate \u201ctaskmgr.exe\u201d binary.\n\nIf our readers are unfamiliar with StickyKeys, it was originally designed for people who\nhave difficulty holding down two or more keys simultaneously. StickyKeys can be enabled\non Windows by rapidly pressing the shift key five times. The registry key above will\nsimultaneously launch the Task Manager binary \u201ctaskmgr.exe\u201d along with the intended\nStickyKeys binary. The StickyKeys backdoor can then test corresponded to \u201cgoogle.ru\u201d and\nvarious subdomains. If the test is successful, it will make the following HTTP request to\n\u201ctrstorg[.]ru\u201d on TCP port 80:\n\nGET /bas.php HTTP/1.1\nUser-Agent: DMFR\nHost: trstorg.ru\nCache-Control: no-cache\n\nHTTP/1.1 200 OK\nServer: nginx\nDate: Thu, 19 Jan 2017 17:18:48 GMT\nContent-Type: text/html\nContent-Length: 0\nConnection: keep-alive\nKeep-Alive: timeout=60\nX-Powered-By: PHP/5.5.9-1ubuntu4.\n\nFigure 3: Example Request and Server Response from StickyKeys Backdoor\n\nThis particular sample will no longer work as the IP address \u201c80.254.96[.]251\u201d appeared to\nhave been reassigned to another party and no longer operates a webserver.\n\nOpen Source Intelligence Analysis\n\nThe RedControle backdoors frequently created the unique mutex\n\n6/14\n\n\f\u201cAppFilQsSSSwwww_jadknskjnd_jadknskjnd\u201d\n\nwhich directly links the above samples to the following hashes through open source\nintelligence:\n\n10c5bf2733b7147c3663baa597b2e960069edcadf794d1ec299dfcbab489dfe1\n11e8692a2d2995b105591c42fcd7a0427223f2a6b16f8e6614820024cb3415f4\n27614102c5386333ecd43bb086752397726783f4d1e7fe0c1735686b5199a623\n4f6de2c6d6c80b459f0bdb88cf2ce22e44ad4f3045909cbd8c1fb7632956fb63\n51bc34307923d83b795319877924c9ed926366758d4662c36dce58f3a1ae20bb\n7a7a139b55cd5ddcbcb8f91be1d2a247d42243d2d4a595252851987075a4338d\n93b2e268ca5b8fede64edc0da7195adebbe8fa490de96b5eec1489b7868710f3\na077c085dccb900ddab2542b4b332f7c43b3674c71d5cd11afdd2861b6fec2b8\nc8ca5e80d3f14102fd81b0fda54120d6ce9519a72b9d3aca23cf9b5cc8c93549\n\nSeveral of these samples communicated to the domains \u201csxe-csgo[.]net\u201d and\n\u201ch84622.s05.test-hf[.]su\u201d.\n\nThese domains led to two primary IP addresses: \u201c91.227.16[.]115\u201d and \u201c91.227.16[.]6\u201d as\nwell as a few hundred unique file hashes.\n\nThe IP addresses \u201c109.68.190[.]244\u201d and \u201c46.38.50[.]106\u201d which resolved to \u201csxe-\ncsgo[.]net\u201d in 2015 and 2016 let Cylance definitively tie this subset of activity to activity\ntargeting the Russian Steam community as well as the Counterstrike and CS:Go\ncommunities previously documented here, here, and here.\n\nInfrastructure Analysis\n\nThe threat actor left bits of infrastructure open over time and Cylance was able to harvest\nsome of the server-side scripts utilized by the malware for tracking and recording data\nstolen from intended victims. Additionally, the attacker utilized Cloudflare for free bulk SSL\ncertificates, which inadvertently exposed a number of domains.\n\nThe attacker put a lot of time and effort into closely imitating legitimate domains and\ncontinually altered their targets over time. They would also occasionally register legitimate\ndomains after the domains had expired.\n\nThe actor relied heavily upon the Lithuanian provider \u201cvpsnet[.]lt\u201d likely as a result of the low\ncost overhead of a couple euros per month per virtual private server (VPS).\n\nConclusions\n\nWhen we first discovered that the threat actor was using more than two dozen websites to\nmimic real Russian critical infrastructure companies, we were intrigued. The effort required\nto set up those domains seemed disproportionate to the perceived benefit of using them\nsimply as command-and-control infrastructure.\n\n7/14\n\n\fThen we saw a paid contributor article in a Russian edition of Forbes, published in April\n2017 and entitled (in Google\u2019s translation to English) Attack of the Clones: How Schemes\nWork with Fake Sites of Rosneft and Other Large Companies.\n\nThe author was Ilya Sachkov, the founder and CEO of infosec company Group-IB and a\nmember of cybercrime expert committees in the Council of Europe and the OSCE.\n\nThe article described what appeared to be unpublished Group-IB research findings into an\nelaborate criminal scheme wherein a threat actor was creating near-clones of legitimate\nRussian critical infrastructure companies\u2014Rosneft most prominent among them\u2014in order\nto harvest credentials and perpetuate fraud.\n\nIn the article, Sachkov provided screen shots of many of the mimicked sites to establish\njust how painstakingly close to the original these fake sites were designed to look.\n\nThe article referenced several of the companies and websites by name, which Group-IB said\nwere part of the fraud campaign. At least one of the affected companies was described in\nthe article as being a client of Group-IB.\n\nThat company\u2019s domain, as well as nearly all of the other domains cited by Group-IB were\nalso uncovered in the Cylance investigation. For example, in addition to Rosneft, they\nincluded: Mendeleevkazot, HCSDS, and EuroChem. Mendeleevkazot is a fertilizer\nmanufacturer and part of a larger Russian critical infrastructure holding company. HCSDS\nis an acronym for a Siberian Business Union, a holding company comprised of several\nRussian critical infrastructure companies. EuroChem (Group-IB\u2019s apparent client) is a\nSwiss-based fertilizer company with its primary mining activity in Russia. Its name came up\nin several news-related searches indicating its involvement in large financial transactions\nas well as geopolitical maneuvering.\n\nGiven the overlap in findings and the direct connection to past criminal campaigns\ntargeting the gaming community, it seemed clear we were looking at the same operation\u2014a\ncriminal operation, not nation-state espionage activity.\n\nThe line between well-organized criminal efforts and nation-state activity can often be\nblurry, but practitioners and consumers of threat intelligence should beware of inherent\nbiases. As we have shown in this Bulletin, what appears at first blush to be a clear indicator\nof nation-state malfeasance may in fact simply allow a criminal to hack your way of\nthinking shortly before hacking your organization.\n\nAppendix\n\nPhishing Documents Hashes:\n\n7bb9f72436bcbb5fcb190ebc2cce77e1ea41ba0e6614bf2347b4514e7d65da4a\ncb1cb113de38ae4ea1312d133d485769ecb38f2a9306f497788cd8fbb6fc4707\ndcec00c780cb71b955e32231d5340e90e51c3c1828262ec7cfa239e431accf5b\n68ab10ca4f823d0246822f102c412430e0a57e2026b3f0a1fd97f200e9e0e707\n\nRedControle Hashes:\n\n8/14\n\n\f1847f578bb25fc980f8dd4112e746df0e60531012083ffbd1f294d9b19f01e26\nc12e50e7c9162d8c690d3474400fe2f5d0a9c2903adbd2837d3a9023ba86fb79\n9949d5d1adb4a44463363c04678dbff0d45aeff740c754aff0c3d7b54d26016d\n0556aca3b5f3a4797ca36150a4b1423ec42a6827749599395d35e369f6df5568\n302866c5209e8f0b0b78bbc3411e38777de9ca59a8e1c6fa0ffdf7e35aecb2aa\n63d8f1566b5d0fa6459a89a0d48a163b8a356bdf2c0bec4c648b253bd8f36bb9\n8f7cf81d8bfb3780b48693020a18071a9fd382d06b0b7932226b4d583b03c3af\n9949d5d1adb4a44463363c04678dbff0d45aeff740c754aff0c3d7b54d26016d\naa8dc9ad33ffb69b19d2d685e302888eb557a0159c15689c0eb36b6e649c4f3a\nc0b090eca76ccff3b8e7da9a3d94418d0102277a40b1dadf7fd9096ddd668e79\nd31ee9ca7eb1d0fce0f688938269c7200c982f0f13daa9d40a4ce0824de6cc18\n\nStickyKeys Hash:\n\n6e476a2ef02986a13274fb2a126ed60a1ede252919d6993de03622aaa7fe6228\n\nDropper Hash:\n\nb65125ee14f2bf12a58f67c623943658dd457e5b40b354da0975d7615fe9d932\n\nC2 and Phishing Domains:\n\n10-sendmail[.]ru\n3-sendmail[.]ru\na-nhk[.]ru\nacron[.]ru[.]com\nagrarnik-ooo[.]ru\nagrocentrer-eurohem[.]ru\nagroudo[.]ru\namonni[.]ru\naudemar-piguet[.]ru\nautch-mail[.]ru\nazot-n[.]ru\nazot-sds[.]ru\nazotsds[.]ru\nazs-gazpromneft[.]ru\nbalecsm[.]ru\nbarsintez[.]ru\nbashneft-centralasia[.]ru\nbashneft[.]su\nberkovetc[.]ru\nbitmain[.]org[.]ru\nbitum-gazpromneft[.]ru\nbitum-rosneft[.]ru\nbitum-samara[.]ru\nbitumen-rosneft[.]ru\nbitumnpk[.]ru\nbor-silicat[.]ru\n\n9/14\n\n\fbox5[.]photosfromcessna[.]com\nbulgarsyntezi[.]ru\nbunker-rosneft[.]ru\ncard-rn[.]ru\ncargill[.]com[.]ru\ncenter-nic[.]ru\nchem-torg[.]ru\nchemcourier[.]ru\nchickenpaws[.]ru\nchina-technika[.]ru\ncombisapsan[.]ru\ncontacts[.]rosneft-opt[.]su\ncryptoman[.]org[.]ru\ncuban-phosagro[.]ru\ndc-02ec0b5f-mail[.]mail-autch[.]ru\ndc-0649e3d7-mail[.]mp-star[.]ru\ndc-45e81045-mail[.]cibur[.]ru\ndc-99de0f72f24b[.]3-sendmail[.]ru\ndv-china[.]ru\nelectronrg[.]ru\neuro-bitum[.]ru\neuro-chimgroup[.]ru\neurochem-nevinnomissk[.]ru\neurochem-novomoskovsk[.]ru\neurochem-novomoskovsk[.]ru[.]com\neurochem-orel[.]ru\neurochem-trading[.]com\neurochem-trading[.]ru\neurochemnovomoskovsk[.]ru\neurochim[.]ru[.]com\neurohem-novomokcovsk[.]ru\neurohem[.]ru\neurohemgroup[.]ru\nexp[.]gazpromlpj[.]ru\nexpert-cabel[.]ru\nfarr-post[.]ru\nfesagro[.]ru\nflatglas[.]ru\nfrigat-m[.]ru\ng-pntrade[.]ru\ngazprom-bitumen[.]ru\ngazprom-centralasia[.]ru\ngazprom-international[.]su\ngazpromlpg[.]com\ngazpromlpj[.]ru\ngazpromlpq[.]ru\n\n10/14\n\n\fgazpromneft-aero[.]ru\ngispnd[.]ru\ngpn-salavat[.]ru\nhcsds-azot[.]ru\nimap[.]mrggazprom[.]ru\ninter-finans[.]ru\ninter-lens[.]ru\njohn-dir[.]ru\nkartll[.]ru\nkolomna-profil[.]ru\nkub-oil[.]ru\nkuban-phosagro[.]ru\nkubeliai[.]lt\nkubmaslozavod[.]ru\nkyazot[.]ru\nkyrgyzstan-gazprom[.]ru\nlpggazprom[.]ru\nlubricants-rn[.]ru\nlubricants-rosneft[.]com\nlubricants-rosneft[.]ru\nlukoil[.]com\nmag-numoil[.]ru\nmap[.]ros-razvitie[.]ru\nmargcom[.]ru\nmasterhoste[.]ru\nmazutibitum[.]ru\nmc-gp[.]ru\nmekstekla[.]ru\nmendeleevscazot[.]ru\nmendeleevsk-azot[.]ru\nmetalloprakat[.]ru\nmir-polimer[.]ru\nmnpz-gazpromneft[.]ru\nmp-star[.]ru\nmpt-o[.]ru\nmrg-gazprom[.]ru\nmrggazprom[.]ru\nmta5[.]boommail[.]org\nnic-center[.]ru\nnknpz[.]rosneft-opt[.]su\nnl-mk[.]ru\noil-gazpromneft[.]ru\nomega-metal[.]ru\nonlinecontract[.]su\nooo-agrarnik[.]com\nooo-tandem[.]net\n\n11/14\n\n\fopt-rosneft[.]ru\nphaz[.]ru\npolietileni[.]ru\npoligal-vostok[.]ru\npolimer-trubi[.]ru\npolimer16[.]ru[.]com\npop[.]gazprom-centralasia[.]ru\npop[.]mnpz-gazpromneft[.]ru\npop[.]opt-rosneft[.]ru\npop[.]rnp-rosneft[.]ru\npop[.]ros-razvitie[.]ru\npostaitaliana[.]win\nprof-nastillist[.]ru\nprof-zavod[.]ru\nprofzavod[.]net\npromximiya[.]ru\nprosintezi[.]ru\npushkinomill[.]ru\nrefas[.]rnp-rosneft[.]ru\nrefinery-yaroslavl[.]ru\nrefinery-yaroslavl[.]su\nrn-cpr[.]ru\nrn-lubricants[.]ru\nrnp-rosneft[.]ru\nroamingupdate[.]eu\nros-eurochem[.]ru\nros-metal[.]ru\nros-nefti[.]ru\nros-razvitie[.]ru\nrosagrotrayd[.]ru\nrosneft-centralasia[.]ru\nrosneft-de[.]com\nrosneft-opt[.]com\nrosneft-opt[.]su\nrosneft-tender[.]ru\nrosneft-tender[.]su\nrosneft-tuapse[.]ru\nrospolimery[.]ru\nrost-selmash[.]ru\nrps[.]ru[.]com\nru-uralchem[.]ru\nru-uralhim[.]ru\nruproflist[.]ru\nrus-agrohim[.]ru\nrusagro-him[.]ru\nrusagrohim[.]com\n\n12/14\n\n\frussbitum[.]ru\nsaharzol[.]com\nsal-stek[.]ru\nsalavstek[.]ru\nsalstec[.]ru\nsalstek[.]com[.]ru\nsamp[.]real-city[.]lt\nsarat-steklo[.]ru\nsaratovstroisteklo[.]ru\nsaratovstroy-steklo[.]ru\nseverstal[.]com[.]ru\nsibur[.]com[.]ru\nsibur[.]ru[.]com\nsiburint[.]ru\nsimf-khp[.]ru\nsmtp[.]gazpromlpj[.]ru\nspectech-china[.]ru\nspi-mex[.]ru\nsteklo-stroj[.]ru\nsuccessex[.]ru\nsuccessex24[.]ru\nsx[.]perfecttool[.]net\nta-bitum[.]ru\ntdbkh[.]ru\nteh-mail[.]ru\ntektorg-rosneft[.]ru\ntender-rosneft[.]com\ntender-rosneft[.]net\ntender-rosneft[.]ru\ntender-rosneft[.]su\ntender[.]ros-nefti[.]ru\ntiret-salt[.]ru\ntitanomsk[.]ru\ntmez[.]ru\ntolyatiazot[.]ru\ntransneft[.]su\ntrstorg[.]ru\ntsenazabora[.]ru\ntuapse-rosneft[.]ru\nufaneftehim[.]bashneft[.]su\nufaorgsintez[.]bashneft[.]su\nural-met[.]su\nuralchem[.]net[.]ru\nuralchemm[.]ru\nuralchim[.]com\nuralchim[.]com[.]ru\n\n13/14\n\n\furalhem[.]ru\nvitohim-rostov[.]ru\nvmznasos[.]ru\nvmzz[.]ru\nvojxua[.]iheys[.]in\nvolga-phosagro[.]ru\nvostok-polygal[.]ru\nwapmafija[.]eu\nworld-provodnik[.]ru\nwtpc[.]ru\nxn----7sbiki4aifik1ax[.]xn--p1ai\nxn----8sbyfdnfhp0c[.]xn--p1ai\nxn----gtbcbb8bdhqbmdl1a[.]xn--p1ai\nxn----gtbcbb8bdhqbmdl1a5j[.]xn--p1ai\nxn--80aaoboarccvfll0ah5mza[.]xn--p1ai\nxn--e1apchgin[.]xn--p1ai\nxn--j1aicfcj5e[.]xn--e1apchgin[.]xn--p1ai\nyandex[.]mail-autch[.]ru\nyug-polimer[.]ru\n\nShare It:\n\nResearch & Intelligence\n\nAbout The Author\n\nCylance Threat Intelligence Bulletin Monthly bulletin from the Cylance Threat\nIntelligence Team.\nAuthor's Bio\n\n14/14\n\n\f"], "URLs": [], "weight": 0.0}