{"rule_id": 464, "name": "Chinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Targeting Europe _ Proofpoint US", "description": "-", "references": [], "File_Names": ["wd4sx.wmf", "OSEC234.tmp", "Covdi.rtf", "OSEB979.tmp", "Dalailamatrustindia.ddns", "file.dll", "CHINESE.ppsx", "TA.data", "Credential.dll", "credential.dll"], "MD5_Hashes": [], "SHA1_Hashes": [], "SHA256_Hashes": ["4a4a959aef64ea48e2b831468119180d0af4b5b685c35170f5db3f001b9cc319"], "Registry_Entries": ["HKEY_CURRENT_USER\\Software\\Microsoft\\WAB\\Resources. It contains four distinct\nkeys named \u201cDefaultString\u201d, \u201cCredentials\u201d, \u201cSecurity\u201d, and \u201cProperty\u201d. The\n\u201cDefaultString\u201d is randomly generated by CoCreatGuid() with the initial formatting done\nby the multibyte _sprintf_(). This is then stored in the registry by RegSetValueExW()\nwhich uses the wide character type. This results in a broken encoding that renders as\nChinese characters. This should not be interpreted as an indication that the threat actor is\nusing Chinese characters in the malware configuration, despite broader attribution\npointing to Chinese state associated actors. The remaining three keys \u201cCredentials\u201d,\n\u201cSecurity\u201d, and \u201cProperty\u201d represent the three C2 servers in encrypted format that are\nutilized by the malware. The below algorithm is used to decrypt the C2 servers which, in\nthis sample, are revealed to be the IP address 107.151.194[.]197 utilizing ports 80, 443,\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n6/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\nand 8080. Notably, this IP address hosted a single domain welfaretibet[.]tk as of April 5,\n2020. This suggests that threat actors did not establish standalone network infrastructure\nfor targeting European economic entities and intended to utilize this IP to persist in\ntargeting entities related to Tibetan matters in the future.\n\nDecrypted C2 IP Addresses:\n\n107.151.194[.]197:80\n107.151.194[.]197:443\n107.151.194[.]197:8080\n\nFigure 5: Sepulcher malware configuration.\n\nFigure 6: Sepulcher malware C2 decryption algorithm.\n\nSepulcher malware has seven work modes that include conducting reconnaissance on an\ninfected host, spawning a reverse command shell, reading from file, and writing to file.\nMore granularly, additional commands exist within the intelligence\ngathering/reconnaissance work modes (1002, 1003, 1004) which carry out\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n7/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\nreconnaissance functionality within the infected host. These commands include obtaining\ninformation about the drives, file information, directory statistics, directory paths,\ndirectory content, running processes, and services. Additionally, it is capable of more\nactive functionalities like deleting directories and files, creating directories, moving file\nsource to destination, spawning a shell to execute commands, terminating a process,\nrestarting a service, changing a service start type, and deleting a service.\n\nMode Functionality\n\n1005 Reverse command shell\n\n1006 Read from File\n\n1009 Do nothing /PONG\n\n1919 Write to File\n\n1002\n\nSystem intelligence gathering/reconnaissance functionalities\n\n1003\n\n1004\n\nFigure 7: Sepulcher malware work modes (commands).\n\nCom-\nmand\n\nCOM-\nMAND_DA-\nTA.data\n\nFunctionality\n\n6001\n\nDrive letter\n\nGet drive information: sizes, type, path, etc.\n\n6002\n\nFile path\n\nGet file information in a WIN32_FILE_ATTRIBUTE_DATA\nstructure.\n\n6003\n\nDirectory\npath\n\nGet directory statistics: number of files, sub directories and to-\ntal size.\n\n6004\n\nDirectory\npath\n\nGet directory content information: WIN32_FILE_ATTRIBUTE_-\nDATA and dir/file name.\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n8/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\n6005\n\nN/A\n\nDelete directory / file and empty the recycle bin.\n\n6006\n\nDirectory\nname\n\nCreate directory.\n\n6007\n\nSrc file path,\nDst file path\n\nMove file Source to Destination.\n\n6008\n\nN/A\n\nGet all drives information: sizes, types, path, etc.\n\n6009\n\nCommand\nstring\n\nShell execute command.\n\n6010\n\nPID string\n\nTerminate process.\n\n6017\n\nN/A\n\nGet directory content detailed information: WIN32_FILE_AT-\nTRIBUTE_DATA and dir/file name for each dir/file inside\n\n6018\n\nN/A\n\nGet list of running processes.\n\n6019\n\nN/A\n\nGet list of services.\n\n6020\n\nN/A\n\nRestart service.\n\n6021\n\nN/A\n\nChange service start type.\n\n6023\n\nN/A\n\nDelete service.\n\nFigure 8: Sepulcher intelligence gathering/reconnaissance commands.\n\nCommand and Control\n\nThe malware receives commands including various mode commands and sub-commands\nvia the C2 addresses decrypted from the malware\u2019s configuration. The initial\ncommunication is initiated by the client via a single byte XOR encrypted handshake\npacket and completed via a server-to-client packet that is not encrypted. The\ncommunication then continues with a single byte XOR encrypted client-to-server\nPACKET_HELLO that specifies the malware command mode. In the case of modes 1002,\n1003, and 1004, which are the commands that initialize the intelligence\ngathering/reconnaissance capabilities of the malware, the server replays the\nPACKET_HELLO with mode commands in the initial PACKET_HANDSHAKE via a\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n9/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\nPACKET_COMMAND. The same method of C2 communication was observed for\nSepulcher sub-commands, however, the format of observed sub-commands delivered via\nthe \u201cCOMMAND_DATA\u201d field varied depending on content of the PACKET_COMMAND.\nOnce a PACKET_COMMAND is received, the result is stored in a %TEMP% file on the\nhost. Finally, that result is exfiltrated to the C2 server using the above described\nPACKET_COMMAND method.\n\nFigure 9: Sepulcher C2 PACKET_HELLO delivering malware mode command.\n\nFigure 10: Sepulcher C2 PACKET_COMMAND to replay initial packet with mode\ncommand.\n\nConclusion\n\nThe adoption of COVID-19 lures by Chinese APT groups in espionage campaigns was a\ngrowing trend in the threat landscape during the first half of 2020. This was thought to be\neffective decoy fodder by threat actors as was observed in the WHO content that was\ncoopted as part of the TA413 March 2020 campaign targeting European economic\nentities. However, following an initial urgency in intelligence collection around the health\nof western global economies in response to the COVID-19 pandemic, a return to normalcy\nwas observed in both the targets and decoy content of TA413 campaigns. While the new\nSepulcher malware is far from groundbreaking, its combination with timely social\nengineering lures masquerading as critical guidance from the WHO leveraged an urgent\nglobal crisis to entice victims. This campaign\u2019s specific focus on European economic,\ndiplomatic, and legislative entities belies a possible momentary realignment for Chinese\ncyber espionage groups to collect information on global economies cast into upheaval as a\nresult of COVID-19. However, in the case of TA413 that shift may have been short lived.\nThe re-emergence of well-known Tibetan themed sender addresses and graphically\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n10/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\ndidactic PowerPoint attachments in later July again tie TA413 to its emblematic targeting\nof the Tibetan community. Despite the recurring use of publicly disclosed email\naddresses, a pedestrian RAT, and the recycling of delivery methods observed over a year\nago, the targeting shift between these two campaigns paint a conspicuously contemporary\nportrait of a rapidly evolving cyber threat landscape in 2020.\n\n Indicators of Compromise (IOCs)\n\nIOC\n\nIOC\nType\n\nDescription\n\n4a4a959ae-\nf64ea48e2b831468119180d0af4b5b685c35170f5d-\nb3f001b9cc319\n\nSHA256\n\nCredential.dll \n\nSepulcher Malware\n\nMarch 2020\n\nf6f9224c389ee46b28fe04847de4afb1e33-\nca03763c9e5c41bc61a29eab7f669\n\nSHA256\n\nOSEC234.tmp\n\nSepulcher Malware Dro\n\nMarch 2020\n\ntseringkanyaq@yahoo[.]com\n\nEmail\nAddress\n\nSender Address First O\nserved 2013\n\n107.151.194[.]197\n\nIP\n\nCommand & Control \n\nwelfaretibet[.]tk\n\nDomain\n\nDomain Related by I\n\nMarch 2020\n\nmediabureauin@gmail[.]com\n\nEmail\nAddress\n\nSender Address First O\nserved 2019\n\nff301b3295959a3ac5f3d0a5ea0d9f0aedcd8-\nda7c4207b18f4bbb6ddaa0cdf22\n\nSHA256\n\nPowerPoint Attachme\n\n TIBETANS BEING HIT\nDEADLY VIRUS THAT C\nRIES A GUN AND SPE\n\nCHINESE.ppsx\n\n118.99.13[.]4\n\nIP\n\nMalware Delivery IP\n\nhxxp://118.99.13[.]4:1234/qqqzqa\n\nURL\n\nURL\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n11/12\n\n\f9/7/2020\n\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Ta\u2026\n\nhxxp://118.99.13[.]4:8099/file.dll\n\nURL\n\nURL Delivery Resour\n\nC2 Communication\n\ne89614e3b0430d706bef2d1f13b30b43e5c53d-\nb9a477e2ff60ef5464e1e9add4\n\nSepulcher Malware\n\nSHA256\n\nFile.dll | Credential.d\n\nSepulcher Malware\n\nJuly 2020\n\nDalailamatrustindia.ddns[.]net\n\nDomain Command & Control Do\n\n115.126.6[.]16\n\nIP\n\nHosting IP\n\nDalailamatrustindia.ddns\n\n\u00a9 2020. All rights reserved. Terms and conditions Privacy Policy Sitemap\n\nhttps://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic\n\n12/12\n\n\u00a0\n\f"], "URLs": ["https://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic"], "weight": 0.0}